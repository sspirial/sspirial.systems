var IB=Object.defineProperty;var H3=e=>{throw TypeError(e)};var MB=(e,t,n)=>t in e?IB(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var y=(e,t,n)=>MB(e,typeof t!="symbol"?t+"":t,n),mT=(e,t,n)=>t.has(e)||H3("Cannot "+n);var Ce=(e,t,n)=>(mT(e,t,"read from private field"),n?n.call(e):t.get(e)),br=(e,t,n)=>t.has(e)?H3("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),Zl=(e,t,n,r)=>(mT(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),jt=(e,t,n)=>(mT(e,t,"access private method"),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const c of i)if(c.type==="childList")for(const f of c.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&r(f)}).observe(document,{childList:!0,subtree:!0});function n(i){const c={};return i.integrity&&(c.integrity=i.integrity),i.referrerPolicy&&(c.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?c.credentials="include":i.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function r(i){if(i.ep)return;i.ep=!0;const c=n(i);fetch(i.href,c)}})();function $j(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var gT={exports:{}},wg={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var B3;function jB(){if(B3)return wg;B3=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(r,i,c){var f=null;if(c!==void 0&&(f=""+c),i.key!==void 0&&(f=""+i.key),"key"in i){c={};for(var m in i)m!=="key"&&(c[m]=i[m])}else c=i;return i=c.ref,{$$typeof:e,type:r,key:f,ref:i!==void 0?i:null,props:c}}return wg.Fragment=t,wg.jsx=n,wg.jsxs=n,wg}var V3;function FB(){return V3||(V3=1,gT.exports=jB()),gT.exports}var F=FB(),pT={exports:{}},Eg={},_T={exports:{}},yT={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var G3;function LB(){return G3||(G3=1,(function(e){function t(oe,Te){var Ee=oe.length;oe.push(Te);e:for(;0<Ee;){var pt=Ee-1>>>1,Q=oe[pt];if(0<i(Q,Te))oe[pt]=Te,oe[Ee]=Q,Ee=pt;else break e}}function n(oe){return oe.length===0?null:oe[0]}function r(oe){if(oe.length===0)return null;var Te=oe[0],Ee=oe.pop();if(Ee!==Te){oe[0]=Ee;e:for(var pt=0,Q=oe.length,ue=Q>>>1;pt<ue;){var Be=2*(pt+1)-1,_e=oe[Be],be=Be+1,ct=oe[be];if(0>i(_e,Ee))be<Q&&0>i(ct,_e)?(oe[pt]=ct,oe[be]=Ee,pt=be):(oe[pt]=_e,oe[Be]=Ee,pt=Be);else if(be<Q&&0>i(ct,Ee))oe[pt]=ct,oe[be]=Ee,pt=be;else break e}}return Te}function i(oe,Te){var Ee=oe.sortIndex-Te.sortIndex;return Ee!==0?Ee:oe.id-Te.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;e.unstable_now=function(){return c.now()}}else{var f=Date,m=f.now();e.unstable_now=function(){return f.now()-m}}var g=[],b=[],S=1,v=null,q=3,k=!1,N=!1,H=!1,x=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;function $(oe){for(var Te=n(b);Te!==null;){if(Te.callback===null)r(b);else if(Te.startTime<=oe)r(b),Te.sortIndex=Te.expirationTime,t(g,Te);else break;Te=n(b)}}function R(oe){if(H=!1,$(oe),!N)if(n(g)!==null)N=!0,ge();else{var Te=n(b);Te!==null&&Ve(R,Te.startTime-oe)}}var I=!1,z=-1,V=5,K=-1;function Y(){return!(e.unstable_now()-K<V)}function P(){if(I){var oe=e.unstable_now();K=oe;var Te=!0;try{e:{N=!1,H&&(H=!1,C(z),z=-1),k=!0;var Ee=q;try{t:{for($(oe),v=n(g);v!==null&&!(v.expirationTime>oe&&Y());){var pt=v.callback;if(typeof pt=="function"){v.callback=null,q=v.priorityLevel;var Q=pt(v.expirationTime<=oe);if(oe=e.unstable_now(),typeof Q=="function"){v.callback=Q,$(oe),Te=!0;break t}v===n(g)&&r(g),$(oe)}else r(g);v=n(g)}if(v!==null)Te=!0;else{var ue=n(b);ue!==null&&Ve(R,ue.startTime-oe),Te=!1}}break e}finally{v=null,q=Ee,k=!1}Te=void 0}}finally{Te?ne():I=!1}}}var ne;if(typeof E=="function")ne=function(){E(P)};else if(typeof MessageChannel<"u"){var Se=new MessageChannel,Re=Se.port2;Se.port1.onmessage=P,ne=function(){Re.postMessage(null)}}else ne=function(){x(P,0)};function ge(){I||(I=!0,ne())}function Ve(oe,Te){z=x(function(){oe(e.unstable_now())},Te)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(oe){oe.callback=null},e.unstable_continueExecution=function(){N||k||(N=!0,ge())},e.unstable_forceFrameRate=function(oe){0>oe||125<oe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):V=0<oe?Math.floor(1e3/oe):5},e.unstable_getCurrentPriorityLevel=function(){return q},e.unstable_getFirstCallbackNode=function(){return n(g)},e.unstable_next=function(oe){switch(q){case 1:case 2:case 3:var Te=3;break;default:Te=q}var Ee=q;q=Te;try{return oe()}finally{q=Ee}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(oe,Te){switch(oe){case 1:case 2:case 3:case 4:case 5:break;default:oe=3}var Ee=q;q=oe;try{return Te()}finally{q=Ee}},e.unstable_scheduleCallback=function(oe,Te,Ee){var pt=e.unstable_now();switch(typeof Ee=="object"&&Ee!==null?(Ee=Ee.delay,Ee=typeof Ee=="number"&&0<Ee?pt+Ee:pt):Ee=pt,oe){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=Ee+Q,oe={id:S++,callback:Te,priorityLevel:oe,startTime:Ee,expirationTime:Q,sortIndex:-1},Ee>pt?(oe.sortIndex=Ee,t(b,oe),n(g)===null&&oe===n(b)&&(H?(C(z),z=-1):H=!0,Ve(R,Ee-pt))):(oe.sortIndex=Q,t(g,oe),N||k||(N=!0,ge())),oe},e.unstable_shouldYield=Y,e.unstable_wrapCallback=function(oe){var Te=q;return function(){var Ee=q;q=Te;try{return oe.apply(this,arguments)}finally{q=Ee}}}})(yT)),yT}var K3;function UB(){return K3||(K3=1,_T.exports=LB()),_T.exports}var bT={exports:{}},_t={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Q3;function zB(){if(Q3)return _t;Q3=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),f=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),b=Symbol.for("react.memo"),S=Symbol.for("react.lazy"),v=Symbol.iterator;function q(Q){return Q===null||typeof Q!="object"?null:(Q=v&&Q[v]||Q["@@iterator"],typeof Q=="function"?Q:null)}var k={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},N=Object.assign,H={};function x(Q,ue,Be){this.props=Q,this.context=ue,this.refs=H,this.updater=Be||k}x.prototype.isReactComponent={},x.prototype.setState=function(Q,ue){if(typeof Q!="object"&&typeof Q!="function"&&Q!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Q,ue,"setState")},x.prototype.forceUpdate=function(Q){this.updater.enqueueForceUpdate(this,Q,"forceUpdate")};function C(){}C.prototype=x.prototype;function E(Q,ue,Be){this.props=Q,this.context=ue,this.refs=H,this.updater=Be||k}var $=E.prototype=new C;$.constructor=E,N($,x.prototype),$.isPureReactComponent=!0;var R=Array.isArray,I={H:null,A:null,T:null,S:null},z=Object.prototype.hasOwnProperty;function V(Q,ue,Be,_e,be,ct){return Be=ct.ref,{$$typeof:e,type:Q,key:ue,ref:Be!==void 0?Be:null,props:ct}}function K(Q,ue){return V(Q.type,ue,void 0,void 0,void 0,Q.props)}function Y(Q){return typeof Q=="object"&&Q!==null&&Q.$$typeof===e}function P(Q){var ue={"=":"=0",":":"=2"};return"$"+Q.replace(/[=:]/g,function(Be){return ue[Be]})}var ne=/\/+/g;function Se(Q,ue){return typeof Q=="object"&&Q!==null&&Q.key!=null?P(""+Q.key):ue.toString(36)}function Re(){}function ge(Q){switch(Q.status){case"fulfilled":return Q.value;case"rejected":throw Q.reason;default:switch(typeof Q.status=="string"?Q.then(Re,Re):(Q.status="pending",Q.then(function(ue){Q.status==="pending"&&(Q.status="fulfilled",Q.value=ue)},function(ue){Q.status==="pending"&&(Q.status="rejected",Q.reason=ue)})),Q.status){case"fulfilled":return Q.value;case"rejected":throw Q.reason}}throw Q}function Ve(Q,ue,Be,_e,be){var ct=typeof Q;(ct==="undefined"||ct==="boolean")&&(Q=null);var rt=!1;if(Q===null)rt=!0;else switch(ct){case"bigint":case"string":case"number":rt=!0;break;case"object":switch(Q.$$typeof){case e:case t:rt=!0;break;case S:return rt=Q._init,Ve(rt(Q._payload),ue,Be,_e,be)}}if(rt)return be=be(Q),rt=_e===""?"."+Se(Q,0):_e,R(be)?(Be="",rt!=null&&(Be=rt.replace(ne,"$&/")+"/"),Ve(be,ue,Be,"",function(vn){return vn})):be!=null&&(Y(be)&&(be=K(be,Be+(be.key==null||Q&&Q.key===be.key?"":(""+be.key).replace(ne,"$&/")+"/")+rt)),ue.push(be)),1;rt=0;var Qn=_e===""?".":_e+":";if(R(Q))for(var Lt=0;Lt<Q.length;Lt++)_e=Q[Lt],ct=Qn+Se(_e,Lt),rt+=Ve(_e,ue,Be,ct,be);else if(Lt=q(Q),typeof Lt=="function")for(Q=Lt.call(Q),Lt=0;!(_e=Q.next()).done;)_e=_e.value,ct=Qn+Se(_e,Lt++),rt+=Ve(_e,ue,Be,ct,be);else if(ct==="object"){if(typeof Q.then=="function")return Ve(ge(Q),ue,Be,_e,be);throw ue=String(Q),Error("Objects are not valid as a React child (found: "+(ue==="[object Object]"?"object with keys {"+Object.keys(Q).join(", ")+"}":ue)+"). If you meant to render a collection of children, use an array instead.")}return rt}function oe(Q,ue,Be){if(Q==null)return Q;var _e=[],be=0;return Ve(Q,_e,"","",function(ct){return ue.call(Be,ct,be++)}),_e}function Te(Q){if(Q._status===-1){var ue=Q._result;ue=ue(),ue.then(function(Be){(Q._status===0||Q._status===-1)&&(Q._status=1,Q._result=Be)},function(Be){(Q._status===0||Q._status===-1)&&(Q._status=2,Q._result=Be)}),Q._status===-1&&(Q._status=0,Q._result=ue)}if(Q._status===1)return Q._result.default;throw Q._result}var Ee=typeof reportError=="function"?reportError:function(Q){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ue=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Q=="object"&&Q!==null&&typeof Q.message=="string"?String(Q.message):String(Q),error:Q});if(!window.dispatchEvent(ue))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Q);return}console.error(Q)};function pt(){}return _t.Children={map:oe,forEach:function(Q,ue,Be){oe(Q,function(){ue.apply(this,arguments)},Be)},count:function(Q){var ue=0;return oe(Q,function(){ue++}),ue},toArray:function(Q){return oe(Q,function(ue){return ue})||[]},only:function(Q){if(!Y(Q))throw Error("React.Children.only expected to receive a single React element child.");return Q}},_t.Component=x,_t.Fragment=n,_t.Profiler=i,_t.PureComponent=E,_t.StrictMode=r,_t.Suspense=g,_t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=I,_t.act=function(){throw Error("act(...) is not supported in production builds of React.")},_t.cache=function(Q){return function(){return Q.apply(null,arguments)}},_t.cloneElement=function(Q,ue,Be){if(Q==null)throw Error("The argument must be a React element, but you passed "+Q+".");var _e=N({},Q.props),be=Q.key,ct=void 0;if(ue!=null)for(rt in ue.ref!==void 0&&(ct=void 0),ue.key!==void 0&&(be=""+ue.key),ue)!z.call(ue,rt)||rt==="key"||rt==="__self"||rt==="__source"||rt==="ref"&&ue.ref===void 0||(_e[rt]=ue[rt]);var rt=arguments.length-2;if(rt===1)_e.children=Be;else if(1<rt){for(var Qn=Array(rt),Lt=0;Lt<rt;Lt++)Qn[Lt]=arguments[Lt+2];_e.children=Qn}return V(Q.type,be,void 0,void 0,ct,_e)},_t.createContext=function(Q){return Q={$$typeof:f,_currentValue:Q,_currentValue2:Q,_threadCount:0,Provider:null,Consumer:null},Q.Provider=Q,Q.Consumer={$$typeof:c,_context:Q},Q},_t.createElement=function(Q,ue,Be){var _e,be={},ct=null;if(ue!=null)for(_e in ue.key!==void 0&&(ct=""+ue.key),ue)z.call(ue,_e)&&_e!=="key"&&_e!=="__self"&&_e!=="__source"&&(be[_e]=ue[_e]);var rt=arguments.length-2;if(rt===1)be.children=Be;else if(1<rt){for(var Qn=Array(rt),Lt=0;Lt<rt;Lt++)Qn[Lt]=arguments[Lt+2];be.children=Qn}if(Q&&Q.defaultProps)for(_e in rt=Q.defaultProps,rt)be[_e]===void 0&&(be[_e]=rt[_e]);return V(Q,ct,void 0,void 0,null,be)},_t.createRef=function(){return{current:null}},_t.forwardRef=function(Q){return{$$typeof:m,render:Q}},_t.isValidElement=Y,_t.lazy=function(Q){return{$$typeof:S,_payload:{_status:-1,_result:Q},_init:Te}},_t.memo=function(Q,ue){return{$$typeof:b,type:Q,compare:ue===void 0?null:ue}},_t.startTransition=function(Q){var ue=I.T,Be={};I.T=Be;try{var _e=Q(),be=I.S;be!==null&&be(Be,_e),typeof _e=="object"&&_e!==null&&typeof _e.then=="function"&&_e.then(pt,Ee)}catch(ct){Ee(ct)}finally{I.T=ue}},_t.unstable_useCacheRefresh=function(){return I.H.useCacheRefresh()},_t.use=function(Q){return I.H.use(Q)},_t.useActionState=function(Q,ue,Be){return I.H.useActionState(Q,ue,Be)},_t.useCallback=function(Q,ue){return I.H.useCallback(Q,ue)},_t.useContext=function(Q){return I.H.useContext(Q)},_t.useDebugValue=function(){},_t.useDeferredValue=function(Q,ue){return I.H.useDeferredValue(Q,ue)},_t.useEffect=function(Q,ue){return I.H.useEffect(Q,ue)},_t.useId=function(){return I.H.useId()},_t.useImperativeHandle=function(Q,ue,Be){return I.H.useImperativeHandle(Q,ue,Be)},_t.useInsertionEffect=function(Q,ue){return I.H.useInsertionEffect(Q,ue)},_t.useLayoutEffect=function(Q,ue){return I.H.useLayoutEffect(Q,ue)},_t.useMemo=function(Q,ue){return I.H.useMemo(Q,ue)},_t.useOptimistic=function(Q,ue){return I.H.useOptimistic(Q,ue)},_t.useReducer=function(Q,ue,Be){return I.H.useReducer(Q,ue,Be)},_t.useRef=function(Q){return I.H.useRef(Q)},_t.useState=function(Q){return I.H.useState(Q)},_t.useSyncExternalStore=function(Q,ue,Be){return I.H.useSyncExternalStore(Q,ue,Be)},_t.useTransition=function(){return I.H.useTransition()},_t.version="19.0.0",_t}var Y3;function hA(){return Y3||(Y3=1,bT.exports=zB()),bT.exports}var ST={exports:{}},Zr={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var W3;function PB(){if(W3)return Zr;W3=1;var e=hA();function t(g){var b="https://react.dev/errors/"+g;if(1<arguments.length){b+="?args[]="+encodeURIComponent(arguments[1]);for(var S=2;S<arguments.length;S++)b+="&args[]="+encodeURIComponent(arguments[S])}return"Minified React error #"+g+"; visit "+b+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},i=Symbol.for("react.portal");function c(g,b,S){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:v==null?null:""+v,children:g,containerInfo:b,implementation:S}}var f=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function m(g,b){if(g==="font")return"";if(typeof b=="string")return b==="use-credentials"?b:""}return Zr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Zr.createPortal=function(g,b){var S=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!b||b.nodeType!==1&&b.nodeType!==9&&b.nodeType!==11)throw Error(t(299));return c(g,b,null,S)},Zr.flushSync=function(g){var b=f.T,S=r.p;try{if(f.T=null,r.p=2,g)return g()}finally{f.T=b,r.p=S,r.d.f()}},Zr.preconnect=function(g,b){typeof g=="string"&&(b?(b=b.crossOrigin,b=typeof b=="string"?b==="use-credentials"?b:"":void 0):b=null,r.d.C(g,b))},Zr.prefetchDNS=function(g){typeof g=="string"&&r.d.D(g)},Zr.preinit=function(g,b){if(typeof g=="string"&&b&&typeof b.as=="string"){var S=b.as,v=m(S,b.crossOrigin),q=typeof b.integrity=="string"?b.integrity:void 0,k=typeof b.fetchPriority=="string"?b.fetchPriority:void 0;S==="style"?r.d.S(g,typeof b.precedence=="string"?b.precedence:void 0,{crossOrigin:v,integrity:q,fetchPriority:k}):S==="script"&&r.d.X(g,{crossOrigin:v,integrity:q,fetchPriority:k,nonce:typeof b.nonce=="string"?b.nonce:void 0})}},Zr.preinitModule=function(g,b){if(typeof g=="string")if(typeof b=="object"&&b!==null){if(b.as==null||b.as==="script"){var S=m(b.as,b.crossOrigin);r.d.M(g,{crossOrigin:S,integrity:typeof b.integrity=="string"?b.integrity:void 0,nonce:typeof b.nonce=="string"?b.nonce:void 0})}}else b==null&&r.d.M(g)},Zr.preload=function(g,b){if(typeof g=="string"&&typeof b=="object"&&b!==null&&typeof b.as=="string"){var S=b.as,v=m(S,b.crossOrigin);r.d.L(g,S,{crossOrigin:v,integrity:typeof b.integrity=="string"?b.integrity:void 0,nonce:typeof b.nonce=="string"?b.nonce:void 0,type:typeof b.type=="string"?b.type:void 0,fetchPriority:typeof b.fetchPriority=="string"?b.fetchPriority:void 0,referrerPolicy:typeof b.referrerPolicy=="string"?b.referrerPolicy:void 0,imageSrcSet:typeof b.imageSrcSet=="string"?b.imageSrcSet:void 0,imageSizes:typeof b.imageSizes=="string"?b.imageSizes:void 0,media:typeof b.media=="string"?b.media:void 0})}},Zr.preloadModule=function(g,b){if(typeof g=="string")if(b){var S=m(b.as,b.crossOrigin);r.d.m(g,{as:typeof b.as=="string"&&b.as!=="script"?b.as:void 0,crossOrigin:S,integrity:typeof b.integrity=="string"?b.integrity:void 0})}else r.d.m(g)},Zr.requestFormReset=function(g){r.d.r(g)},Zr.unstable_batchedUpdates=function(g,b){return g(b)},Zr.useFormState=function(g,b,S){return f.H.useFormState(g,b,S)},Zr.useFormStatus=function(){return f.H.useHostTransitionStatus()},Zr.version="19.0.0",Zr}var J3;function Ij(){if(J3)return ST.exports;J3=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),ST.exports=PB(),ST.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var X3;function HB(){if(X3)return Eg;X3=1;var e=UB(),t=hA(),n=Ij();function r(s){var a="https://react.dev/errors/"+s;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)a+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+s+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}var c=Symbol.for("react.element"),f=Symbol.for("react.transitional.element"),m=Symbol.for("react.portal"),g=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),v=Symbol.for("react.provider"),q=Symbol.for("react.consumer"),k=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),H=Symbol.for("react.suspense"),x=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),$=Symbol.for("react.offscreen"),R=Symbol.for("react.memo_cache_sentinel"),I=Symbol.iterator;function z(s){return s===null||typeof s!="object"?null:(s=I&&s[I]||s["@@iterator"],typeof s=="function"?s:null)}var V=Symbol.for("react.client.reference");function K(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===V?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case g:return"Fragment";case m:return"Portal";case S:return"Profiler";case b:return"StrictMode";case H:return"Suspense";case x:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case k:return(s.displayName||"Context")+".Provider";case q:return(s._context.displayName||"Context")+".Consumer";case N:var a=s.render;return s=s.displayName,s||(s=a.displayName||a.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case C:return a=s.displayName||null,a!==null?a:K(s.type)||"Memo";case E:a=s._payload,s=s._init;try{return K(s(a))}catch{}}return null}var Y=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,P=Object.assign,ne,Se;function Re(s){if(ne===void 0)try{throw Error()}catch(o){var a=o.stack.trim().match(/\n( *(at )?)/);ne=a&&a[1]||"",Se=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ne+s+Se}var ge=!1;function Ve(s,a){if(!s||ge)return"";ge=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var l={DetermineComponentFrameRoot:function(){try{if(a){var de=function(){throw Error()};if(Object.defineProperty(de.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(de,[])}catch(ae){var re=ae}Reflect.construct(s,[],de)}else{try{de.call()}catch(ae){re=ae}s.call(de.prototype)}}else{try{throw Error()}catch(ae){re=ae}(de=s())&&typeof de.catch=="function"&&de.catch(function(){})}}catch(ae){if(ae&&re&&typeof ae.stack=="string")return[ae.stack,re.stack]}return[null,null]}};l.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var h=Object.getOwnPropertyDescriptor(l.DetermineComponentFrameRoot,"name");h&&h.configurable&&Object.defineProperty(l.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var p=l.DetermineComponentFrameRoot(),T=p[0],M=p[1];if(T&&M){var B=T.split(`
`),Z=M.split(`
`);for(h=l=0;l<B.length&&!B[l].includes("DetermineComponentFrameRoot");)l++;for(;h<Z.length&&!Z[h].includes("DetermineComponentFrameRoot");)h++;if(l===B.length||h===Z.length)for(l=B.length-1,h=Z.length-1;1<=l&&0<=h&&B[l]!==Z[h];)h--;for(;1<=l&&0<=h;l--,h--)if(B[l]!==Z[h]){if(l!==1||h!==1)do if(l--,h--,0>h||B[l]!==Z[h]){var ie=`
`+B[l].replace(" at new "," at ");return s.displayName&&ie.includes("<anonymous>")&&(ie=ie.replace("<anonymous>",s.displayName)),ie}while(1<=l&&0<=h);break}}}finally{ge=!1,Error.prepareStackTrace=o}return(o=s?s.displayName||s.name:"")?Re(o):""}function oe(s){switch(s.tag){case 26:case 27:case 5:return Re(s.type);case 16:return Re("Lazy");case 13:return Re("Suspense");case 19:return Re("SuspenseList");case 0:case 15:return s=Ve(s.type,!1),s;case 11:return s=Ve(s.type.render,!1),s;case 1:return s=Ve(s.type,!0),s;default:return""}}function Te(s){try{var a="";do a+=oe(s),s=s.return;while(s);return a}catch(o){return`
Error generating stack: `+o.message+`
`+o.stack}}function Ee(s){var a=s,o=s;if(s.alternate)for(;a.return;)a=a.return;else{s=a;do a=s,(a.flags&4098)!==0&&(o=a.return),s=a.return;while(s)}return a.tag===3?o:null}function pt(s){if(s.tag===13){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function Q(s){if(Ee(s)!==s)throw Error(r(188))}function ue(s){var a=s.alternate;if(!a){if(a=Ee(s),a===null)throw Error(r(188));return a!==s?null:s}for(var o=s,l=a;;){var h=o.return;if(h===null)break;var p=h.alternate;if(p===null){if(l=h.return,l!==null){o=l;continue}break}if(h.child===p.child){for(p=h.child;p;){if(p===o)return Q(h),s;if(p===l)return Q(h),a;p=p.sibling}throw Error(r(188))}if(o.return!==l.return)o=h,l=p;else{for(var T=!1,M=h.child;M;){if(M===o){T=!0,o=h,l=p;break}if(M===l){T=!0,l=h,o=p;break}M=M.sibling}if(!T){for(M=p.child;M;){if(M===o){T=!0,o=p,l=h;break}if(M===l){T=!0,l=p,o=h;break}M=M.sibling}if(!T)throw Error(r(189))}}if(o.alternate!==l)throw Error(r(190))}if(o.tag!==3)throw Error(r(188));return o.stateNode.current===o?s:a}function Be(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s;for(s=s.child;s!==null;){if(a=Be(s),a!==null)return a;s=s.sibling}return null}var _e=Array.isArray,be=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ct={pending:!1,data:null,method:null,action:null},rt=[],Qn=-1;function Lt(s){return{current:s}}function vn(s){0>Qn||(s.current=rt[Qn],rt[Qn]=null,Qn--)}function Kt(s,a){Qn++,rt[Qn]=s.current,s.current=a}var pr=Lt(null),Tl=Lt(null),Ia=Lt(null),Tf=Lt(null);function Xo(s,a){switch(Kt(Ia,a),Kt(Tl,s),Kt(pr,null),s=a.nodeType,s){case 9:case 11:a=(a=a.documentElement)&&(a=a.namespaceURI)?y3(a):0;break;default:if(s=s===8?a.parentNode:a,a=s.tagName,s=s.namespaceURI)s=y3(s),a=b3(s,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}vn(pr),Kt(pr,a)}function Qi(){vn(pr),vn(Tl),vn(Ia)}function hm(s){s.memoizedState!==null&&Kt(Tf,s);var a=pr.current,o=b3(a,s.type);a!==o&&(Kt(Tl,s),Kt(pr,o))}function kl(s){Tl.current===s&&(vn(pr),vn(Tl)),Tf.current===s&&(vn(Tf),_g._currentValue=ct)}var mm=Object.prototype.hasOwnProperty,gm=e.unstable_scheduleCallback,pm=e.unstable_cancelCallback,We=e.unstable_shouldYield,cn=e.unstable_requestPaint,Ms=e.unstable_now,kf=e.unstable_getCurrentPriorityLevel,_m=e.unstable_ImmediatePriority,Yi=e.unstable_UserBlockingPriority,Cf=e.unstable_NormalPriority,eE=e.unstable_LowPriority,ym=e.unstable_IdlePriority,Zo=e.log,Wi=e.unstable_setDisableYieldValue,Cl=null,mt=null;function tE(s){if(mt&&typeof mt.onCommitFiberRoot=="function")try{mt.onCommitFiberRoot(Cl,s,void 0,(s.current.flags&128)===128)}catch{}}function Ma(s){if(typeof Zo=="function"&&Wi(s),mt&&typeof mt.setStrictMode=="function")try{mt.setStrictMode(Cl,s)}catch{}}var jn=Math.clz32?Math.clz32:Sm,bm=Math.log,ec=Math.LN2;function Sm(s){return s>>>=0,s===0?32:31-(bm(s)/ec|0)|0}var tc=128,Af=4194304;function cs(s){var a=s&42;if(a!==0)return a;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Rf(s,a){var o=s.pendingLanes;if(o===0)return 0;var l=0,h=s.suspendedLanes,p=s.pingedLanes,T=s.warmLanes;s=s.finishedLanes!==0;var M=o&134217727;return M!==0?(o=M&~h,o!==0?l=cs(o):(p&=M,p!==0?l=cs(p):s||(T=M&~T,T!==0&&(l=cs(T))))):(M=o&~h,M!==0?l=cs(M):p!==0?l=cs(p):s||(T=o&~T,T!==0&&(l=cs(T)))),l===0?0:a!==0&&a!==l&&(a&h)===0&&(h=l&-l,T=a&-a,h>=T||h===32&&(T&4194176)!==0)?a:l}function nc(s,a){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&a)===0}function oy(s,a){switch(s){case 1:case 2:case 4:case 8:return a+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function et(){var s=tc;return tc<<=1,(tc&4194176)===0&&(tc=128),s}function cy(){var s=Af;return Af<<=1,(Af&62914560)===0&&(Af=4194304),s}function vm(s){for(var a=[],o=0;31>o;o++)a.push(s);return a}function Al(s,a){s.pendingLanes|=a,a!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function nE(s,a,o,l,h,p){var T=s.pendingLanes;s.pendingLanes=o,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=o,s.entangledLanes&=o,s.errorRecoveryDisabledLanes&=o,s.shellSuspendCounter=0;var M=s.entanglements,B=s.expirationTimes,Z=s.hiddenUpdates;for(o=T&~o;0<o;){var ie=31-jn(o),de=1<<ie;M[ie]=0,B[ie]=-1;var re=Z[ie];if(re!==null)for(Z[ie]=null,ie=0;ie<re.length;ie++){var ae=re[ie];ae!==null&&(ae.lane&=-536870913)}o&=~de}l!==0&&ly(s,l,0),p!==0&&h===0&&s.tag!==0&&(s.suspendedLanes|=p&~(T&~a))}function ly(s,a,o){s.pendingLanes|=a,s.suspendedLanes&=~a;var l=31-jn(a);s.entangledLanes|=a,s.entanglements[l]=s.entanglements[l]|1073741824|o&4194218}function uy(s,a){var o=s.entangledLanes|=a;for(s=s.entanglements;o;){var l=31-jn(o),h=1<<l;h&a|s[l]&a&&(s[l]|=a),o&=~h}}function xf(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function A(){var s=be.p;return s!==0?s:(s=window.event,s===void 0?32:j3(s.type))}function bt(s,a){var o=be.p;try{return be.p=s,a()}finally{be.p=o}}var fi=Math.random().toString(36).slice(2),Ar="__reactFiber$"+fi,Qr="__reactProps$"+fi,rc="__reactContainer$"+fi,sc="__reactEvents$"+fi,rE="__reactListeners$"+fi,sE="__reactHandles$"+fi,fy="__reactResources$"+fi,ja="__reactMarker$"+fi;function wm(s){delete s[Ar],delete s[Qr],delete s[sc],delete s[rE],delete s[sE]}function Yr(s){var a=s[Ar];if(a)return a;for(var o=s.parentNode;o;){if(a=o[rc]||o[Ar]){if(o=a.alternate,a.child!==null||o!==null&&o.child!==null)for(s=w3(s);s!==null;){if(o=s[Ar])return o;s=w3(s)}return a}s=o,o=s.parentNode}return null}function ac(s){if(s=s[Ar]||s[rc]){var a=s.tag;if(a===5||a===6||a===13||a===26||a===27||a===3)return s}return null}function Rl(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s.stateNode;throw Error(r(33))}function ic(s){var a=s[fy];return a||(a=s[fy]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function ir(s){s[ja]=!0}var dy=new Set,hy={};function Ji(s,a){oc(s,a),oc(s+"Capture",a)}function oc(s,a){for(hy[s]=a,s=0;s<a.length;s++)dy.add(a[s])}var Fa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),my=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),gy={},py={};function aE(s){return mm.call(py,s)?!0:mm.call(gy,s)?!1:my.test(s)?py[s]=!0:(gy[s]=!0,!1)}function Of(s,a,o){if(aE(a))if(o===null)s.removeAttribute(a);else{switch(typeof o){case"undefined":case"function":case"symbol":s.removeAttribute(a);return;case"boolean":var l=a.toLowerCase().slice(0,5);if(l!=="data-"&&l!=="aria-"){s.removeAttribute(a);return}}s.setAttribute(a,""+o)}}function Df(s,a,o){if(o===null)s.removeAttribute(a);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(a);return}s.setAttribute(a,""+o)}}function La(s,a,o,l){if(l===null)s.removeAttribute(o);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttributeNS(a,o,""+l)}}function As(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function _y(s){var a=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function iE(s){var a=_y(s)?"checked":"value",o=Object.getOwnPropertyDescriptor(s.constructor.prototype,a),l=""+s[a];if(!s.hasOwnProperty(a)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var h=o.get,p=o.set;return Object.defineProperty(s,a,{configurable:!0,get:function(){return h.call(this)},set:function(T){l=""+T,p.call(this,T)}}),Object.defineProperty(s,a,{enumerable:o.enumerable}),{getValue:function(){return l},setValue:function(T){l=""+T},stopTracking:function(){s._valueTracker=null,delete s[a]}}}}function qf(s){s._valueTracker||(s._valueTracker=iE(s))}function yy(s){if(!s)return!1;var a=s._valueTracker;if(!a)return!0;var o=a.getValue(),l="";return s&&(l=_y(s)?s.checked?"true":"false":s.value),s=l,s!==o?(a.setValue(s),!0):!1}function Nf(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var oE=/[\n"\\]/g;function Rs(s){return s.replace(oE,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function xl(s,a,o,l,h,p,T,M){s.name="",T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?s.type=T:s.removeAttribute("type"),a!=null?T==="number"?(a===0&&s.value===""||s.value!=a)&&(s.value=""+As(a)):s.value!==""+As(a)&&(s.value=""+As(a)):T!=="submit"&&T!=="reset"||s.removeAttribute("value"),a!=null?Xi(s,T,As(a)):o!=null?Xi(s,T,As(o)):l!=null&&s.removeAttribute("value"),h==null&&p!=null&&(s.defaultChecked=!!p),h!=null&&(s.checked=h&&typeof h!="function"&&typeof h!="symbol"),M!=null&&typeof M!="function"&&typeof M!="symbol"&&typeof M!="boolean"?s.name=""+As(M):s.removeAttribute("name")}function by(s,a,o,l,h,p,T,M){if(p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"&&(s.type=p),a!=null||o!=null){if(!(p!=="submit"&&p!=="reset"||a!=null))return;o=o!=null?""+As(o):"",a=a!=null?""+As(a):o,M||a===s.value||(s.value=a),s.defaultValue=a}l=l??h,l=typeof l!="function"&&typeof l!="symbol"&&!!l,s.checked=M?s.checked:!!l,s.defaultChecked=!!l,T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(s.name=T)}function Xi(s,a,o){a==="number"&&Nf(s.ownerDocument)===s||s.defaultValue===""+o||(s.defaultValue=""+o)}function cc(s,a,o,l){if(s=s.options,a){a={};for(var h=0;h<o.length;h++)a["$"+o[h]]=!0;for(o=0;o<s.length;o++)h=a.hasOwnProperty("$"+s[o].value),s[o].selected!==h&&(s[o].selected=h),h&&l&&(s[o].defaultSelected=!0)}else{for(o=""+As(o),a=null,h=0;h<s.length;h++){if(s[h].value===o){s[h].selected=!0,l&&(s[h].defaultSelected=!0);return}a!==null||s[h].disabled||(a=s[h])}a!==null&&(a.selected=!0)}}function Sy(s,a,o){if(a!=null&&(a=""+As(a),a!==s.value&&(s.value=a),o==null)){s.defaultValue!==a&&(s.defaultValue=a);return}s.defaultValue=o!=null?""+As(o):""}function vy(s,a,o,l){if(a==null){if(l!=null){if(o!=null)throw Error(r(92));if(_e(l)){if(1<l.length)throw Error(r(93));l=l[0]}o=l}o==null&&(o=""),a=o}o=As(a),s.defaultValue=o,l=s.textContent,l===o&&l!==""&&l!==null&&(s.value=l)}function lc(s,a){if(a){var o=s.firstChild;if(o&&o===s.lastChild&&o.nodeType===3){o.nodeValue=a;return}}s.textContent=a}var cE=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function wy(s,a,o){var l=a.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?l?s.setProperty(a,""):a==="float"?s.cssFloat="":s[a]="":l?s.setProperty(a,o):typeof o!="number"||o===0||cE.has(a)?a==="float"?s.cssFloat=o:s[a]=(""+o).trim():s[a]=o+"px"}function Ey(s,a,o){if(a!=null&&typeof a!="object")throw Error(r(62));if(s=s.style,o!=null){for(var l in o)!o.hasOwnProperty(l)||a!=null&&a.hasOwnProperty(l)||(l.indexOf("--")===0?s.setProperty(l,""):l==="float"?s.cssFloat="":s[l]="");for(var h in a)l=a[h],a.hasOwnProperty(h)&&o[h]!==l&&wy(s,h,l)}else for(var p in a)a.hasOwnProperty(p)&&wy(s,p,a[p])}function Em(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var lE=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),uE=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function $f(s){return uE.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var wt=null;function Tm(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var uc=null,fc=null;function Ty(s){var a=ac(s);if(a&&(s=a.stateNode)){var o=s[Qr]||null;e:switch(s=a.stateNode,a.type){case"input":if(xl(s,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),a=o.name,o.type==="radio"&&a!=null){for(o=s;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Rs(""+a)+'"][type="radio"]'),a=0;a<o.length;a++){var l=o[a];if(l!==s&&l.form===s.form){var h=l[Qr]||null;if(!h)throw Error(r(90));xl(l,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name)}}for(a=0;a<o.length;a++)l=o[a],l.form===s.form&&yy(l)}break e;case"textarea":Sy(s,o.value,o.defaultValue);break e;case"select":a=o.value,a!=null&&cc(s,!!o.multiple,a,!1)}}}var km=!1;function ky(s,a,o){if(km)return s(a,o);km=!0;try{var l=s(a);return l}finally{if(km=!1,(uc!==null||fc!==null)&&(gb(),uc&&(a=uc,s=fc,fc=uc=null,Ty(a),s)))for(a=0;a<s.length;a++)Ty(s[a])}}function Ol(s,a){var o=s.stateNode;if(o===null)return null;var l=o[Qr]||null;if(l===null)return null;o=l[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(s=s.type,l=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!l;break e;default:s=!1}if(s)return null;if(o&&typeof o!="function")throw Error(r(231,a,typeof o));return o}var Cm=!1;if(Fa)try{var Dl={};Object.defineProperty(Dl,"passive",{get:function(){Cm=!0}}),window.addEventListener("test",Dl,Dl),window.removeEventListener("test",Dl,Dl)}catch{Cm=!1}var di=null,Am=null,If=null;function Cy(){if(If)return If;var s,a=Am,o=a.length,l,h="value"in di?di.value:di.textContent,p=h.length;for(s=0;s<o&&a[s]===h[s];s++);var T=o-s;for(l=1;l<=T&&a[o-l]===h[p-l];l++);return If=h.slice(s,1<l?1-l:void 0)}function Mf(s){var a=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&a===13&&(s=13)):s=a,s===10&&(s=13),32<=s||s===13?s:0}function jf(){return!0}function Ay(){return!1}function Wr(s){function a(o,l,h,p,T){this._reactName=o,this._targetInst=h,this.type=l,this.nativeEvent=p,this.target=T,this.currentTarget=null;for(var M in s)s.hasOwnProperty(M)&&(o=s[M],this[M]=o?o(p):p[M]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?jf:Ay,this.isPropagationStopped=Ay,this}return P(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=jf)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=jf)},persist:function(){},isPersistent:jf}),a}var Zi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ff=Wr(Zi),ql=P({},Zi,{view:0,detail:0}),fE=Wr(ql),Rm,xm,Nl,Lf=P({},ql,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:qm,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Nl&&(Nl&&s.type==="mousemove"?(Rm=s.screenX-Nl.screenX,xm=s.screenY-Nl.screenY):xm=Rm=0,Nl=s),Rm)},movementY:function(s){return"movementY"in s?s.movementY:xm}}),Ry=Wr(Lf),dE=P({},Lf,{dataTransfer:0}),hE=Wr(dE),mE=P({},ql,{relatedTarget:0}),Om=Wr(mE),gE=P({},Zi,{animationName:0,elapsedTime:0,pseudoElement:0}),pE=Wr(gE),_E=P({},Zi,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),yE=Wr(_E),bE=P({},Zi,{data:0}),Dm=Wr(bE),SE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},vE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},wE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function dc(s){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(s):(s=wE[s])?!!a[s]:!1}function qm(){return dc}var EE=P({},ql,{key:function(s){if(s.key){var a=SE[s.key]||s.key;if(a!=="Unidentified")return a}return s.type==="keypress"?(s=Mf(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?vE[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:qm,charCode:function(s){return s.type==="keypress"?Mf(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Mf(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),hc=Wr(EE),TE=P({},Lf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Nm=Wr(TE),kE=P({},ql,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:qm}),xy=Wr(kE),CE=P({},Zi,{propertyName:0,elapsedTime:0,pseudoElement:0}),Oy=Wr(CE),Dy=P({},Lf,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),qy=Wr(Dy),AE=P({},Zi,{newState:0,oldState:0}),hi=Wr(AE),RE=[9,13,27,32],$m=Fa&&"CompositionEvent"in window,$l=null;Fa&&"documentMode"in document&&($l=document.documentMode);var xE=Fa&&"TextEvent"in window&&!$l,Ny=Fa&&(!$m||$l&&8<$l&&11>=$l),Im=" ",$y=!1;function Iy(s,a){switch(s){case"keyup":return RE.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function My(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var mc=!1;function L(s,a){switch(s){case"compositionend":return My(a);case"keypress":return a.which!==32?null:($y=!0,Im);case"textInput":return s=a.data,s===Im&&$y?null:s;default:return null}}function jy(s,a){if(mc)return s==="compositionend"||!$m&&Iy(s,a)?(s=Cy(),If=Am=di=null,mc=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Ny&&a.locale!=="ko"?null:a.data;default:return null}}var Fy={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Mm(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a==="input"?!!Fy[s.type]:a==="textarea"}function jm(s,a,o,l){uc?fc?fc.push(l):fc=[l]:uc=l,a=Sb(a,"onChange"),0<a.length&&(o=new Ff("onChange","change",null,o,l),s.push({event:o,listeners:a}))}var gc=null,pc=null;function Uf(s){h3(s,0)}function zf(s){var a=Rl(s);if(yy(a))return s}function Fm(s,a){if(s==="change")return a}var Lm=!1;if(Fa){var u;if(Fa){var d="oninput"in document;if(!d){var _=document.createElement("div");_.setAttribute("oninput","return;"),d=typeof _.oninput=="function"}u=d}else u=!1;Lm=u&&(!document.documentMode||9<document.documentMode)}function w(){gc&&(gc.detachEvent("onpropertychange",O),pc=gc=null)}function O(s){if(s.propertyName==="value"&&zf(pc)){var a=[];jm(a,pc,s,Tm(s)),ky(Uf,a)}}function U(s,a,o){s==="focusin"?(w(),gc=a,pc=o,gc.attachEvent("onpropertychange",O)):s==="focusout"&&w()}function G(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return zf(pc)}function J(s,a){if(s==="click")return zf(a)}function ce(s,a){if(s==="input"||s==="change")return zf(a)}function ke(s,a){return s===a&&(s!==0||1/s===1/a)||s!==s&&a!==a}var Me=typeof Object.is=="function"?Object.is:ke;function st(s,a){if(Me(s,a))return!0;if(typeof s!="object"||s===null||typeof a!="object"||a===null)return!1;var o=Object.keys(s),l=Object.keys(a);if(o.length!==l.length)return!1;for(l=0;l<o.length;l++){var h=o[l];if(!mm.call(a,h)||!Me(s[h],a[h]))return!1}return!0}function Rt(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function je(s,a){var o=Rt(s);s=0;for(var l;o;){if(o.nodeType===3){if(l=s+o.textContent.length,s<=a&&l>=a)return{node:o,offset:a-s};s=l}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=Rt(o)}}function Pe(s,a){return s&&a?s===a?!0:s&&s.nodeType===3?!1:a&&a.nodeType===3?Pe(s,a.parentNode):"contains"in s?s.contains(a):s.compareDocumentPosition?!!(s.compareDocumentPosition(a)&16):!1:!1}function Ut(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var a=Nf(s.document);a instanceof s.HTMLIFrameElement;){try{var o=typeof a.contentWindow.location.href=="string"}catch{o=!1}if(o)s=a.contentWindow;else break;a=Nf(s.document)}return a}function Rr(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a&&(a==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||a==="textarea"||s.contentEditable==="true")}function ls(s,a){var o=Ut(a);a=s.focusedElem;var l=s.selectionRange;if(o!==a&&a&&a.ownerDocument&&Pe(a.ownerDocument.documentElement,a)){if(l!==null&&Rr(a)){if(s=l.start,o=l.end,o===void 0&&(o=s),"selectionStart"in a)a.selectionStart=s,a.selectionEnd=Math.min(o,a.value.length);else if(o=(s=a.ownerDocument||document)&&s.defaultView||window,o.getSelection){o=o.getSelection();var h=a.textContent.length,p=Math.min(l.start,h);l=l.end===void 0?p:Math.min(l.end,h),!o.extend&&p>l&&(h=l,l=p,p=h),h=je(a,p);var T=je(a,l);h&&T&&(o.rangeCount!==1||o.anchorNode!==h.node||o.anchorOffset!==h.offset||o.focusNode!==T.node||o.focusOffset!==T.offset)&&(s=s.createRange(),s.setStart(h.node,h.offset),o.removeAllRanges(),p>l?(o.addRange(s),o.extend(T.node,T.offset)):(s.setEnd(T.node,T.offset),o.addRange(s)))}}for(s=[],o=a;o=o.parentNode;)o.nodeType===1&&s.push({element:o,left:o.scrollLeft,top:o.scrollTop});for(typeof a.focus=="function"&&a.focus(),a=0;a<s.length;a++)o=s[a],o.element.scrollLeft=o.left,o.element.scrollTop=o.top}}var js=Fa&&"documentMode"in document&&11>=document.documentMode,xr=null,eo=null,Jr=null,mi=!1;function or(s,a,o){var l=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;mi||xr==null||xr!==Nf(l)||(l=xr,"selectionStart"in l&&Rr(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),Jr&&st(Jr,l)||(Jr=l,l=Sb(eo,"onSelect"),0<l.length&&(a=new Ff("onSelect","select",null,a,o),s.push({event:a,listeners:l}),a.target=xr)))}function Il(s,a){var o={};return o[s.toLowerCase()]=a.toLowerCase(),o["Webkit"+s]="webkit"+a,o["Moz"+s]="moz"+a,o}var Pf={animationend:Il("Animation","AnimationEnd"),animationiteration:Il("Animation","AnimationIteration"),animationstart:Il("Animation","AnimationStart"),transitionrun:Il("Transition","TransitionRun"),transitionstart:Il("Transition","TransitionStart"),transitioncancel:Il("Transition","TransitionCancel"),transitionend:Il("Transition","TransitionEnd")},OE={},Xx={};Fa&&(Xx=document.createElement("div").style,"AnimationEvent"in window||(delete Pf.animationend.animation,delete Pf.animationiteration.animation,delete Pf.animationstart.animation),"TransitionEvent"in window||delete Pf.transitionend.transition);function Ml(s){if(OE[s])return OE[s];if(!Pf[s])return s;var a=Pf[s],o;for(o in a)if(a.hasOwnProperty(o)&&o in Xx)return OE[s]=a[o];return s}var Zx=Ml("animationend"),eO=Ml("animationiteration"),tO=Ml("animationstart"),y8=Ml("transitionrun"),b8=Ml("transitionstart"),S8=Ml("transitioncancel"),nO=Ml("transitionend"),rO=new Map,sO="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function Ua(s,a){rO.set(s,a),Ji(a,[s])}var ra=[],Hf=0,DE=0;function Ly(){for(var s=Hf,a=DE=Hf=0;a<s;){var o=ra[a];ra[a++]=null;var l=ra[a];ra[a++]=null;var h=ra[a];ra[a++]=null;var p=ra[a];if(ra[a++]=null,l!==null&&h!==null){var T=l.pending;T===null?h.next=h:(h.next=T.next,T.next=h),l.pending=h}p!==0&&aO(o,h,p)}}function Uy(s,a,o,l){ra[Hf++]=s,ra[Hf++]=a,ra[Hf++]=o,ra[Hf++]=l,DE|=l,s.lanes|=l,s=s.alternate,s!==null&&(s.lanes|=l)}function qE(s,a,o,l){return Uy(s,a,o,l),zy(s)}function _c(s,a){return Uy(s,null,null,a),zy(s)}function aO(s,a,o){s.lanes|=o;var l=s.alternate;l!==null&&(l.lanes|=o);for(var h=!1,p=s.return;p!==null;)p.childLanes|=o,l=p.alternate,l!==null&&(l.childLanes|=o),p.tag===22&&(s=p.stateNode,s===null||s._visibility&1||(h=!0)),s=p,p=p.return;h&&a!==null&&s.tag===3&&(p=s.stateNode,h=31-jn(o),p=p.hiddenUpdates,s=p[h],s===null?p[h]=[a]:s.push(a),a.lane=o|536870912)}function zy(s){if(50<ug)throw ug=0,F1=null,Error(r(185));for(var a=s.return;a!==null;)s=a,a=s.return;return s.tag===3?s.stateNode:null}var Bf={},iO=new WeakMap;function sa(s,a){if(typeof s=="object"&&s!==null){var o=iO.get(s);return o!==void 0?o:(a={value:s,source:a,stack:Te(a)},iO.set(s,a),a)}return{value:s,source:a,stack:Te(a)}}var Vf=[],Gf=0,Py=null,Hy=0,aa=[],ia=0,jl=null,to=1,no="";function Fl(s,a){Vf[Gf++]=Hy,Vf[Gf++]=Py,Py=s,Hy=a}function oO(s,a,o){aa[ia++]=to,aa[ia++]=no,aa[ia++]=jl,jl=s;var l=to;s=no;var h=32-jn(l)-1;l&=~(1<<h),o+=1;var p=32-jn(a)+h;if(30<p){var T=h-h%5;p=(l&(1<<T)-1).toString(32),l>>=T,h-=T,to=1<<32-jn(a)+h|o<<h|l,no=p+s}else to=1<<p|o<<h|l,no=s}function NE(s){s.return!==null&&(Fl(s,1),oO(s,1,0))}function $E(s){for(;s===Py;)Py=Vf[--Gf],Vf[Gf]=null,Hy=Vf[--Gf],Vf[Gf]=null;for(;s===jl;)jl=aa[--ia],aa[ia]=null,no=aa[--ia],aa[ia]=null,to=aa[--ia],aa[ia]=null}var us=null,Mr=null,It=!1,za=null,gi=!1,IE=Error(r(519));function Ll(s){var a=Error(r(418,""));throw Pm(sa(a,s)),IE}function cO(s){var a=s.stateNode,o=s.type,l=s.memoizedProps;switch(a[Ar]=s,a[Qr]=l,o){case"dialog":Ot("cancel",a),Ot("close",a);break;case"iframe":case"object":case"embed":Ot("load",a);break;case"video":case"audio":for(o=0;o<dg.length;o++)Ot(dg[o],a);break;case"source":Ot("error",a);break;case"img":case"image":case"link":Ot("error",a),Ot("load",a);break;case"details":Ot("toggle",a);break;case"input":Ot("invalid",a),by(a,l.value,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name,!0),qf(a);break;case"select":Ot("invalid",a);break;case"textarea":Ot("invalid",a),vy(a,l.value,l.defaultValue,l.children),qf(a)}o=l.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||a.textContent===""+o||l.suppressHydrationWarning===!0||_3(a.textContent,o)?(l.popover!=null&&(Ot("beforetoggle",a),Ot("toggle",a)),l.onScroll!=null&&Ot("scroll",a),l.onScrollEnd!=null&&Ot("scrollend",a),l.onClick!=null&&(a.onclick=vb),a=!0):a=!1,a||Ll(s)}function lO(s){for(us=s.return;us;)switch(us.tag){case 3:case 27:gi=!0;return;case 5:case 13:gi=!1;return;default:us=us.return}}function Um(s){if(s!==us)return!1;if(!It)return lO(s),It=!0,!1;var a=!1,o;if((o=s.tag!==3&&s.tag!==27)&&((o=s.tag===5)&&(o=s.type,o=!(o!=="form"&&o!=="button")||tT(s.type,s.memoizedProps)),o=!o),o&&(a=!0),a&&Mr&&Ll(s),lO(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));e:{for(s=s.nextSibling,a=0;s;){if(s.nodeType===8)if(o=s.data,o==="/$"){if(a===0){Mr=Ha(s.nextSibling);break e}a--}else o!=="$"&&o!=="$!"&&o!=="$?"||a++;s=s.nextSibling}Mr=null}}else Mr=us?Ha(s.stateNode.nextSibling):null;return!0}function zm(){Mr=us=null,It=!1}function Pm(s){za===null?za=[s]:za.push(s)}var Hm=Error(r(460)),uO=Error(r(474)),ME={then:function(){}};function fO(s){return s=s.status,s==="fulfilled"||s==="rejected"}function By(){}function dO(s,a,o){switch(o=s[o],o===void 0?s.push(a):o!==a&&(a.then(By,By),a=o),a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,s===Hm?Error(r(483)):s;default:if(typeof a.status=="string")a.then(By,By);else{if(s=ln,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=a,s.status="pending",s.then(function(l){if(a.status==="pending"){var h=a;h.status="fulfilled",h.value=l}},function(l){if(a.status==="pending"){var h=a;h.status="rejected",h.reason=l}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,s===Hm?Error(r(483)):s}throw Bm=a,Hm}}var Bm=null;function hO(){if(Bm===null)throw Error(r(459));var s=Bm;return Bm=null,s}var Kf=null,Vm=0;function Vy(s){var a=Vm;return Vm+=1,Kf===null&&(Kf=[]),dO(Kf,s,a)}function Gm(s,a){a=a.props.ref,s.ref=a!==void 0?a:null}function Gy(s,a){throw a.$$typeof===c?Error(r(525)):(s=Object.prototype.toString.call(a),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":s)))}function mO(s){var a=s._init;return a(s._payload)}function gO(s){function a(ee,X){if(s){var te=ee.deletions;te===null?(ee.deletions=[X],ee.flags|=16):te.push(X)}}function o(ee,X){if(!s)return null;for(;X!==null;)a(ee,X),X=X.sibling;return null}function l(ee){for(var X=new Map;ee!==null;)ee.key!==null?X.set(ee.key,ee):X.set(ee.index,ee),ee=ee.sibling;return X}function h(ee,X){return ee=xc(ee,X),ee.index=0,ee.sibling=null,ee}function p(ee,X,te){return ee.index=te,s?(te=ee.alternate,te!==null?(te=te.index,te<X?(ee.flags|=33554434,X):te):(ee.flags|=33554434,X)):(ee.flags|=1048576,X)}function T(ee){return s&&ee.alternate===null&&(ee.flags|=33554434),ee}function M(ee,X,te,le){return X===null||X.tag!==6?(X=O1(te,ee.mode,le),X.return=ee,X):(X=h(X,te),X.return=ee,X)}function B(ee,X,te,le){var Oe=te.type;return Oe===g?ie(ee,X,te.props.children,le,te.key):X!==null&&(X.elementType===Oe||typeof Oe=="object"&&Oe!==null&&Oe.$$typeof===E&&mO(Oe)===X.type)?(X=h(X,te.props),Gm(X,te),X.return=ee,X):(X=ub(te.type,te.key,te.props,null,ee.mode,le),Gm(X,te),X.return=ee,X)}function Z(ee,X,te,le){return X===null||X.tag!==4||X.stateNode.containerInfo!==te.containerInfo||X.stateNode.implementation!==te.implementation?(X=D1(te,ee.mode,le),X.return=ee,X):(X=h(X,te.children||[]),X.return=ee,X)}function ie(ee,X,te,le,Oe){return X===null||X.tag!==7?(X=Yl(te,ee.mode,le,Oe),X.return=ee,X):(X=h(X,te),X.return=ee,X)}function de(ee,X,te){if(typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint")return X=O1(""+X,ee.mode,te),X.return=ee,X;if(typeof X=="object"&&X!==null){switch(X.$$typeof){case f:return te=ub(X.type,X.key,X.props,null,ee.mode,te),Gm(te,X),te.return=ee,te;case m:return X=D1(X,ee.mode,te),X.return=ee,X;case E:var le=X._init;return X=le(X._payload),de(ee,X,te)}if(_e(X)||z(X))return X=Yl(X,ee.mode,te,null),X.return=ee,X;if(typeof X.then=="function")return de(ee,Vy(X),te);if(X.$$typeof===k)return de(ee,ob(ee,X),te);Gy(ee,X)}return null}function re(ee,X,te,le){var Oe=X!==null?X.key:null;if(typeof te=="string"&&te!==""||typeof te=="number"||typeof te=="bigint")return Oe!==null?null:M(ee,X,""+te,le);if(typeof te=="object"&&te!==null){switch(te.$$typeof){case f:return te.key===Oe?B(ee,X,te,le):null;case m:return te.key===Oe?Z(ee,X,te,le):null;case E:return Oe=te._init,te=Oe(te._payload),re(ee,X,te,le)}if(_e(te)||z(te))return Oe!==null?null:ie(ee,X,te,le,null);if(typeof te.then=="function")return re(ee,X,Vy(te),le);if(te.$$typeof===k)return re(ee,X,ob(ee,te),le);Gy(ee,te)}return null}function ae(ee,X,te,le,Oe){if(typeof le=="string"&&le!==""||typeof le=="number"||typeof le=="bigint")return ee=ee.get(te)||null,M(X,ee,""+le,Oe);if(typeof le=="object"&&le!==null){switch(le.$$typeof){case f:return ee=ee.get(le.key===null?te:le.key)||null,B(X,ee,le,Oe);case m:return ee=ee.get(le.key===null?te:le.key)||null,Z(X,ee,le,Oe);case E:var Et=le._init;return le=Et(le._payload),ae(ee,X,te,le,Oe)}if(_e(le)||z(le))return ee=ee.get(te)||null,ie(X,ee,le,Oe,null);if(typeof le.then=="function")return ae(ee,X,te,Vy(le),Oe);if(le.$$typeof===k)return ae(ee,X,te,ob(X,le),Oe);Gy(X,le)}return null}function Fe(ee,X,te,le){for(var Oe=null,Et=null,Le=X,Je=X=0,qr=null;Le!==null&&Je<te.length;Je++){Le.index>Je?(qr=Le,Le=null):qr=Le.sibling;var Mt=re(ee,Le,te[Je],le);if(Mt===null){Le===null&&(Le=qr);break}s&&Le&&Mt.alternate===null&&a(ee,Le),X=p(Mt,X,Je),Et===null?Oe=Mt:Et.sibling=Mt,Et=Mt,Le=qr}if(Je===te.length)return o(ee,Le),It&&Fl(ee,Je),Oe;if(Le===null){for(;Je<te.length;Je++)Le=de(ee,te[Je],le),Le!==null&&(X=p(Le,X,Je),Et===null?Oe=Le:Et.sibling=Le,Et=Le);return It&&Fl(ee,Je),Oe}for(Le=l(Le);Je<te.length;Je++)qr=ae(Le,ee,Je,te[Je],le),qr!==null&&(s&&qr.alternate!==null&&Le.delete(qr.key===null?Je:qr.key),X=p(qr,X,Je),Et===null?Oe=qr:Et.sibling=qr,Et=qr);return s&&Le.forEach(function(Mc){return a(ee,Mc)}),It&&Fl(ee,Je),Oe}function lt(ee,X,te,le){if(te==null)throw Error(r(151));for(var Oe=null,Et=null,Le=X,Je=X=0,qr=null,Mt=te.next();Le!==null&&!Mt.done;Je++,Mt=te.next()){Le.index>Je?(qr=Le,Le=null):qr=Le.sibling;var Mc=re(ee,Le,Mt.value,le);if(Mc===null){Le===null&&(Le=qr);break}s&&Le&&Mc.alternate===null&&a(ee,Le),X=p(Mc,X,Je),Et===null?Oe=Mc:Et.sibling=Mc,Et=Mc,Le=qr}if(Mt.done)return o(ee,Le),It&&Fl(ee,Je),Oe;if(Le===null){for(;!Mt.done;Je++,Mt=te.next())Mt=de(ee,Mt.value,le),Mt!==null&&(X=p(Mt,X,Je),Et===null?Oe=Mt:Et.sibling=Mt,Et=Mt);return It&&Fl(ee,Je),Oe}for(Le=l(Le);!Mt.done;Je++,Mt=te.next())Mt=ae(Le,ee,Je,Mt.value,le),Mt!==null&&(s&&Mt.alternate!==null&&Le.delete(Mt.key===null?Je:Mt.key),X=p(Mt,X,Je),Et===null?Oe=Mt:Et.sibling=Mt,Et=Mt);return s&&Le.forEach(function($B){return a(ee,$B)}),It&&Fl(ee,Je),Oe}function Un(ee,X,te,le){if(typeof te=="object"&&te!==null&&te.type===g&&te.key===null&&(te=te.props.children),typeof te=="object"&&te!==null){switch(te.$$typeof){case f:e:{for(var Oe=te.key;X!==null;){if(X.key===Oe){if(Oe=te.type,Oe===g){if(X.tag===7){o(ee,X.sibling),le=h(X,te.props.children),le.return=ee,ee=le;break e}}else if(X.elementType===Oe||typeof Oe=="object"&&Oe!==null&&Oe.$$typeof===E&&mO(Oe)===X.type){o(ee,X.sibling),le=h(X,te.props),Gm(le,te),le.return=ee,ee=le;break e}o(ee,X);break}else a(ee,X);X=X.sibling}te.type===g?(le=Yl(te.props.children,ee.mode,le,te.key),le.return=ee,ee=le):(le=ub(te.type,te.key,te.props,null,ee.mode,le),Gm(le,te),le.return=ee,ee=le)}return T(ee);case m:e:{for(Oe=te.key;X!==null;){if(X.key===Oe)if(X.tag===4&&X.stateNode.containerInfo===te.containerInfo&&X.stateNode.implementation===te.implementation){o(ee,X.sibling),le=h(X,te.children||[]),le.return=ee,ee=le;break e}else{o(ee,X);break}else a(ee,X);X=X.sibling}le=D1(te,ee.mode,le),le.return=ee,ee=le}return T(ee);case E:return Oe=te._init,te=Oe(te._payload),Un(ee,X,te,le)}if(_e(te))return Fe(ee,X,te,le);if(z(te)){if(Oe=z(te),typeof Oe!="function")throw Error(r(150));return te=Oe.call(te),lt(ee,X,te,le)}if(typeof te.then=="function")return Un(ee,X,Vy(te),le);if(te.$$typeof===k)return Un(ee,X,ob(ee,te),le);Gy(ee,te)}return typeof te=="string"&&te!==""||typeof te=="number"||typeof te=="bigint"?(te=""+te,X!==null&&X.tag===6?(o(ee,X.sibling),le=h(X,te),le.return=ee,ee=le):(o(ee,X),le=O1(te,ee.mode,le),le.return=ee,ee=le),T(ee)):o(ee,X)}return function(ee,X,te,le){try{Vm=0;var Oe=Un(ee,X,te,le);return Kf=null,Oe}catch(Le){if(Le===Hm)throw Le;var Et=ua(29,Le,null,ee.mode);return Et.lanes=le,Et.return=ee,Et}finally{}}}var Ul=gO(!0),pO=gO(!1),Qf=Lt(null),Ky=Lt(0);function _O(s,a){s=mo,Kt(Ky,s),Kt(Qf,a),mo=s|a.baseLanes}function jE(){Kt(Ky,mo),Kt(Qf,Qf.current)}function FE(){mo=Ky.current,vn(Qf),vn(Ky)}var oa=Lt(null),pi=null;function yc(s){var a=s.alternate;Kt(_r,_r.current&1),Kt(oa,s),pi===null&&(a===null||Qf.current!==null||a.memoizedState!==null)&&(pi=s)}function yO(s){if(s.tag===22){if(Kt(_r,_r.current),Kt(oa,s),pi===null){var a=s.alternate;a!==null&&a.memoizedState!==null&&(pi=s)}}else bc()}function bc(){Kt(_r,_r.current),Kt(oa,oa.current)}function ro(s){vn(oa),pi===s&&(pi=null),vn(_r)}var _r=Lt(0);function Qy(s){for(var a=s;a!==null;){if(a.tag===13){var o=a.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||o.data==="$!"))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var v8=typeof AbortController<"u"?AbortController:function(){var s=[],a=this.signal={aborted:!1,addEventListener:function(o,l){s.push(l)}};this.abort=function(){a.aborted=!0,s.forEach(function(o){return o()})}},w8=e.unstable_scheduleCallback,E8=e.unstable_NormalPriority,yr={$$typeof:k,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function LE(){return{controller:new v8,data:new Map,refCount:0}}function Km(s){s.refCount--,s.refCount===0&&w8(E8,function(){s.controller.abort()})}var Qm=null,UE=0,Yf=0,Wf=null;function T8(s,a){if(Qm===null){var o=Qm=[];UE=0,Yf=G1(),Wf={status:"pending",value:void 0,then:function(l){o.push(l)}}}return UE++,a.then(bO,bO),a}function bO(){if(--UE===0&&Qm!==null){Wf!==null&&(Wf.status="fulfilled");var s=Qm;Qm=null,Yf=0,Wf=null;for(var a=0;a<s.length;a++)(0,s[a])()}}function k8(s,a){var o=[],l={status:"pending",value:null,reason:null,then:function(h){o.push(h)}};return s.then(function(){l.status="fulfilled",l.value=a;for(var h=0;h<o.length;h++)(0,o[h])(a)},function(h){for(l.status="rejected",l.reason=h,h=0;h<o.length;h++)(0,o[h])(void 0)}),l}var SO=Y.S;Y.S=function(s,a){typeof a=="object"&&a!==null&&typeof a.then=="function"&&T8(s,a),SO!==null&&SO(s,a)};var zl=Lt(null);function zE(){var s=zl.current;return s!==null?s:ln.pooledCache}function Yy(s,a){a===null?Kt(zl,zl.current):Kt(zl,a.pool)}function vO(){var s=zE();return s===null?null:{parent:yr._currentValue,pool:s}}var Sc=0,vt=null,Wt=null,cr=null,Wy=!1,Jf=!1,Pl=!1,Jy=0,Ym=0,Xf=null,C8=0;function Yn(){throw Error(r(321))}function PE(s,a){if(a===null)return!1;for(var o=0;o<a.length&&o<s.length;o++)if(!Me(s[o],a[o]))return!1;return!0}function HE(s,a,o,l,h,p){return Sc=p,vt=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,Y.H=s===null||s.memoizedState===null?Hl:vc,Pl=!1,p=o(l,h),Pl=!1,Jf&&(p=EO(a,o,l,h)),wO(s),p}function wO(s){Y.H=_i;var a=Wt!==null&&Wt.next!==null;if(Sc=0,cr=Wt=vt=null,Wy=!1,Ym=0,Xf=null,a)throw Error(r(300));s===null||Or||(s=s.dependencies,s!==null&&ib(s)&&(Or=!0))}function EO(s,a,o,l){vt=s;var h=0;do{if(Jf&&(Xf=null),Ym=0,Jf=!1,25<=h)throw Error(r(301));if(h+=1,cr=Wt=null,s.updateQueue!=null){var p=s.updateQueue;p.lastEffect=null,p.events=null,p.stores=null,p.memoCache!=null&&(p.memoCache.index=0)}Y.H=Bl,p=a(o,l)}while(Jf);return p}function A8(){var s=Y.H,a=s.useState()[0];return a=typeof a.then=="function"?Wm(a):a,s=s.useState()[0],(Wt!==null?Wt.memoizedState:null)!==s&&(vt.flags|=1024),a}function BE(){var s=Jy!==0;return Jy=0,s}function VE(s,a,o){a.updateQueue=s.updateQueue,a.flags&=-2053,s.lanes&=~o}function GE(s){if(Wy){for(s=s.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}Wy=!1}Sc=0,cr=Wt=vt=null,Jf=!1,Ym=Jy=0,Xf=null}function xs(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return cr===null?vt.memoizedState=cr=s:cr=cr.next=s,cr}function lr(){if(Wt===null){var s=vt.alternate;s=s!==null?s.memoizedState:null}else s=Wt.next;var a=cr===null?vt.memoizedState:cr.next;if(a!==null)cr=a,Wt=s;else{if(s===null)throw vt.alternate===null?Error(r(467)):Error(r(310));Wt=s,s={memoizedState:Wt.memoizedState,baseState:Wt.baseState,baseQueue:Wt.baseQueue,queue:Wt.queue,next:null},cr===null?vt.memoizedState=cr=s:cr=cr.next=s}return cr}var Xy;Xy=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function Wm(s){var a=Ym;return Ym+=1,Xf===null&&(Xf=[]),s=dO(Xf,s,a),a=vt,(cr===null?a.memoizedState:cr.next)===null&&(a=a.alternate,Y.H=a===null||a.memoizedState===null?Hl:vc),s}function Zy(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Wm(s);if(s.$$typeof===k)return Xr(s)}throw Error(r(438,String(s)))}function KE(s){var a=null,o=vt.updateQueue;if(o!==null&&(a=o.memoCache),a==null){var l=vt.alternate;l!==null&&(l=l.updateQueue,l!==null&&(l=l.memoCache,l!=null&&(a={data:l.data.map(function(h){return h.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),o===null&&(o=Xy(),vt.updateQueue=o),o.memoCache=a,o=a.data[a.index],o===void 0)for(o=a.data[a.index]=Array(s),l=0;l<s;l++)o[l]=R;return a.index++,o}function so(s,a){return typeof a=="function"?a(s):a}function eb(s){var a=lr();return QE(a,Wt,s)}function QE(s,a,o){var l=s.queue;if(l===null)throw Error(r(311));l.lastRenderedReducer=o;var h=s.baseQueue,p=l.pending;if(p!==null){if(h!==null){var T=h.next;h.next=p.next,p.next=T}a.baseQueue=h=p,l.pending=null}if(p=s.baseState,h===null)s.memoizedState=p;else{a=h.next;var M=T=null,B=null,Z=a,ie=!1;do{var de=Z.lane&-536870913;if(de!==Z.lane?(qt&de)===de:(Sc&de)===de){var re=Z.revertLane;if(re===0)B!==null&&(B=B.next={lane:0,revertLane:0,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null}),de===Yf&&(ie=!0);else if((Sc&re)===re){Z=Z.next,re===Yf&&(ie=!0);continue}else de={lane:0,revertLane:Z.revertLane,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null},B===null?(M=B=de,T=p):B=B.next=de,vt.lanes|=re,Oc|=re;de=Z.action,Pl&&o(p,de),p=Z.hasEagerState?Z.eagerState:o(p,de)}else re={lane:de,revertLane:Z.revertLane,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null},B===null?(M=B=re,T=p):B=B.next=re,vt.lanes|=de,Oc|=de;Z=Z.next}while(Z!==null&&Z!==a);if(B===null?T=p:B.next=M,!Me(p,s.memoizedState)&&(Or=!0,ie&&(o=Wf,o!==null)))throw o;s.memoizedState=p,s.baseState=T,s.baseQueue=B,l.lastRenderedState=p}return h===null&&(l.lanes=0),[s.memoizedState,l.dispatch]}function YE(s){var a=lr(),o=a.queue;if(o===null)throw Error(r(311));o.lastRenderedReducer=s;var l=o.dispatch,h=o.pending,p=a.memoizedState;if(h!==null){o.pending=null;var T=h=h.next;do p=s(p,T.action),T=T.next;while(T!==h);Me(p,a.memoizedState)||(Or=!0),a.memoizedState=p,a.baseQueue===null&&(a.baseState=p),o.lastRenderedState=p}return[p,l]}function TO(s,a,o){var l=vt,h=lr(),p=It;if(p){if(o===void 0)throw Error(r(407));o=o()}else o=a();var T=!Me((Wt||h).memoizedState,o);if(T&&(h.memoizedState=o,Or=!0),h=h.queue,XE(AO.bind(null,l,h,s),[s]),h.getSnapshot!==a||T||cr!==null&&cr.memoizedState.tag&1){if(l.flags|=2048,Zf(9,CO.bind(null,l,h,o,a),{destroy:void 0},null),ln===null)throw Error(r(349));p||(Sc&60)!==0||kO(l,a,o)}return o}function kO(s,a,o){s.flags|=16384,s={getSnapshot:a,value:o},a=vt.updateQueue,a===null?(a=Xy(),vt.updateQueue=a,a.stores=[s]):(o=a.stores,o===null?a.stores=[s]:o.push(s))}function CO(s,a,o,l){a.value=o,a.getSnapshot=l,RO(a)&&xO(s)}function AO(s,a,o){return o(function(){RO(a)&&xO(s)})}function RO(s){var a=s.getSnapshot;s=s.value;try{var o=a();return!Me(s,o)}catch{return!0}}function xO(s){var a=_c(s,2);a!==null&&fs(a,s,2)}function WE(s){var a=xs();if(typeof s=="function"){var o=s;if(s=o(),Pl){Ma(!0);try{o()}finally{Ma(!1)}}}return a.memoizedState=a.baseState=s,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:so,lastRenderedState:s},a}function OO(s,a,o,l){return s.baseState=o,QE(s,Wt,typeof l=="function"?l:so)}function R8(s,a,o,l,h){if(rb(s))throw Error(r(485));if(s=a.action,s!==null){var p={payload:h,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(T){p.listeners.push(T)}};Y.T!==null?o(!0):p.isTransition=!1,l(p),o=a.pending,o===null?(p.next=a.pending=p,DO(a,p)):(p.next=o.next,a.pending=o.next=p)}}function DO(s,a){var o=a.action,l=a.payload,h=s.state;if(a.isTransition){var p=Y.T,T={};Y.T=T;try{var M=o(h,l),B=Y.S;B!==null&&B(T,M),qO(s,a,M)}catch(Z){JE(s,a,Z)}finally{Y.T=p}}else try{p=o(h,l),qO(s,a,p)}catch(Z){JE(s,a,Z)}}function qO(s,a,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(l){NO(s,a,l)},function(l){return JE(s,a,l)}):NO(s,a,o)}function NO(s,a,o){a.status="fulfilled",a.value=o,$O(a),s.state=o,a=s.pending,a!==null&&(o=a.next,o===a?s.pending=null:(o=o.next,a.next=o,DO(s,o)))}function JE(s,a,o){var l=s.pending;if(s.pending=null,l!==null){l=l.next;do a.status="rejected",a.reason=o,$O(a),a=a.next;while(a!==l)}s.action=null}function $O(s){s=s.listeners;for(var a=0;a<s.length;a++)(0,s[a])()}function IO(s,a){return a}function MO(s,a){if(It){var o=ln.formState;if(o!==null){e:{var l=vt;if(It){if(Mr){t:{for(var h=Mr,p=gi;h.nodeType!==8;){if(!p){h=null;break t}if(h=Ha(h.nextSibling),h===null){h=null;break t}}p=h.data,h=p==="F!"||p==="F"?h:null}if(h){Mr=Ha(h.nextSibling),l=h.data==="F!";break e}}Ll(l)}l=!1}l&&(a=o[0])}}return o=xs(),o.memoizedState=o.baseState=a,l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:IO,lastRenderedState:a},o.queue=l,o=eD.bind(null,vt,l),l.dispatch=o,l=WE(!1),p=r1.bind(null,vt,!1,l.queue),l=xs(),h={state:a,dispatch:null,action:s,pending:null},l.queue=h,o=R8.bind(null,vt,h,p,o),h.dispatch=o,l.memoizedState=s,[a,o,!1]}function jO(s){var a=lr();return FO(a,Wt,s)}function FO(s,a,o){a=QE(s,a,IO)[0],s=eb(so)[0],a=typeof a=="object"&&a!==null&&typeof a.then=="function"?Wm(a):a;var l=lr(),h=l.queue,p=h.dispatch;return o!==l.memoizedState&&(vt.flags|=2048,Zf(9,x8.bind(null,h,o),{destroy:void 0},null)),[a,p,s]}function x8(s,a){s.action=a}function LO(s){var a=lr(),o=Wt;if(o!==null)return FO(a,o,s);lr(),a=a.memoizedState,o=lr();var l=o.queue.dispatch;return o.memoizedState=s,[a,l,!1]}function Zf(s,a,o,l){return s={tag:s,create:a,inst:o,deps:l,next:null},a=vt.updateQueue,a===null&&(a=Xy(),vt.updateQueue=a),o=a.lastEffect,o===null?a.lastEffect=s.next=s:(l=o.next,o.next=s,s.next=l,a.lastEffect=s),s}function UO(){return lr().memoizedState}function tb(s,a,o,l){var h=xs();vt.flags|=s,h.memoizedState=Zf(1|a,o,{destroy:void 0},l===void 0?null:l)}function nb(s,a,o,l){var h=lr();l=l===void 0?null:l;var p=h.memoizedState.inst;Wt!==null&&l!==null&&PE(l,Wt.memoizedState.deps)?h.memoizedState=Zf(a,o,p,l):(vt.flags|=s,h.memoizedState=Zf(1|a,o,p,l))}function zO(s,a){tb(8390656,8,s,a)}function XE(s,a){nb(2048,8,s,a)}function PO(s,a){return nb(4,2,s,a)}function HO(s,a){return nb(4,4,s,a)}function BO(s,a){if(typeof a=="function"){s=s();var o=a(s);return function(){typeof o=="function"?o():a(null)}}if(a!=null)return s=s(),a.current=s,function(){a.current=null}}function VO(s,a,o){o=o!=null?o.concat([s]):null,nb(4,4,BO.bind(null,a,s),o)}function ZE(){}function GO(s,a){var o=lr();a=a===void 0?null:a;var l=o.memoizedState;return a!==null&&PE(a,l[1])?l[0]:(o.memoizedState=[s,a],s)}function KO(s,a){var o=lr();a=a===void 0?null:a;var l=o.memoizedState;if(a!==null&&PE(a,l[1]))return l[0];if(l=s(),Pl){Ma(!0);try{s()}finally{Ma(!1)}}return o.memoizedState=[l,a],l}function e1(s,a,o){return o===void 0||(Sc&1073741824)!==0?s.memoizedState=a:(s.memoizedState=o,s=YD(),vt.lanes|=s,Oc|=s,o)}function QO(s,a,o,l){return Me(o,a)?o:Qf.current!==null?(s=e1(s,o,l),Me(s,a)||(Or=!0),s):(Sc&42)===0?(Or=!0,s.memoizedState=o):(s=YD(),vt.lanes|=s,Oc|=s,a)}function YO(s,a,o,l,h){var p=be.p;be.p=p!==0&&8>p?p:8;var T=Y.T,M={};Y.T=M,r1(s,!1,a,o);try{var B=h(),Z=Y.S;if(Z!==null&&Z(M,B),B!==null&&typeof B=="object"&&typeof B.then=="function"){var ie=k8(B,l);Jm(s,a,ie,zs(s))}else Jm(s,a,l,zs(s))}catch(de){Jm(s,a,{then:function(){},status:"rejected",reason:de},zs())}finally{be.p=p,Y.T=T}}function O8(){}function t1(s,a,o,l){if(s.tag!==5)throw Error(r(476));var h=WO(s).queue;YO(s,h,a,ct,o===null?O8:function(){return JO(s),o(l)})}function WO(s){var a=s.memoizedState;if(a!==null)return a;a={memoizedState:ct,baseState:ct,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:so,lastRenderedState:ct},next:null};var o={};return a.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:so,lastRenderedState:o},next:null},s.memoizedState=a,s=s.alternate,s!==null&&(s.memoizedState=a),a}function JO(s){var a=WO(s).next.queue;Jm(s,a,{},zs())}function n1(){return Xr(_g)}function XO(){return lr().memoizedState}function ZO(){return lr().memoizedState}function D8(s){for(var a=s.return;a!==null;){switch(a.tag){case 24:case 3:var o=zs();s=Tc(o);var l=kc(a,s,o);l!==null&&(fs(l,a,o),eg(l,a,o)),a={cache:LE()},s.payload=a;return}a=a.return}}function q8(s,a,o){var l=zs();o={lane:l,revertLane:0,action:o,hasEagerState:!1,eagerState:null,next:null},rb(s)?tD(a,o):(o=qE(s,a,o,l),o!==null&&(fs(o,s,l),nD(o,a,l)))}function eD(s,a,o){var l=zs();Jm(s,a,o,l)}function Jm(s,a,o,l){var h={lane:l,revertLane:0,action:o,hasEagerState:!1,eagerState:null,next:null};if(rb(s))tD(a,h);else{var p=s.alternate;if(s.lanes===0&&(p===null||p.lanes===0)&&(p=a.lastRenderedReducer,p!==null))try{var T=a.lastRenderedState,M=p(T,o);if(h.hasEagerState=!0,h.eagerState=M,Me(M,T))return Uy(s,a,h,0),ln===null&&Ly(),!1}catch{}finally{}if(o=qE(s,a,h,l),o!==null)return fs(o,s,l),nD(o,a,l),!0}return!1}function r1(s,a,o,l){if(l={lane:2,revertLane:G1(),action:l,hasEagerState:!1,eagerState:null,next:null},rb(s)){if(a)throw Error(r(479))}else a=qE(s,o,l,2),a!==null&&fs(a,s,2)}function rb(s){var a=s.alternate;return s===vt||a!==null&&a===vt}function tD(s,a){Jf=Wy=!0;var o=s.pending;o===null?a.next=a:(a.next=o.next,o.next=a),s.pending=a}function nD(s,a,o){if((o&4194176)!==0){var l=a.lanes;l&=s.pendingLanes,o|=l,a.lanes=o,uy(s,o)}}var _i={readContext:Xr,use:Zy,useCallback:Yn,useContext:Yn,useEffect:Yn,useImperativeHandle:Yn,useLayoutEffect:Yn,useInsertionEffect:Yn,useMemo:Yn,useReducer:Yn,useRef:Yn,useState:Yn,useDebugValue:Yn,useDeferredValue:Yn,useTransition:Yn,useSyncExternalStore:Yn,useId:Yn};_i.useCacheRefresh=Yn,_i.useMemoCache=Yn,_i.useHostTransitionStatus=Yn,_i.useFormState=Yn,_i.useActionState=Yn,_i.useOptimistic=Yn;var Hl={readContext:Xr,use:Zy,useCallback:function(s,a){return xs().memoizedState=[s,a===void 0?null:a],s},useContext:Xr,useEffect:zO,useImperativeHandle:function(s,a,o){o=o!=null?o.concat([s]):null,tb(4194308,4,BO.bind(null,a,s),o)},useLayoutEffect:function(s,a){return tb(4194308,4,s,a)},useInsertionEffect:function(s,a){tb(4,2,s,a)},useMemo:function(s,a){var o=xs();a=a===void 0?null:a;var l=s();if(Pl){Ma(!0);try{s()}finally{Ma(!1)}}return o.memoizedState=[l,a],l},useReducer:function(s,a,o){var l=xs();if(o!==void 0){var h=o(a);if(Pl){Ma(!0);try{o(a)}finally{Ma(!1)}}}else h=a;return l.memoizedState=l.baseState=h,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:h},l.queue=s,s=s.dispatch=q8.bind(null,vt,s),[l.memoizedState,s]},useRef:function(s){var a=xs();return s={current:s},a.memoizedState=s},useState:function(s){s=WE(s);var a=s.queue,o=eD.bind(null,vt,a);return a.dispatch=o,[s.memoizedState,o]},useDebugValue:ZE,useDeferredValue:function(s,a){var o=xs();return e1(o,s,a)},useTransition:function(){var s=WE(!1);return s=YO.bind(null,vt,s.queue,!0,!1),xs().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,a,o){var l=vt,h=xs();if(It){if(o===void 0)throw Error(r(407));o=o()}else{if(o=a(),ln===null)throw Error(r(349));(qt&60)!==0||kO(l,a,o)}h.memoizedState=o;var p={value:o,getSnapshot:a};return h.queue=p,zO(AO.bind(null,l,p,s),[s]),l.flags|=2048,Zf(9,CO.bind(null,l,p,o,a),{destroy:void 0},null),o},useId:function(){var s=xs(),a=ln.identifierPrefix;if(It){var o=no,l=to;o=(l&~(1<<32-jn(l)-1)).toString(32)+o,a=":"+a+"R"+o,o=Jy++,0<o&&(a+="H"+o.toString(32)),a+=":"}else o=C8++,a=":"+a+"r"+o.toString(32)+":";return s.memoizedState=a},useCacheRefresh:function(){return xs().memoizedState=D8.bind(null,vt)}};Hl.useMemoCache=KE,Hl.useHostTransitionStatus=n1,Hl.useFormState=MO,Hl.useActionState=MO,Hl.useOptimistic=function(s){var a=xs();a.memoizedState=a.baseState=s;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=o,a=r1.bind(null,vt,!0,o),o.dispatch=a,[s,a]};var vc={readContext:Xr,use:Zy,useCallback:GO,useContext:Xr,useEffect:XE,useImperativeHandle:VO,useInsertionEffect:PO,useLayoutEffect:HO,useMemo:KO,useReducer:eb,useRef:UO,useState:function(){return eb(so)},useDebugValue:ZE,useDeferredValue:function(s,a){var o=lr();return QO(o,Wt.memoizedState,s,a)},useTransition:function(){var s=eb(so)[0],a=lr().memoizedState;return[typeof s=="boolean"?s:Wm(s),a]},useSyncExternalStore:TO,useId:XO};vc.useCacheRefresh=ZO,vc.useMemoCache=KE,vc.useHostTransitionStatus=n1,vc.useFormState=jO,vc.useActionState=jO,vc.useOptimistic=function(s,a){var o=lr();return OO(o,Wt,s,a)};var Bl={readContext:Xr,use:Zy,useCallback:GO,useContext:Xr,useEffect:XE,useImperativeHandle:VO,useInsertionEffect:PO,useLayoutEffect:HO,useMemo:KO,useReducer:YE,useRef:UO,useState:function(){return YE(so)},useDebugValue:ZE,useDeferredValue:function(s,a){var o=lr();return Wt===null?e1(o,s,a):QO(o,Wt.memoizedState,s,a)},useTransition:function(){var s=YE(so)[0],a=lr().memoizedState;return[typeof s=="boolean"?s:Wm(s),a]},useSyncExternalStore:TO,useId:XO};Bl.useCacheRefresh=ZO,Bl.useMemoCache=KE,Bl.useHostTransitionStatus=n1,Bl.useFormState=LO,Bl.useActionState=LO,Bl.useOptimistic=function(s,a){var o=lr();return Wt!==null?OO(o,Wt,s,a):(o.baseState=s,[s,o.queue.dispatch])};function s1(s,a,o,l){a=s.memoizedState,o=o(l,a),o=o==null?a:P({},a,o),s.memoizedState=o,s.lanes===0&&(s.updateQueue.baseState=o)}var a1={isMounted:function(s){return(s=s._reactInternals)?Ee(s)===s:!1},enqueueSetState:function(s,a,o){s=s._reactInternals;var l=zs(),h=Tc(l);h.payload=a,o!=null&&(h.callback=o),a=kc(s,h,l),a!==null&&(fs(a,s,l),eg(a,s,l))},enqueueReplaceState:function(s,a,o){s=s._reactInternals;var l=zs(),h=Tc(l);h.tag=1,h.payload=a,o!=null&&(h.callback=o),a=kc(s,h,l),a!==null&&(fs(a,s,l),eg(a,s,l))},enqueueForceUpdate:function(s,a){s=s._reactInternals;var o=zs(),l=Tc(o);l.tag=2,a!=null&&(l.callback=a),a=kc(s,l,o),a!==null&&(fs(a,s,o),eg(a,s,o))}};function rD(s,a,o,l,h,p,T){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(l,p,T):a.prototype&&a.prototype.isPureReactComponent?!st(o,l)||!st(h,p):!0}function sD(s,a,o,l){s=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(o,l),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(o,l),a.state!==s&&a1.enqueueReplaceState(a,a.state,null)}function Vl(s,a){var o=a;if("ref"in a){o={};for(var l in a)l!=="ref"&&(o[l]=a[l])}if(s=s.defaultProps){o===a&&(o=P({},o));for(var h in s)o[h]===void 0&&(o[h]=s[h])}return o}var sb=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function aD(s){sb(s)}function iD(s){console.error(s)}function oD(s){sb(s)}function ab(s,a){try{var o=s.onUncaughtError;o(a.value,{componentStack:a.stack})}catch(l){setTimeout(function(){throw l})}}function cD(s,a,o){try{var l=s.onCaughtError;l(o.value,{componentStack:o.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(h){setTimeout(function(){throw h})}}function i1(s,a,o){return o=Tc(o),o.tag=3,o.payload={element:null},o.callback=function(){ab(s,a)},o}function lD(s){return s=Tc(s),s.tag=3,s}function uD(s,a,o,l){var h=o.type.getDerivedStateFromError;if(typeof h=="function"){var p=l.value;s.payload=function(){return h(p)},s.callback=function(){cD(a,o,l)}}var T=o.stateNode;T!==null&&typeof T.componentDidCatch=="function"&&(s.callback=function(){cD(a,o,l),typeof h!="function"&&(Dc===null?Dc=new Set([this]):Dc.add(this));var M=l.stack;this.componentDidCatch(l.value,{componentStack:M!==null?M:""})})}function N8(s,a,o,l,h){if(o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){if(a=o.alternate,a!==null&&Zm(a,o,h,!0),o=oa.current,o!==null){switch(o.tag){case 13:return pi===null?z1():o.alternate===null&&Ln===0&&(Ln=3),o.flags&=-257,o.flags|=65536,o.lanes=h,l===ME?o.flags|=16384:(a=o.updateQueue,a===null?o.updateQueue=new Set([l]):a.add(l),H1(s,l,h)),!1;case 22:return o.flags|=65536,l===ME?o.flags|=16384:(a=o.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([l])},o.updateQueue=a):(o=a.retryQueue,o===null?a.retryQueue=new Set([l]):o.add(l)),H1(s,l,h)),!1}throw Error(r(435,o.tag))}return H1(s,l,h),z1(),!1}if(It)return a=oa.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=h,l!==IE&&(s=Error(r(422),{cause:l}),Pm(sa(s,o)))):(l!==IE&&(a=Error(r(423),{cause:l}),Pm(sa(a,o))),s=s.current.alternate,s.flags|=65536,h&=-h,s.lanes|=h,l=sa(l,o),h=i1(s.stateNode,l,h),v1(s,h),Ln!==4&&(Ln=2)),!1;var p=Error(r(520),{cause:l});if(p=sa(p,o),cg===null?cg=[p]:cg.push(p),Ln!==4&&(Ln=2),a===null)return!0;l=sa(l,o),o=a;do{switch(o.tag){case 3:return o.flags|=65536,s=h&-h,o.lanes|=s,s=i1(o.stateNode,l,s),v1(o,s),!1;case 1:if(a=o.type,p=o.stateNode,(o.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(Dc===null||!Dc.has(p))))return o.flags|=65536,h&=-h,o.lanes|=h,h=lD(h),uD(h,s,o,l),v1(o,h),!1}o=o.return}while(o!==null);return!1}var fD=Error(r(461)),Or=!1;function jr(s,a,o,l){a.child=s===null?pO(a,null,o,l):Ul(a,s.child,o,l)}function dD(s,a,o,l,h){o=o.render;var p=a.ref;if("ref"in l){var T={};for(var M in l)M!=="ref"&&(T[M]=l[M])}else T=l;return Kl(a),l=HE(s,a,o,T,p,h),M=BE(),s!==null&&!Or?(VE(s,a,h),ao(s,a,h)):(It&&M&&NE(a),a.flags|=1,jr(s,a,l,h),a.child)}function hD(s,a,o,l,h){if(s===null){var p=o.type;return typeof p=="function"&&!x1(p)&&p.defaultProps===void 0&&o.compare===null?(a.tag=15,a.type=p,mD(s,a,p,l,h)):(s=ub(o.type,null,l,a,a.mode,h),s.ref=a.ref,s.return=a,a.child=s)}if(p=s.child,!g1(s,h)){var T=p.memoizedProps;if(o=o.compare,o=o!==null?o:st,o(T,l)&&s.ref===a.ref)return ao(s,a,h)}return a.flags|=1,s=xc(p,l),s.ref=a.ref,s.return=a,a.child=s}function mD(s,a,o,l,h){if(s!==null){var p=s.memoizedProps;if(st(p,l)&&s.ref===a.ref)if(Or=!1,a.pendingProps=l=p,g1(s,h))(s.flags&131072)!==0&&(Or=!0);else return a.lanes=s.lanes,ao(s,a,h)}return o1(s,a,o,l,h)}function gD(s,a,o){var l=a.pendingProps,h=l.children,p=(a.stateNode._pendingVisibility&2)!==0,T=s!==null?s.memoizedState:null;if(Xm(s,a),l.mode==="hidden"||p){if((a.flags&128)!==0){if(l=T!==null?T.baseLanes|o:o,s!==null){for(h=a.child=s.child,p=0;h!==null;)p=p|h.lanes|h.childLanes,h=h.sibling;a.childLanes=p&~l}else a.childLanes=0,a.child=null;return pD(s,a,l,o)}if((o&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},s!==null&&Yy(a,T!==null?T.cachePool:null),T!==null?_O(a,T):jE(),yO(a);else return a.lanes=a.childLanes=536870912,pD(s,a,T!==null?T.baseLanes|o:o,o)}else T!==null?(Yy(a,T.cachePool),_O(a,T),bc(),a.memoizedState=null):(s!==null&&Yy(a,null),jE(),bc());return jr(s,a,h,o),a.child}function pD(s,a,o,l){var h=zE();return h=h===null?null:{parent:yr._currentValue,pool:h},a.memoizedState={baseLanes:o,cachePool:h},s!==null&&Yy(a,null),jE(),yO(a),s!==null&&Zm(s,a,l,!0),null}function Xm(s,a){var o=a.ref;if(o===null)s!==null&&s.ref!==null&&(a.flags|=2097664);else{if(typeof o!="function"&&typeof o!="object")throw Error(r(284));(s===null||s.ref!==o)&&(a.flags|=2097664)}}function o1(s,a,o,l,h){return Kl(a),o=HE(s,a,o,l,void 0,h),l=BE(),s!==null&&!Or?(VE(s,a,h),ao(s,a,h)):(It&&l&&NE(a),a.flags|=1,jr(s,a,o,h),a.child)}function _D(s,a,o,l,h,p){return Kl(a),a.updateQueue=null,o=EO(a,l,o,h),wO(s),l=BE(),s!==null&&!Or?(VE(s,a,p),ao(s,a,p)):(It&&l&&NE(a),a.flags|=1,jr(s,a,o,p),a.child)}function yD(s,a,o,l,h){if(Kl(a),a.stateNode===null){var p=Bf,T=o.contextType;typeof T=="object"&&T!==null&&(p=Xr(T)),p=new o(l,p),a.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=a1,a.stateNode=p,p._reactInternals=a,p=a.stateNode,p.props=l,p.state=a.memoizedState,p.refs={},b1(a),T=o.contextType,p.context=typeof T=="object"&&T!==null?Xr(T):Bf,p.state=a.memoizedState,T=o.getDerivedStateFromProps,typeof T=="function"&&(s1(a,o,T,l),p.state=a.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(T=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),T!==p.state&&a1.enqueueReplaceState(p,p.state,null),ng(a,l,p,h),tg(),p.state=a.memoizedState),typeof p.componentDidMount=="function"&&(a.flags|=4194308),l=!0}else if(s===null){p=a.stateNode;var M=a.memoizedProps,B=Vl(o,M);p.props=B;var Z=p.context,ie=o.contextType;T=Bf,typeof ie=="object"&&ie!==null&&(T=Xr(ie));var de=o.getDerivedStateFromProps;ie=typeof de=="function"||typeof p.getSnapshotBeforeUpdate=="function",M=a.pendingProps!==M,ie||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(M||Z!==T)&&sD(a,p,l,T),Ec=!1;var re=a.memoizedState;p.state=re,ng(a,l,p,h),tg(),Z=a.memoizedState,M||re!==Z||Ec?(typeof de=="function"&&(s1(a,o,de,l),Z=a.memoizedState),(B=Ec||rD(a,o,B,l,re,Z,T))?(ie||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(a.flags|=4194308)):(typeof p.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=l,a.memoizedState=Z),p.props=l,p.state=Z,p.context=T,l=B):(typeof p.componentDidMount=="function"&&(a.flags|=4194308),l=!1)}else{p=a.stateNode,S1(s,a),T=a.memoizedProps,ie=Vl(o,T),p.props=ie,de=a.pendingProps,re=p.context,Z=o.contextType,B=Bf,typeof Z=="object"&&Z!==null&&(B=Xr(Z)),M=o.getDerivedStateFromProps,(Z=typeof M=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(T!==de||re!==B)&&sD(a,p,l,B),Ec=!1,re=a.memoizedState,p.state=re,ng(a,l,p,h),tg();var ae=a.memoizedState;T!==de||re!==ae||Ec||s!==null&&s.dependencies!==null&&ib(s.dependencies)?(typeof M=="function"&&(s1(a,o,M,l),ae=a.memoizedState),(ie=Ec||rD(a,o,ie,l,re,ae,B)||s!==null&&s.dependencies!==null&&ib(s.dependencies))?(Z||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(l,ae,B),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(l,ae,B)),typeof p.componentDidUpdate=="function"&&(a.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof p.componentDidUpdate!="function"||T===s.memoizedProps&&re===s.memoizedState||(a.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||T===s.memoizedProps&&re===s.memoizedState||(a.flags|=1024),a.memoizedProps=l,a.memoizedState=ae),p.props=l,p.state=ae,p.context=B,l=ie):(typeof p.componentDidUpdate!="function"||T===s.memoizedProps&&re===s.memoizedState||(a.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||T===s.memoizedProps&&re===s.memoizedState||(a.flags|=1024),l=!1)}return p=l,Xm(s,a),l=(a.flags&128)!==0,p||l?(p=a.stateNode,o=l&&typeof o.getDerivedStateFromError!="function"?null:p.render(),a.flags|=1,s!==null&&l?(a.child=Ul(a,s.child,null,h),a.child=Ul(a,null,o,h)):jr(s,a,o,h),a.memoizedState=p.state,s=a.child):s=ao(s,a,h),s}function bD(s,a,o,l){return zm(),a.flags|=256,jr(s,a,o,l),a.child}var c1={dehydrated:null,treeContext:null,retryLane:0};function l1(s){return{baseLanes:s,cachePool:vO()}}function u1(s,a,o){return s=s!==null?s.childLanes&~o:0,a&&(s|=fa),s}function SD(s,a,o){var l=a.pendingProps,h=!1,p=(a.flags&128)!==0,T;if((T=p)||(T=s!==null&&s.memoizedState===null?!1:(_r.current&2)!==0),T&&(h=!0,a.flags&=-129),T=(a.flags&32)!==0,a.flags&=-33,s===null){if(It){if(h?yc(a):bc(),It){var M=Mr,B;if(B=M){e:{for(B=M,M=gi;B.nodeType!==8;){if(!M){M=null;break e}if(B=Ha(B.nextSibling),B===null){M=null;break e}}M=B}M!==null?(a.memoizedState={dehydrated:M,treeContext:jl!==null?{id:to,overflow:no}:null,retryLane:536870912},B=ua(18,null,null,0),B.stateNode=M,B.return=a,a.child=B,us=a,Mr=null,B=!0):B=!1}B||Ll(a)}if(M=a.memoizedState,M!==null&&(M=M.dehydrated,M!==null))return M.data==="$!"?a.lanes=16:a.lanes=536870912,null;ro(a)}return M=l.children,l=l.fallback,h?(bc(),h=a.mode,M=d1({mode:"hidden",children:M},h),l=Yl(l,h,o,null),M.return=a,l.return=a,M.sibling=l,a.child=M,h=a.child,h.memoizedState=l1(o),h.childLanes=u1(s,T,o),a.memoizedState=c1,l):(yc(a),f1(a,M))}if(B=s.memoizedState,B!==null&&(M=B.dehydrated,M!==null)){if(p)a.flags&256?(yc(a),a.flags&=-257,a=h1(s,a,o)):a.memoizedState!==null?(bc(),a.child=s.child,a.flags|=128,a=null):(bc(),h=l.fallback,M=a.mode,l=d1({mode:"visible",children:l.children},M),h=Yl(h,M,o,null),h.flags|=2,l.return=a,h.return=a,l.sibling=h,a.child=l,Ul(a,s.child,null,o),l=a.child,l.memoizedState=l1(o),l.childLanes=u1(s,T,o),a.memoizedState=c1,a=h);else if(yc(a),M.data==="$!"){if(T=M.nextSibling&&M.nextSibling.dataset,T)var Z=T.dgst;T=Z,l=Error(r(419)),l.stack="",l.digest=T,Pm({value:l,source:null,stack:null}),a=h1(s,a,o)}else if(Or||Zm(s,a,o,!1),T=(o&s.childLanes)!==0,Or||T){if(T=ln,T!==null){if(l=o&-o,(l&42)!==0)l=1;else switch(l){case 2:l=1;break;case 8:l=4;break;case 32:l=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:l=64;break;case 268435456:l=134217728;break;default:l=0}if(l=(l&(T.suspendedLanes|o))!==0?0:l,l!==0&&l!==B.retryLane)throw B.retryLane=l,_c(s,l),fs(T,s,l),fD}M.data==="$?"||z1(),a=h1(s,a,o)}else M.data==="$?"?(a.flags|=128,a.child=s.child,a=Q8.bind(null,s),M._reactRetry=a,a=null):(s=B.treeContext,Mr=Ha(M.nextSibling),us=a,It=!0,za=null,gi=!1,s!==null&&(aa[ia++]=to,aa[ia++]=no,aa[ia++]=jl,to=s.id,no=s.overflow,jl=a),a=f1(a,l.children),a.flags|=4096);return a}return h?(bc(),h=l.fallback,M=a.mode,B=s.child,Z=B.sibling,l=xc(B,{mode:"hidden",children:l.children}),l.subtreeFlags=B.subtreeFlags&31457280,Z!==null?h=xc(Z,h):(h=Yl(h,M,o,null),h.flags|=2),h.return=a,l.return=a,l.sibling=h,a.child=l,l=h,h=a.child,M=s.child.memoizedState,M===null?M=l1(o):(B=M.cachePool,B!==null?(Z=yr._currentValue,B=B.parent!==Z?{parent:Z,pool:Z}:B):B=vO(),M={baseLanes:M.baseLanes|o,cachePool:B}),h.memoizedState=M,h.childLanes=u1(s,T,o),a.memoizedState=c1,l):(yc(a),o=s.child,s=o.sibling,o=xc(o,{mode:"visible",children:l.children}),o.return=a,o.sibling=null,s!==null&&(T=a.deletions,T===null?(a.deletions=[s],a.flags|=16):T.push(s)),a.child=o,a.memoizedState=null,o)}function f1(s,a){return a=d1({mode:"visible",children:a},s.mode),a.return=s,s.child=a}function d1(s,a){return GD(s,a,0,null)}function h1(s,a,o){return Ul(a,s.child,null,o),s=f1(a,a.pendingProps.children),s.flags|=2,a.memoizedState=null,s}function vD(s,a,o){s.lanes|=a;var l=s.alternate;l!==null&&(l.lanes|=a),_1(s.return,a,o)}function m1(s,a,o,l,h){var p=s.memoizedState;p===null?s.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:l,tail:o,tailMode:h}:(p.isBackwards=a,p.rendering=null,p.renderingStartTime=0,p.last=l,p.tail=o,p.tailMode=h)}function wD(s,a,o){var l=a.pendingProps,h=l.revealOrder,p=l.tail;if(jr(s,a,l.children,o),l=_r.current,(l&2)!==0)l=l&1|2,a.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=a.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&vD(s,o,a);else if(s.tag===19)vD(s,o,a);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}l&=1}switch(Kt(_r,l),h){case"forwards":for(o=a.child,h=null;o!==null;)s=o.alternate,s!==null&&Qy(s)===null&&(h=o),o=o.sibling;o=h,o===null?(h=a.child,a.child=null):(h=o.sibling,o.sibling=null),m1(a,!1,h,o,p);break;case"backwards":for(o=null,h=a.child,a.child=null;h!==null;){if(s=h.alternate,s!==null&&Qy(s)===null){a.child=h;break}s=h.sibling,h.sibling=o,o=h,h=s}m1(a,!0,o,null,p);break;case"together":m1(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function ao(s,a,o){if(s!==null&&(a.dependencies=s.dependencies),Oc|=a.lanes,(o&a.childLanes)===0)if(s!==null){if(Zm(s,a,o,!1),(o&a.childLanes)===0)return null}else return null;if(s!==null&&a.child!==s.child)throw Error(r(153));if(a.child!==null){for(s=a.child,o=xc(s,s.pendingProps),a.child=o,o.return=a;s.sibling!==null;)s=s.sibling,o=o.sibling=xc(s,s.pendingProps),o.return=a;o.sibling=null}return a.child}function g1(s,a){return(s.lanes&a)!==0?!0:(s=s.dependencies,!!(s!==null&&ib(s)))}function $8(s,a,o){switch(a.tag){case 3:Xo(a,a.stateNode.containerInfo),wc(a,yr,s.memoizedState.cache),zm();break;case 27:case 5:hm(a);break;case 4:Xo(a,a.stateNode.containerInfo);break;case 10:wc(a,a.type,a.memoizedProps.value);break;case 13:var l=a.memoizedState;if(l!==null)return l.dehydrated!==null?(yc(a),a.flags|=128,null):(o&a.child.childLanes)!==0?SD(s,a,o):(yc(a),s=ao(s,a,o),s!==null?s.sibling:null);yc(a);break;case 19:var h=(s.flags&128)!==0;if(l=(o&a.childLanes)!==0,l||(Zm(s,a,o,!1),l=(o&a.childLanes)!==0),h){if(l)return wD(s,a,o);a.flags|=128}if(h=a.memoizedState,h!==null&&(h.rendering=null,h.tail=null,h.lastEffect=null),Kt(_r,_r.current),l)break;return null;case 22:case 23:return a.lanes=0,gD(s,a,o);case 24:wc(a,yr,s.memoizedState.cache)}return ao(s,a,o)}function ED(s,a,o){if(s!==null)if(s.memoizedProps!==a.pendingProps)Or=!0;else{if(!g1(s,o)&&(a.flags&128)===0)return Or=!1,$8(s,a,o);Or=(s.flags&131072)!==0}else Or=!1,It&&(a.flags&1048576)!==0&&oO(a,Hy,a.index);switch(a.lanes=0,a.tag){case 16:e:{s=a.pendingProps;var l=a.elementType,h=l._init;if(l=h(l._payload),a.type=l,typeof l=="function")x1(l)?(s=Vl(l,s),a.tag=1,a=yD(null,a,l,s,o)):(a.tag=0,a=o1(null,a,l,s,o));else{if(l!=null){if(h=l.$$typeof,h===N){a.tag=11,a=dD(null,a,l,s,o);break e}else if(h===C){a.tag=14,a=hD(null,a,l,s,o);break e}}throw a=K(l)||l,Error(r(306,a,""))}}return a;case 0:return o1(s,a,a.type,a.pendingProps,o);case 1:return l=a.type,h=Vl(l,a.pendingProps),yD(s,a,l,h,o);case 3:e:{if(Xo(a,a.stateNode.containerInfo),s===null)throw Error(r(387));var p=a.pendingProps;h=a.memoizedState,l=h.element,S1(s,a),ng(a,p,null,o);var T=a.memoizedState;if(p=T.cache,wc(a,yr,p),p!==h.cache&&y1(a,[yr],o,!0),tg(),p=T.element,h.isDehydrated)if(h={element:p,isDehydrated:!1,cache:T.cache},a.updateQueue.baseState=h,a.memoizedState=h,a.flags&256){a=bD(s,a,p,o);break e}else if(p!==l){l=sa(Error(r(424)),a),Pm(l),a=bD(s,a,p,o);break e}else for(Mr=Ha(a.stateNode.containerInfo.firstChild),us=a,It=!0,za=null,gi=!0,o=pO(a,null,p,o),a.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(zm(),p===l){a=ao(s,a,o);break e}jr(s,a,p,o)}a=a.child}return a;case 26:return Xm(s,a),s===null?(o=C3(a.type,null,a.pendingProps,null))?a.memoizedState=o:It||(o=a.type,s=a.pendingProps,l=wb(Ia.current).createElement(o),l[Ar]=a,l[Qr]=s,Fr(l,o,s),ir(l),a.stateNode=l):a.memoizedState=C3(a.type,s.memoizedProps,a.pendingProps,s.memoizedState),null;case 27:return hm(a),s===null&&It&&(l=a.stateNode=E3(a.type,a.pendingProps,Ia.current),us=a,gi=!0,Mr=Ha(l.firstChild)),l=a.pendingProps.children,s!==null||It?jr(s,a,l,o):a.child=Ul(a,null,l,o),Xm(s,a),a.child;case 5:return s===null&&It&&((h=l=Mr)&&(l=uB(l,a.type,a.pendingProps,gi),l!==null?(a.stateNode=l,us=a,Mr=Ha(l.firstChild),gi=!1,h=!0):h=!1),h||Ll(a)),hm(a),h=a.type,p=a.pendingProps,T=s!==null?s.memoizedProps:null,l=p.children,tT(h,p)?l=null:T!==null&&tT(h,T)&&(a.flags|=32),a.memoizedState!==null&&(h=HE(s,a,A8,null,null,o),_g._currentValue=h),Xm(s,a),jr(s,a,l,o),a.child;case 6:return s===null&&It&&((s=o=Mr)&&(o=fB(o,a.pendingProps,gi),o!==null?(a.stateNode=o,us=a,Mr=null,s=!0):s=!1),s||Ll(a)),null;case 13:return SD(s,a,o);case 4:return Xo(a,a.stateNode.containerInfo),l=a.pendingProps,s===null?a.child=Ul(a,null,l,o):jr(s,a,l,o),a.child;case 11:return dD(s,a,a.type,a.pendingProps,o);case 7:return jr(s,a,a.pendingProps,o),a.child;case 8:return jr(s,a,a.pendingProps.children,o),a.child;case 12:return jr(s,a,a.pendingProps.children,o),a.child;case 10:return l=a.pendingProps,wc(a,a.type,l.value),jr(s,a,l.children,o),a.child;case 9:return h=a.type._context,l=a.pendingProps.children,Kl(a),h=Xr(h),l=l(h),a.flags|=1,jr(s,a,l,o),a.child;case 14:return hD(s,a,a.type,a.pendingProps,o);case 15:return mD(s,a,a.type,a.pendingProps,o);case 19:return wD(s,a,o);case 22:return gD(s,a,o);case 24:return Kl(a),l=Xr(yr),s===null?(h=zE(),h===null&&(h=ln,p=LE(),h.pooledCache=p,p.refCount++,p!==null&&(h.pooledCacheLanes|=o),h=p),a.memoizedState={parent:l,cache:h},b1(a),wc(a,yr,h)):((s.lanes&o)!==0&&(S1(s,a),ng(a,null,null,o),tg()),h=s.memoizedState,p=a.memoizedState,h.parent!==l?(h={parent:l,cache:l},a.memoizedState=h,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=h),wc(a,yr,l)):(l=p.cache,wc(a,yr,l),l!==h.cache&&y1(a,[yr],o,!0))),jr(s,a,a.pendingProps.children,o),a.child;case 29:throw a.pendingProps}throw Error(r(156,a.tag))}var p1=Lt(null),Gl=null,io=null;function wc(s,a,o){Kt(p1,a._currentValue),a._currentValue=o}function oo(s){s._currentValue=p1.current,vn(p1)}function _1(s,a,o){for(;s!==null;){var l=s.alternate;if((s.childLanes&a)!==a?(s.childLanes|=a,l!==null&&(l.childLanes|=a)):l!==null&&(l.childLanes&a)!==a&&(l.childLanes|=a),s===o)break;s=s.return}}function y1(s,a,o,l){var h=s.child;for(h!==null&&(h.return=s);h!==null;){var p=h.dependencies;if(p!==null){var T=h.child;p=p.firstContext;e:for(;p!==null;){var M=p;p=h;for(var B=0;B<a.length;B++)if(M.context===a[B]){p.lanes|=o,M=p.alternate,M!==null&&(M.lanes|=o),_1(p.return,o,s),l||(T=null);break e}p=M.next}}else if(h.tag===18){if(T=h.return,T===null)throw Error(r(341));T.lanes|=o,p=T.alternate,p!==null&&(p.lanes|=o),_1(T,o,s),T=null}else T=h.child;if(T!==null)T.return=h;else for(T=h;T!==null;){if(T===s){T=null;break}if(h=T.sibling,h!==null){h.return=T.return,T=h;break}T=T.return}h=T}}function Zm(s,a,o,l){s=null;for(var h=a,p=!1;h!==null;){if(!p){if((h.flags&524288)!==0)p=!0;else if((h.flags&262144)!==0)break}if(h.tag===10){var T=h.alternate;if(T===null)throw Error(r(387));if(T=T.memoizedProps,T!==null){var M=h.type;Me(h.pendingProps.value,T.value)||(s!==null?s.push(M):s=[M])}}else if(h===Tf.current){if(T=h.alternate,T===null)throw Error(r(387));T.memoizedState.memoizedState!==h.memoizedState.memoizedState&&(s!==null?s.push(_g):s=[_g])}h=h.return}s!==null&&y1(a,s,o,l),a.flags|=262144}function ib(s){for(s=s.firstContext;s!==null;){if(!Me(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Kl(s){Gl=s,io=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Xr(s){return TD(Gl,s)}function ob(s,a){return Gl===null&&Kl(s),TD(s,a)}function TD(s,a){var o=a._currentValue;if(a={context:a,memoizedValue:o,next:null},io===null){if(s===null)throw Error(r(308));io=a,s.dependencies={lanes:0,firstContext:a},s.flags|=524288}else io=io.next=a;return o}var Ec=!1;function b1(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function S1(s,a){s=s.updateQueue,a.updateQueue===s&&(a.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Tc(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function kc(s,a,o){var l=s.updateQueue;if(l===null)return null;if(l=l.shared,(Rn&2)!==0){var h=l.pending;return h===null?a.next=a:(a.next=h.next,h.next=a),l.pending=a,a=zy(s),aO(s,null,o),a}return Uy(s,l,a,o),zy(s)}function eg(s,a,o){if(a=a.updateQueue,a!==null&&(a=a.shared,(o&4194176)!==0)){var l=a.lanes;l&=s.pendingLanes,o|=l,a.lanes=o,uy(s,o)}}function v1(s,a){var o=s.updateQueue,l=s.alternate;if(l!==null&&(l=l.updateQueue,o===l)){var h=null,p=null;if(o=o.firstBaseUpdate,o!==null){do{var T={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};p===null?h=p=T:p=p.next=T,o=o.next}while(o!==null);p===null?h=p=a:p=p.next=a}else h=p=a;o={baseState:l.baseState,firstBaseUpdate:h,lastBaseUpdate:p,shared:l.shared,callbacks:l.callbacks},s.updateQueue=o;return}s=o.lastBaseUpdate,s===null?o.firstBaseUpdate=a:s.next=a,o.lastBaseUpdate=a}var w1=!1;function tg(){if(w1){var s=Wf;if(s!==null)throw s}}function ng(s,a,o,l){w1=!1;var h=s.updateQueue;Ec=!1;var p=h.firstBaseUpdate,T=h.lastBaseUpdate,M=h.shared.pending;if(M!==null){h.shared.pending=null;var B=M,Z=B.next;B.next=null,T===null?p=Z:T.next=Z,T=B;var ie=s.alternate;ie!==null&&(ie=ie.updateQueue,M=ie.lastBaseUpdate,M!==T&&(M===null?ie.firstBaseUpdate=Z:M.next=Z,ie.lastBaseUpdate=B))}if(p!==null){var de=h.baseState;T=0,ie=Z=B=null,M=p;do{var re=M.lane&-536870913,ae=re!==M.lane;if(ae?(qt&re)===re:(l&re)===re){re!==0&&re===Yf&&(w1=!0),ie!==null&&(ie=ie.next={lane:0,tag:M.tag,payload:M.payload,callback:null,next:null});e:{var Fe=s,lt=M;re=a;var Un=o;switch(lt.tag){case 1:if(Fe=lt.payload,typeof Fe=="function"){de=Fe.call(Un,de,re);break e}de=Fe;break e;case 3:Fe.flags=Fe.flags&-65537|128;case 0:if(Fe=lt.payload,re=typeof Fe=="function"?Fe.call(Un,de,re):Fe,re==null)break e;de=P({},de,re);break e;case 2:Ec=!0}}re=M.callback,re!==null&&(s.flags|=64,ae&&(s.flags|=8192),ae=h.callbacks,ae===null?h.callbacks=[re]:ae.push(re))}else ae={lane:re,tag:M.tag,payload:M.payload,callback:M.callback,next:null},ie===null?(Z=ie=ae,B=de):ie=ie.next=ae,T|=re;if(M=M.next,M===null){if(M=h.shared.pending,M===null)break;ae=M,M=ae.next,ae.next=null,h.lastBaseUpdate=ae,h.shared.pending=null}}while(!0);ie===null&&(B=de),h.baseState=B,h.firstBaseUpdate=Z,h.lastBaseUpdate=ie,p===null&&(h.shared.lanes=0),Oc|=T,s.lanes=T,s.memoizedState=de}}function kD(s,a){if(typeof s!="function")throw Error(r(191,s));s.call(a)}function CD(s,a){var o=s.callbacks;if(o!==null)for(s.callbacks=null,s=0;s<o.length;s++)kD(o[s],a)}function rg(s,a){try{var o=a.updateQueue,l=o!==null?o.lastEffect:null;if(l!==null){var h=l.next;o=h;do{if((o.tag&s)===s){l=void 0;var p=o.create,T=o.inst;l=p(),T.destroy=l}o=o.next}while(o!==h)}}catch(M){tn(a,a.return,M)}}function Cc(s,a,o){try{var l=a.updateQueue,h=l!==null?l.lastEffect:null;if(h!==null){var p=h.next;l=p;do{if((l.tag&s)===s){var T=l.inst,M=T.destroy;if(M!==void 0){T.destroy=void 0,h=a;var B=o;try{M()}catch(Z){tn(h,B,Z)}}}l=l.next}while(l!==p)}}catch(Z){tn(a,a.return,Z)}}function AD(s){var a=s.updateQueue;if(a!==null){var o=s.stateNode;try{CD(a,o)}catch(l){tn(s,s.return,l)}}}function RD(s,a,o){o.props=Vl(s.type,s.memoizedProps),o.state=s.memoizedState;try{o.componentWillUnmount()}catch(l){tn(s,a,l)}}function Ql(s,a){try{var o=s.ref;if(o!==null){var l=s.stateNode;switch(s.tag){case 26:case 27:case 5:var h=l;break;default:h=l}typeof o=="function"?s.refCleanup=o(h):o.current=h}}catch(p){tn(s,a,p)}}function Fs(s,a){var o=s.ref,l=s.refCleanup;if(o!==null)if(typeof l=="function")try{l()}catch(h){tn(s,a,h)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(h){tn(s,a,h)}else o.current=null}function xD(s){var a=s.type,o=s.memoizedProps,l=s.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":o.autoFocus&&l.focus();break e;case"img":o.src?l.src=o.src:o.srcSet&&(l.srcset=o.srcSet)}}catch(h){tn(s,s.return,h)}}function OD(s,a,o){try{var l=s.stateNode;aB(l,s.type,o,a),l[Qr]=a}catch(h){tn(s,s.return,h)}}function DD(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27||s.tag===4}function E1(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||DD(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==27&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function T1(s,a,o){var l=s.tag;if(l===5||l===6)s=s.stateNode,a?o.nodeType===8?o.parentNode.insertBefore(s,a):o.insertBefore(s,a):(o.nodeType===8?(a=o.parentNode,a.insertBefore(s,o)):(a=o,a.appendChild(s)),o=o._reactRootContainer,o!=null||a.onclick!==null||(a.onclick=vb));else if(l!==4&&l!==27&&(s=s.child,s!==null))for(T1(s,a,o),s=s.sibling;s!==null;)T1(s,a,o),s=s.sibling}function cb(s,a,o){var l=s.tag;if(l===5||l===6)s=s.stateNode,a?o.insertBefore(s,a):o.appendChild(s);else if(l!==4&&l!==27&&(s=s.child,s!==null))for(cb(s,a,o),s=s.sibling;s!==null;)cb(s,a,o),s=s.sibling}var co=!1,Fn=!1,k1=!1,qD=typeof WeakSet=="function"?WeakSet:Set,Dr=null,ND=!1;function I8(s,a){if(s=s.containerInfo,Z1=Rb,s=Ut(s),Rr(s)){if("selectionStart"in s)var o={start:s.selectionStart,end:s.selectionEnd};else e:{o=(o=s.ownerDocument)&&o.defaultView||window;var l=o.getSelection&&o.getSelection();if(l&&l.rangeCount!==0){o=l.anchorNode;var h=l.anchorOffset,p=l.focusNode;l=l.focusOffset;try{o.nodeType,p.nodeType}catch{o=null;break e}var T=0,M=-1,B=-1,Z=0,ie=0,de=s,re=null;t:for(;;){for(var ae;de!==o||h!==0&&de.nodeType!==3||(M=T+h),de!==p||l!==0&&de.nodeType!==3||(B=T+l),de.nodeType===3&&(T+=de.nodeValue.length),(ae=de.firstChild)!==null;)re=de,de=ae;for(;;){if(de===s)break t;if(re===o&&++Z===h&&(M=T),re===p&&++ie===l&&(B=T),(ae=de.nextSibling)!==null)break;de=re,re=de.parentNode}de=ae}o=M===-1||B===-1?null:{start:M,end:B}}else o=null}o=o||{start:0,end:0}}else o=null;for(eT={focusedElem:s,selectionRange:o},Rb=!1,Dr=a;Dr!==null;)if(a=Dr,s=a.child,(a.subtreeFlags&1028)!==0&&s!==null)s.return=a,Dr=s;else for(;Dr!==null;){switch(a=Dr,p=a.alternate,s=a.flags,a.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&p!==null){s=void 0,o=a,h=p.memoizedProps,p=p.memoizedState,l=o.stateNode;try{var Fe=Vl(o.type,h,o.elementType===o.type);s=l.getSnapshotBeforeUpdate(Fe,p),l.__reactInternalSnapshotBeforeUpdate=s}catch(lt){tn(o,o.return,lt)}}break;case 3:if((s&1024)!==0){if(s=a.stateNode.containerInfo,o=s.nodeType,o===9)sT(s);else if(o===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":sT(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(r(163))}if(s=a.sibling,s!==null){s.return=a.return,Dr=s;break}Dr=a.return}return Fe=ND,ND=!1,Fe}function $D(s,a,o){var l=o.flags;switch(o.tag){case 0:case 11:case 15:uo(s,o),l&4&&rg(5,o);break;case 1:if(uo(s,o),l&4)if(s=o.stateNode,a===null)try{s.componentDidMount()}catch(M){tn(o,o.return,M)}else{var h=Vl(o.type,a.memoizedProps);a=a.memoizedState;try{s.componentDidUpdate(h,a,s.__reactInternalSnapshotBeforeUpdate)}catch(M){tn(o,o.return,M)}}l&64&&AD(o),l&512&&Ql(o,o.return);break;case 3:if(uo(s,o),l&64&&(l=o.updateQueue,l!==null)){if(s=null,o.child!==null)switch(o.child.tag){case 27:case 5:s=o.child.stateNode;break;case 1:s=o.child.stateNode}try{CD(l,s)}catch(M){tn(o,o.return,M)}}break;case 26:uo(s,o),l&512&&Ql(o,o.return);break;case 27:case 5:uo(s,o),a===null&&l&4&&xD(o),l&512&&Ql(o,o.return);break;case 12:uo(s,o);break;case 13:uo(s,o),l&4&&jD(s,o);break;case 22:if(h=o.memoizedState!==null||co,!h){a=a!==null&&a.memoizedState!==null||Fn;var p=co,T=Fn;co=h,(Fn=a)&&!T?Ac(s,o,(o.subtreeFlags&8772)!==0):uo(s,o),co=p,Fn=T}l&512&&(o.memoizedProps.mode==="manual"?Ql(o,o.return):Fs(o,o.return));break;default:uo(s,o)}}function ID(s){var a=s.alternate;a!==null&&(s.alternate=null,ID(a)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(a=s.stateNode,a!==null&&wm(a)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var ur=null,Ls=!1;function lo(s,a,o){for(o=o.child;o!==null;)MD(s,a,o),o=o.sibling}function MD(s,a,o){if(mt&&typeof mt.onCommitFiberUnmount=="function")try{mt.onCommitFiberUnmount(Cl,o)}catch{}switch(o.tag){case 26:Fn||Fs(o,a),lo(s,a,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:Fn||Fs(o,a);var l=ur,h=Ls;for(ur=o.stateNode,lo(s,a,o),o=o.stateNode,a=o.attributes;a.length;)o.removeAttributeNode(a[0]);wm(o),ur=l,Ls=h;break;case 5:Fn||Fs(o,a);case 6:h=ur;var p=Ls;if(ur=null,lo(s,a,o),ur=h,Ls=p,ur!==null)if(Ls)try{s=ur,l=o.stateNode,s.nodeType===8?s.parentNode.removeChild(l):s.removeChild(l)}catch(T){tn(o,a,T)}else try{ur.removeChild(o.stateNode)}catch(T){tn(o,a,T)}break;case 18:ur!==null&&(Ls?(a=ur,o=o.stateNode,a.nodeType===8?rT(a.parentNode,o):a.nodeType===1&&rT(a,o),vg(a)):rT(ur,o.stateNode));break;case 4:l=ur,h=Ls,ur=o.stateNode.containerInfo,Ls=!0,lo(s,a,o),ur=l,Ls=h;break;case 0:case 11:case 14:case 15:Fn||Cc(2,o,a),Fn||Cc(4,o,a),lo(s,a,o);break;case 1:Fn||(Fs(o,a),l=o.stateNode,typeof l.componentWillUnmount=="function"&&RD(o,a,l)),lo(s,a,o);break;case 21:lo(s,a,o);break;case 22:Fn||Fs(o,a),Fn=(l=Fn)||o.memoizedState!==null,lo(s,a,o),Fn=l;break;default:lo(s,a,o)}}function jD(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{vg(s)}catch(o){tn(a,a.return,o)}}function M8(s){switch(s.tag){case 13:case 19:var a=s.stateNode;return a===null&&(a=s.stateNode=new qD),a;case 22:return s=s.stateNode,a=s._retryCache,a===null&&(a=s._retryCache=new qD),a;default:throw Error(r(435,s.tag))}}function C1(s,a){var o=M8(s);a.forEach(function(l){var h=Y8.bind(null,s,l);o.has(l)||(o.add(l),l.then(h,h))})}function ca(s,a){var o=a.deletions;if(o!==null)for(var l=0;l<o.length;l++){var h=o[l],p=s,T=a,M=T;e:for(;M!==null;){switch(M.tag){case 27:case 5:ur=M.stateNode,Ls=!1;break e;case 3:ur=M.stateNode.containerInfo,Ls=!0;break e;case 4:ur=M.stateNode.containerInfo,Ls=!0;break e}M=M.return}if(ur===null)throw Error(r(160));MD(p,T,h),ur=null,Ls=!1,p=h.alternate,p!==null&&(p.return=null),h.return=null}if(a.subtreeFlags&13878)for(a=a.child;a!==null;)FD(a,s),a=a.sibling}var Pa=null;function FD(s,a){var o=s.alternate,l=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:ca(a,s),la(s),l&4&&(Cc(3,s,s.return),rg(3,s),Cc(5,s,s.return));break;case 1:ca(a,s),la(s),l&512&&(Fn||o===null||Fs(o,o.return)),l&64&&co&&(s=s.updateQueue,s!==null&&(l=s.callbacks,l!==null&&(o=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=o===null?l:o.concat(l))));break;case 26:var h=Pa;if(ca(a,s),la(s),l&512&&(Fn||o===null||Fs(o,o.return)),l&4){var p=o!==null?o.memoizedState:null;if(l=s.memoizedState,o===null)if(l===null)if(s.stateNode===null){e:{l=s.type,o=s.memoizedProps,h=h.ownerDocument||h;t:switch(l){case"title":p=h.getElementsByTagName("title")[0],(!p||p[ja]||p[Ar]||p.namespaceURI==="http://www.w3.org/2000/svg"||p.hasAttribute("itemprop"))&&(p=h.createElement(l),h.head.insertBefore(p,h.querySelector("head > title"))),Fr(p,l,o),p[Ar]=s,ir(p),l=p;break e;case"link":var T=x3("link","href",h).get(l+(o.href||""));if(T){for(var M=0;M<T.length;M++)if(p=T[M],p.getAttribute("href")===(o.href==null?null:o.href)&&p.getAttribute("rel")===(o.rel==null?null:o.rel)&&p.getAttribute("title")===(o.title==null?null:o.title)&&p.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){T.splice(M,1);break t}}p=h.createElement(l),Fr(p,l,o),h.head.appendChild(p);break;case"meta":if(T=x3("meta","content",h).get(l+(o.content||""))){for(M=0;M<T.length;M++)if(p=T[M],p.getAttribute("content")===(o.content==null?null:""+o.content)&&p.getAttribute("name")===(o.name==null?null:o.name)&&p.getAttribute("property")===(o.property==null?null:o.property)&&p.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&p.getAttribute("charset")===(o.charSet==null?null:o.charSet)){T.splice(M,1);break t}}p=h.createElement(l),Fr(p,l,o),h.head.appendChild(p);break;default:throw Error(r(468,l))}p[Ar]=s,ir(p),l=p}s.stateNode=l}else O3(h,s.type,s.stateNode);else s.stateNode=R3(h,l,s.memoizedProps);else p!==l?(p===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):p.count--,l===null?O3(h,s.type,s.stateNode):R3(h,l,s.memoizedProps)):l===null&&s.stateNode!==null&&OD(s,s.memoizedProps,o.memoizedProps)}break;case 27:if(l&4&&s.alternate===null){h=s.stateNode,p=s.memoizedProps;try{for(var B=h.firstChild;B;){var Z=B.nextSibling,ie=B.nodeName;B[ja]||ie==="HEAD"||ie==="BODY"||ie==="SCRIPT"||ie==="STYLE"||ie==="LINK"&&B.rel.toLowerCase()==="stylesheet"||h.removeChild(B),B=Z}for(var de=s.type,re=h.attributes;re.length;)h.removeAttributeNode(re[0]);Fr(h,de,p),h[Ar]=s,h[Qr]=p}catch(Fe){tn(s,s.return,Fe)}}case 5:if(ca(a,s),la(s),l&512&&(Fn||o===null||Fs(o,o.return)),s.flags&32){h=s.stateNode;try{lc(h,"")}catch(Fe){tn(s,s.return,Fe)}}l&4&&s.stateNode!=null&&(h=s.memoizedProps,OD(s,h,o!==null?o.memoizedProps:h)),l&1024&&(k1=!0);break;case 6:if(ca(a,s),la(s),l&4){if(s.stateNode===null)throw Error(r(162));l=s.memoizedProps,o=s.stateNode;try{o.nodeValue=l}catch(Fe){tn(s,s.return,Fe)}}break;case 3:if(kb=null,h=Pa,Pa=Eb(a.containerInfo),ca(a,s),Pa=h,la(s),l&4&&o!==null&&o.memoizedState.isDehydrated)try{vg(a.containerInfo)}catch(Fe){tn(s,s.return,Fe)}k1&&(k1=!1,LD(s));break;case 4:l=Pa,Pa=Eb(s.stateNode.containerInfo),ca(a,s),la(s),Pa=l;break;case 12:ca(a,s),la(s);break;case 13:ca(a,s),la(s),s.child.flags&8192&&s.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(I1=Ms()),l&4&&(l=s.updateQueue,l!==null&&(s.updateQueue=null,C1(s,l)));break;case 22:if(l&512&&(Fn||o===null||Fs(o,o.return)),B=s.memoizedState!==null,Z=o!==null&&o.memoizedState!==null,ie=co,de=Fn,co=ie||B,Fn=de||Z,ca(a,s),Fn=de,co=ie,la(s),a=s.stateNode,a._current=s,a._visibility&=-3,a._visibility|=a._pendingVisibility&2,l&8192&&(a._visibility=B?a._visibility&-2:a._visibility|1,B&&(a=co||Fn,o===null||Z||a||ed(s)),s.memoizedProps===null||s.memoizedProps.mode!=="manual"))e:for(o=null,a=s;;){if(a.tag===5||a.tag===26||a.tag===27){if(o===null){Z=o=a;try{if(h=Z.stateNode,B)p=h.style,typeof p.setProperty=="function"?p.setProperty("display","none","important"):p.display="none";else{T=Z.stateNode,M=Z.memoizedProps.style;var ae=M!=null&&M.hasOwnProperty("display")?M.display:null;T.style.display=ae==null||typeof ae=="boolean"?"":(""+ae).trim()}}catch(Fe){tn(Z,Z.return,Fe)}}}else if(a.tag===6){if(o===null){Z=a;try{Z.stateNode.nodeValue=B?"":Z.memoizedProps}catch(Fe){tn(Z,Z.return,Fe)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===s)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break e;for(;a.sibling===null;){if(a.return===null||a.return===s)break e;o===a&&(o=null),a=a.return}o===a&&(o=null),a.sibling.return=a.return,a=a.sibling}l&4&&(l=s.updateQueue,l!==null&&(o=l.retryQueue,o!==null&&(l.retryQueue=null,C1(s,o))));break;case 19:ca(a,s),la(s),l&4&&(l=s.updateQueue,l!==null&&(s.updateQueue=null,C1(s,l)));break;case 21:break;default:ca(a,s),la(s)}}function la(s){var a=s.flags;if(a&2){try{if(s.tag!==27){e:{for(var o=s.return;o!==null;){if(DD(o)){var l=o;break e}o=o.return}throw Error(r(160))}switch(l.tag){case 27:var h=l.stateNode,p=E1(s);cb(s,p,h);break;case 5:var T=l.stateNode;l.flags&32&&(lc(T,""),l.flags&=-33);var M=E1(s);cb(s,M,T);break;case 3:case 4:var B=l.stateNode.containerInfo,Z=E1(s);T1(s,Z,B);break;default:throw Error(r(161))}}}catch(ie){tn(s,s.return,ie)}s.flags&=-3}a&4096&&(s.flags&=-4097)}function LD(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var a=s;LD(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),s=s.sibling}}function uo(s,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)$D(s,a.alternate,a),a=a.sibling}function ed(s){for(s=s.child;s!==null;){var a=s;switch(a.tag){case 0:case 11:case 14:case 15:Cc(4,a,a.return),ed(a);break;case 1:Fs(a,a.return);var o=a.stateNode;typeof o.componentWillUnmount=="function"&&RD(a,a.return,o),ed(a);break;case 26:case 27:case 5:Fs(a,a.return),ed(a);break;case 22:Fs(a,a.return),a.memoizedState===null&&ed(a);break;default:ed(a)}s=s.sibling}}function Ac(s,a,o){for(o=o&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var l=a.alternate,h=s,p=a,T=p.flags;switch(p.tag){case 0:case 11:case 15:Ac(h,p,o),rg(4,p);break;case 1:if(Ac(h,p,o),l=p,h=l.stateNode,typeof h.componentDidMount=="function")try{h.componentDidMount()}catch(Z){tn(l,l.return,Z)}if(l=p,h=l.updateQueue,h!==null){var M=l.stateNode;try{var B=h.shared.hiddenCallbacks;if(B!==null)for(h.shared.hiddenCallbacks=null,h=0;h<B.length;h++)kD(B[h],M)}catch(Z){tn(l,l.return,Z)}}o&&T&64&&AD(p),Ql(p,p.return);break;case 26:case 27:case 5:Ac(h,p,o),o&&l===null&&T&4&&xD(p),Ql(p,p.return);break;case 12:Ac(h,p,o);break;case 13:Ac(h,p,o),o&&T&4&&jD(h,p);break;case 22:p.memoizedState===null&&Ac(h,p,o),Ql(p,p.return);break;default:Ac(h,p,o)}a=a.sibling}}function A1(s,a){var o=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),s=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(s=a.memoizedState.cachePool.pool),s!==o&&(s!=null&&s.refCount++,o!=null&&Km(o))}function R1(s,a){s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&Km(s))}function Rc(s,a,o,l){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)UD(s,a,o,l),a=a.sibling}function UD(s,a,o,l){var h=a.flags;switch(a.tag){case 0:case 11:case 15:Rc(s,a,o,l),h&2048&&rg(9,a);break;case 3:Rc(s,a,o,l),h&2048&&(s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&Km(s)));break;case 12:if(h&2048){Rc(s,a,o,l),s=a.stateNode;try{var p=a.memoizedProps,T=p.id,M=p.onPostCommit;typeof M=="function"&&M(T,a.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(B){tn(a,a.return,B)}}else Rc(s,a,o,l);break;case 23:break;case 22:p=a.stateNode,a.memoizedState!==null?p._visibility&4?Rc(s,a,o,l):sg(s,a):p._visibility&4?Rc(s,a,o,l):(p._visibility|=4,td(s,a,o,l,(a.subtreeFlags&10256)!==0)),h&2048&&A1(a.alternate,a);break;case 24:Rc(s,a,o,l),h&2048&&R1(a.alternate,a);break;default:Rc(s,a,o,l)}}function td(s,a,o,l,h){for(h=h&&(a.subtreeFlags&10256)!==0,a=a.child;a!==null;){var p=s,T=a,M=o,B=l,Z=T.flags;switch(T.tag){case 0:case 11:case 15:td(p,T,M,B,h),rg(8,T);break;case 23:break;case 22:var ie=T.stateNode;T.memoizedState!==null?ie._visibility&4?td(p,T,M,B,h):sg(p,T):(ie._visibility|=4,td(p,T,M,B,h)),h&&Z&2048&&A1(T.alternate,T);break;case 24:td(p,T,M,B,h),h&&Z&2048&&R1(T.alternate,T);break;default:td(p,T,M,B,h)}a=a.sibling}}function sg(s,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var o=s,l=a,h=l.flags;switch(l.tag){case 22:sg(o,l),h&2048&&A1(l.alternate,l);break;case 24:sg(o,l),h&2048&&R1(l.alternate,l);break;default:sg(o,l)}a=a.sibling}}var ag=8192;function nd(s){if(s.subtreeFlags&ag)for(s=s.child;s!==null;)zD(s),s=s.sibling}function zD(s){switch(s.tag){case 26:nd(s),s.flags&ag&&s.memoizedState!==null&&TB(Pa,s.memoizedState,s.memoizedProps);break;case 5:nd(s);break;case 3:case 4:var a=Pa;Pa=Eb(s.stateNode.containerInfo),nd(s),Pa=a;break;case 22:s.memoizedState===null&&(a=s.alternate,a!==null&&a.memoizedState!==null?(a=ag,ag=16777216,nd(s),ag=a):nd(s));break;default:nd(s)}}function PD(s){var a=s.alternate;if(a!==null&&(s=a.child,s!==null)){a.child=null;do a=s.sibling,s.sibling=null,s=a;while(s!==null)}}function ig(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var o=0;o<a.length;o++){var l=a[o];Dr=l,BD(l,s)}PD(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)HD(s),s=s.sibling}function HD(s){switch(s.tag){case 0:case 11:case 15:ig(s),s.flags&2048&&Cc(9,s,s.return);break;case 3:ig(s);break;case 12:ig(s);break;case 22:var a=s.stateNode;s.memoizedState!==null&&a._visibility&4&&(s.return===null||s.return.tag!==13)?(a._visibility&=-5,lb(s)):ig(s);break;default:ig(s)}}function lb(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var o=0;o<a.length;o++){var l=a[o];Dr=l,BD(l,s)}PD(s)}for(s=s.child;s!==null;){switch(a=s,a.tag){case 0:case 11:case 15:Cc(8,a,a.return),lb(a);break;case 22:o=a.stateNode,o._visibility&4&&(o._visibility&=-5,lb(a));break;default:lb(a)}s=s.sibling}}function BD(s,a){for(;Dr!==null;){var o=Dr;switch(o.tag){case 0:case 11:case 15:Cc(8,o,a);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var l=o.memoizedState.cachePool.pool;l!=null&&l.refCount++}break;case 24:Km(o.memoizedState.cache)}if(l=o.child,l!==null)l.return=o,Dr=l;else e:for(o=s;Dr!==null;){l=Dr;var h=l.sibling,p=l.return;if(ID(l),l===o){Dr=null;break e}if(h!==null){h.return=p,Dr=h;break e}Dr=p}}}function j8(s,a,o,l){this.tag=s,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ua(s,a,o,l){return new j8(s,a,o,l)}function x1(s){return s=s.prototype,!(!s||!s.isReactComponent)}function xc(s,a){var o=s.alternate;return o===null?(o=ua(s.tag,a,s.key,s.mode),o.elementType=s.elementType,o.type=s.type,o.stateNode=s.stateNode,o.alternate=s,s.alternate=o):(o.pendingProps=a,o.type=s.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=s.flags&31457280,o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,a=s.dependencies,o.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},o.sibling=s.sibling,o.index=s.index,o.ref=s.ref,o.refCleanup=s.refCleanup,o}function VD(s,a){s.flags&=31457282;var o=s.alternate;return o===null?(s.childLanes=0,s.lanes=a,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,a=o.dependencies,s.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),s}function ub(s,a,o,l,h,p){var T=0;if(l=s,typeof s=="function")x1(s)&&(T=1);else if(typeof s=="string")T=wB(s,o,pr.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case g:return Yl(o.children,h,p,a);case b:T=8,h|=24;break;case S:return s=ua(12,o,a,h|2),s.elementType=S,s.lanes=p,s;case H:return s=ua(13,o,a,h),s.elementType=H,s.lanes=p,s;case x:return s=ua(19,o,a,h),s.elementType=x,s.lanes=p,s;case $:return GD(o,h,p,a);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case v:case k:T=10;break e;case q:T=9;break e;case N:T=11;break e;case C:T=14;break e;case E:T=16,l=null;break e}T=29,o=Error(r(130,s===null?"null":typeof s,"")),l=null}return a=ua(T,o,a,h),a.elementType=s,a.type=l,a.lanes=p,a}function Yl(s,a,o,l){return s=ua(7,s,l,a),s.lanes=o,s}function GD(s,a,o,l){s=ua(22,s,l,a),s.elementType=$,s.lanes=o;var h={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var p=h._current;if(p===null)throw Error(r(456));if((h._pendingVisibility&2)===0){var T=_c(p,2);T!==null&&(h._pendingVisibility|=2,fs(T,p,2))}},attach:function(){var p=h._current;if(p===null)throw Error(r(456));if((h._pendingVisibility&2)!==0){var T=_c(p,2);T!==null&&(h._pendingVisibility&=-3,fs(T,p,2))}}};return s.stateNode=h,s}function O1(s,a,o){return s=ua(6,s,null,a),s.lanes=o,s}function D1(s,a,o){return a=ua(4,s.children!==null?s.children:[],s.key,a),a.lanes=o,a.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},a}function fo(s){s.flags|=4}function KD(s,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!D3(a)){if(a=oa.current,a!==null&&((qt&4194176)===qt?pi!==null:(qt&62914560)!==qt&&(qt&536870912)===0||a!==pi))throw Bm=ME,uO;s.flags|=8192}}function fb(s,a){a!==null&&(s.flags|=4),s.flags&16384&&(a=s.tag!==22?cy():536870912,s.lanes|=a,sd|=a)}function og(s,a){if(!It)switch(s.tailMode){case"hidden":a=s.tail;for(var o=null;a!==null;)a.alternate!==null&&(o=a),a=a.sibling;o===null?s.tail=null:o.sibling=null;break;case"collapsed":o=s.tail;for(var l=null;o!==null;)o.alternate!==null&&(l=o),o=o.sibling;l===null?a||s.tail===null?s.tail=null:s.tail.sibling=null:l.sibling=null}}function An(s){var a=s.alternate!==null&&s.alternate.child===s.child,o=0,l=0;if(a)for(var h=s.child;h!==null;)o|=h.lanes|h.childLanes,l|=h.subtreeFlags&31457280,l|=h.flags&31457280,h.return=s,h=h.sibling;else for(h=s.child;h!==null;)o|=h.lanes|h.childLanes,l|=h.subtreeFlags,l|=h.flags,h.return=s,h=h.sibling;return s.subtreeFlags|=l,s.childLanes=o,a}function F8(s,a,o){var l=a.pendingProps;switch($E(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return An(a),null;case 1:return An(a),null;case 3:return o=a.stateNode,l=null,s!==null&&(l=s.memoizedState.cache),a.memoizedState.cache!==l&&(a.flags|=2048),oo(yr),Qi(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(s===null||s.child===null)&&(Um(a)?fo(a):s===null||s.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,za!==null&&(L1(za),za=null))),An(a),null;case 26:return o=a.memoizedState,s===null?(fo(a),o!==null?(An(a),KD(a,o)):(An(a),a.flags&=-16777217)):o?o!==s.memoizedState?(fo(a),An(a),KD(a,o)):(An(a),a.flags&=-16777217):(s.memoizedProps!==l&&fo(a),An(a),a.flags&=-16777217),null;case 27:kl(a),o=Ia.current;var h=a.type;if(s!==null&&a.stateNode!=null)s.memoizedProps!==l&&fo(a);else{if(!l){if(a.stateNode===null)throw Error(r(166));return An(a),null}s=pr.current,Um(a)?cO(a):(s=E3(h,l,o),a.stateNode=s,fo(a))}return An(a),null;case 5:if(kl(a),o=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==l&&fo(a);else{if(!l){if(a.stateNode===null)throw Error(r(166));return An(a),null}if(s=pr.current,Um(a))cO(a);else{switch(h=wb(Ia.current),s){case 1:s=h.createElementNS("http://www.w3.org/2000/svg",o);break;case 2:s=h.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;default:switch(o){case"svg":s=h.createElementNS("http://www.w3.org/2000/svg",o);break;case"math":s=h.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;case"script":s=h.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof l.is=="string"?h.createElement("select",{is:l.is}):h.createElement("select"),l.multiple?s.multiple=!0:l.size&&(s.size=l.size);break;default:s=typeof l.is=="string"?h.createElement(o,{is:l.is}):h.createElement(o)}}s[Ar]=a,s[Qr]=l;e:for(h=a.child;h!==null;){if(h.tag===5||h.tag===6)s.appendChild(h.stateNode);else if(h.tag!==4&&h.tag!==27&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===a)break e;for(;h.sibling===null;){if(h.return===null||h.return===a)break e;h=h.return}h.sibling.return=h.return,h=h.sibling}a.stateNode=s;e:switch(Fr(s,o,l),o){case"button":case"input":case"select":case"textarea":s=!!l.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&fo(a)}}return An(a),a.flags&=-16777217,null;case 6:if(s&&a.stateNode!=null)s.memoizedProps!==l&&fo(a);else{if(typeof l!="string"&&a.stateNode===null)throw Error(r(166));if(s=Ia.current,Um(a)){if(s=a.stateNode,o=a.memoizedProps,l=null,h=us,h!==null)switch(h.tag){case 27:case 5:l=h.memoizedProps}s[Ar]=a,s=!!(s.nodeValue===o||l!==null&&l.suppressHydrationWarning===!0||_3(s.nodeValue,o)),s||Ll(a)}else s=wb(s).createTextNode(l),s[Ar]=a,a.stateNode=s}return An(a),null;case 13:if(l=a.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(h=Um(a),l!==null&&l.dehydrated!==null){if(s===null){if(!h)throw Error(r(318));if(h=a.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(r(317));h[Ar]=a}else zm(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;An(a),h=!1}else za!==null&&(L1(za),za=null),h=!0;if(!h)return a.flags&256?(ro(a),a):(ro(a),null)}if(ro(a),(a.flags&128)!==0)return a.lanes=o,a;if(o=l!==null,s=s!==null&&s.memoizedState!==null,o){l=a.child,h=null,l.alternate!==null&&l.alternate.memoizedState!==null&&l.alternate.memoizedState.cachePool!==null&&(h=l.alternate.memoizedState.cachePool.pool);var p=null;l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(p=l.memoizedState.cachePool.pool),p!==h&&(l.flags|=2048)}return o!==s&&o&&(a.child.flags|=8192),fb(a,a.updateQueue),An(a),null;case 4:return Qi(),s===null&&W1(a.stateNode.containerInfo),An(a),null;case 10:return oo(a.type),An(a),null;case 19:if(vn(_r),h=a.memoizedState,h===null)return An(a),null;if(l=(a.flags&128)!==0,p=h.rendering,p===null)if(l)og(h,!1);else{if(Ln!==0||s!==null&&(s.flags&128)!==0)for(s=a.child;s!==null;){if(p=Qy(s),p!==null){for(a.flags|=128,og(h,!1),s=p.updateQueue,a.updateQueue=s,fb(a,s),a.subtreeFlags=0,s=o,o=a.child;o!==null;)VD(o,s),o=o.sibling;return Kt(_r,_r.current&1|2),a.child}s=s.sibling}h.tail!==null&&Ms()>db&&(a.flags|=128,l=!0,og(h,!1),a.lanes=4194304)}else{if(!l)if(s=Qy(p),s!==null){if(a.flags|=128,l=!0,s=s.updateQueue,a.updateQueue=s,fb(a,s),og(h,!0),h.tail===null&&h.tailMode==="hidden"&&!p.alternate&&!It)return An(a),null}else 2*Ms()-h.renderingStartTime>db&&o!==536870912&&(a.flags|=128,l=!0,og(h,!1),a.lanes=4194304);h.isBackwards?(p.sibling=a.child,a.child=p):(s=h.last,s!==null?s.sibling=p:a.child=p,h.last=p)}return h.tail!==null?(a=h.tail,h.rendering=a,h.tail=a.sibling,h.renderingStartTime=Ms(),a.sibling=null,s=_r.current,Kt(_r,l?s&1|2:s&1),a):(An(a),null);case 22:case 23:return ro(a),FE(),l=a.memoizedState!==null,s!==null?s.memoizedState!==null!==l&&(a.flags|=8192):l&&(a.flags|=8192),l?(o&536870912)!==0&&(a.flags&128)===0&&(An(a),a.subtreeFlags&6&&(a.flags|=8192)):An(a),o=a.updateQueue,o!==null&&fb(a,o.retryQueue),o=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),l=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(l=a.memoizedState.cachePool.pool),l!==o&&(a.flags|=2048),s!==null&&vn(zl),null;case 24:return o=null,s!==null&&(o=s.memoizedState.cache),a.memoizedState.cache!==o&&(a.flags|=2048),oo(yr),An(a),null;case 25:return null}throw Error(r(156,a.tag))}function L8(s,a){switch($E(a),a.tag){case 1:return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 3:return oo(yr),Qi(),s=a.flags,(s&65536)!==0&&(s&128)===0?(a.flags=s&-65537|128,a):null;case 26:case 27:case 5:return kl(a),null;case 13:if(ro(a),s=a.memoizedState,s!==null&&s.dehydrated!==null){if(a.alternate===null)throw Error(r(340));zm()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 19:return vn(_r),null;case 4:return Qi(),null;case 10:return oo(a.type),null;case 22:case 23:return ro(a),FE(),s!==null&&vn(zl),s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 24:return oo(yr),null;case 25:return null;default:return null}}function QD(s,a){switch($E(a),a.tag){case 3:oo(yr),Qi();break;case 26:case 27:case 5:kl(a);break;case 4:Qi();break;case 13:ro(a);break;case 19:vn(_r);break;case 10:oo(a.type);break;case 22:case 23:ro(a),FE(),s!==null&&vn(zl);break;case 24:oo(yr)}}var U8={getCacheForType:function(s){var a=Xr(yr),o=a.data.get(s);return o===void 0&&(o=s(),a.data.set(s,o)),o}},z8=typeof WeakMap=="function"?WeakMap:Map,Rn=0,ln=null,kt=null,qt=0,un=0,Us=null,ho=!1,rd=!1,q1=!1,mo=0,Ln=0,Oc=0,Wl=0,N1=0,fa=0,sd=0,cg=null,yi=null,$1=!1,I1=0,db=1/0,hb=null,Dc=null,mb=!1,Jl=null,lg=0,M1=0,j1=null,ug=0,F1=null;function zs(){if((Rn&2)!==0&&qt!==0)return qt&-qt;if(Y.T!==null){var s=Yf;return s!==0?s:G1()}return A()}function YD(){fa===0&&(fa=(qt&536870912)===0||It?et():536870912);var s=oa.current;return s!==null&&(s.flags|=32),fa}function fs(s,a,o){(s===ln&&un===2||s.cancelPendingCommit!==null)&&(ad(s,0),go(s,qt,fa,!1)),Al(s,o),((Rn&2)===0||s!==ln)&&(s===ln&&((Rn&2)===0&&(Wl|=o),Ln===4&&go(s,qt,fa,!1)),bi(s))}function WD(s,a,o){if((Rn&6)!==0)throw Error(r(327));var l=!o&&(a&60)===0&&(a&s.expiredLanes)===0||nc(s,a),h=l?B8(s,a):P1(s,a,!0),p=l;do{if(h===0){rd&&!l&&go(s,a,0,!1);break}else if(h===6)go(s,a,0,!ho);else{if(o=s.current.alternate,p&&!P8(o)){h=P1(s,a,!1),p=!1;continue}if(h===2){if(p=a,s.errorRecoveryDisabledLanes&p)var T=0;else T=s.pendingLanes&-536870913,T=T!==0?T:T&536870912?536870912:0;if(T!==0){a=T;e:{var M=s;h=cg;var B=M.current.memoizedState.isDehydrated;if(B&&(ad(M,T).flags|=256),T=P1(M,T,!1),T!==2){if(q1&&!B){M.errorRecoveryDisabledLanes|=p,Wl|=p,h=4;break e}p=yi,yi=h,p!==null&&L1(p)}h=T}if(p=!1,h!==2)continue}}if(h===1){ad(s,0),go(s,a,0,!0);break}e:{switch(l=s,h){case 0:case 1:throw Error(r(345));case 4:if((a&4194176)===a){go(l,a,fa,!ho);break e}break;case 2:yi=null;break;case 3:case 5:break;default:throw Error(r(329))}if(l.finishedWork=o,l.finishedLanes=a,(a&62914560)===a&&(p=I1+300-Ms(),10<p)){if(go(l,a,fa,!ho),Rf(l,0)!==0)break e;l.timeoutHandle=S3(JD.bind(null,l,o,yi,hb,$1,a,fa,Wl,sd,ho,2,-0,0),p);break e}JD(l,o,yi,hb,$1,a,fa,Wl,sd,ho,0,-0,0)}}break}while(!0);bi(s)}function L1(s){yi===null?yi=s:yi.push.apply(yi,s)}function JD(s,a,o,l,h,p,T,M,B,Z,ie,de,re){var ae=a.subtreeFlags;if((ae&8192||(ae&16785408)===16785408)&&(pg={stylesheets:null,count:0,unsuspend:EB},zD(a),a=kB(),a!==null)){s.cancelPendingCommit=a(s3.bind(null,s,o,l,h,T,M,B,1,de,re)),go(s,p,T,!Z);return}s3(s,o,l,h,T,M,B,ie,de,re)}function P8(s){for(var a=s;;){var o=a.tag;if((o===0||o===11||o===15)&&a.flags&16384&&(o=a.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var l=0;l<o.length;l++){var h=o[l],p=h.getSnapshot;h=h.value;try{if(!Me(p(),h))return!1}catch{return!1}}if(o=a.child,a.subtreeFlags&16384&&o!==null)o.return=a,a=o;else{if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function go(s,a,o,l){a&=~N1,a&=~Wl,s.suspendedLanes|=a,s.pingedLanes&=~a,l&&(s.warmLanes|=a),l=s.expirationTimes;for(var h=a;0<h;){var p=31-jn(h),T=1<<p;l[p]=-1,h&=~T}o!==0&&ly(s,o,a)}function gb(){return(Rn&6)===0?(fg(0),!1):!0}function U1(){if(kt!==null){if(un===0)var s=kt.return;else s=kt,io=Gl=null,GE(s),Kf=null,Vm=0,s=kt;for(;s!==null;)QD(s.alternate,s),s=s.return;kt=null}}function ad(s,a){s.finishedWork=null,s.finishedLanes=0;var o=s.timeoutHandle;o!==-1&&(s.timeoutHandle=-1,oB(o)),o=s.cancelPendingCommit,o!==null&&(s.cancelPendingCommit=null,o()),U1(),ln=s,kt=o=xc(s.current,null),qt=a,un=0,Us=null,ho=!1,rd=nc(s,a),q1=!1,sd=fa=N1=Wl=Oc=Ln=0,yi=cg=null,$1=!1,(a&8)!==0&&(a|=a&32);var l=s.entangledLanes;if(l!==0)for(s=s.entanglements,l&=a;0<l;){var h=31-jn(l),p=1<<h;a|=s[h],l&=~p}return mo=a,Ly(),o}function XD(s,a){vt=null,Y.H=_i,a===Hm?(a=hO(),un=3):a===uO?(a=hO(),un=4):un=a===fD?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Us=a,kt===null&&(Ln=1,ab(s,sa(a,s.current)))}function ZD(){var s=Y.H;return Y.H=_i,s===null?_i:s}function e3(){var s=Y.A;return Y.A=U8,s}function z1(){Ln=4,ho||(qt&4194176)!==qt&&oa.current!==null||(rd=!0),(Oc&134217727)===0&&(Wl&134217727)===0||ln===null||go(ln,qt,fa,!1)}function P1(s,a,o){var l=Rn;Rn|=2;var h=ZD(),p=e3();(ln!==s||qt!==a)&&(hb=null,ad(s,a)),a=!1;var T=Ln;e:do try{if(un!==0&&kt!==null){var M=kt,B=Us;switch(un){case 8:U1(),T=6;break e;case 3:case 2:case 6:oa.current===null&&(a=!0);var Z=un;if(un=0,Us=null,id(s,M,B,Z),o&&rd){T=0;break e}break;default:Z=un,un=0,Us=null,id(s,M,B,Z)}}H8(),T=Ln;break}catch(ie){XD(s,ie)}while(!0);return a&&s.shellSuspendCounter++,io=Gl=null,Rn=l,Y.H=h,Y.A=p,kt===null&&(ln=null,qt=0,Ly()),T}function H8(){for(;kt!==null;)t3(kt)}function B8(s,a){var o=Rn;Rn|=2;var l=ZD(),h=e3();ln!==s||qt!==a?(hb=null,db=Ms()+500,ad(s,a)):rd=nc(s,a);e:do try{if(un!==0&&kt!==null){a=kt;var p=Us;t:switch(un){case 1:un=0,Us=null,id(s,a,p,1);break;case 2:if(fO(p)){un=0,Us=null,n3(a);break}a=function(){un===2&&ln===s&&(un=7),bi(s)},p.then(a,a);break e;case 3:un=7;break e;case 4:un=5;break e;case 7:fO(p)?(un=0,Us=null,n3(a)):(un=0,Us=null,id(s,a,p,7));break;case 5:var T=null;switch(kt.tag){case 26:T=kt.memoizedState;case 5:case 27:var M=kt;if(!T||D3(T)){un=0,Us=null;var B=M.sibling;if(B!==null)kt=B;else{var Z=M.return;Z!==null?(kt=Z,pb(Z)):kt=null}break t}}un=0,Us=null,id(s,a,p,5);break;case 6:un=0,Us=null,id(s,a,p,6);break;case 8:U1(),Ln=6;break e;default:throw Error(r(462))}}V8();break}catch(ie){XD(s,ie)}while(!0);return io=Gl=null,Y.H=l,Y.A=h,Rn=o,kt!==null?0:(ln=null,qt=0,Ly(),Ln)}function V8(){for(;kt!==null&&!We();)t3(kt)}function t3(s){var a=ED(s.alternate,s,mo);s.memoizedProps=s.pendingProps,a===null?pb(s):kt=a}function n3(s){var a=s,o=a.alternate;switch(a.tag){case 15:case 0:a=_D(o,a,a.pendingProps,a.type,void 0,qt);break;case 11:a=_D(o,a,a.pendingProps,a.type.render,a.ref,qt);break;case 5:GE(a);default:QD(o,a),a=kt=VD(a,mo),a=ED(o,a,mo)}s.memoizedProps=s.pendingProps,a===null?pb(s):kt=a}function id(s,a,o,l){io=Gl=null,GE(a),Kf=null,Vm=0;var h=a.return;try{if(N8(s,h,a,o,qt)){Ln=1,ab(s,sa(o,s.current)),kt=null;return}}catch(p){if(h!==null)throw kt=h,p;Ln=1,ab(s,sa(o,s.current)),kt=null;return}a.flags&32768?(It||l===1?s=!0:rd||(qt&536870912)!==0?s=!1:(ho=s=!0,(l===2||l===3||l===6)&&(l=oa.current,l!==null&&l.tag===13&&(l.flags|=16384))),r3(a,s)):pb(a)}function pb(s){var a=s;do{if((a.flags&32768)!==0){r3(a,ho);return}s=a.return;var o=F8(a.alternate,a,mo);if(o!==null){kt=o;return}if(a=a.sibling,a!==null){kt=a;return}kt=a=s}while(a!==null);Ln===0&&(Ln=5)}function r3(s,a){do{var o=L8(s.alternate,s);if(o!==null){o.flags&=32767,kt=o;return}if(o=s.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!a&&(s=s.sibling,s!==null)){kt=s;return}kt=s=o}while(s!==null);Ln=6,kt=null}function s3(s,a,o,l,h,p,T,M,B,Z){var ie=Y.T,de=be.p;try{be.p=2,Y.T=null,G8(s,a,o,l,de,h,p,T,M,B,Z)}finally{Y.T=ie,be.p=de}}function G8(s,a,o,l,h,p,T,M){do od();while(Jl!==null);if((Rn&6)!==0)throw Error(r(327));var B=s.finishedWork;if(l=s.finishedLanes,B===null)return null;if(s.finishedWork=null,s.finishedLanes=0,B===s.current)throw Error(r(177));s.callbackNode=null,s.callbackPriority=0,s.cancelPendingCommit=null;var Z=B.lanes|B.childLanes;if(Z|=DE,nE(s,l,Z,p,T,M),s===ln&&(kt=ln=null,qt=0),(B.subtreeFlags&10256)===0&&(B.flags&10256)===0||mb||(mb=!0,M1=Z,j1=o,W8(Cf,function(){return od(),null})),o=(B.flags&15990)!==0,(B.subtreeFlags&15990)!==0||o?(o=Y.T,Y.T=null,p=be.p,be.p=2,T=Rn,Rn|=4,I8(s,B),FD(B,s),ls(eT,s.containerInfo),Rb=!!Z1,eT=Z1=null,s.current=B,$D(s,B.alternate,B),cn(),Rn=T,be.p=p,Y.T=o):s.current=B,mb?(mb=!1,Jl=s,lg=l):a3(s,Z),Z=s.pendingLanes,Z===0&&(Dc=null),tE(B.stateNode),bi(s),a!==null)for(h=s.onRecoverableError,B=0;B<a.length;B++)Z=a[B],h(Z.value,{componentStack:Z.stack});return(lg&3)!==0&&od(),Z=s.pendingLanes,(l&4194218)!==0&&(Z&42)!==0?s===F1?ug++:(ug=0,F1=s):ug=0,fg(0),null}function a3(s,a){(s.pooledCacheLanes&=a)===0&&(a=s.pooledCache,a!=null&&(s.pooledCache=null,Km(a)))}function od(){if(Jl!==null){var s=Jl,a=M1;M1=0;var o=xf(lg),l=Y.T,h=be.p;try{if(be.p=32>o?32:o,Y.T=null,Jl===null)var p=!1;else{o=j1,j1=null;var T=Jl,M=lg;if(Jl=null,lg=0,(Rn&6)!==0)throw Error(r(331));var B=Rn;if(Rn|=4,HD(T.current),UD(T,T.current,M,o),Rn=B,fg(0,!1),mt&&typeof mt.onPostCommitFiberRoot=="function")try{mt.onPostCommitFiberRoot(Cl,T)}catch{}p=!0}return p}finally{be.p=h,Y.T=l,a3(s,a)}}return!1}function i3(s,a,o){a=sa(o,a),a=i1(s.stateNode,a,2),s=kc(s,a,2),s!==null&&(Al(s,2),bi(s))}function tn(s,a,o){if(s.tag===3)i3(s,s,o);else for(;a!==null;){if(a.tag===3){i3(a,s,o);break}else if(a.tag===1){var l=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(Dc===null||!Dc.has(l))){s=sa(o,s),o=lD(2),l=kc(a,o,2),l!==null&&(uD(o,l,a,s),Al(l,2),bi(l));break}}a=a.return}}function H1(s,a,o){var l=s.pingCache;if(l===null){l=s.pingCache=new z8;var h=new Set;l.set(a,h)}else h=l.get(a),h===void 0&&(h=new Set,l.set(a,h));h.has(o)||(q1=!0,h.add(o),s=K8.bind(null,s,a,o),a.then(s,s))}function K8(s,a,o){var l=s.pingCache;l!==null&&l.delete(a),s.pingedLanes|=s.suspendedLanes&o,s.warmLanes&=~o,ln===s&&(qt&o)===o&&(Ln===4||Ln===3&&(qt&62914560)===qt&&300>Ms()-I1?(Rn&2)===0&&ad(s,0):N1|=o,sd===qt&&(sd=0)),bi(s)}function o3(s,a){a===0&&(a=cy()),s=_c(s,a),s!==null&&(Al(s,a),bi(s))}function Q8(s){var a=s.memoizedState,o=0;a!==null&&(o=a.retryLane),o3(s,o)}function Y8(s,a){var o=0;switch(s.tag){case 13:var l=s.stateNode,h=s.memoizedState;h!==null&&(o=h.retryLane);break;case 19:l=s.stateNode;break;case 22:l=s.stateNode._retryCache;break;default:throw Error(r(314))}l!==null&&l.delete(a),o3(s,o)}function W8(s,a){return gm(s,a)}var _b=null,cd=null,B1=!1,yb=!1,V1=!1,Xl=0;function bi(s){s!==cd&&s.next===null&&(cd===null?_b=cd=s:cd=cd.next=s),yb=!0,B1||(B1=!0,X8(J8))}function fg(s,a){if(!V1&&yb){V1=!0;do for(var o=!1,l=_b;l!==null;){if(s!==0){var h=l.pendingLanes;if(h===0)var p=0;else{var T=l.suspendedLanes,M=l.pingedLanes;p=(1<<31-jn(42|s)+1)-1,p&=h&~(T&~M),p=p&201326677?p&201326677|1:p?p|2:0}p!==0&&(o=!0,u3(l,p))}else p=qt,p=Rf(l,l===ln?p:0),(p&3)===0||nc(l,p)||(o=!0,u3(l,p));l=l.next}while(o);V1=!1}}function J8(){yb=B1=!1;var s=0;Xl!==0&&(iB()&&(s=Xl),Xl=0);for(var a=Ms(),o=null,l=_b;l!==null;){var h=l.next,p=c3(l,a);p===0?(l.next=null,o===null?_b=h:o.next=h,h===null&&(cd=o)):(o=l,(s!==0||(p&3)!==0)&&(yb=!0)),l=h}fg(s)}function c3(s,a){for(var o=s.suspendedLanes,l=s.pingedLanes,h=s.expirationTimes,p=s.pendingLanes&-62914561;0<p;){var T=31-jn(p),M=1<<T,B=h[T];B===-1?((M&o)===0||(M&l)!==0)&&(h[T]=oy(M,a)):B<=a&&(s.expiredLanes|=M),p&=~M}if(a=ln,o=qt,o=Rf(s,s===a?o:0),l=s.callbackNode,o===0||s===a&&un===2||s.cancelPendingCommit!==null)return l!==null&&l!==null&&pm(l),s.callbackNode=null,s.callbackPriority=0;if((o&3)===0||nc(s,o)){if(a=o&-o,a===s.callbackPriority)return a;switch(l!==null&&pm(l),xf(o)){case 2:case 8:o=Yi;break;case 32:o=Cf;break;case 268435456:o=ym;break;default:o=Cf}return l=l3.bind(null,s),o=gm(o,l),s.callbackPriority=a,s.callbackNode=o,a}return l!==null&&l!==null&&pm(l),s.callbackPriority=2,s.callbackNode=null,2}function l3(s,a){var o=s.callbackNode;if(od()&&s.callbackNode!==o)return null;var l=qt;return l=Rf(s,s===ln?l:0),l===0?null:(WD(s,l,a),c3(s,Ms()),s.callbackNode!=null&&s.callbackNode===o?l3.bind(null,s):null)}function u3(s,a){if(od())return null;WD(s,a,!0)}function X8(s){cB(function(){(Rn&6)!==0?gm(_m,s):s()})}function G1(){return Xl===0&&(Xl=et()),Xl}function f3(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:$f(""+s)}function d3(s,a){var o=a.ownerDocument.createElement("input");return o.name=a.name,o.value=a.value,s.id&&o.setAttribute("form",s.id),a.parentNode.insertBefore(o,a),s=new FormData(s),o.parentNode.removeChild(o),s}function Z8(s,a,o,l,h){if(a==="submit"&&o&&o.stateNode===h){var p=f3((h[Qr]||null).action),T=l.submitter;T&&(a=(a=T[Qr]||null)?f3(a.formAction):T.getAttribute("formAction"),a!==null&&(p=a,T=null));var M=new Ff("action","action",null,l,h);s.push({event:M,listeners:[{instance:null,listener:function(){if(l.defaultPrevented){if(Xl!==0){var B=T?d3(h,T):new FormData(h);t1(o,{pending:!0,data:B,method:h.method,action:p},null,B)}}else typeof p=="function"&&(M.preventDefault(),B=T?d3(h,T):new FormData(h),t1(o,{pending:!0,data:B,method:h.method,action:p},p,B))},currentTarget:h}]})}}for(var K1=0;K1<sO.length;K1++){var Q1=sO[K1],eB=Q1.toLowerCase(),tB=Q1[0].toUpperCase()+Q1.slice(1);Ua(eB,"on"+tB)}Ua(Zx,"onAnimationEnd"),Ua(eO,"onAnimationIteration"),Ua(tO,"onAnimationStart"),Ua("dblclick","onDoubleClick"),Ua("focusin","onFocus"),Ua("focusout","onBlur"),Ua(y8,"onTransitionRun"),Ua(b8,"onTransitionStart"),Ua(S8,"onTransitionCancel"),Ua(nO,"onTransitionEnd"),oc("onMouseEnter",["mouseout","mouseover"]),oc("onMouseLeave",["mouseout","mouseover"]),oc("onPointerEnter",["pointerout","pointerover"]),oc("onPointerLeave",["pointerout","pointerover"]),Ji("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ji("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ji("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ji("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ji("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ji("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var dg="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),nB=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(dg));function h3(s,a){a=(a&4)!==0;for(var o=0;o<s.length;o++){var l=s[o],h=l.event;l=l.listeners;e:{var p=void 0;if(a)for(var T=l.length-1;0<=T;T--){var M=l[T],B=M.instance,Z=M.currentTarget;if(M=M.listener,B!==p&&h.isPropagationStopped())break e;p=M,h.currentTarget=Z;try{p(h)}catch(ie){sb(ie)}h.currentTarget=null,p=B}else for(T=0;T<l.length;T++){if(M=l[T],B=M.instance,Z=M.currentTarget,M=M.listener,B!==p&&h.isPropagationStopped())break e;p=M,h.currentTarget=Z;try{p(h)}catch(ie){sb(ie)}h.currentTarget=null,p=B}}}}function Ot(s,a){var o=a[sc];o===void 0&&(o=a[sc]=new Set);var l=s+"__bubble";o.has(l)||(m3(a,s,2,!1),o.add(l))}function Y1(s,a,o){var l=0;a&&(l|=4),m3(o,s,l,a)}var bb="_reactListening"+Math.random().toString(36).slice(2);function W1(s){if(!s[bb]){s[bb]=!0,dy.forEach(function(o){o!=="selectionchange"&&(nB.has(o)||Y1(o,!1,s),Y1(o,!0,s))});var a=s.nodeType===9?s:s.ownerDocument;a===null||a[bb]||(a[bb]=!0,Y1("selectionchange",!1,a))}}function m3(s,a,o,l){switch(j3(a)){case 2:var h=RB;break;case 8:h=xB;break;default:h=lT}o=h.bind(null,a,o,s),h=void 0,!Cm||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(h=!0),l?h!==void 0?s.addEventListener(a,o,{capture:!0,passive:h}):s.addEventListener(a,o,!0):h!==void 0?s.addEventListener(a,o,{passive:h}):s.addEventListener(a,o,!1)}function J1(s,a,o,l,h){var p=l;if((a&1)===0&&(a&2)===0&&l!==null)e:for(;;){if(l===null)return;var T=l.tag;if(T===3||T===4){var M=l.stateNode.containerInfo;if(M===h||M.nodeType===8&&M.parentNode===h)break;if(T===4)for(T=l.return;T!==null;){var B=T.tag;if((B===3||B===4)&&(B=T.stateNode.containerInfo,B===h||B.nodeType===8&&B.parentNode===h))return;T=T.return}for(;M!==null;){if(T=Yr(M),T===null)return;if(B=T.tag,B===5||B===6||B===26||B===27){l=p=T;continue e}M=M.parentNode}}l=l.return}ky(function(){var Z=p,ie=Tm(o),de=[];e:{var re=rO.get(s);if(re!==void 0){var ae=Ff,Fe=s;switch(s){case"keypress":if(Mf(o)===0)break e;case"keydown":case"keyup":ae=hc;break;case"focusin":Fe="focus",ae=Om;break;case"focusout":Fe="blur",ae=Om;break;case"beforeblur":case"afterblur":ae=Om;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ae=Ry;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ae=hE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ae=xy;break;case Zx:case eO:case tO:ae=pE;break;case nO:ae=Oy;break;case"scroll":case"scrollend":ae=fE;break;case"wheel":ae=qy;break;case"copy":case"cut":case"paste":ae=yE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ae=Nm;break;case"toggle":case"beforetoggle":ae=hi}var lt=(a&4)!==0,Un=!lt&&(s==="scroll"||s==="scrollend"),ee=lt?re!==null?re+"Capture":null:re;lt=[];for(var X=Z,te;X!==null;){var le=X;if(te=le.stateNode,le=le.tag,le!==5&&le!==26&&le!==27||te===null||ee===null||(le=Ol(X,ee),le!=null&&lt.push(hg(X,le,te))),Un)break;X=X.return}0<lt.length&&(re=new ae(re,Fe,null,o,ie),de.push({event:re,listeners:lt}))}}if((a&7)===0){e:{if(re=s==="mouseover"||s==="pointerover",ae=s==="mouseout"||s==="pointerout",re&&o!==wt&&(Fe=o.relatedTarget||o.fromElement)&&(Yr(Fe)||Fe[rc]))break e;if((ae||re)&&(re=ie.window===ie?ie:(re=ie.ownerDocument)?re.defaultView||re.parentWindow:window,ae?(Fe=o.relatedTarget||o.toElement,ae=Z,Fe=Fe?Yr(Fe):null,Fe!==null&&(Un=Ee(Fe),lt=Fe.tag,Fe!==Un||lt!==5&&lt!==27&&lt!==6)&&(Fe=null)):(ae=null,Fe=Z),ae!==Fe)){if(lt=Ry,le="onMouseLeave",ee="onMouseEnter",X="mouse",(s==="pointerout"||s==="pointerover")&&(lt=Nm,le="onPointerLeave",ee="onPointerEnter",X="pointer"),Un=ae==null?re:Rl(ae),te=Fe==null?re:Rl(Fe),re=new lt(le,X+"leave",ae,o,ie),re.target=Un,re.relatedTarget=te,le=null,Yr(ie)===Z&&(lt=new lt(ee,X+"enter",Fe,o,ie),lt.target=te,lt.relatedTarget=Un,le=lt),Un=le,ae&&Fe)t:{for(lt=ae,ee=Fe,X=0,te=lt;te;te=ld(te))X++;for(te=0,le=ee;le;le=ld(le))te++;for(;0<X-te;)lt=ld(lt),X--;for(;0<te-X;)ee=ld(ee),te--;for(;X--;){if(lt===ee||ee!==null&&lt===ee.alternate)break t;lt=ld(lt),ee=ld(ee)}lt=null}else lt=null;ae!==null&&g3(de,re,ae,lt,!1),Fe!==null&&Un!==null&&g3(de,Un,Fe,lt,!0)}}e:{if(re=Z?Rl(Z):window,ae=re.nodeName&&re.nodeName.toLowerCase(),ae==="select"||ae==="input"&&re.type==="file")var Oe=Fm;else if(Mm(re))if(Lm)Oe=ce;else{Oe=G;var Et=U}else ae=re.nodeName,!ae||ae.toLowerCase()!=="input"||re.type!=="checkbox"&&re.type!=="radio"?Z&&Em(Z.elementType)&&(Oe=Fm):Oe=J;if(Oe&&(Oe=Oe(s,Z))){jm(de,Oe,o,ie);break e}Et&&Et(s,re,Z),s==="focusout"&&Z&&re.type==="number"&&Z.memoizedProps.value!=null&&Xi(re,"number",re.value)}switch(Et=Z?Rl(Z):window,s){case"focusin":(Mm(Et)||Et.contentEditable==="true")&&(xr=Et,eo=Z,Jr=null);break;case"focusout":Jr=eo=xr=null;break;case"mousedown":mi=!0;break;case"contextmenu":case"mouseup":case"dragend":mi=!1,or(de,o,ie);break;case"selectionchange":if(js)break;case"keydown":case"keyup":or(de,o,ie)}var Le;if($m)e:{switch(s){case"compositionstart":var Je="onCompositionStart";break e;case"compositionend":Je="onCompositionEnd";break e;case"compositionupdate":Je="onCompositionUpdate";break e}Je=void 0}else mc?Iy(s,o)&&(Je="onCompositionEnd"):s==="keydown"&&o.keyCode===229&&(Je="onCompositionStart");Je&&(Ny&&o.locale!=="ko"&&(mc||Je!=="onCompositionStart"?Je==="onCompositionEnd"&&mc&&(Le=Cy()):(di=ie,Am="value"in di?di.value:di.textContent,mc=!0)),Et=Sb(Z,Je),0<Et.length&&(Je=new Dm(Je,s,null,o,ie),de.push({event:Je,listeners:Et}),Le?Je.data=Le:(Le=My(o),Le!==null&&(Je.data=Le)))),(Le=xE?L(s,o):jy(s,o))&&(Je=Sb(Z,"onBeforeInput"),0<Je.length&&(Et=new Dm("onBeforeInput","beforeinput",null,o,ie),de.push({event:Et,listeners:Je}),Et.data=Le)),Z8(de,s,Z,o,ie)}h3(de,a)})}function hg(s,a,o){return{instance:s,listener:a,currentTarget:o}}function Sb(s,a){for(var o=a+"Capture",l=[];s!==null;){var h=s,p=h.stateNode;h=h.tag,h!==5&&h!==26&&h!==27||p===null||(h=Ol(s,o),h!=null&&l.unshift(hg(s,h,p)),h=Ol(s,a),h!=null&&l.push(hg(s,h,p))),s=s.return}return l}function ld(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function g3(s,a,o,l,h){for(var p=a._reactName,T=[];o!==null&&o!==l;){var M=o,B=M.alternate,Z=M.stateNode;if(M=M.tag,B!==null&&B===l)break;M!==5&&M!==26&&M!==27||Z===null||(B=Z,h?(Z=Ol(o,p),Z!=null&&T.unshift(hg(o,Z,B))):h||(Z=Ol(o,p),Z!=null&&T.push(hg(o,Z,B)))),o=o.return}T.length!==0&&s.push({event:a,listeners:T})}var rB=/\r\n?/g,sB=/\u0000|\uFFFD/g;function p3(s){return(typeof s=="string"?s:""+s).replace(rB,`
`).replace(sB,"")}function _3(s,a){return a=p3(a),p3(s)===a}function vb(){}function Jt(s,a,o,l,h,p){switch(o){case"children":typeof l=="string"?a==="body"||a==="textarea"&&l===""||lc(s,l):(typeof l=="number"||typeof l=="bigint")&&a!=="body"&&lc(s,""+l);break;case"className":Df(s,"class",l);break;case"tabIndex":Df(s,"tabindex",l);break;case"dir":case"role":case"viewBox":case"width":case"height":Df(s,o,l);break;case"style":Ey(s,l,p);break;case"data":if(a!=="object"){Df(s,"data",l);break}case"src":case"href":if(l===""&&(a!=="a"||o!=="href")){s.removeAttribute(o);break}if(l==null||typeof l=="function"||typeof l=="symbol"||typeof l=="boolean"){s.removeAttribute(o);break}l=$f(""+l),s.setAttribute(o,l);break;case"action":case"formAction":if(typeof l=="function"){s.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof p=="function"&&(o==="formAction"?(a!=="input"&&Jt(s,a,"name",h.name,h,null),Jt(s,a,"formEncType",h.formEncType,h,null),Jt(s,a,"formMethod",h.formMethod,h,null),Jt(s,a,"formTarget",h.formTarget,h,null)):(Jt(s,a,"encType",h.encType,h,null),Jt(s,a,"method",h.method,h,null),Jt(s,a,"target",h.target,h,null)));if(l==null||typeof l=="symbol"||typeof l=="boolean"){s.removeAttribute(o);break}l=$f(""+l),s.setAttribute(o,l);break;case"onClick":l!=null&&(s.onclick=vb);break;case"onScroll":l!=null&&Ot("scroll",s);break;case"onScrollEnd":l!=null&&Ot("scrollend",s);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(r(61));if(o=l.__html,o!=null){if(h.children!=null)throw Error(r(60));s.innerHTML=o}}break;case"multiple":s.multiple=l&&typeof l!="function"&&typeof l!="symbol";break;case"muted":s.muted=l&&typeof l!="function"&&typeof l!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(l==null||typeof l=="function"||typeof l=="boolean"||typeof l=="symbol"){s.removeAttribute("xlink:href");break}o=$f(""+l),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":l!=null&&typeof l!="function"&&typeof l!="symbol"?s.setAttribute(o,""+l):s.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":l&&typeof l!="function"&&typeof l!="symbol"?s.setAttribute(o,""):s.removeAttribute(o);break;case"capture":case"download":l===!0?s.setAttribute(o,""):l!==!1&&l!=null&&typeof l!="function"&&typeof l!="symbol"?s.setAttribute(o,l):s.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":l!=null&&typeof l!="function"&&typeof l!="symbol"&&!isNaN(l)&&1<=l?s.setAttribute(o,l):s.removeAttribute(o);break;case"rowSpan":case"start":l==null||typeof l=="function"||typeof l=="symbol"||isNaN(l)?s.removeAttribute(o):s.setAttribute(o,l);break;case"popover":Ot("beforetoggle",s),Ot("toggle",s),Of(s,"popover",l);break;case"xlinkActuate":La(s,"http://www.w3.org/1999/xlink","xlink:actuate",l);break;case"xlinkArcrole":La(s,"http://www.w3.org/1999/xlink","xlink:arcrole",l);break;case"xlinkRole":La(s,"http://www.w3.org/1999/xlink","xlink:role",l);break;case"xlinkShow":La(s,"http://www.w3.org/1999/xlink","xlink:show",l);break;case"xlinkTitle":La(s,"http://www.w3.org/1999/xlink","xlink:title",l);break;case"xlinkType":La(s,"http://www.w3.org/1999/xlink","xlink:type",l);break;case"xmlBase":La(s,"http://www.w3.org/XML/1998/namespace","xml:base",l);break;case"xmlLang":La(s,"http://www.w3.org/XML/1998/namespace","xml:lang",l);break;case"xmlSpace":La(s,"http://www.w3.org/XML/1998/namespace","xml:space",l);break;case"is":Of(s,"is",l);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=lE.get(o)||o,Of(s,o,l))}}function X1(s,a,o,l,h,p){switch(o){case"style":Ey(s,l,p);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(r(61));if(o=l.__html,o!=null){if(h.children!=null)throw Error(r(60));s.innerHTML=o}}break;case"children":typeof l=="string"?lc(s,l):(typeof l=="number"||typeof l=="bigint")&&lc(s,""+l);break;case"onScroll":l!=null&&Ot("scroll",s);break;case"onScrollEnd":l!=null&&Ot("scrollend",s);break;case"onClick":l!=null&&(s.onclick=vb);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!hy.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(h=o.endsWith("Capture"),a=o.slice(2,h?o.length-7:void 0),p=s[Qr]||null,p=p!=null?p[o]:null,typeof p=="function"&&s.removeEventListener(a,p,h),typeof l=="function")){typeof p!="function"&&p!==null&&(o in s?s[o]=null:s.hasAttribute(o)&&s.removeAttribute(o)),s.addEventListener(a,l,h);break e}o in s?s[o]=l:l===!0?s.setAttribute(o,""):Of(s,o,l)}}}function Fr(s,a,o){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ot("error",s),Ot("load",s);var l=!1,h=!1,p;for(p in o)if(o.hasOwnProperty(p)){var T=o[p];if(T!=null)switch(p){case"src":l=!0;break;case"srcSet":h=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,a));default:Jt(s,a,p,T,o,null)}}h&&Jt(s,a,"srcSet",o.srcSet,o,null),l&&Jt(s,a,"src",o.src,o,null);return;case"input":Ot("invalid",s);var M=p=T=h=null,B=null,Z=null;for(l in o)if(o.hasOwnProperty(l)){var ie=o[l];if(ie!=null)switch(l){case"name":h=ie;break;case"type":T=ie;break;case"checked":B=ie;break;case"defaultChecked":Z=ie;break;case"value":p=ie;break;case"defaultValue":M=ie;break;case"children":case"dangerouslySetInnerHTML":if(ie!=null)throw Error(r(137,a));break;default:Jt(s,a,l,ie,o,null)}}by(s,p,M,B,Z,T,h,!1),qf(s);return;case"select":Ot("invalid",s),l=T=p=null;for(h in o)if(o.hasOwnProperty(h)&&(M=o[h],M!=null))switch(h){case"value":p=M;break;case"defaultValue":T=M;break;case"multiple":l=M;default:Jt(s,a,h,M,o,null)}a=p,o=T,s.multiple=!!l,a!=null?cc(s,!!l,a,!1):o!=null&&cc(s,!!l,o,!0);return;case"textarea":Ot("invalid",s),p=h=l=null;for(T in o)if(o.hasOwnProperty(T)&&(M=o[T],M!=null))switch(T){case"value":l=M;break;case"defaultValue":h=M;break;case"children":p=M;break;case"dangerouslySetInnerHTML":if(M!=null)throw Error(r(91));break;default:Jt(s,a,T,M,o,null)}vy(s,l,h,p),qf(s);return;case"option":for(B in o)if(o.hasOwnProperty(B)&&(l=o[B],l!=null))switch(B){case"selected":s.selected=l&&typeof l!="function"&&typeof l!="symbol";break;default:Jt(s,a,B,l,o,null)}return;case"dialog":Ot("cancel",s),Ot("close",s);break;case"iframe":case"object":Ot("load",s);break;case"video":case"audio":for(l=0;l<dg.length;l++)Ot(dg[l],s);break;case"image":Ot("error",s),Ot("load",s);break;case"details":Ot("toggle",s);break;case"embed":case"source":case"link":Ot("error",s),Ot("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Z in o)if(o.hasOwnProperty(Z)&&(l=o[Z],l!=null))switch(Z){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,a));default:Jt(s,a,Z,l,o,null)}return;default:if(Em(a)){for(ie in o)o.hasOwnProperty(ie)&&(l=o[ie],l!==void 0&&X1(s,a,ie,l,o,void 0));return}}for(M in o)o.hasOwnProperty(M)&&(l=o[M],l!=null&&Jt(s,a,M,l,o,null))}function aB(s,a,o,l){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var h=null,p=null,T=null,M=null,B=null,Z=null,ie=null;for(ae in o){var de=o[ae];if(o.hasOwnProperty(ae)&&de!=null)switch(ae){case"checked":break;case"value":break;case"defaultValue":B=de;default:l.hasOwnProperty(ae)||Jt(s,a,ae,null,l,de)}}for(var re in l){var ae=l[re];if(de=o[re],l.hasOwnProperty(re)&&(ae!=null||de!=null))switch(re){case"type":p=ae;break;case"name":h=ae;break;case"checked":Z=ae;break;case"defaultChecked":ie=ae;break;case"value":T=ae;break;case"defaultValue":M=ae;break;case"children":case"dangerouslySetInnerHTML":if(ae!=null)throw Error(r(137,a));break;default:ae!==de&&Jt(s,a,re,ae,l,de)}}xl(s,T,M,B,Z,ie,p,h);return;case"select":ae=T=M=re=null;for(p in o)if(B=o[p],o.hasOwnProperty(p)&&B!=null)switch(p){case"value":break;case"multiple":ae=B;default:l.hasOwnProperty(p)||Jt(s,a,p,null,l,B)}for(h in l)if(p=l[h],B=o[h],l.hasOwnProperty(h)&&(p!=null||B!=null))switch(h){case"value":re=p;break;case"defaultValue":M=p;break;case"multiple":T=p;default:p!==B&&Jt(s,a,h,p,l,B)}a=M,o=T,l=ae,re!=null?cc(s,!!o,re,!1):!!l!=!!o&&(a!=null?cc(s,!!o,a,!0):cc(s,!!o,o?[]:"",!1));return;case"textarea":ae=re=null;for(M in o)if(h=o[M],o.hasOwnProperty(M)&&h!=null&&!l.hasOwnProperty(M))switch(M){case"value":break;case"children":break;default:Jt(s,a,M,null,l,h)}for(T in l)if(h=l[T],p=o[T],l.hasOwnProperty(T)&&(h!=null||p!=null))switch(T){case"value":re=h;break;case"defaultValue":ae=h;break;case"children":break;case"dangerouslySetInnerHTML":if(h!=null)throw Error(r(91));break;default:h!==p&&Jt(s,a,T,h,l,p)}Sy(s,re,ae);return;case"option":for(var Fe in o)if(re=o[Fe],o.hasOwnProperty(Fe)&&re!=null&&!l.hasOwnProperty(Fe))switch(Fe){case"selected":s.selected=!1;break;default:Jt(s,a,Fe,null,l,re)}for(B in l)if(re=l[B],ae=o[B],l.hasOwnProperty(B)&&re!==ae&&(re!=null||ae!=null))switch(B){case"selected":s.selected=re&&typeof re!="function"&&typeof re!="symbol";break;default:Jt(s,a,B,re,l,ae)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var lt in o)re=o[lt],o.hasOwnProperty(lt)&&re!=null&&!l.hasOwnProperty(lt)&&Jt(s,a,lt,null,l,re);for(Z in l)if(re=l[Z],ae=o[Z],l.hasOwnProperty(Z)&&re!==ae&&(re!=null||ae!=null))switch(Z){case"children":case"dangerouslySetInnerHTML":if(re!=null)throw Error(r(137,a));break;default:Jt(s,a,Z,re,l,ae)}return;default:if(Em(a)){for(var Un in o)re=o[Un],o.hasOwnProperty(Un)&&re!==void 0&&!l.hasOwnProperty(Un)&&X1(s,a,Un,void 0,l,re);for(ie in l)re=l[ie],ae=o[ie],!l.hasOwnProperty(ie)||re===ae||re===void 0&&ae===void 0||X1(s,a,ie,re,l,ae);return}}for(var ee in o)re=o[ee],o.hasOwnProperty(ee)&&re!=null&&!l.hasOwnProperty(ee)&&Jt(s,a,ee,null,l,re);for(de in l)re=l[de],ae=o[de],!l.hasOwnProperty(de)||re===ae||re==null&&ae==null||Jt(s,a,de,re,l,ae)}var Z1=null,eT=null;function wb(s){return s.nodeType===9?s:s.ownerDocument}function y3(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function b3(s,a){if(s===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&a==="foreignObject"?0:s}function tT(s,a){return s==="textarea"||s==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var nT=null;function iB(){var s=window.event;return s&&s.type==="popstate"?s===nT?!1:(nT=s,!0):(nT=null,!1)}var S3=typeof setTimeout=="function"?setTimeout:void 0,oB=typeof clearTimeout=="function"?clearTimeout:void 0,v3=typeof Promise=="function"?Promise:void 0,cB=typeof queueMicrotask=="function"?queueMicrotask:typeof v3<"u"?function(s){return v3.resolve(null).then(s).catch(lB)}:S3;function lB(s){setTimeout(function(){throw s})}function rT(s,a){var o=a,l=0;do{var h=o.nextSibling;if(s.removeChild(o),h&&h.nodeType===8)if(o=h.data,o==="/$"){if(l===0){s.removeChild(h),vg(a);return}l--}else o!=="$"&&o!=="$?"&&o!=="$!"||l++;o=h}while(o);vg(a)}function sT(s){var a=s.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var o=a;switch(a=a.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":sT(o),wm(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}s.removeChild(o)}}function uB(s,a,o,l){for(;s.nodeType===1;){var h=o;if(s.nodeName.toLowerCase()!==a.toLowerCase()){if(!l&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(l){if(!s[ja])switch(a){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(p=s.getAttribute("rel"),p==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(p!==h.rel||s.getAttribute("href")!==(h.href==null?null:h.href)||s.getAttribute("crossorigin")!==(h.crossOrigin==null?null:h.crossOrigin)||s.getAttribute("title")!==(h.title==null?null:h.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(p=s.getAttribute("src"),(p!==(h.src==null?null:h.src)||s.getAttribute("type")!==(h.type==null?null:h.type)||s.getAttribute("crossorigin")!==(h.crossOrigin==null?null:h.crossOrigin))&&p&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(a==="input"&&s.type==="hidden"){var p=h.name==null?null:""+h.name;if(h.type==="hidden"&&s.getAttribute("name")===p)return s}else return s;if(s=Ha(s.nextSibling),s===null)break}return null}function fB(s,a,o){if(a==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!o||(s=Ha(s.nextSibling),s===null))return null;return s}function Ha(s){for(;s!=null;s=s.nextSibling){var a=s.nodeType;if(a===1||a===3)break;if(a===8){if(a=s.data,a==="$"||a==="$!"||a==="$?"||a==="F!"||a==="F")break;if(a==="/$")return null}}return s}function w3(s){s=s.previousSibling;for(var a=0;s;){if(s.nodeType===8){var o=s.data;if(o==="$"||o==="$!"||o==="$?"){if(a===0)return s;a--}else o==="/$"&&a++}s=s.previousSibling}return null}function E3(s,a,o){switch(a=wb(o),s){case"html":if(s=a.documentElement,!s)throw Error(r(452));return s;case"head":if(s=a.head,!s)throw Error(r(453));return s;case"body":if(s=a.body,!s)throw Error(r(454));return s;default:throw Error(r(451))}}var da=new Map,T3=new Set;function Eb(s){return typeof s.getRootNode=="function"?s.getRootNode():s.ownerDocument}var po=be.d;be.d={f:dB,r:hB,D:mB,C:gB,L:pB,m:_B,X:bB,S:yB,M:SB};function dB(){var s=po.f(),a=gb();return s||a}function hB(s){var a=ac(s);a!==null&&a.tag===5&&a.type==="form"?JO(a):po.r(s)}var ud=typeof document>"u"?null:document;function k3(s,a,o){var l=ud;if(l&&typeof a=="string"&&a){var h=Rs(a);h='link[rel="'+s+'"][href="'+h+'"]',typeof o=="string"&&(h+='[crossorigin="'+o+'"]'),T3.has(h)||(T3.add(h),s={rel:s,crossOrigin:o,href:a},l.querySelector(h)===null&&(a=l.createElement("link"),Fr(a,"link",s),ir(a),l.head.appendChild(a)))}}function mB(s){po.D(s),k3("dns-prefetch",s,null)}function gB(s,a){po.C(s,a),k3("preconnect",s,a)}function pB(s,a,o){po.L(s,a,o);var l=ud;if(l&&s&&a){var h='link[rel="preload"][as="'+Rs(a)+'"]';a==="image"&&o&&o.imageSrcSet?(h+='[imagesrcset="'+Rs(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(h+='[imagesizes="'+Rs(o.imageSizes)+'"]')):h+='[href="'+Rs(s)+'"]';var p=h;switch(a){case"style":p=fd(s);break;case"script":p=dd(s)}da.has(p)||(s=P({rel:"preload",href:a==="image"&&o&&o.imageSrcSet?void 0:s,as:a},o),da.set(p,s),l.querySelector(h)!==null||a==="style"&&l.querySelector(mg(p))||a==="script"&&l.querySelector(gg(p))||(a=l.createElement("link"),Fr(a,"link",s),ir(a),l.head.appendChild(a)))}}function _B(s,a){po.m(s,a);var o=ud;if(o&&s){var l=a&&typeof a.as=="string"?a.as:"script",h='link[rel="modulepreload"][as="'+Rs(l)+'"][href="'+Rs(s)+'"]',p=h;switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":p=dd(s)}if(!da.has(p)&&(s=P({rel:"modulepreload",href:s},a),da.set(p,s),o.querySelector(h)===null)){switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(gg(p)))return}l=o.createElement("link"),Fr(l,"link",s),ir(l),o.head.appendChild(l)}}}function yB(s,a,o){po.S(s,a,o);var l=ud;if(l&&s){var h=ic(l).hoistableStyles,p=fd(s);a=a||"default";var T=h.get(p);if(!T){var M={loading:0,preload:null};if(T=l.querySelector(mg(p)))M.loading=5;else{s=P({rel:"stylesheet",href:s,"data-precedence":a},o),(o=da.get(p))&&aT(s,o);var B=T=l.createElement("link");ir(B),Fr(B,"link",s),B._p=new Promise(function(Z,ie){B.onload=Z,B.onerror=ie}),B.addEventListener("load",function(){M.loading|=1}),B.addEventListener("error",function(){M.loading|=2}),M.loading|=4,Tb(T,a,l)}T={type:"stylesheet",instance:T,count:1,state:M},h.set(p,T)}}}function bB(s,a){po.X(s,a);var o=ud;if(o&&s){var l=ic(o).hoistableScripts,h=dd(s),p=l.get(h);p||(p=o.querySelector(gg(h)),p||(s=P({src:s,async:!0},a),(a=da.get(h))&&iT(s,a),p=o.createElement("script"),ir(p),Fr(p,"link",s),o.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},l.set(h,p))}}function SB(s,a){po.M(s,a);var o=ud;if(o&&s){var l=ic(o).hoistableScripts,h=dd(s),p=l.get(h);p||(p=o.querySelector(gg(h)),p||(s=P({src:s,async:!0,type:"module"},a),(a=da.get(h))&&iT(s,a),p=o.createElement("script"),ir(p),Fr(p,"link",s),o.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},l.set(h,p))}}function C3(s,a,o,l){var h=(h=Ia.current)?Eb(h):null;if(!h)throw Error(r(446));switch(s){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(a=fd(o.href),o=ic(h).hoistableStyles,l=o.get(a),l||(l={type:"style",instance:null,count:0,state:null},o.set(a,l)),l):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){s=fd(o.href);var p=ic(h).hoistableStyles,T=p.get(s);if(T||(h=h.ownerDocument||h,T={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},p.set(s,T),(p=h.querySelector(mg(s)))&&!p._p&&(T.instance=p,T.state.loading=5),da.has(s)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},da.set(s,o),p||vB(h,s,o,T.state))),a&&l===null)throw Error(r(528,""));return T}if(a&&l!==null)throw Error(r(529,""));return null;case"script":return a=o.async,o=o.src,typeof o=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=dd(o),o=ic(h).hoistableScripts,l=o.get(a),l||(l={type:"script",instance:null,count:0,state:null},o.set(a,l)),l):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,s))}}function fd(s){return'href="'+Rs(s)+'"'}function mg(s){return'link[rel="stylesheet"]['+s+"]"}function A3(s){return P({},s,{"data-precedence":s.precedence,precedence:null})}function vB(s,a,o,l){s.querySelector('link[rel="preload"][as="style"]['+a+"]")?l.loading=1:(a=s.createElement("link"),l.preload=a,a.addEventListener("load",function(){return l.loading|=1}),a.addEventListener("error",function(){return l.loading|=2}),Fr(a,"link",o),ir(a),s.head.appendChild(a))}function dd(s){return'[src="'+Rs(s)+'"]'}function gg(s){return"script[async]"+s}function R3(s,a,o){if(a.count++,a.instance===null)switch(a.type){case"style":var l=s.querySelector('style[data-href~="'+Rs(o.href)+'"]');if(l)return a.instance=l,ir(l),l;var h=P({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return l=(s.ownerDocument||s).createElement("style"),ir(l),Fr(l,"style",h),Tb(l,o.precedence,s),a.instance=l;case"stylesheet":h=fd(o.href);var p=s.querySelector(mg(h));if(p)return a.state.loading|=4,a.instance=p,ir(p),p;l=A3(o),(h=da.get(h))&&aT(l,h),p=(s.ownerDocument||s).createElement("link"),ir(p);var T=p;return T._p=new Promise(function(M,B){T.onload=M,T.onerror=B}),Fr(p,"link",l),a.state.loading|=4,Tb(p,o.precedence,s),a.instance=p;case"script":return p=dd(o.src),(h=s.querySelector(gg(p)))?(a.instance=h,ir(h),h):(l=o,(h=da.get(p))&&(l=P({},o),iT(l,h)),s=s.ownerDocument||s,h=s.createElement("script"),ir(h),Fr(h,"link",l),s.head.appendChild(h),a.instance=h);case"void":return null;default:throw Error(r(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(l=a.instance,a.state.loading|=4,Tb(l,o.precedence,s));return a.instance}function Tb(s,a,o){for(var l=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),h=l.length?l[l.length-1]:null,p=h,T=0;T<l.length;T++){var M=l[T];if(M.dataset.precedence===a)p=M;else if(p!==h)break}p?p.parentNode.insertBefore(s,p.nextSibling):(a=o.nodeType===9?o.head:o,a.insertBefore(s,a.firstChild))}function aT(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.title==null&&(s.title=a.title)}function iT(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.integrity==null&&(s.integrity=a.integrity)}var kb=null;function x3(s,a,o){if(kb===null){var l=new Map,h=kb=new Map;h.set(o,l)}else h=kb,l=h.get(o),l||(l=new Map,h.set(o,l));if(l.has(s))return l;for(l.set(s,null),o=o.getElementsByTagName(s),h=0;h<o.length;h++){var p=o[h];if(!(p[ja]||p[Ar]||s==="link"&&p.getAttribute("rel")==="stylesheet")&&p.namespaceURI!=="http://www.w3.org/2000/svg"){var T=p.getAttribute(a)||"";T=s+T;var M=l.get(T);M?M.push(p):l.set(T,[p])}}return l}function O3(s,a,o){s=s.ownerDocument||s,s.head.insertBefore(o,a==="title"?s.querySelector("head > title"):null)}function wB(s,a,o){if(o===1||a.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return s=a.disabled,typeof a.precedence=="string"&&s==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function D3(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var pg=null;function EB(){}function TB(s,a,o){if(pg===null)throw Error(r(475));var l=pg;if(a.type==="stylesheet"&&(typeof o.media!="string"||matchMedia(o.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var h=fd(o.href),p=s.querySelector(mg(h));if(p){s=p._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(l.count++,l=Cb.bind(l),s.then(l,l)),a.state.loading|=4,a.instance=p,ir(p);return}p=s.ownerDocument||s,o=A3(o),(h=da.get(h))&&aT(o,h),p=p.createElement("link"),ir(p);var T=p;T._p=new Promise(function(M,B){T.onload=M,T.onerror=B}),Fr(p,"link",o),a.instance=p}l.stylesheets===null&&(l.stylesheets=new Map),l.stylesheets.set(a,s),(s=a.state.preload)&&(a.state.loading&3)===0&&(l.count++,a=Cb.bind(l),s.addEventListener("load",a),s.addEventListener("error",a))}}function kB(){if(pg===null)throw Error(r(475));var s=pg;return s.stylesheets&&s.count===0&&oT(s,s.stylesheets),0<s.count?function(a){var o=setTimeout(function(){if(s.stylesheets&&oT(s,s.stylesheets),s.unsuspend){var l=s.unsuspend;s.unsuspend=null,l()}},6e4);return s.unsuspend=a,function(){s.unsuspend=null,clearTimeout(o)}}:null}function Cb(){if(this.count--,this.count===0){if(this.stylesheets)oT(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Ab=null;function oT(s,a){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Ab=new Map,a.forEach(CB,s),Ab=null,Cb.call(s))}function CB(s,a){if(!(a.state.loading&4)){var o=Ab.get(s);if(o)var l=o.get(null);else{o=new Map,Ab.set(s,o);for(var h=s.querySelectorAll("link[data-precedence],style[data-precedence]"),p=0;p<h.length;p++){var T=h[p];(T.nodeName==="LINK"||T.getAttribute("media")!=="not all")&&(o.set(T.dataset.precedence,T),l=T)}l&&o.set(null,l)}h=a.instance,T=h.getAttribute("data-precedence"),p=o.get(T)||l,p===l&&o.set(null,h),o.set(T,h),this.count++,l=Cb.bind(this),h.addEventListener("load",l),h.addEventListener("error",l),p?p.parentNode.insertBefore(h,p.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(h,s.firstChild)),a.state.loading|=4}}var _g={$$typeof:k,Provider:null,Consumer:null,_currentValue:ct,_currentValue2:ct,_threadCount:0};function AB(s,a,o,l,h,p,T,M){this.tag=1,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=vm(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vm(0),this.hiddenUpdates=vm(null),this.identifierPrefix=l,this.onUncaughtError=h,this.onCaughtError=p,this.onRecoverableError=T,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=M,this.incompleteTransitions=new Map}function q3(s,a,o,l,h,p,T,M,B,Z,ie,de){return s=new AB(s,a,o,T,M,B,Z,de),a=1,p===!0&&(a|=24),p=ua(3,null,null,a),s.current=p,p.stateNode=s,a=LE(),a.refCount++,s.pooledCache=a,a.refCount++,p.memoizedState={element:l,isDehydrated:o,cache:a},b1(p),s}function N3(s){return s?(s=Bf,s):Bf}function $3(s,a,o,l,h,p){h=N3(h),l.context===null?l.context=h:l.pendingContext=h,l=Tc(a),l.payload={element:o},p=p===void 0?null:p,p!==null&&(l.callback=p),o=kc(s,l,a),o!==null&&(fs(o,s,a),eg(o,s,a))}function I3(s,a){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var o=s.retryLane;s.retryLane=o!==0&&o<a?o:a}}function cT(s,a){I3(s,a),(s=s.alternate)&&I3(s,a)}function M3(s){if(s.tag===13){var a=_c(s,67108864);a!==null&&fs(a,s,67108864),cT(s,67108864)}}var Rb=!0;function RB(s,a,o,l){var h=Y.T;Y.T=null;var p=be.p;try{be.p=2,lT(s,a,o,l)}finally{be.p=p,Y.T=h}}function xB(s,a,o,l){var h=Y.T;Y.T=null;var p=be.p;try{be.p=8,lT(s,a,o,l)}finally{be.p=p,Y.T=h}}function lT(s,a,o,l){if(Rb){var h=uT(l);if(h===null)J1(s,a,l,xb,o),F3(s,l);else if(DB(h,s,a,o,l))l.stopPropagation();else if(F3(s,l),a&4&&-1<OB.indexOf(s)){for(;h!==null;){var p=ac(h);if(p!==null)switch(p.tag){case 3:if(p=p.stateNode,p.current.memoizedState.isDehydrated){var T=cs(p.pendingLanes);if(T!==0){var M=p;for(M.pendingLanes|=2,M.entangledLanes|=2;T;){var B=1<<31-jn(T);M.entanglements[1]|=B,T&=~B}bi(p),(Rn&6)===0&&(db=Ms()+500,fg(0))}}break;case 13:M=_c(p,2),M!==null&&fs(M,p,2),gb(),cT(p,2)}if(p=uT(l),p===null&&J1(s,a,l,xb,o),p===h)break;h=p}h!==null&&l.stopPropagation()}else J1(s,a,l,null,o)}}function uT(s){return s=Tm(s),fT(s)}var xb=null;function fT(s){if(xb=null,s=Yr(s),s!==null){var a=Ee(s);if(a===null)s=null;else{var o=a.tag;if(o===13){if(s=pt(a),s!==null)return s;s=null}else if(o===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;s=null}else a!==s&&(s=null)}}return xb=s,null}function j3(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(kf()){case _m:return 2;case Yi:return 8;case Cf:case eE:return 32;case ym:return 268435456;default:return 32}default:return 32}}var dT=!1,qc=null,Nc=null,$c=null,yg=new Map,bg=new Map,Ic=[],OB="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function F3(s,a){switch(s){case"focusin":case"focusout":qc=null;break;case"dragenter":case"dragleave":Nc=null;break;case"mouseover":case"mouseout":$c=null;break;case"pointerover":case"pointerout":yg.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":bg.delete(a.pointerId)}}function Sg(s,a,o,l,h,p){return s===null||s.nativeEvent!==p?(s={blockedOn:a,domEventName:o,eventSystemFlags:l,nativeEvent:p,targetContainers:[h]},a!==null&&(a=ac(a),a!==null&&M3(a)),s):(s.eventSystemFlags|=l,a=s.targetContainers,h!==null&&a.indexOf(h)===-1&&a.push(h),s)}function DB(s,a,o,l,h){switch(a){case"focusin":return qc=Sg(qc,s,a,o,l,h),!0;case"dragenter":return Nc=Sg(Nc,s,a,o,l,h),!0;case"mouseover":return $c=Sg($c,s,a,o,l,h),!0;case"pointerover":var p=h.pointerId;return yg.set(p,Sg(yg.get(p)||null,s,a,o,l,h)),!0;case"gotpointercapture":return p=h.pointerId,bg.set(p,Sg(bg.get(p)||null,s,a,o,l,h)),!0}return!1}function L3(s){var a=Yr(s.target);if(a!==null){var o=Ee(a);if(o!==null){if(a=o.tag,a===13){if(a=pt(o),a!==null){s.blockedOn=a,bt(s.priority,function(){if(o.tag===13){var l=zs(),h=_c(o,l);h!==null&&fs(h,o,l),cT(o,l)}});return}}else if(a===3&&o.stateNode.current.memoizedState.isDehydrated){s.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Ob(s){if(s.blockedOn!==null)return!1;for(var a=s.targetContainers;0<a.length;){var o=uT(s.nativeEvent);if(o===null){o=s.nativeEvent;var l=new o.constructor(o.type,o);wt=l,o.target.dispatchEvent(l),wt=null}else return a=ac(o),a!==null&&M3(a),s.blockedOn=o,!1;a.shift()}return!0}function U3(s,a,o){Ob(s)&&o.delete(a)}function qB(){dT=!1,qc!==null&&Ob(qc)&&(qc=null),Nc!==null&&Ob(Nc)&&(Nc=null),$c!==null&&Ob($c)&&($c=null),yg.forEach(U3),bg.forEach(U3)}function Db(s,a){s.blockedOn===a&&(s.blockedOn=null,dT||(dT=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,qB)))}var qb=null;function z3(s){qb!==s&&(qb=s,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){qb===s&&(qb=null);for(var a=0;a<s.length;a+=3){var o=s[a],l=s[a+1],h=s[a+2];if(typeof l!="function"){if(fT(l||o)===null)continue;break}var p=ac(o);p!==null&&(s.splice(a,3),a-=3,t1(p,{pending:!0,data:h,method:o.method,action:l},l,h))}}))}function vg(s){function a(B){return Db(B,s)}qc!==null&&Db(qc,s),Nc!==null&&Db(Nc,s),$c!==null&&Db($c,s),yg.forEach(a),bg.forEach(a);for(var o=0;o<Ic.length;o++){var l=Ic[o];l.blockedOn===s&&(l.blockedOn=null)}for(;0<Ic.length&&(o=Ic[0],o.blockedOn===null);)L3(o),o.blockedOn===null&&Ic.shift();if(o=(s.ownerDocument||s).$$reactFormReplay,o!=null)for(l=0;l<o.length;l+=3){var h=o[l],p=o[l+1],T=h[Qr]||null;if(typeof p=="function")T||z3(o);else if(T){var M=null;if(p&&p.hasAttribute("formAction")){if(h=p,T=p[Qr]||null)M=T.formAction;else if(fT(h)!==null)continue}else M=T.action;typeof M=="function"?o[l+1]=M:(o.splice(l,3),l-=3),z3(o)}}}function hT(s){this._internalRoot=s}Nb.prototype.render=hT.prototype.render=function(s){var a=this._internalRoot;if(a===null)throw Error(r(409));var o=a.current,l=zs();$3(o,l,s,a,null,null)},Nb.prototype.unmount=hT.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var a=s.containerInfo;s.tag===0&&od(),$3(s.current,2,null,s,null,null),gb(),a[rc]=null}};function Nb(s){this._internalRoot=s}Nb.prototype.unstable_scheduleHydration=function(s){if(s){var a=A();s={blockedOn:null,target:s,priority:a};for(var o=0;o<Ic.length&&a!==0&&a<Ic[o].priority;o++);Ic.splice(o,0,s),o===0&&L3(s)}};var P3=t.version;if(P3!=="19.0.0")throw Error(r(527,P3,"19.0.0"));be.findDOMNode=function(s){var a=s._reactInternals;if(a===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=ue(a),s=s!==null?Be(s):null,s=s===null?null:s.stateNode,s};var NB={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:Y,findFiberByHostInstance:Yr,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var $b=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$b.isDisabled&&$b.supportsFiber)try{Cl=$b.inject(NB),mt=$b}catch{}}return Eg.createRoot=function(s,a){if(!i(s))throw Error(r(299));var o=!1,l="",h=aD,p=iD,T=oD,M=null;return a!=null&&(a.unstable_strictMode===!0&&(o=!0),a.identifierPrefix!==void 0&&(l=a.identifierPrefix),a.onUncaughtError!==void 0&&(h=a.onUncaughtError),a.onCaughtError!==void 0&&(p=a.onCaughtError),a.onRecoverableError!==void 0&&(T=a.onRecoverableError),a.unstable_transitionCallbacks!==void 0&&(M=a.unstable_transitionCallbacks)),a=q3(s,1,!1,null,null,o,l,h,p,T,M,null),s[rc]=a.current,W1(s.nodeType===8?s.parentNode:s),new hT(a)},Eg.hydrateRoot=function(s,a,o){if(!i(s))throw Error(r(299));var l=!1,h="",p=aD,T=iD,M=oD,B=null,Z=null;return o!=null&&(o.unstable_strictMode===!0&&(l=!0),o.identifierPrefix!==void 0&&(h=o.identifierPrefix),o.onUncaughtError!==void 0&&(p=o.onUncaughtError),o.onCaughtError!==void 0&&(T=o.onCaughtError),o.onRecoverableError!==void 0&&(M=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(B=o.unstable_transitionCallbacks),o.formState!==void 0&&(Z=o.formState)),a=q3(s,1,!0,a,o??null,l,h,p,T,M,B,Z),a.context=N3(null),o=a.current,l=zs(),h=Tc(l),h.callback=null,kc(o,h,l),a.current.lanes=l,Al(a,l),bi(a),s[rc]=a.current,W1(s),new Nb(a)},Eg.version="19.0.0",Eg}var Z3;function BB(){if(Z3)return pT.exports;Z3=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),pT.exports=HB(),pT.exports}var VB=BB();const GB=$j(VB),KB=e=>typeof e=="function",D=function(e,t){if(typeof e=="function")return function(){return e(arguments)?t.apply(this,arguments):n=>t(n,...arguments)};switch(e){case 0:case 1:throw new RangeError(`Invalid arity ${e}`);case 2:return function(n,r){return arguments.length>=2?t(n,r):function(i){return t(i,n)}};case 3:return function(n,r,i){return arguments.length>=3?t(n,r,i):function(c){return t(c,n,r)}};case 4:return function(n,r,i,c){return arguments.length>=4?t(n,r,i,c):function(f){return t(f,n,r,i)}};case 5:return function(n,r,i,c,f){return arguments.length>=5?t(n,r,i,c,f):function(m){return t(m,n,r,i,c)}};default:return function(){if(arguments.length>=e)return t.apply(this,arguments);const n=arguments;return function(r){return t(r,...n)}}}},Ie=e=>e,e0=e=>()=>e,eq=e0(!0),Ni=e0(!1),Mj=e0(void 0),_p=Mj;function j(e,t,n,r,i,c,f,m,g){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return n(t(e));case 4:return r(n(t(e)));case 5:return i(r(n(t(e))));case 6:return c(i(r(n(t(e)))));case 7:return f(c(i(r(n(t(e))))));case 8:return m(f(c(i(r(n(t(e)))))));case 9:return g(m(f(c(i(r(n(t(e))))))));default:{let b=arguments[0];for(let S=1;S<arguments.length;S++)b=arguments[S](b);return b}}}const Jc=e=>(t,n)=>t===n||e(t,n),QB=(e,t)=>e===t,YB=()=>QB,WB=YB(),jj=D(2,(e,t)=>Jc((n,r)=>e(t(n),t(r)))),JB=jj(WB,e=>e.getTime()),XB=e=>Jc((t,n)=>{if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(!e(t[r],n[r]))return!1;return!0});let ZB="3.15.2";const t0=()=>ZB,Ib=`effect/GlobalValue/globalStoreId/${t0()}`;let Tg;const St=(e,t)=>(Tg||(globalThis[Ib]??(globalThis[Ib]=new Map),Tg=globalThis[Ib]),Tg.has(e)||Tg.set(e,t()),Tg.get(e)),e7=e=>e instanceof Set,Es=e=>typeof e=="string",Mo=e=>typeof e=="number",Ru=e=>typeof e=="boolean",n0=e=>typeof e=="bigint",kS=e=>typeof e=="symbol",Ah=KB,t7=e=>e===void 0,n7=e=>!1,r0=e=>typeof e=="object"&&e!==null,Hi=e=>r0(e)||Ah(e),Ae=D(2,(e,t)=>Hi(e)&&t in e),mA=D(2,(e,t)=>Ae(e,"_tag")&&e._tag===t),hd=e=>e==null,r7=e=>e!=null,s7=e=>e instanceof Uint8Array,Fj=e=>e instanceof Date,gA=e=>Ae(e,Symbol.iterator),a7=e=>r0(e)&&!Array.isArray(e),Lj=e=>Ae(e,"then")&&Ah(e.then),s0=e=>`BUG: ${e} - please report an issue at https://github.com/Effect-TS/effect/issues`;let Uj=class zj{constructor(t){y(this,"self");y(this,"called",!1);this.self=t}next(t){return this.called?{value:t,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(t){return{value:t,done:!0}}throw(t){throw t}[Symbol.iterator](){return new zj(this.self)}};const i7=335903614,o7=4150755663,c7=1481765933,l7=1284865837,u7=9007199254740992,f7=134217728;class d7{constructor(t,n,r,i){y(this,"_state");return hd(n)&&hd(t)?(n=Math.random()*4294967295>>>0,t=0):hd(n)&&(n=t,t=0),hd(i)&&hd(r)?(i=this._state?this._state[3]:o7,r=this._state?this._state[2]:i7):hd(i)&&(i=r,r=0),this._state=new Int32Array([0,0,r>>>0,((i||0)|1)>>>0]),this._next(),tq(this._state,this._state[0],this._state[1],t>>>0,n>>>0),this._next(),this}getState(){return[this._state[0],this._state[1],this._state[2],this._state[3]]}setState(t){this._state[0]=t[0],this._state[1]=t[1],this._state[2]=t[2],this._state[3]=t[3]|1}integer(t){return Math.round(this.number()*Number.MAX_SAFE_INTEGER)%t}number(){const t=(this._next()&67108863)*1,n=(this._next()&134217727)*1;return(t*f7+n)/u7}_next(){const t=this._state[0]>>>0,n=this._state[1]>>>0;h7(this._state,t,n,c7,l7),tq(this._state,this._state[0],this._state[1],this._state[2],this._state[3]);let r=t>>>18,i=(n>>>18|t<<14)>>>0;r=(r^t)>>>0,i=(i^n)>>>0;const c=(i>>>27|r<<5)>>>0,f=t>>>27,m=(-f>>>0&31)>>>0;return(c>>>f|c<<m)>>>0}}function h7(e,t,n,r,i){let c=(n>>>16)*(i&65535)>>>0,f=(n&65535)*(i>>>16)>>>0,m=(n&65535)*(i&65535)>>>0,g=(n>>>16)*(i>>>16)+((f>>>16)+(c>>>16))>>>0;f=f<<16>>>0,m=m+f>>>0,m>>>0<f>>>0&&(g=g+1>>>0),c=c<<16>>>0,m=m+c>>>0,m>>>0<c>>>0&&(g=g+1>>>0),g=g+Math.imul(n,r)>>>0,g=g+Math.imul(t,i)>>>0,e[0]=g,e[1]=m}function tq(e,t,n,r,i){let c=t+r>>>0;const f=n+i>>>0;f>>>0<n>>>0&&(c=c+1|0),e[0]=c,e[1]=f}const lk=Symbol.for("effect/Utils/YieldWrap");var a_;class Rh{constructor(t){br(this,a_);Zl(this,a_,t)}[lk](){return Ce(this,a_)}}a_=new WeakMap;function Pj(e){if(typeof e=="object"&&e!==null&&lk in e)return e[lk]();throw new Error(s0("yieldWrapGet"))}const ma=St("effect/Utils/isStructuralRegion",()=>({enabled:!1,tester:void 0})),Hj={effect_internal_function:e=>e()},m7={effect_internal_function:e=>{try{return e()}finally{}}};var zI;const g7=((zI=Hj.effect_internal_function(()=>new Error().stack))==null?void 0:zI.includes("effect_internal_function"))===!0,nn=g7?Hj.effect_internal_function:m7.effect_internal_function,p7=(function*(){}).constructor,_7=e=>Hi(e)&&e.constructor===p7,vT=St(Symbol.for("effect/Hash/randomHashCache"),()=>new WeakMap),nt=Symbol.for("effect/Hash"),we=e=>{if(ma.enabled===!0)return 0;switch(typeof e){case"number":return pA(e);case"bigint":return qn(e.toString(10));case"boolean":return qn(String(e));case"symbol":return qn(String(e));case"string":return qn(e);case"undefined":return qn("undefined");case"function":case"object":return e===null?qn("null"):e instanceof Date?we(e.toISOString()):e instanceof URL?we(e.href):y7(e)?e[nt]():a0(e);default:throw new Error(`BUG: unhandled typeof ${typeof e} - please report an issue at https://github.com/Effect-TS/effect/issues`)}},a0=e=>(vT.has(e)||vT.set(e,pA(Math.floor(Math.random()*Number.MAX_SAFE_INTEGER))),vT.get(e)),Qe=e=>t=>t*53^e,i0=e=>e&3221225471|e>>>1&1073741824,y7=e=>Ae(e,nt),pA=e=>{if(e!==e||e===1/0)return 0;let t=e|0;for(t!==e&&(t^=e*4294967295);e>4294967295;)t^=e/=4294967295;return i0(t)},qn=e=>{let t=5381,n=e.length;for(;n;)t=t*33^e.charCodeAt(--n);return i0(t)},b7=(e,t)=>{let n=12289;for(let r=0;r<t.length;r++)n^=j(qn(t[r]),Qe(we(e[t[r]])));return i0(n)},Bj=e=>b7(e,Object.keys(e)),c_=e=>{let t=6151;for(let n=0;n<e.length;n++)t=j(t,Qe(we(e[n])));return i0(t)},Yt=function(){if(arguments.length===1){const n=arguments[0];return function(r){return Object.defineProperty(n,nt,{value(){return r},enumerable:!1}),r}}const e=arguments[0],t=arguments[1];return Object.defineProperty(e,nt,{value(){return t},enumerable:!1}),t},Ze=Symbol.for("effect/Equal");function Ge(){return arguments.length===1?e=>CS(e,arguments[0]):CS(arguments[0],arguments[1])}function CS(e,t){if(e===t)return!0;const n=typeof e;if(n!==typeof t)return!1;if(n==="object"||n==="function"){if(e!==null&&t!==null){if(AS(e)&&AS(t))return we(e)===we(t)&&e[Ze](t)?!0:ma.enabled&&ma.tester?ma.tester(e,t):!1;if(e instanceof Date&&t instanceof Date)return e.toISOString()===t.toISOString();if(e instanceof URL&&t instanceof URL)return e.href===t.href}if(ma.enabled){if(Array.isArray(e)&&Array.isArray(t))return e.length===t.length&&e.every((r,i)=>CS(r,t[i]));if(Object.getPrototypeOf(e)===Object.prototype&&Object.getPrototypeOf(e)===Object.prototype){const r=Object.keys(e),i=Object.keys(t);if(r.length===i.length){for(const c of r)if(!(c in t&&CS(e[c],t[c])))return ma.tester?ma.tester(e,t):!1;return!0}}return ma.tester?ma.tester(e,t):!1}}return ma.enabled&&ma.tester?ma.tester(e,t):!1}const AS=e=>Ae(e,Ze),_A=()=>Ge,Gt=Symbol.for("nodejs.util.inspect.custom"),Cn=e=>{try{if(Ae(e,"toJSON")&&Ah(e.toJSON)&&e.toJSON.length===0)return e.toJSON();if(Array.isArray(e))return e.map(Cn)}catch{return{}}return yp(e)},hn=e=>JSON.stringify(e,null,2);let S7=class{[Gt](){return this.toJSON()}toString(){return hn(this.toJSON())}};const xu=(e,t=2)=>{if(typeof e=="string")return e;try{return typeof e=="object"?Vj(e,t):String(e)}catch{return String(e)}},Vj=(e,t)=>{let n=[];const r=JSON.stringify(e,(i,c)=>typeof c=="object"&&c!==null?n.includes(c)?void 0:n.push(c)&&(yu.fiberRefs!==void 0&&Gj(c)?c[yA](yu.fiberRefs):c):c,t);return n=void 0,r},yA=Symbol.for("effect/Inspectable/Redactable"),Gj=e=>typeof e=="object"&&e!==null&&yA in e,yu=St("effect/Inspectable/redactableState",()=>({fiberRefs:void 0})),v7=(e,t)=>{const n=yu.fiberRefs;yu.fiberRefs=e;try{return t()}finally{yu.fiberRefs=n}},yp=e=>Gj(e)&&yu.fiberRefs!==void 0?e[yA](yu.fiberRefs):e,xe=(e,t)=>{switch(t.length){case 0:return e;case 1:return t[0](e);case 2:return t[1](t[0](e));case 3:return t[2](t[1](t[0](e)));case 4:return t[3](t[2](t[1](t[0](e))));case 5:return t[4](t[3](t[2](t[1](t[0](e)))));case 6:return t[5](t[4](t[3](t[2](t[1](t[0](e))))));case 7:return t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))));case 8:return t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e))))))));case 9:return t[8](t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))))));default:{let n=e;for(let r=0,i=t.length;r<i;r++)n=t[r](n);return n}}},Zg="Async",l_="Commit",kr="Failure",eS="OnFailure",RS="OnSuccess",xS="OnSuccessAndFailure",Cr="Success",Kj="Sync",w7="Tag",xh="UpdateRuntimeFlags",OS="While",ep="Iterator",Qj="WithRuntime",tS="Yield",bA="RevertFlags",E7=Symbol.for("effect/Effect"),uk=Symbol.for("effect/Stream"),T7=Symbol.for("effect/Sink"),k7=Symbol.for("effect/Channel"),Ou={_R:e=>e,_E:e=>e,_A:e=>e,_V:t0()},C7={_A:e=>e,_In:e=>e,_L:e=>e,_E:e=>e,_R:e=>e},A7={_Env:e=>e,_InErr:e=>e,_InElem:e=>e,_InDone:e=>e,_OutErr:e=>e,_OutElem:e=>e,_OutDone:e=>e},u_={[E7]:Ou,[uk]:Ou,[T7]:C7,[k7]:A7,[Ze](e){return this===e},[nt](){return Yt(this,a0(this))},[Symbol.iterator](){return new Uj(new Rh(this))},pipe(){return xe(this,arguments)}},SA={[nt](){return Yt(this,Bj(this))},[Ze](e){const t=Object.keys(this),n=Object.keys(e);if(t.length!==n.length)return!1;for(const r of t)if(!(r in e&&Ge(this[r],e[r])))return!1;return!0}},f_={...u_,_op:l_},R7={...f_,...SA},x7=(function(){function e(){}return e.prototype=f_,e})(),Yj=Symbol.for("effect/Option"),Wj={...u_,[Yj]:{_A:e=>e},[Gt](){return this.toJSON()},toString(){return hn(this.toJSON())}},O7=Object.assign(Object.create(Wj),{_tag:"Some",_op:"Some",[Ze](e){return vA(e)&&Xj(e)&&Ge(this.value,e.value)},[nt](){return Yt(this,Qe(we(this._tag))(we(this.value)))},toJSON(){return{_id:"Option",_tag:this._tag,value:Cn(this.value)}}}),D7=we("None"),q7=Object.assign(Object.create(Wj),{_tag:"None",_op:"None",[Ze](e){return vA(e)&&Jj(e)},[nt](){return D7},toJSON(){return{_id:"Option",_tag:this._tag}}}),vA=e=>Ae(e,Yj),Jj=e=>e._tag==="None",Xj=e=>e._tag==="Some",wA=Object.create(q7),DS=e=>{const t=Object.create(O7);return t.value=e,t},Zj=Symbol.for("effect/Either"),eF={...u_,[Zj]:{_R:e=>e},[Gt](){return this.toJSON()},toString(){return hn(this.toJSON())}},N7=Object.assign(Object.create(eF),{_tag:"Right",_op:"Right",[Ze](e){return EA(e)&&nF(e)&&Ge(this.right,e.right)},[nt](){return Qe(we(this._tag))(we(this.right))},toJSON(){return{_id:"Either",_tag:this._tag,right:Cn(this.right)}}}),$7=Object.assign(Object.create(eF),{_tag:"Left",_op:"Left",[Ze](e){return EA(e)&&tF(e)&&Ge(this.left,e.left)},[nt](){return Qe(we(this._tag))(we(this.left))},toJSON(){return{_id:"Either",_tag:this._tag,left:Cn(this.left)}}}),EA=e=>Ae(e,Zj),tF=e=>e._tag==="Left",nF=e=>e._tag==="Right",I7=e=>{const t=Object.create($7);return t.left=e,t},M7=e=>{const t=Object.create(N7);return t.right=e,t},He=M7,Ue=I7,j7=e=>{if(Ah(e))try{return He(e())}catch(t){return Ue(t)}else try{return He(e.try())}catch(t){return Ue(e.catch(t))}},rF=EA,vr=tF,Ci=nF,F7=D(2,(e,{onLeft:t,onRight:n})=>vr(e)?Ue(t(e.left)):He(n(e.right))),d_=D(2,(e,t)=>vr(e)?Ue(t(e.left)):He(e.right)),L7=D(2,(e,t)=>Ci(e)?He(t(e.right)):Ue(e.left)),zr=D(2,(e,{onLeft:t,onRight:n})=>vr(e)?t(e.left):n(e.right)),U7=zr({onLeft:Ie,onRight:Ie}),sF=D(2,(e,t)=>{if(Ci(e))return e.right;throw t(e.left)}),z7=sF(()=>new Error("getOrThrow called on a Left")),aF=e=>e.length>0,iF=e=>(t,n)=>t===n?0:e(t,n),P7=iF((e,t)=>e<t?-1:1),oF=D(2,(e,t)=>iF((n,r)=>e(t(n),t(r)))),H7=e=>D(2,(t,n)=>e(t,n)===1),me=()=>wA,pe=DS,B7=vA,_n=Jj,Zt=Xj,Bt=D(2,(e,{onNone:t,onSome:n})=>_n(e)?t():n(e.value)),yn=D(2,(e,t)=>_n(e)?t():e.value),xo=D(2,(e,t)=>_n(e)?t():e),V7=D(2,(e,t)=>_n(e)?pe(t()):e),of=e=>e==null?me():pe(e),ba=yn(Mj),cF=e=>(...t)=>{try{return pe(e(...t))}catch{return me()}},bu=D(2,(e,t)=>_n(e)?me():pe(t(e.value))),Oh=D(2,(e,t)=>_n(e)?me():t(e.value)),G7=D(2,(e,t)=>_n(e)?me():of(t(e.value))),K7=Oh,Q7=D(2,(e,t)=>K7(e,n=>t(n)?DS(n):wA)),Y7=e=>Jc((t,n)=>_n(t)?_n(n):_n(n)?!1:e(t.value,n.value)),W7=e=>D(2,(t,n)=>_n(t)?!1:e(t.value,n)),J7=_A(),X7=W7(J7),Z7=D(2,(e,t)=>_n(e)?!1:t(e.value)),qS=e=>(t,n)=>_n(t)?n:_n(n)?t:pe(e(t.value,n.value)),eV=(...e)=>e,tV=e=>{const n=e[Symbol.iterator]().next();return n.done?me():pe(n.value)},fk=e=>{const n=e[Symbol.iterator]().next();if(n.done)throw new Error("unsafeHead: empty iterable");return n.value},nV=D(2,(e,t)=>{let n=0;for(const r of e){const i=t(r,n);if(Ru(i)){if(i)return pe(r)}else if(Zt(i))return i;n++}return me()}),rV={[Symbol.iterator](){return sV}},sV={next(){return{done:!0,value:void 0}}},aV=()=>rV,iV=D(2,(e,t)=>({[Symbol.iterator](){const n=e[Symbol.iterator]();let r=0;return{next(){let i=n.next();for(;!i.done;){if(t(i.value,r++))return{done:!1,value:i.value};i=n.next()}return{done:!0,value:void 0}}}}})),o0=e=>new Array(e),oV=D(2,(e,t)=>{const n=Math.max(1,Math.floor(e)),r=new Array(n);for(let i=0;i<n;i++)r[i]=t(i);return r}),Ht=e=>Array.isArray(e)?e:Array.from(e),TA=e=>Array.isArray(e)?e:[e],cV=D(2,(e,{onEmpty:t,onNonEmpty:n})=>bn(e)?n(e):t()),lV=D(2,(e,{onEmpty:t,onNonEmpty:n})=>bn(e)?n(Ss(e),Du(e)):t()),NS=D(2,(e,t)=>[t,...e]),uV=D(2,(e,t)=>[...e,t]),kA=D(2,(e,t)=>Ht(e).concat(Ht(t))),fV=Array.isArray,dV=e=>e.length===0,hV=dV,nS=aF,bn=aF,lF=(e,t)=>e<0||e>=t.length,mV=(e,t)=>Math.floor(Math.min(Math.max(0,e),t.length)),gV=D(2,(e,t)=>{const n=Math.floor(t);return lF(n,e)?me():pe(e[n])}),uF=D(2,(e,t)=>{const n=Math.floor(t);if(lF(n,e))throw new Error(`Index ${n} out of bounds`);return e[n]}),tp=gV(0),Ss=uF(0),pV=e=>bn(e)?pe(fF(e)):me(),fF=e=>e[e.length-1],Du=e=>e.slice(1),_V=(e,t)=>{let n=0;for(const r of e){if(!t(r,n))break;n++}return n},dF=D(2,(e,t)=>mF(e,_V(e,t))),yV=D(2,(e,t)=>{const n=Ht(e);return n.slice(mV(t,n),n.length)}),bV=nV,nq=e=>Array.from(e).reverse(),bp=D(2,(e,t)=>{const n=Array.from(e);return n.sort(t),n}),rq=D(2,(e,t)=>SV(e,t,eV)),SV=D(3,(e,t,n)=>{const r=Ht(e),i=Ht(t);if(bn(r)&&bn(i)){const c=[n(Ss(r),Ss(i))],f=Math.min(r.length,i.length);for(let m=1;m<f;m++)c[m]=n(r[m],i[m]);return c}return[]}),vV=e=>D(2,(t,n)=>{for(const r of t)if(e(n,r))return!0;return!1}),hF=_A(),mF=D(2,(e,t)=>{const n=Array.from(e),r=Math.floor(t);return bn(n)?r>=1?wV(n,r):[[],n]:[n,[]]}),wV=D(2,(e,t)=>{const n=Math.max(1,Math.floor(t));return n>=e.length?[Lg(e),[]]:[NS(e.slice(1,n),Ss(e)),e.slice(n)]}),EV=D(2,(e,t)=>dF(e,(n,r)=>!t(n,r))),Lg=e=>e.slice(),TV=D(3,(e,t,n)=>{const r=Ht(e),i=Ht(t);return bn(r)?bn(i)?pF(n)(kA(r,i)):r:i}),rS=D(2,(e,t)=>TV(e,t,hF)),kV=e=>{const t=vV(e);return D(2,(n,r)=>Ht(n).filter(i=>t(r,i)))},CV=kV(hF),rl=()=>[],pa=e=>[e],Su=D(2,(e,t)=>e.map(t)),$S=D(2,(e,t)=>{if(hV(e))return[];const n=[];for(let r=0;r<e.length;r++){const i=t(e[r],r);for(let c=0;c<i.length;c++)n.push(i[c])}return n}),AV=$S(Ie),gF=D(2,(e,t)=>{const n=Ht(e),r=[];for(let i=0;i<n.length;i++){const c=t(n[i],i);Zt(c)&&r.push(c.value)}return r}),RV=D(2,(e,t)=>{const n=Ht(e),r=[];for(let i=0;i<n.length;i++)t(n[i],i)&&r.push(n[i]);return r}),CA=D(3,(e,t,n)=>Ht(e).reduce((r,i,c)=>n(r,i,c),t)),sq=(e,t)=>{const n=[];let r=e,i;for(;Zt(i=t(r));){const[c,f]=i.value;n.push(c),r=f}return n},h_=XB,pF=D(2,(e,t)=>{const n=Ht(e);if(bn(n)){const r=[Ss(n)],i=Du(n);for(const c of i)r.every(f=>!t(c,f))&&r.push(c);return r}return[]}),xV=e=>pF(e,_A()),Dh=D(2,(e,t)=>Ht(e).join(t)),_F=(e,t)=>{switch(t._tag){case"StringKeyword":case"TemplateLiteral":return Object.keys(e);case"SymbolKeyword":return Object.getOwnPropertySymbols(e);case"Refinement":return _F(e,t.from)}},Za=e=>Object.keys(e).concat(Object.getOwnPropertySymbols(e)),AA=e=>{let t=!1,n;return()=>(t||(n=e(),t=!0),n)},yF=e=>{try{return e.toISOString()}catch{return String(e)}},Aa=(e,t=!0)=>{if(Array.isArray(e))return`[${e.map(n=>Aa(n,t)).join(",")}]`;if(Fj(e))return yF(e);if(Ae(e,"toString")&&Ah(e.toString)&&e.toString!==Object.prototype.toString)return e.toString();if(Es(e))return JSON.stringify(e);if(Mo(e)||e==null||Ru(e)||kS(e))return String(e);if(n0(e))return String(e)+"n";if(gA(e))return`${e.constructor.name}(${Aa(Array.from(e),t)})`;try{t&&JSON.stringify(e);const n=`{${Za(e).map(i=>`${Es(i)?JSON.stringify(i):String(i)}:${Aa(e[i],!1)}`).join(",")}}`,r=e.constructor.name;return e.constructor!==Object.prototype.constructor?`${r}(${n})`:n}catch{return"<circular structure>"}},RA=e=>typeof e=="string"?JSON.stringify(e):String(e),bF=e=>Array.isArray(e),OV=e=>!Array.isArray(e),aq=e=>`[${RA(e)}]`,SF=e=>bF(e)?e.map(aq).join(""):aq(e),Qo=(e,t,n,r)=>{let i=e;return n&&bn(n)&&(i+=`
at path: ${SF(n)}`),t!==void 0&&(i+=`
details: ${t}`),r&&(i+=`
schema (${r._tag}): ${r}`),i},vF=(e,t,n)=>Qo("Unsupported schema",e,t,n),DV=(e,t)=>vF("Cannot build an Equivalence",t,e),wF=(e,t,n)=>Qo("Unsupported schema or overlapping types",`cannot extend ${e} with ${t}`,n),Sp=e=>vF(void 0,void 0,e),qV=e=>Qo("Unsupported key schema",void 0,void 0,e),NV=e=>Qo("Unsupported literal",`literal value: ${Aa(e)}`),iq=e=>Qo("Duplicate index signature",`${e} index signature`),$V=Qo("Unsupported index signature parameter","An index signature parameter type must be `string`, `symbol`, a template literal type or a refinement of the previous types"),IV=Qo("Invalid element","A required element cannot follow an optional element. ts(1257)"),oq=e=>Qo("Duplicate property signature transformation",`Duplicate key ${Aa(e)}`),EF=e=>Qo("Duplicate property signature",`Duplicate key ${Aa(e)}`),MV=Symbol.for("effect/SchemaId/DateFromSelf"),jV=Symbol.for("effect/SchemaId/Int"),FV=Symbol.for("effect/SchemaId/Between"),Yd=P7,IS=e=>e.replace(/[/\\^$*+?.()|[\]{}]/g,"\\$&"),TF=Symbol.for("effect/annotation/Brand"),LV=Symbol.for("effect/annotation/SchemaId"),kF=Symbol.for("effect/annotation/Message"),xA=Symbol.for("effect/annotation/MissingMessage"),OA=Symbol.for("effect/annotation/Identifier"),Bi=Symbol.for("effect/annotation/Title"),Nd=Symbol.for("effect/annotation/AutoTitle"),m_=Symbol.for("effect/annotation/Description"),CF=Symbol.for("effect/annotation/Examples"),AF=Symbol.for("effect/annotation/Default"),RF=Symbol.for("effect/annotation/JSONSchema"),xF=Symbol.for("effect/annotation/Arbitrary"),OF=Symbol.for("effect/annotation/Pretty"),DA=Symbol.for("effect/annotation/Equivalence"),UV=Symbol.for("effect/annotation/Documentation"),DF=Symbol.for("effect/annotation/Concurrency"),qF=Symbol.for("effect/annotation/Batching"),NF=Symbol.for("effect/annotation/ParseIssueTitle"),$F=Symbol.for("effect/annotation/ParseOptions"),IF=Symbol.for("effect/annotation/DecodingFallback"),MS=Symbol.for("effect/annotation/Surrogate"),zV=Symbol.for("effect/annotation/StableFilter"),is=D(2,(e,t)=>Object.prototype.hasOwnProperty.call(e.annotations,t)?pe(e.annotations[t]):me()),MF=is(TF),PV=is(kF),HV=is(xA),jF=is(Bi),FF=is(Nd),c0=is(OA),LF=is(m_),BV=is(DF),VV=is(qF),GV=is(NF),KV=is($F),QV=is(IF),qh=is(MS),YV=is(zV),WV=e=>Z7(YV(e),t=>t===!0),l0=Symbol.for("effect/annotation/JSONIdentifier"),JV=is(l0),XV=e=>xo(JV(e),()=>c0(e)),ZV=Symbol.for("effect/schema/ParseJson");class u0{constructor(t,n,r,i={}){y(this,"typeParameters");y(this,"decodeUnknown");y(this,"encodeUnknown");y(this,"annotations");y(this,"_tag","Declaration");this.typeParameters=t,this.decodeUnknown=n,this.encodeUnknown=r,this.annotations=i}toString(){return yn($i(this),()=>"<declaration schema>")}toJSON(){return{_tag:this._tag,typeParameters:this.typeParameters.map(t=>t.toJSON()),annotations:hr(this.annotations)}}}const Vi=e=>t=>t._tag===e;let jS=class{constructor(t,n={}){y(this,"literal");y(this,"annotations");y(this,"_tag","Literal");this.literal=t,this.annotations=n}toString(){return yn($i(this),()=>Aa(this.literal))}toJSON(){return{_tag:this._tag,literal:n0(this.literal)?String(this.literal):this.literal,annotations:hr(this.annotations)}}};const np=Vi("Literal"),e9=new jS(null);class UF{constructor(t,n={}){y(this,"symbol");y(this,"annotations");y(this,"_tag","UniqueSymbol");this.symbol=t,this.annotations=n}toString(){return yn($i(this),()=>Aa(this.symbol))}toJSON(){return{_tag:this._tag,symbol:String(this.symbol),annotations:hr(this.annotations)}}}class t9{constructor(t={}){y(this,"annotations");y(this,"_tag","UndefinedKeyword");this.annotations=t}toString(){return pl(this)}toJSON(){return{_tag:this._tag,annotations:hr(this.annotations)}}}const Wd=new t9({[Bi]:"undefined"});class n9{constructor(t={}){y(this,"annotations");y(this,"_tag","VoidKeyword");this.annotations=t}toString(){return pl(this)}toJSON(){return{_tag:this._tag,annotations:hr(this.annotations)}}}const r9=new n9({[Bi]:"void"});class s9{constructor(t={}){y(this,"annotations");y(this,"_tag","NeverKeyword");this.annotations=t}toString(){return pl(this)}toJSON(){return{_tag:this._tag,annotations:hr(this.annotations)}}}const f0=new s9({[Bi]:"never"}),a9=Vi("NeverKeyword");class i9{constructor(t={}){y(this,"annotations");y(this,"_tag","UnknownKeyword");this.annotations=t}toString(){return pl(this)}toJSON(){return{_tag:this._tag,annotations:hr(this.annotations)}}}const zF=new i9({[Bi]:"unknown"});class o9{constructor(t={}){y(this,"annotations");y(this,"_tag","AnyKeyword");this.annotations=t}toString(){return pl(this)}toJSON(){return{_tag:this._tag,annotations:hr(this.annotations)}}}const PF=new o9({[Bi]:"any"});class c9{constructor(t={}){y(this,"annotations");y(this,"_tag","StringKeyword");this.annotations=t}toString(){return pl(this)}toJSON(){return{_tag:this._tag,annotations:hr(this.annotations)}}}const dk=new c9({[Bi]:"string",[m_]:"a string"}),hk=Vi("StringKeyword");class l9{constructor(t={}){y(this,"annotations");y(this,"_tag","NumberKeyword");this.annotations=t}toString(){return pl(this)}toJSON(){return{_tag:this._tag,annotations:hr(this.annotations)}}}const mk=new l9({[Bi]:"number",[m_]:"a number"}),cq=Vi("NumberKeyword");class u9{constructor(t={}){y(this,"annotations");y(this,"_tag","BooleanKeyword");this.annotations=t}toString(){return pl(this)}toJSON(){return{_tag:this._tag,annotations:hr(this.annotations)}}}const gk=new u9({[Bi]:"boolean",[m_]:"a boolean"}),lq=Vi("BooleanKeyword"),qA=Vi("SymbolKeyword");let g_=class{constructor(t,n={}){y(this,"type");y(this,"annotations");this.type=t,this.annotations=n}toJSON(){return{type:this.type.toJSON(),annotations:hr(this.annotations)}}toString(){return String(this.type)}};class gl extends g_{constructor(n,r,i={}){super(n,i);y(this,"isOptional");this.isOptional=r}toJSON(){return{type:this.type.toJSON(),isOptional:this.isOptional,annotations:hr(this.annotations)}}toString(){return String(this.type)+(this.isOptional?"?":"")}}const d0=e=>e.map(t=>t.type);class p_{constructor(t,n,r,i={}){y(this,"elements");y(this,"rest");y(this,"isReadonly");y(this,"annotations");y(this,"_tag","TupleType");this.elements=t,this.rest=n,this.isReadonly=r,this.annotations=i;let c=!1,f=!1;for(const m of t)if(m.isOptional)c=!0;else if(c){f=!0;break}if(f||c&&n.length>1)throw new Error(IV)}toString(){return yn($i(this),()=>f9(this))}toJSON(){return{_tag:this._tag,elements:this.elements.map(t=>t.toJSON()),rest:this.rest.map(t=>t.toJSON()),isReadonly:this.isReadonly,annotations:hr(this.annotations)}}}const f9=e=>{const t=e.elements.map(String).join(", ");return lV(e.rest,{onEmpty:()=>`readonly [${t}]`,onNonEmpty:(n,r)=>{const i=String(n),c=i.includes(" | ")?`(${i})`:i;if(r.length>0){const f=r.map(String).join(", ");return e.elements.length>0?`readonly [${t}, ...${c}[], ${f}]`:`readonly [...${c}[], ${f}]`}else return e.elements.length>0?`readonly [${t}, ...${c}[]]`:`ReadonlyArray<${i}>`}})};class On extends gl{constructor(n,r,i,c,f){super(r,i,f);y(this,"name");y(this,"isReadonly");this.name=n,this.isReadonly=c}toString(){return(this.isReadonly?"readonly ":"")+String(this.name)+(this.isOptional?"?":"")+": "+this.type}toJSON(){return{name:String(this.name),type:this.type.toJSON(),isOptional:this.isOptional,isReadonly:this.isReadonly,annotations:hr(this.annotations)}}}const HF=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return!0;case"Refinement":return HF(e.from)}return!1};class Nh{constructor(t,n,r){y(this,"type");y(this,"isReadonly");y(this,"parameter");if(this.type=n,this.isReadonly=r,HF(t))this.parameter=t;else throw new Error($V)}toString(){return(this.isReadonly?"readonly ":"")+`[x: ${this.parameter}]: ${this.type}`}toJSON(){return{parameter:this.parameter.toJSON(),type:this.type.toJSON(),isReadonly:this.isReadonly}}}class Ra{constructor(t,n,r={}){y(this,"annotations");y(this,"_tag","TypeLiteral");y(this,"propertySignatures");y(this,"indexSignatures");this.annotations=r;const i={};for(let f=0;f<t.length;f++){const m=t[f].name;if(Object.prototype.hasOwnProperty.call(i,m))throw new Error(EF(m));i[m]=null}const c={string:!1,symbol:!1};for(let f=0;f<n.length;f++){const m=vp(n[f].parameter);if(hk(m)){if(c.string)throw new Error(iq("string"));c.string=!0}else if(qA(m)){if(c.symbol)throw new Error(iq("symbol"));c.symbol=!0}}this.propertySignatures=t,this.indexSignatures=n}toString(){return yn($i(this),()=>d9(this))}toJSON(){return{_tag:this._tag,propertySignatures:this.propertySignatures.map(t=>t.toJSON()),indexSignatures:this.indexSignatures.map(t=>t.toJSON()),annotations:hr(this.annotations)}}}const uq=e=>e.map(String).join("; "),d9=e=>{if(e.propertySignatures.length>0){const t=e.propertySignatures.map(String).join("; ");return e.indexSignatures.length>0?`{ ${t}; ${uq(e.indexSignatures)} }`:`{ ${t} }`}else return e.indexSignatures.length>0?`{ ${uq(e.indexSignatures)} }`:"{}"},fq=Vi("TypeLiteral"),h9=bp(oF(Yd,e=>{switch(e._tag){case"AnyKeyword":return 0;case"UnknownKeyword":return 1;case"ObjectKeyword":return 2;case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":return 3}return 4})),m9={string:"StringKeyword",number:"NumberKeyword",boolean:"BooleanKeyword",bigint:"BigIntKeyword"},BF=e=>$S(e,t=>$A(t)?BF(t.types):[t]),g9=e=>{const t=h9(e),n=[],r={},i=[];for(const c of t)switch(c._tag){case"NeverKeyword":break;case"AnyKeyword":return[PF];case"UnknownKeyword":return[zF];case"ObjectKeyword":case"UndefinedKeyword":case"VoidKeyword":case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":{r[c._tag]||(r[c._tag]=c,n.push(c));break}case"Literal":{const f=typeof c.literal;switch(f){case"string":case"number":case"bigint":case"boolean":{const m=m9[f];!r[m]&&!i.includes(c.literal)&&(i.push(c.literal),n.push(c));break}case"object":{i.includes(c.literal)||(i.push(c.literal),n.push(c));break}}break}case"UniqueSymbol":{!r.SymbolKeyword&&!i.includes(c.symbol)&&(i.push(c.symbol),n.push(c));break}case"TupleType":{r.ObjectKeyword||n.push(c);break}case"TypeLiteral":{c.propertySignatures.length===0&&c.indexSignatures.length===0?r["{}"]||(r["{}"]=c,n.push(c)):r.ObjectKeyword||n.push(c);break}default:n.push(c)}return n};var ko;let Er=(ko=class{constructor(t,n={}){y(this,"types");y(this,"annotations");y(this,"_tag","Union");this.types=t,this.annotations=n}toString(){return yn($i(this),()=>this.types.map(String).join(" | "))}toJSON(){return{_tag:this._tag,types:this.types.map(t=>t.toJSON()),annotations:hr(this.annotations)}}},y(ko,"make",(t,n)=>NA(t)?new ko(t,n):t.length===1?t[0]:f0),y(ko,"unify",(t,n)=>ko.make(g9(BF(t)),n)),ko);const p9=(e,t)=>e.map(t),NA=e=>e.length>1,$A=Vi("Union"),wT=St(Symbol.for("effect/Schema/AST/toJSONMemoMap"),()=>new WeakMap);class qu{constructor(t,n={}){y(this,"f");y(this,"annotations");y(this,"_tag","Suspend");this.f=t,this.annotations=n,this.f=AA(t)}toString(){return $i(this).pipe(xo(()=>Oh(cF(this.f)(),t=>$i(t))),yn(()=>"<suspended schema>"))}toJSON(){const t=this.f();let n=wT.get(t);return n||(wT.set(t,{_tag:this._tag}),n={_tag:this._tag,ast:t.toJSON(),annotations:hr(this.annotations)},wT.set(t,n),n)}}let __=class{constructor(t,n,r={}){y(this,"from");y(this,"filter");y(this,"annotations");y(this,"_tag","Refinement");this.from=t,this.filter=n,this.annotations=r}toString(){return c0(this).pipe(yn(()=>Bt(JF(this),{onNone:()=>`{ ${this.from} | filter }`,onSome:t=>$d(this.from)?String(this.from)+" & "+t:t})))}toJSON(){return{_tag:this._tag,from:this.from.toJSON(),annotations:hr(this.annotations)}}};const $d=Vi("Refinement"),ET={};let Ea=class{constructor(t,n,r,i={}){y(this,"from");y(this,"to");y(this,"transformation");y(this,"annotations");y(this,"_tag","Transformation");this.from=t,this.to=n,this.transformation=r,this.annotations=i}toString(){return yn($i(this),()=>`(${String(this.from)} <-> ${String(this.to)})`)}toJSON(){return{_tag:this._tag,from:this.from.toJSON(),to:this.to.toJSON(),annotations:hr(this.annotations)}}};const _9=Vi("Transformation");class VF{constructor(t,n){y(this,"decode");y(this,"encode");y(this,"_tag","FinalTransformation");this.decode=t,this.encode=n}}const y9=e=>t=>t._tag===e;class b9{constructor(){y(this,"_tag","ComposeTransformation")}}const IA=new b9;let S9=class{constructor(t,n,r,i){y(this,"from");y(this,"to");y(this,"decode");y(this,"encode");this.from=t,this.to=n,this.decode=r,this.encode=i}};const v9=e=>e.decode===Ie&&e.encode===Ie;class FS{constructor(t){y(this,"propertySignatureTransformations");y(this,"_tag","TypeLiteralTransformation");this.propertySignatureTransformations=t;const n={},r={};for(const i of t){const c=i.from;if(n[c])throw new Error(oq(c));n[c]=!0;const f=i.to;if(r[f])throw new Error(oq(f));r[f]=!0}}}const pk=y9("TypeLiteralTransformation"),Nu=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={...e.annotations,...t},i=qh(e);return Zt(i)&&(r[MS]=Nu(i.value,t)),n.annotations.value=r,Object.create(Object.getPrototypeOf(e),n)},w9="[\\s\\S]*",E9="[+-]?\\d*\\.?\\d+(?:[Ee][+-]?\\d+)?",GF=(e,t)=>{switch(e._tag){case"Literal":return IS(String(e.literal));case"StringKeyword":return w9;case"NumberKeyword":return E9;case"TemplateLiteral":return KF(e);case"Union":return e.types.map(n=>GF(n)).join("|")}},T9=(e,t,n,r)=>$A(e)?`(${t})`:t,KF=(e,t,n)=>{let r="";if(e.head!==""){const i=IS(e.head);r+=i}for(const i of e.spans){const c=GF(i.type);if(r+=T9(i.type,c),i.literal!==""){const f=IS(i.literal);r+=f}}return r},QF=e=>new RegExp(`^${KF(e)}$`),sS=e=>{const t=qh(e);if(Zt(t))return sS(t.value);switch(e._tag){case"TypeLiteral":return e.propertySignatures.slice();case"Suspend":return sS(e.f());case"Refinement":return sS(e.from)}return au(e).map(n=>uu(e,n))},aS=e=>{switch(e._tag){case"TupleType":{let t=!1,n=[];for(const r of e.elements)r.isOptional&&(t=!0),n.push(r.type);return t&&n.push(Wd),n=n.concat(d0(e.rest)),Er.make(n)}case"Refinement":return aS(e.from);case"Union":return Er.make(e.types.map(aS));case"Suspend":return aS(e.f())}throw new Error(Sp(e))},YF=(e,t)=>{const n=bV(e.propertySignatures,r=>r.name===t);if(Zt(n))return n.value;if(Es(t)){let r;for(const i of e.indexSignatures){const c=vp(i.parameter);switch(c._tag){case"TemplateLiteral":{if(QF(c).test(t))return new On(t,i.type,!1,!0);break}case"StringKeyword":r===void 0&&(r=new On(t,i.type,!1,!0))}}if(r)return r}else if(kS(t))for(const r of e.indexSignatures){const i=vp(r.parameter);if(qA(i))return new On(t,r.type,!1,!0)}},uu=(e,t)=>{const n=qh(e);if(Zt(n))return uu(n.value,t);switch(e._tag){case"TypeLiteral":{const r=YF(e,t);if(r)return r;break}case"Union":return new On(t,Er.make(e.types.map(r=>uu(r,t).type)),!1,!0);case"Suspend":return uu(e.f(),t);case"Refinement":return uu(e.from,t)}throw new Error(Sp(e))},au=e=>{const t=qh(e);if(Zt(t))return au(t.value);switch(e._tag){case"TypeLiteral":return e.propertySignatures.map(n=>n.name);case"Union":return e.types.slice(1).reduce((n,r)=>CV(n,au(r)),au(e.types[0]));case"Suspend":return au(e.f());case"Refinement":return au(e.from);case"Transformation":return au(e.to)}return[]},dq=(e,t)=>{const n=[],r=[],i=c=>{switch(c._tag){case"NeverKeyword":break;case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":case"Refinement":r.push(new Nh(c,t,!0));break;case"Literal":if(Es(c.literal)||Mo(c.literal))n.push(new On(c.literal,t,!1,!0));else throw new Error(NV(c.literal));break;case"Enums":{for(const[f,m]of c.enums)n.push(new On(m,t,!1,!0));break}case"UniqueSymbol":n.push(new On(c.symbol,t,!1,!0));break;case"Union":c.types.forEach(i);break;default:throw new Error(qV(c))}};return i(e),{propertySignatures:n,indexSignatures:r}},wo=(e,t)=>{const n=qh(e);if(Zt(n))return wo(n.value,t);switch(e._tag){case"TypeLiteral":{const r=[],i={};for(const c of e.propertySignatures)i[c.name]=null,t.includes(c.name)&&r.push(c);for(const c of t)if(!(c in i)){const f=YF(e,c);f&&r.push(f)}return new Ra(r,[])}case"Union":return new Ra(t.map(r=>uu(e,r)),[]);case"Suspend":return wo(e.f(),t);case"Refinement":return wo(e.from,t);case"Transformation":switch(e.transformation._tag){case"ComposeTransformation":return new Ea(wo(e.from,t),wo(e.to,t),IA);case"TypeLiteralTransformation":{const r=[],i=[];for(const c of t){const f=e.transformation.propertySignatureTransformations.find(m=>m.to===c);f?(r.push(f),i.push(f.from)):i.push(c)}return bn(r)?new Ea(wo(e.from,i),wo(e.to,t),new FS(r)):wo(e.from,i)}}}throw new Error(Sp(e))},iS=e=>Er.make([e,Wd]),Ug=(e,t)=>{switch(e._tag){case"TupleType":return new p_(e.elements.map(n=>new gl(iS(n.type),!0)),cV(e.rest,{onEmpty:()=>e.rest,onNonEmpty:n=>[new g_(Er.make([...d0(n),Wd]))]}),e.isReadonly);case"TypeLiteral":return new Ra(e.propertySignatures.map(n=>new On(n.name,iS(n.type),!0,n.isReadonly,n.annotations)),e.indexSignatures.map(n=>new Nh(n.parameter,iS(n.type),n.isReadonly)));case"Union":return Er.make(e.types.map(n=>Ug(n)));case"Suspend":return new qu(()=>Ug(e.f()));case"Declaration":case"Refinement":throw new Error(Sp(e));case"Transformation":{if(pk(e.transformation)&&e.transformation.propertySignatureTransformations.every(v9))return new Ea(Ug(e.from),Ug(e.to),e.transformation);throw new Error(Sp(e))}}return e},Sd=e=>{switch(e._tag){case"TupleType":return e.isReadonly===!1?e:new p_(e.elements,e.rest,!1,e.annotations);case"TypeLiteral":{const t=_s(e.propertySignatures,r=>r.isReadonly===!1?r:new On(r.name,r.type,r.isOptional,!1,r.annotations)),n=_s(e.indexSignatures,r=>r.isReadonly===!1?r:new Nh(r.parameter,r.type,!1));return t===e.propertySignatures&&n===e.indexSignatures?e:new Ra(t,n,e.annotations)}case"Union":{const t=_s(e.types,Sd);return t===e.types?e:Er.make(t,e.annotations)}case"Suspend":return new qu(()=>Sd(e.f()),e.annotations);case"Refinement":{const t=Sd(e.from);return t===e.from?e:new __(t,e.filter,e.annotations)}case"Transformation":{const t=Sd(e.from),n=Sd(e.to);return t===e.from&&n===e.to?e:new Ea(t,n,e.transformation,e.annotations)}}return e},WF=e=>t=>{let n;for(const r of e)Object.prototype.hasOwnProperty.call(t.annotations,r)&&(n===void 0&&(n={}),n[r]=t.annotations[r]);return n},k9=e=>t=>{const n={...t.annotations};for(const r of e)delete n[r];return n},C9=WF([CF,AF,RF,xF,OF,DA]),Dn=e=>{switch(e._tag){case"Declaration":{const t=_s(e.typeParameters,Dn);return t===e.typeParameters?e:new u0(t,e.decodeUnknown,e.encodeUnknown,e.annotations)}case"TupleType":{const t=_s(e.elements,i=>{const c=Dn(i.type);return c===i.type?i:new gl(c,i.isOptional)}),n=d0(e.rest),r=_s(n,Dn);return t===e.elements&&r===n?e:new p_(t,r.map(i=>new g_(i)),e.isReadonly,e.annotations)}case"TypeLiteral":{const t=_s(e.propertySignatures,r=>{const i=Dn(r.type);return i===r.type?r:new On(r.name,i,r.isOptional,r.isReadonly)}),n=_s(e.indexSignatures,r=>{const i=Dn(r.type);return i===r.type?r:new Nh(r.parameter,i,r.isReadonly)});return t===e.propertySignatures&&n===e.indexSignatures?e:new Ra(t,n,e.annotations)}case"Union":{const t=_s(e.types,Dn);return t===e.types?e:Er.make(t,e.annotations)}case"Suspend":return new qu(()=>Dn(e.f()),e.annotations);case"Refinement":{const t=Dn(e.from);return t===e.from?e:new __(t,e.filter,e.annotations)}case"Transformation":{const t=C9(e);return Dn(t!==void 0?Nu(e.to,t):e.to)}}return e},md=e=>Bt(XV(e),{onNone:()=>{},onSome:t=>({[l0]:t})});function _s(e,t){let n=!1;const r=o0(e.length);for(let i=0;i<e.length;i++){const c=e[i],f=t(c);f!==c&&(n=!0),r[i]=f}return n?r:e}const Si=(e,t)=>{switch(e._tag){case"Declaration":{const n=_s(e.typeParameters,r=>Si(r));return n===e.typeParameters?e:new u0(n,e.decodeUnknown,e.encodeUnknown,e.annotations)}case"TupleType":{const n=_s(e.elements,c=>{const f=Si(c.type);return f===c.type?c:new gl(f,c.isOptional)}),r=d0(e.rest),i=_s(r,c=>Si(c));return n===e.elements&&i===r?e:new p_(n,i.map(c=>new g_(c)),e.isReadonly,md(e))}case"TypeLiteral":{const n=_s(e.propertySignatures,i=>{const c=Si(i.type);return c===i.type?i:new On(i.name,c,i.isOptional,i.isReadonly)}),r=_s(e.indexSignatures,i=>{const c=Si(i.type);return c===i.type?i:new Nh(i.parameter,c,i.isReadonly)});return n===e.propertySignatures&&r===e.indexSignatures?e:new Ra(n,r,md(e))}case"Union":{const n=_s(e.types,r=>Si(r));return n===e.types?e:Er.make(n,md(e))}case"Suspend":return new qu(()=>Si(e.f()),md(e));case"Refinement":{const n=Si(e.from),r=md(e);return r?Nu(n,r):n}case"Transformation":{const n=md(e);return Si(n?Nu(e.from,n):e.from)}}return e},_k=e=>Si(e),hr=e=>{const t={};for(const n of Object.getOwnPropertySymbols(e))t[String(n)]=e[n];return t},vp=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return e;case"Refinement":return vp(e.from)}},A9=(e,t)=>new Ea(e,t,IA),pl=e=>yn($i(e),()=>e._tag);function R9(e){return Bt(MF(e),{onNone:()=>"",onSome:t=>t.map(n=>` & Brand<${Aa(n)}>`).join("")})}const JF=e=>jF(e).pipe(xo(()=>LF(e)),xo(()=>FF(e)),bu(t=>t+R9(e))),$i=e=>xo(c0(e),()=>JF(e)),x9=(e,t,n)=>{switch(e._tag){case"UndefinedKeyword":return f0;case"Union":{const r=[];let i=!1;for(const c of e.types){const f=t(c);f?(i=!0,a9(f)||r.push(f)):r.push(c)}if(i)return Er.make(r);break}case"Suspend":return t(e.f());case"Transformation":return n(e)}},hq=Symbol.for("effect/Brand/Refined"),XF=()=>Object.assign(e=>e,{[hq]:hq,option:e=>pe(e),either:e=>He(e),is:e=>!0}),ZF=Symbol.for("effect/Context/Tag"),LS=Symbol.for("effect/Context/Reference"),O9="effect/STM",D9=Symbol.for(O9),MA={...u_,_op:"Tag",[D9]:Ou,[ZF]:{_Service:e=>e,_Identifier:e=>e},toString(){return hn(this.toJSON())},toJSON(){return{_id:"Tag",key:this.key,stack:this.stack}},[Gt](){return this.toJSON()},of(e){return e},context(e){return nL(this,e)}},q9={...MA,[LS]:LS},N9=e=>{const t=Error.stackTraceLimit;Error.stackTraceLimit=2;const n=new Error;Error.stackTraceLimit=t;const r=Object.create(MA);return Object.defineProperty(r,"stack",{get(){return n.stack}}),r.key=e,r},$9=e=>()=>{const t=Error.stackTraceLimit;Error.stackTraceLimit=2;const n=new Error;Error.stackTraceLimit=t;function r(){}return Object.setPrototypeOf(r,MA),r.key=e,Object.defineProperty(r,"stack",{get(){return n.stack}}),r},I9=()=>(e,t)=>{const n=Error.stackTraceLimit;Error.stackTraceLimit=2;const r=new Error;Error.stackTraceLimit=n;function i(){}return Object.setPrototypeOf(i,q9),i.key=e,i.defaultValue=t.defaultValue,Object.defineProperty(i,"stack",{get(){return r.stack}}),i},eL=Symbol.for("effect/Context"),M9={[eL]:{_Services:e=>e},[Ze](e){if(tL(e)&&this.unsafeMap.size===e.unsafeMap.size){for(const t of this.unsafeMap.keys())if(!e.unsafeMap.has(t)||!Ge(this.unsafeMap.get(t),e.unsafeMap.get(t)))return!1;return!0}return!1},[nt](){return Yt(this,pA(this.unsafeMap.size))},pipe(){return xe(this,arguments)},toString(){return hn(this.toJSON())},toJSON(){return{_id:"Context",services:Array.from(this.unsafeMap).map(Cn)}},[Gt](){return this.toJSON()}},$u=e=>{const t=Object.create(M9);return t.unsafeMap=e,t},j9=e=>{const t=new Error(`Service not found${e.key?`: ${String(e.key)}`:""}`);if(e.stack){const n=e.stack.split(`
`);if(n.length>2){const r=n[2].match(/at (.*)/);r&&(t.message=t.message+` (defined at ${r[1]})`)}}if(t.stack){const n=t.stack.split(`
`);n.splice(1,3),t.stack=n.join(`
`)}return t},tL=e=>Ae(e,eL),F9=e=>Ae(e,ZF),L9=e=>Ae(e,LS),U9=$u(new Map),z9=()=>U9,nL=(e,t)=>$u(new Map([[e.key,t]])),P9=D(3,(e,t,n)=>{const r=new Map(e.unsafeMap);return r.set(t.key,n),$u(r)}),TT=St("effect/Context/defaultValueCache",()=>new Map),jA=e=>{if(TT.has(e.key))return TT.get(e.key);const t=e.defaultValue();return TT.set(e.key,t),t},H9=(e,t)=>e.unsafeMap.has(t.key)?e.unsafeMap.get(t.key):jA(t),rL=D(2,(e,t)=>{if(!e.unsafeMap.has(t.key)){if(LS in t)return jA(t);throw j9(t)}return e.unsafeMap.get(t.key)}),B9=rL,V9=D(2,(e,t)=>e.unsafeMap.has(t.key)?DS(e.unsafeMap.get(t.key)):L9(t)?DS(jA(t)):wA),G9=D(2,(e,t)=>{const n=new Map(e.unsafeMap);for(const[r,i]of t.unsafeMap)n.set(r,i);return $u(n)}),K9=(...e)=>t=>{const n=new Map(t.unsafeMap);for(const r of e)n.delete(r.key);return $u(n)},Cs=N9,Q9=tL,FA=F9,Iu=z9,h0=nL,Ks=P9,Ws=B9,m0=rL,Xs=V9,_l=G9,Y9=K9,LA=$9,g0=I9,sL=Symbol.for("effect/Chunk");function W9(e,t,n,r,i){for(let c=t;c<Math.min(e.length,t+i);c++)n[r+c-t]=e[c];return n}const aL=[],J9=e=>Jc((t,n)=>t.length===n.length&&xa(t).every((r,i)=>e(r,Oo(n,i)))),X9=J9(Ge),Z9={[sL]:{_A:e=>e},toString(){return hn(this.toJSON())},toJSON(){return{_id:"Chunk",values:xa(this).map(Cn)}},[Gt](){return this.toJSON()},[Ze](e){return p0(e)&&X9(this,e)},[nt](){return Yt(this,c_(xa(this)))},[Symbol.iterator](){switch(this.backing._tag){case"IArray":return this.backing.array[Symbol.iterator]();case"IEmpty":return aL[Symbol.iterator]();default:return xa(this)[Symbol.iterator]()}},pipe(){return xe(this,arguments)}},Pn=e=>{const t=Object.create(Z9);switch(t.backing=e,e._tag){case"IEmpty":{t.length=0,t.depth=0,t.left=t,t.right=t;break}case"IConcat":{t.length=e.left.length+e.right.length,t.depth=1+Math.max(e.left.depth,e.right.depth),t.left=e.left,t.right=e.right;break}case"IArray":{t.length=e.array.length,t.depth=0,t.left=Ya,t.right=Ya;break}case"ISingleton":{t.length=1,t.depth=0,t.left=Ya,t.right=Ya;break}case"ISlice":{t.length=e.length,t.depth=e.chunk.depth+1,t.left=Ya,t.right=Ya;break}}return t},p0=e=>Ae(e,sL),Ya=Pn({_tag:"IEmpty"}),an=()=>Ya,kT=(...e)=>rG(e),Sn=e=>Pn({_tag:"ISingleton",a:e}),Mu=e=>p0(e)?e:Bn(Ht(e)),yk=(e,t,n)=>{switch(e.backing._tag){case"IArray":{W9(e.backing.array,0,t,n,e.length);break}case"IConcat":{yk(e.left,t,n),yk(e.right,t,n+e.left.length);break}case"ISingleton":{t[n]=e.backing.a;break}case"ISlice":{let r=0,i=n;for(;r<e.length;)t[i]=Oo(e,r),r+=1,i+=1;break}}},eG=e=>{switch(e.backing._tag){case"IEmpty":return aL;case"IArray":return e.backing.array;default:{const t=new Array(e.length);return yk(e,t,0),e.backing={_tag:"IArray",array:t},e.left=Ya,e.right=Ya,e.depth=0,t}}},xa=eG,tG=e=>{switch(e.backing._tag){case"IEmpty":case"ISingleton":return e;case"IArray":return Pn({_tag:"IArray",array:nq(e.backing.array)});case"IConcat":return Pn({_tag:"IConcat",left:jo(e.backing.right),right:jo(e.backing.left)});case"ISlice":return Bn(nq(xa(e)))}},jo=tG,nG=D(2,(e,t)=>t<0||t>=e.length?me():pe(Oo(e,t))),Bn=e=>e.length===0?an():e.length===1?Sn(e[0]):Pn({_tag:"IArray",array:e}),rG=e=>Bn(e),Oo=D(2,(e,t)=>{switch(e.backing._tag){case"IEmpty":throw new Error("Index out of bounds");case"ISingleton":{if(t!==0)throw new Error("Index out of bounds");return e.backing.a}case"IArray":{if(t>=e.length||t<0)throw new Error("Index out of bounds");return e.backing.array[t]}case"IConcat":return t<e.left.length?Oo(e.left,t):Oo(e.right,t-e.left.length);case"ISlice":return Oo(e.backing.chunk,t+e.backing.offset)}}),wp=D(2,(e,t)=>pn(e,Sn(t))),Gr=D(2,(e,t)=>pn(Sn(t),e)),Jd=D(2,(e,t)=>{if(t<=0)return Ya;if(t>=e.length)return e;switch(e.backing._tag){case"ISlice":return Pn({_tag:"ISlice",chunk:e.backing.chunk,length:t,offset:e.backing.offset});case"IConcat":return t>e.left.length?Pn({_tag:"IConcat",left:e.left,right:Jd(e.right,t-e.left.length)}):Jd(e.left,t);default:return Pn({_tag:"ISlice",chunk:e,offset:0,length:t})}}),Ai=D(2,(e,t)=>{if(t<=0)return e;if(t>=e.length)return Ya;switch(e.backing._tag){case"ISlice":return Pn({_tag:"ISlice",chunk:e.backing.chunk,offset:e.backing.offset+t,length:e.backing.length-t});case"IConcat":return t>e.left.length?Ai(e.right,t-e.left.length):Pn({_tag:"IConcat",left:Ai(e.left,t),right:e.right});default:return Pn({_tag:"ISlice",chunk:e,offset:t,length:e.length-t})}}),pn=D(2,(e,t)=>{if(e.backing._tag==="IEmpty")return t;if(t.backing._tag==="IEmpty")return e;const n=t.depth-e.depth;if(Math.abs(n)<=1)return Pn({_tag:"IConcat",left:e,right:t});if(n<-1)if(e.left.depth>=e.right.depth){const r=pn(e.right,t);return Pn({_tag:"IConcat",left:e.left,right:r})}else{const r=pn(e.right.right,t);if(r.depth===e.depth-3){const i=Pn({_tag:"IConcat",left:e.right.left,right:r});return Pn({_tag:"IConcat",left:e.left,right:i})}else{const i=Pn({_tag:"IConcat",left:e.left,right:e.right.left});return Pn({_tag:"IConcat",left:i,right:r})}}else if(t.right.depth>=t.left.depth){const r=pn(e,t.left);return Pn({_tag:"IConcat",left:r,right:t.right})}else{const r=pn(e,t.left.left);if(r.depth===t.depth-3){const i=Pn({_tag:"IConcat",left:r,right:t.left.right});return Pn({_tag:"IConcat",left:i,right:t.right})}else{const i=Pn({_tag:"IConcat",left:t.left.right,right:t.right});return Pn({_tag:"IConcat",left:r,right:i})}}}),iL=D(2,(e,t)=>Bn(gF(e,t))),_0=D(2,(e,t)=>Bn(RV(e,t))),y0=e=>e.length===0,Ii=e=>e.length>0,b0=nG(0),S0=e=>Oo(e,0),Ri=S0,oL=D(2,(e,t)=>e.backing._tag==="ISingleton"?Sn(t(e.backing.a,0)):Bn(j(xa(e),Su((n,r)=>t(n,r))))),cL=D(2,(e,t)=>[Jd(e,t),Ai(e,t)]),sG=D(2,(e,t)=>{let n=0;for(const r of xa(e)){if(t(r))break;n++}return cL(e,n)}),Co=e=>Ai(e,1),aG=D(2,(e,t)=>Ai(e,e.length-t)),iG=CA,bk=Symbol.for("effect/Duration"),lL=BigInt(0),mq=BigInt(24),Mb=BigInt(60),Sk=BigInt(1e3),gq=BigInt(1e6),pq=BigInt(1e9),oG=/^(-?\d+(?:\.\d+)?)\s+(nanos?|micros?|millis?|seconds?|minutes?|hours?|days?|weeks?)$/,Zs=e=>{if(uL(e))return e;if(Mo(e))return ju(e);if(n0(e))return CT(e);if(Array.isArray(e)&&e.length===2&&e.every(Mo))return e[0]===-1/0||e[1]===-1/0||Number.isNaN(e[0])||Number.isNaN(e[1])?UA:e[0]===1/0||e[1]===1/0?fG:CT(BigInt(Math.round(e[0]*1e9))+BigInt(Math.round(e[1])));if(Es(e)){const t=oG.exec(e);if(t){const[n,r,i]=t,c=Number(r);switch(i){case"nano":case"nanos":return CT(BigInt(r));case"micro":case"micros":return dG(BigInt(r));case"milli":case"millis":return ju(c);case"second":case"seconds":return US(c);case"minute":case"minutes":return fL(c);case"hour":case"hours":return hG(c);case"day":case"days":return mG(c);case"week":case"weeks":return gG(c)}}}throw new Error("Invalid DurationInput")},_q={_tag:"Millis",millis:0},cG={_tag:"Infinity"},lG={[bk]:bk,[nt](){return Yt(this,Bj(this.value))},[Ze](e){return uL(e)&&wG(this,e)},toString(){return`Duration(${mL(this)})`},toJSON(){switch(this.value._tag){case"Millis":return{_id:"Duration",_tag:"Millis",millis:this.value.millis};case"Nanos":return{_id:"Duration",_tag:"Nanos",hrtime:_G(this)};case"Infinity":return{_id:"Duration",_tag:"Infinity"}}},[Gt](){return this.toJSON()},pipe(){return xe(this,arguments)}},Is=e=>{const t=Object.create(lG);return Mo(e)?isNaN(e)||e<=0?t.value=_q:Number.isFinite(e)?Number.isInteger(e)?t.value={_tag:"Millis",millis:e}:t.value={_tag:"Nanos",nanos:BigInt(Math.round(e*1e6))}:t.value=cG:e<=lL?t.value=_q:t.value={_tag:"Nanos",nanos:e},t},uL=e=>Ae(e,bk),uG=e=>{switch(e.value._tag){case"Millis":return e.value.millis===0;case"Nanos":return e.value.nanos===lL;case"Infinity":return!1}},UA=Is(0),fG=Is(1/0),CT=e=>Is(e),dG=e=>Is(e*Sk),ju=e=>Is(e),US=e=>Is(e*1e3),fL=e=>Is(e*6e4),hG=e=>Is(e*36e5),mG=e=>Is(e*864e5),gG=e=>Is(e*6048e5),Xd=e=>dL(e,{onMillis:t=>t,onNanos:t=>Number(t)/1e6}),pG=e=>{const t=Zs(e);switch(t.value._tag){case"Infinity":throw new Error("Cannot convert infinite duration to nanos");case"Nanos":return t.value.nanos;case"Millis":return BigInt(Math.round(t.value.millis*1e6))}},_G=e=>{const t=Zs(e);switch(t.value._tag){case"Infinity":return[1/0,0];case"Nanos":return[Number(t.value.nanos/pq),Number(t.value.nanos%pq)];case"Millis":return[Math.floor(t.value.millis/1e3),Math.round(t.value.millis%1e3*1e6)]}},dL=D(2,(e,t)=>{const n=Zs(e);switch(n.value._tag){case"Nanos":return t.onNanos(n.value.nanos);case"Infinity":return t.onMillis(1/0);case"Millis":return t.onMillis(n.value.millis)}}),v0=D(3,(e,t,n)=>{const r=Zs(e),i=Zs(t);if(r.value._tag==="Infinity"||i.value._tag==="Infinity")return n.onMillis(Xd(r),Xd(i));if(r.value._tag==="Nanos"||i.value._tag==="Nanos"){const c=r.value._tag==="Nanos"?r.value.nanos:BigInt(Math.round(r.value.millis*1e6)),f=i.value._tag==="Nanos"?i.value.nanos:BigInt(Math.round(i.value.millis*1e6));return n.onNanos(c,f)}return n.onMillis(r.value.millis,i.value.millis)}),yG=(e,t)=>v0(e,t,{onMillis:(n,r)=>n===r,onNanos:(n,r)=>n===r}),bG=D(2,(e,t)=>dL(e,{onMillis:n=>Is(n*t),onNanos:n=>Is(n*BigInt(t))})),SG=D(2,(e,t)=>v0(e,t,{onMillis:(n,r)=>Is(n+r),onNanos:(n,r)=>Is(n+r)})),hL=D(2,(e,t)=>v0(e,t,{onMillis:(n,r)=>n<=r,onNanos:(n,r)=>n<=r})),vG=D(2,(e,t)=>v0(e,t,{onMillis:(n,r)=>n>=r,onNanos:(n,r)=>n>=r})),wG=D(2,(e,t)=>yG(Zs(e),Zs(t))),EG=e=>{const t=Zs(e);if(t.value._tag==="Infinity")return{days:1/0,hours:1/0,minutes:1/0,seconds:1/0,millis:1/0,nanos:1/0};const n=pG(t),r=n/gq,i=r/Sk,c=i/Mb,f=c/Mb,m=f/mq;return{days:Number(m),hours:Number(f%mq),minutes:Number(c%Mb),seconds:Number(i%Mb),millis:Number(r%Sk),nanos:Number(n%gq)}},mL=e=>{const t=Zs(e);if(t.value._tag==="Infinity")return"Infinity";if(uG(t))return"0";const n=EG(t),r=[];return n.days!==0&&r.push(`${n.days}d`),n.hours!==0&&r.push(`${n.hours}h`),n.minutes!==0&&r.push(`${n.minutes}m`),n.seconds!==0&&r.push(`${n.seconds}s`),n.millis!==0&&r.push(`${n.millis}ms`),n.nanos!==0&&r.push(`${n.nanos}ns`),r.join(" ")},Fu=5,zA=Math.pow(2,Fu),TG=zA-1,kG=zA/2,CG=zA/4;function AG(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),e=e+(e>>4)&252645135,e+=e>>8,e+=e>>16,e&127}function Zd(e,t){return t>>>e&TG}function Cd(e){return 1<<e}function gL(e,t){return AG(e&t-1)}const RG=(e,t)=>({value:e,previous:t});function Id(e,t,n,r){let i=r;if(!e){const c=r.length;i=new Array(c);for(let f=0;f<c;++f)i[f]=r[f]}return i[t]=n,i}function pL(e,t,n){const r=n.length-1;let i=0,c=0,f=n;if(e)i=c=t;else for(f=new Array(r);i<t;)f[c++]=n[i++];for(++i;i<=r;)f[c++]=n[i++];return e&&(f.length=r),f}function xG(e,t,n,r){const i=r.length;if(e){let g=i;for(;g>=t;)r[g--]=r[g];return r[t]=n,r}let c=0,f=0;const m=new Array(i+1);for(;c<t;)m[f++]=r[c++];for(m[t]=n;c<i;)m[++f]=r[c++];return m}class sl{constructor(){y(this,"_tag","EmptyNode")}modify(t,n,r,i,c,f){const m=r(me());return _n(m)?new sl:(++f.value,new vu(t,i,c,m))}}function Ja(e){return mA(e,"EmptyNode")}function OG(e){return Ja(e)||e._tag==="LeafNode"||e._tag==="CollisionNode"}function w0(e,t){return Ja(e)?!1:t===e.edit}class vu{constructor(t,n,r,i){y(this,"edit");y(this,"hash");y(this,"key");y(this,"value");y(this,"_tag","LeafNode");this.edit=t,this.hash=n,this.key=r,this.value=i}modify(t,n,r,i,c,f){if(Ge(c,this.key)){const g=r(this.value);return g===this.value?this:_n(g)?(--f.value,new sl):w0(this,t)?(this.value=g,this):new vu(t,i,c,g)}const m=r(me());return _n(m)?this:(++f.value,_L(t,n,this.hash,this,i,new vu(t,i,c,m)))}}class PA{constructor(t,n,r){y(this,"edit");y(this,"hash");y(this,"children");y(this,"_tag","CollisionNode");this.edit=t,this.hash=n,this.children=r}modify(t,n,r,i,c,f){if(i===this.hash){const g=w0(this,t),b=this.updateCollisionList(g,t,this.hash,this.children,r,c,f);return b===this.children?this:b.length>1?new PA(t,this.hash,b):b[0]}const m=r(me());return _n(m)?this:(++f.value,_L(t,n,this.hash,this,i,new vu(t,i,c,m)))}updateCollisionList(t,n,r,i,c,f,m){const g=i.length;for(let S=0;S<g;++S){const v=i[S];if("key"in v&&Ge(f,v.key)){const q=v.value,k=c(q);return k===q?i:_n(k)?(--m.value,pL(t,S,i)):Id(t,S,new vu(n,r,f,k),i)}}const b=c(me());return _n(b)?i:(++m.value,Id(t,g,new vu(n,r,f,b),i))}}class eh{constructor(t,n,r){y(this,"edit");y(this,"mask");y(this,"children");y(this,"_tag","IndexedNode");this.edit=t,this.mask=n,this.children=r}modify(t,n,r,i,c,f){const m=this.mask,g=this.children,b=Zd(n,i),S=Cd(b),v=gL(m,S),q=m&S,k=w0(this,t);if(!q){const E=new sl().modify(t,n+Fu,r,i,c,f);return E?g.length>=kG?qG(t,b,E,m,g):new eh(t,m|S,xG(k,v,E,g)):this}const N=g[v],H=N.modify(t,n+Fu,r,i,c,f);if(N===H)return this;let x=m,C;if(Ja(H)){if(x&=~S,!x)return new sl;if(g.length<=2&&OG(g[v^1]))return g[v^1];C=pL(k,v,g)}else C=Id(k,v,H,g);return k?(this.mask=x,this.children=C,this):new eh(t,x,C)}}class HA{constructor(t,n,r){y(this,"edit");y(this,"size");y(this,"children");y(this,"_tag","ArrayNode");this.edit=t,this.size=n,this.children=r}modify(t,n,r,i,c,f){let m=this.size;const g=this.children,b=Zd(n,i),S=g[b],v=(S||new sl).modify(t,n+Fu,r,i,c,f);if(S===v)return this;const q=w0(this,t);let k;if(Ja(S)&&!Ja(v))++m,k=Id(q,b,v,g);else if(!Ja(S)&&Ja(v)){if(--m,m<=CG)return DG(t,m,b,g);k=Id(q,b,new sl,g)}else k=Id(q,b,v,g);return q?(this.size=m,this.children=k,this):new HA(t,m,k)}}function DG(e,t,n,r){const i=new Array(t-1);let c=0,f=0;for(let m=0,g=r.length;m<g;++m)if(m!==n){const b=r[m];b&&!Ja(b)&&(i[c++]=b,f|=1<<m)}return new eh(e,f,i)}function qG(e,t,n,r,i){const c=[];let f=r,m=0;for(let g=0;f;++g)f&1&&(c[g]=i[m++]),f>>>=1;return c[t]=n,new HA(e,m+1,c)}function NG(e,t,n,r,i,c){if(n===i)return new PA(e,n,[c,r]);const f=Zd(t,n),m=Zd(t,i);if(f===m)return g=>new eh(e,Cd(f)|Cd(m),[g]);{const g=f<m?[r,c]:[c,r];return new eh(e,Cd(f)|Cd(m),g)}}function _L(e,t,n,r,i,c){let f,m=t;for(;;){const g=NG(e,m,n,r,i,c);if(typeof g=="function")f=RG(g,f),m=m+Fu;else{let b=g;for(;f!=null;)b=f.value(b),f=f.previous;return b}}}const yL="effect/HashMap",vk=Symbol.for(yL),$G={[vk]:vk,[Symbol.iterator](){return new E0(this,(e,t)=>[e,t])},[nt](){let e=we(yL);for(const t of this)e^=j(we(t[0]),Qe(we(t[1])));return Yt(this,e)},[Ze](e){if(jG(e)){if(e._size!==this._size)return!1;for(const t of this){const n=j(e,VA(t[0],we(t[0])));if(_n(n))return!1;if(!Ge(t[1],n.value))return!1}return!0}return!1},toString(){return hn(this.toJSON())},toJSON(){return{_id:"HashMap",values:Array.from(this).map(Cn)}},[Gt](){return this.toJSON()},pipe(){return xe(this,arguments)}},BA=(e,t,n,r)=>{const i=Object.create($G);return i._editable=e,i._edit=t,i._root=n,i._size=r,i};class E0{constructor(t,n){y(this,"map");y(this,"f");y(this,"v");this.map=t,this.f=n,this.v=bL(this.map._root,this.f,void 0)}next(){if(_n(this.v))return{done:!0,value:void 0};const t=this.v.value;return this.v=zS(t.cont),{done:!1,value:t.value}}[Symbol.iterator](){return new E0(this.map,this.f)}}const zS=e=>e?SL(e[0],e[1],e[2],e[3],e[4]):me(),bL=(e,t,n=void 0)=>{switch(e._tag){case"LeafNode":return Zt(e.value)?pe({value:t(e.key,e.value.value),cont:n}):zS(n);case"CollisionNode":case"ArrayNode":case"IndexedNode":{const r=e.children;return SL(r.length,r,0,t,n)}default:return zS(n)}},SL=(e,t,n,r,i)=>{for(;n<e;){const c=t[n++];if(c&&!Ja(c))return bL(c,r,[e,t,n,r,i])}return zS(i)},IG=BA(!1,0,new sl,0),T0=()=>IG,MG=e=>{const t=wL(T0());for(const n of e)Ep(t,n[0],n[1]);return PG(t)},jG=e=>Ae(e,vk),FG=e=>e&&Ja(e._root),LG=D(2,(e,t)=>VA(e,t,we(t))),VA=D(3,(e,t,n)=>{let r=e._root,i=0;for(;;)switch(r._tag){case"LeafNode":return Ge(t,r.key)?r.value:me();case"CollisionNode":{if(n===r.hash){const c=r.children;for(let f=0,m=c.length;f<m;++f){const g=c[f];if("key"in g&&Ge(t,g.key))return g.value}}return me()}case"IndexedNode":{const c=Zd(i,n),f=Cd(c);if(r.mask&f){r=r.children[gL(r.mask,f)],i+=Fu;break}return me()}case"ArrayNode":{if(r=r.children[Zd(i,n)],r){i+=Fu;break}return me()}default:return me()}}),UG=D(2,(e,t)=>Zt(VA(e,t,we(t)))),Ep=D(3,(e,t,n)=>GA(e,t,()=>pe(n))),zG=D(3,(e,t,n)=>e._editable?(e._root=t,e._size=n,e):t===e._root?e:BA(e._editable,e._edit,t,n)),vL=e=>new E0(e,t=>t),PS=e=>e._size,wL=e=>BA(!0,e._edit+1,e._root,e._size),PG=e=>(e._editable=!1,e),GA=D(3,(e,t,n)=>HG(e,t,we(t),n)),HG=D(4,(e,t,n,r)=>{const i={value:e._size},c=e._root.modify(e._editable?e._edit:NaN,0,r,n,t,i);return j(e,zG(c,i.value))}),yq=D(2,(e,t)=>GA(e,t,me)),BG=D(2,(e,t)=>k0(e,T0(),(n,r,i)=>Ep(n,i,t(r,i)))),EL=D(2,(e,t)=>k0(e,void 0,(n,r,i)=>t(r,i))),k0=D(3,(e,t,n)=>{const r=e._root;if(r._tag==="LeafNode")return Zt(r.value)?n(t,r.value.value,r.key):t;if(r._tag==="EmptyNode")return t;const i=[r.children];let c;for(;c=i.pop();)for(let f=0,m=c.length;f<m;){const g=c[f++];g&&!Ja(g)&&(g._tag==="LeafNode"?Zt(g.value)&&(t=n(t,g.value.value,g.key)):i.push(g.children))}return t}),TL="effect/HashSet",wk=Symbol.for(TL),VG={[wk]:wk,[Symbol.iterator](){return vL(this._keyMap)},[nt](){return Yt(this,Qe(we(this._keyMap))(we(TL)))},[Ze](e){return GG(e)?PS(this._keyMap)===PS(e._keyMap)&&Ge(this._keyMap,e._keyMap):!1},toString(){return hn(this.toJSON())},toJSON(){return{_id:"HashSet",values:Array.from(this).map(Cn)}},[Gt](){return this.toJSON()},pipe(){return xe(this,arguments)}},C0=e=>{const t=Object.create(VG);return t._keyMap=e,t},GG=e=>Ae(e,wk),KG=C0(T0()),A0=()=>KG,QG=e=>{const t=KA(A0());for(const n of e)Tp(t,n);return QA(t)},YG=(...e)=>{const t=KA(A0());for(const n of e)Tp(t,n);return QA(t)},WG=D(2,(e,t)=>UG(e._keyMap,t)),JG=e=>PS(e._keyMap),KA=e=>C0(wL(e._keyMap)),QA=e=>(e._keyMap._editable=!1,e),kL=D(2,(e,t)=>{const n=KA(e);return t(n),QA(n)}),Tp=D(2,(e,t)=>e._keyMap._editable?(Ep(t,!0)(e._keyMap),e):C0(Ep(t,!0)(e._keyMap))),CL=D(2,(e,t)=>e._keyMap._editable?(yq(t)(e._keyMap),e):C0(yq(t)(e._keyMap))),XG=D(2,(e,t)=>kL(e,n=>{for(const r of t)CL(n,r)})),ZG=D(2,(e,t)=>kL(A0(),n=>{eK(e,r=>Tp(n,r));for(const r of t)Tp(n,r)})),eK=D(2,(e,t)=>EL(e._keyMap,(n,r)=>t(r))),tK=D(3,(e,t,n)=>k0(e._keyMap,t,(r,i,c)=>n(r,c))),Lu=A0,nK=QG,R0=YG,YA=WG,WA=JG,Md=Tp,JA=CL,bq=XG,kp=ZG,Cp=tK,Sq=Symbol.for("effect/MutableRef"),rK={[Sq]:Sq,toString(){return hn(this.toJSON())},toJSON(){return{_id:"MutableRef",current:Cn(this.current)}},[Gt](){return this.toJSON()},pipe(){return xe(this,arguments)}},cf=e=>{const t=Object.create(rK);return t.current=e,t},sK=D(3,(e,t,n)=>Ge(t,e.current)?(e.current=n,!0):!1),Dt=e=>e.current,lf=D(2,(e,t)=>(e.current=t,e)),x0="effect/FiberId",Uu=Symbol.for(x0),th="None",Ek="Runtime",Tk="Composite",aK=qn(`${x0}-${th}`);var PI;let iK=class{constructor(){y(this,PI,Uu);y(this,"_tag",th);y(this,"id",-1);y(this,"startTimeMillis",-1)}[(PI=Uu,nt)](){return aK}[Ze](t){return ZA(t)&&t._tag===th}toString(){return hn(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag}}[Gt](){return this.toJSON()}};var HI;class XA{constructor(t,n){y(this,"id");y(this,"startTimeMillis");y(this,HI,Uu);y(this,"_tag",Ek);this.id=t,this.startTimeMillis=n}[(HI=Uu,nt)](){return Yt(this,qn(`${x0}-${this._tag}-${this.id}-${this.startTimeMillis}`))}[Ze](t){return ZA(t)&&t._tag===Ek&&this.id===t.id&&this.startTimeMillis===t.startTimeMillis}toString(){return hn(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag,id:this.id,startTimeMillis:this.startTimeMillis}}[Gt](){return this.toJSON()}}var BI;let AL=class{constructor(t,n){y(this,"left");y(this,"right");y(this,BI,Uu);y(this,"_tag",Tk);y(this,"_hash");this.left=t,this.right=n}[(BI=Uu,nt)](){return j(qn(`${x0}-${this._tag}`),Qe(we(this.left)),Qe(we(this.right)),Yt(this))}[Ze](t){return ZA(t)&&t._tag===Tk&&Ge(this.left,t.left)&&Ge(this.right,t.right)}toString(){return hn(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag,left:Cn(this.left),right:Cn(this.right)}}[Gt](){return this.toJSON()}};const RL=new iK,oK=(e,t)=>new XA(e,t),cK=(e,t)=>new AL(e,t),ZA=e=>Ae(e,Uu),xL=D(2,(e,t)=>e._tag===th?t:t._tag===th?e:new AL(e,t)),lK=e=>j(e,Cp(RL,(t,n)=>xL(n)(t))),HS=e=>{switch(e._tag){case th:return Lu();case Ek:return R0(e.id);case Tk:return j(HS(e.left),kp(HS(e.right)))}},vq=St(Symbol.for("effect/Fiber/Id/_fiberCounter"),()=>cf(0)),uK=(e,t)=>new XA(e,t),O0=e=>Array.from(HS(e)).map(n=>`#${n}`).join(","),fK=()=>{const e=Dt(vq);return j(vq,lf(e+1)),new XA(e,Date.now())},Oa=RL,dK=oK,hK=cK,Xc=xL,mK=lK,eR=HS,OL=uK,gK=O0,DL=fK,D0=T0,pK=MG,_K=FG,qL=LG,BS=Ep,NL=vL,$L=PS,yK=GA,bK=BG,SK=EL,IL=k0,Ap=Symbol.for("effect/List"),kk=e=>Ht(e),vK=e=>jj(h_(e),kk),wK=vK(Ge),EK={[Ap]:Ap,_tag:"Cons",toString(){return hn(this.toJSON())},toJSON(){return{_id:"List",_tag:"Cons",values:kk(this).map(Cn)}},[Gt](){return this.toJSON()},[Ze](e){return jL(e)&&this._tag===e._tag&&wK(this,e)},[nt](){return Yt(this,c_(kk(this)))},[Symbol.iterator](){let e=!1,t=this;return{next(){if(e)return this.return();if(t._tag==="Nil")return e=!0,this.return();const n=t.head;return t=t.tail,{done:e,value:n}},return(n){return e||(e=!0),{done:!0,value:n}}}},pipe(){return xe(this,arguments)}},VS=(e,t)=>{const n=Object.create(EK);return n.head=e,n.tail=t,n},TK=qn("Nil"),kK={[Ap]:Ap,_tag:"Nil",toString(){return hn(this.toJSON())},toJSON(){return{_id:"List",_tag:"Nil"}},[Gt](){return this.toJSON()},[nt](){return TK},[Ze](e){return jL(e)&&this._tag===e._tag},[Symbol.iterator](){return{next(){return{done:!0,value:void 0}}}},pipe(){return xe(this,arguments)}},ML=Object.create(kK),jL=e=>Ae(e,Ap),Do=e=>e._tag==="Nil",tR=e=>e._tag==="Cons",CK=()=>ML,zu=(e,t)=>VS(e,t),nh=CK,nR=e=>VS(e,ML),AK=D(2,(e,t)=>xK(t,e)),RK=D(2,(e,t)=>zu(t,e)),xK=D(2,(e,t)=>{if(Do(e))return t;if(Do(t))return e;{const n=VS(t.head,e);let r=n,i=t.tail;for(;!Do(i);){const c=VS(i.head,e);r.tail=c,r=c,i=i.tail}return n}}),OK=D(3,(e,t,n)=>{let r=t,i=e;for(;!Do(i);)r=n(r,i.head),i=i.tail;return r}),DK=e=>{let t=nh(),n=e;for(;!Do(n);)t=RK(t,n.head),n=n.tail;return t},q0=(function(){function e(t){t&&Object.assign(this,t)}return e.prototype=SA,e})(),qK=Symbol.for("effect/DifferContextPatch");function wq(e){return e}const y_={...q0.prototype,[qK]:{_Value:wq,_Patch:wq}},NK=Object.assign(Object.create(y_),{_tag:"Empty"}),$K=Object.create(NK),FL=()=>$K,IK=Object.assign(Object.create(y_),{_tag:"AndThen"}),MK=(e,t)=>{const n=Object.create(IK);return n.first=e,n.second=t,n},jK=Object.assign(Object.create(y_),{_tag:"AddService"}),FK=(e,t)=>{const n=Object.create(jK);return n.key=e,n.service=t,n},LK=Object.assign(Object.create(y_),{_tag:"RemoveService"}),UK=e=>{const t=Object.create(LK);return t.key=e,t},zK=Object.assign(Object.create(y_),{_tag:"UpdateService"}),PK=(e,t)=>{const n=Object.create(zK);return n.key=e,n.update=t,n},HK=(e,t)=>{const n=new Map(e.unsafeMap);let r=FL();for(const[i,c]of t.unsafeMap.entries())if(n.has(i)){const f=n.get(i);n.delete(i),Ge(f,c)||(r=oS(PK(i,()=>c))(r))}else n.delete(i),r=oS(FK(i,c))(r);for(const[i]of n.entries())r=oS(UK(i))(r);return r},oS=D(2,(e,t)=>MK(e,t)),BK=D(2,(e,t)=>{if(e._tag==="Empty")return t;let n=!1,r=Sn(e);const i=new Map(t.unsafeMap);for(;Ii(r);){const f=Ri(r),m=Co(r);switch(f._tag){case"Empty":{r=m;break}case"AddService":{i.set(f.key,f.service),r=m;break}case"AndThen":{r=Gr(Gr(m,f.second),f.first);break}case"RemoveService":{i.delete(f.key),r=m;break}case"UpdateService":{i.set(f.key,f.update(i.get(f.key))),n=!0,r=m;break}}}if(!n)return $u(i);const c=new Map;for(const[f]of t.unsafeMap)i.has(f)&&(c.set(f,i.get(f)),i.delete(f));for(const[f,m]of i)c.set(f,m);return $u(c)}),VK=Symbol.for("effect/DifferHashSetPatch");function AT(e){return e}const N0={...q0.prototype,[VK]:{_Value:AT,_Key:AT,_Patch:AT}},GK=Object.assign(Object.create(N0),{_tag:"Empty"}),KK=Object.create(GK),LL=()=>KK,QK=Object.assign(Object.create(N0),{_tag:"AndThen"}),YK=(e,t)=>{const n=Object.create(QK);return n.first=e,n.second=t,n},WK=Object.assign(Object.create(N0),{_tag:"Add"}),JK=e=>{const t=Object.create(WK);return t.value=e,t},XK=Object.assign(Object.create(N0),{_tag:"Remove"}),ZK=e=>{const t=Object.create(XK);return t.value=e,t},eQ=(e,t)=>{const[n,r]=Cp([e,LL()],([i,c],f)=>YA(f)(i)?[JA(f)(i),c]:[i,Ck(JK(f))(c)])(t);return Cp(r,(i,c)=>Ck(ZK(c))(i))(n)},Ck=D(2,(e,t)=>YK(e,t)),tQ=D(2,(e,t)=>{if(e._tag==="Empty")return t;let n=t,r=Sn(e);for(;Ii(r);){const i=Ri(r),c=Co(r);switch(i._tag){case"Empty":{r=c;break}case"AndThen":{r=Gr(i.first)(Gr(i.second)(c));break}case"Add":{n=Md(i.value)(n),r=c;break}case"Remove":n=JA(i.value)(n),r=c}}return n}),nQ=Symbol.for("effect/DifferReadonlyArrayPatch");function Eq(e){return e}const b_={...q0.prototype,[nQ]:{_Value:Eq,_Patch:Eq}},rQ=Object.assign(Object.create(b_),{_tag:"Empty"}),sQ=Object.create(rQ),UL=()=>sQ,aQ=Object.assign(Object.create(b_),{_tag:"AndThen"}),iQ=(e,t)=>{const n=Object.create(aQ);return n.first=e,n.second=t,n},oQ=Object.assign(Object.create(b_),{_tag:"Append"}),cQ=e=>{const t=Object.create(oQ);return t.values=e,t},lQ=Object.assign(Object.create(b_),{_tag:"Slice"}),uQ=(e,t)=>{const n=Object.create(lQ);return n.from=e,n.until=t,n},fQ=Object.assign(Object.create(b_),{_tag:"Update"}),dQ=(e,t)=>{const n=Object.create(fQ);return n.index=e,n.patch=t,n},hQ=e=>{let t=0,n=UL();for(;t<e.oldValue.length&&t<e.newValue.length;){const r=e.oldValue[t],i=e.newValue[t],c=e.differ.diff(r,i);Ge(c,e.differ.empty)||(n=cS(n,dQ(t,c))),t=t+1}return t<e.oldValue.length&&(n=cS(n,uQ(0,t))),t<e.newValue.length&&(n=cS(n,cQ(yV(t)(e.newValue)))),n},cS=D(2,(e,t)=>iQ(e,t)),mQ=D(3,(e,t,n)=>{if(e._tag==="Empty")return t;let r=t.slice(),i=pa(e);for(;nS(i);){const c=Ss(i),f=Du(i);switch(c._tag){case"Empty":{i=f;break}case"AndThen":{f.unshift(c.first,c.second),i=f;break}case"Append":{for(const m of c.values)r.push(m);i=f;break}case"Slice":{r=r.slice(c.from,c.until),i=f;break}case"Update":{r[c.index]=n.patch(c.patch,r[c.index]),i=f;break}}}return r}),gQ=Symbol.for("effect/Differ"),pQ={[gQ]:{_P:Ie,_V:Ie},pipe(){return xe(this,arguments)}},$h=e=>{const t=Object.create(pQ);return t.empty=e.empty,t.diff=e.diff,t.combine=e.combine,t.patch=e.patch,t},_Q=()=>$h({empty:FL(),combine:(e,t)=>oS(t)(e),diff:(e,t)=>HK(e,t),patch:(e,t)=>BK(t)(e)}),yQ=()=>$h({empty:LL(),combine:(e,t)=>Ck(t)(e),diff:(e,t)=>eQ(e,t),patch:(e,t)=>tQ(t)(e)}),bQ=e=>$h({empty:UL(),combine:(t,n)=>cS(t,n),diff:(t,n)=>hQ({oldValue:t,newValue:n,differ:e}),patch:(t,n)=>mQ(t,n,e)}),zL=()=>SQ((e,t)=>t),SQ=e=>$h({empty:Ie,combine:(t,n)=>t===Ie?n:n===Ie?t:r=>n(t(r)),diff:(t,n)=>Ge(t,n)?Ie:e0(n),patch:(t,n)=>e(n,t(n))}),Rp=255,PL=8,Ak=e=>e&Rp,Rk=e=>e>>PL&Rp,S_=(e,t)=>(e&Rp)+((t&e&Rp)<<PL),vQ=S_(0,0),wQ=e=>S_(e,e),EQ=e=>S_(e,0),TQ=D(2,(e,t)=>S_(Ak(e)&~t,Rk(e))),kQ=D(2,(e,t)=>e|t),CQ=e=>~e>>>0&Rp,AQ=0,Ih=1,RQ=2,HL=4,xk=16,BL=32,xQ=e=>$0(e,BL),OQ=D(2,(e,t)=>e|t),Uc=e=>VL(e)&&!qQ(e),VL=e=>$0(e,Ih),$0=D(2,(e,t)=>(e&t)!==0),GL=(...e)=>e.reduce((t,n)=>t|n,0),DQ=GL(AQ),Tq=e=>$0(e,HL),qQ=e=>$0(e,xk),wu=D(2,(e,t)=>S_(e^t,t)),jd=D(2,(e,t)=>e&(CQ(Ak(t))|Rk(t))|Ak(t)&Rk(t)),kq=$h({empty:vQ,diff:(e,t)=>wu(e,t),combine:(e,t)=>kQ(t)(e),patch:(e,t)=>jd(t,e)}),NQ=wQ,KL=EQ,Cq=TQ,QL=(e,t)=>({_tag:"Par",left:e,right:t}),jb=(e,t)=>({_tag:"Seq",left:e,right:t}),$Q=e=>{let t=nR(e),n=nh();for(;;){const[r,i]=OK(t,[YL(),nh()],([c,f],m)=>{const[g,b]=IQ(m);return[UQ(c,g),AK(f,b)]});if(n=MQ(n,r),Do(i))return DK(n);t=i}throw new Error("BUG: BlockedRequests.flatten - please report an issue at https://github.com/Effect-TS/effect/issues")},IQ=e=>{let t=e,n=YL(),r=nh(),i=nh();for(;;)switch(t._tag){case"Empty":{if(Do(r))return[n,i];t=r.head,r=r.tail;break}case"Par":{r=zu(t.right,r),t=t.left;break}case"Seq":{const c=t.left,f=t.right;switch(c._tag){case"Empty":{t=f;break}case"Par":{const m=c.left,g=c.right;t=QL(jb(m,f),jb(g,f));break}case"Seq":{const m=c.left,g=c.right;t=jb(m,jb(g,f));break}case"Single":{t=c,i=zu(f,i);break}}break}case"Single":{if(n=LQ(n,t),Do(r))return[n,i];t=r.head,r=r.tail;break}}throw new Error("BUG: BlockedRequests.step - please report an issue at https://github.com/Effect-TS/effect/issues")},MQ=(e,t)=>{if(Do(e))return nR(RT(t));if(zQ(t))return e;const n=KQ(e.head),r=PQ(t);return n.length===1&&r.length===1&&Ge(n[0],r[0])?zu(GQ(e.head,RT(t)),e.tail):zu(RT(t),e)},jQ=Symbol.for("effect/RequestBlock/RequestBlockParallel"),FQ={_R:e=>e};var VI;VI=jQ;class rR{constructor(t){y(this,"map");y(this,VI,FQ);this.map=t}}const YL=()=>new rR(D0()),LQ=(e,t)=>new rR(yK(e.map,t.dataSource,n=>V7(bu(n,wp(t.blockedRequest)),()=>Sn(t.blockedRequest)))),UQ=(e,t)=>new rR(IL(e.map,t.map,(n,r,i)=>BS(n,i,Bt(qL(n,i),{onNone:()=>r,onSome:c=>pn(r,c)})))),zQ=e=>_K(e.map),PQ=e=>Array.from(NL(e.map)),RT=e=>VQ(bK(e.map,t=>Sn(t))),HQ=Symbol.for("effect/RequestBlock/RequestBlockSequential"),BQ={_R:e=>e};var GI;GI=HQ;class WL{constructor(t){y(this,"map");y(this,GI,BQ);this.map=t}}const VQ=e=>new WL(e),GQ=(e,t)=>new WL(IL(t.map,e.map,(n,r,i)=>BS(n,i,Bt(qL(n,i),{onNone:()=>an(),onSome:c=>pn(c,r)})))),KQ=e=>Array.from(NL(e.map)),QQ=e=>Array.from(e.map),Mh="Die",Pu="Empty",uf="Fail",jh="Interrupt",rh="Parallel",sh="Sequential",JL="effect/Cause",XL=Symbol.for(JL),YQ={_E:e=>e},Fh={[XL]:YQ,[nt](){return j(we(JL),Qe(we(iY(this))),Yt(this))},[Ze](e){return sR(e)&&aY(this,e)},pipe(){return xe(this,arguments)},toJSON(){switch(this._tag){case"Empty":return{_id:"Cause",_tag:this._tag};case"Die":return{_id:"Cause",_tag:this._tag,defect:Cn(this.defect)};case"Interrupt":return{_id:"Cause",_tag:this._tag,fiberId:this.fiberId.toJSON()};case"Fail":return{_id:"Cause",_tag:this._tag,failure:Cn(this.error)};case"Sequential":case"Parallel":return{_id:"Cause",_tag:this._tag,left:Cn(this.left),right:Cn(this.right)}}},toString(){return yl(this)},[Gt](){return this.toJSON()}},Fo=(()=>{const e=Object.create(Fh);return e._tag=Pu,e})(),Hu=e=>{const t=Object.create(Fh);return t._tag=uf,t.error=e,t},ns=e=>{const t=Object.create(Fh);return t._tag=Mh,t.defect=e,t},Sa=e=>{const t=Object.create(Fh);return t._tag=jh,t.fiberId=e,t},Mi=(e,t)=>{const n=Object.create(Fh);return n._tag=rh,n.left=e,n.right=t,n},tr=(e,t)=>{const n=Object.create(Fh);return n._tag=sh,n.left=e,n.right=t,n},sR=e=>Ae(e,XL),WQ=e=>e._tag===Pu,JQ=e=>e._tag===uf,aR=e=>e._tag===Mh,iR=e=>e._tag===Pu?!0:ah(e,!0,(t,n)=>{switch(n._tag){case Pu:return pe(t);case Mh:case uf:case jh:return pe(!1);default:return me()}}),oR=e=>Zt(eY(e)),I0=e=>F0(void 0,cY)(e),XQ=e=>jo(ah(e,an(),(t,n)=>n._tag===uf?pe(j(t,Gr(n.error))):me())),ZL=e=>jo(ah(e,an(),(t,n)=>n._tag===Mh?pe(j(t,Gr(n.defect))):me())),cR=e=>ah(e,Lu(),(t,n)=>n._tag===jh?pe(j(t,Md(n.fiberId))):me()),eU=e=>j0(e,t=>t._tag===uf?pe(t.error):me()),M0=e=>{const t=eU(e);switch(t._tag){case"None":return He(e);case"Some":return Ue(t.value)}},ZQ=e=>v_(e,{onEmpty:pe(Fo),onFail:bu(Hu),onDie:t=>pe(ns(t)),onInterrupt:t=>pe(Sa(t)),onSequential:qS(tr),onParallel:qS(Mi)}),eY=e=>j0(e,t=>t._tag===jh?pe(t.fiberId):me()),tY=e=>v_(e,{onEmpty:me(),onFail:()=>me(),onDie:t=>pe(ns(t)),onInterrupt:()=>me(),onSequential:qS(tr),onParallel:qS(Mi)}),Aq=e=>v_(e,{onEmpty:Fo,onFail:()=>Fo,onDie:ns,onInterrupt:Sa,onSequential:tr,onParallel:Mi}),nY=e=>v_(e,{onEmpty:Fo,onFail:ns,onDie:ns,onInterrupt:Sa,onSequential:tr,onParallel:Mi}),rY=D(2,(e,t)=>sY(e,n=>Hu(t(n)))),sY=D(2,(e,t)=>v_(e,{onEmpty:Fo,onFail:n=>t(n),onDie:n=>ns(n),onInterrupt:n=>Sa(n),onSequential:(n,r)=>tr(n,r),onParallel:(n,r)=>Mi(n,r)})),aY=(e,t)=>{let n=Sn(e),r=Sn(t);for(;Ii(n)&&Ii(r);){const[i,c]=j(Ri(n),ah([Lu(),an()],([g,b],S)=>{const[v,q]=Ok(S);return pe([j(g,kp(v)),j(b,pn(q))])})),[f,m]=j(Ri(r),ah([Lu(),an()],([g,b],S)=>{const[v,q]=Ok(S);return pe([j(g,kp(v)),j(b,pn(q))])}));if(!Ge(i,f))return!1;n=c,r=m}return!0},iY=e=>oY(Sn(e),an()),oY=(e,t)=>{for(;;){const[n,r]=j(e,CA([Lu(),an()],([c,f],m)=>{const[g,b]=Ok(m);return[j(c,kp(g)),j(f,pn(b))]})),i=WA(n)>0?j(t,Gr(n)):t;if(y0(r))return jo(i);e=r,t=i}throw new Error(s0("Cause.flattenCauseLoop"))},j0=D(2,(e,t)=>{const n=[e];for(;n.length>0;){const r=n.pop(),i=t(r);switch(i._tag){case"None":{switch(r._tag){case sh:case rh:{n.push(r.right),n.push(r.left);break}}break}case"Some":return i}}return me()}),Ok=e=>{let t=e;const n=[];let r=Lu(),i=an();for(;t!==void 0;)switch(t._tag){case Pu:{if(n.length===0)return[r,i];t=n.pop();break}case uf:{if(r=Md(r,kT(t._tag,t.error)),n.length===0)return[r,i];t=n.pop();break}case Mh:{if(r=Md(r,kT(t._tag,t.defect)),n.length===0)return[r,i];t=n.pop();break}case jh:{if(r=Md(r,kT(t._tag,t.fiberId)),n.length===0)return[r,i];t=n.pop();break}case sh:{switch(t.left._tag){case Pu:{t=t.right;break}case sh:{t=tr(t.left.left,tr(t.left.right,t.right));break}case rh:{t=Mi(tr(t.left.left,t.right),tr(t.left.right,t.right));break}default:{i=Gr(i,t.right),t=t.left;break}}break}case rh:{n.push(t.right),t=t.left;break}}throw new Error(s0("Cause.evaluateCauseLoop"))},cY={emptyCase:eq,failCase:Ni,dieCase:Ni,interruptCase:eq,sequentialCase:(e,t,n)=>t&&n,parallelCase:(e,t,n)=>t&&n},Rq="SequentialCase",xq="ParallelCase",v_=D(2,(e,{onDie:t,onEmpty:n,onFail:r,onInterrupt:i,onParallel:c,onSequential:f})=>F0(e,void 0,{emptyCase:()=>n,failCase:(m,g)=>r(g),dieCase:(m,g)=>t(g),interruptCase:(m,g)=>i(g),sequentialCase:(m,g,b)=>f(g,b),parallelCase:(m,g,b)=>c(g,b)})),ah=D(3,(e,t,n)=>{let r=t,i=e;const c=[];for(;i!==void 0;){const f=n(r,i);switch(r=Zt(f)?f.value:r,i._tag){case sh:{c.push(i.right),i=i.left;break}case rh:{c.push(i.right),i=i.left;break}default:{i=void 0;break}}i===void 0&&c.length>0&&(i=c.pop())}return r}),F0=D(3,(e,t,n)=>{const r=[e],i=[];for(;r.length>0;){const f=r.pop();switch(f._tag){case Pu:{i.push(He(n.emptyCase(t)));break}case uf:{i.push(He(n.failCase(t,f.error)));break}case Mh:{i.push(He(n.dieCase(t,f.defect)));break}case jh:{i.push(He(n.interruptCase(t,f.fiberId)));break}case sh:{r.push(f.right),r.push(f.left),i.push(Ue({_tag:Rq}));break}case rh:{r.push(f.right),r.push(f.left),i.push(Ue({_tag:xq}));break}}}const c=[];for(;i.length>0;){const f=i.pop();switch(f._tag){case"Left":{switch(f.left._tag){case Rq:{const m=c.pop(),g=c.pop(),b=n.sequentialCase(t,m,g);c.push(b);break}case xq:{const m=c.pop(),g=c.pop(),b=n.parallelCase(t,m,g);c.push(b);break}}break}case"Right":{c.push(f.right);break}}}if(c.length===0)throw new Error("BUG: Cause.reduceWithContext - please report an issue at https://github.com/Effect-TS/effect/issues");return c.pop()}),yl=(e,t)=>I0(e)?"All fibers interrupted without errors.":lR(e).map(function(n){return(t==null?void 0:t.renderErrorCause)!==!0||n.cause===void 0?n.stack:`${n.stack} {
${tU(n.cause,"  ")}
}`}).join(`
`),tU=(e,t)=>{const n=e.stack.split(`
`);let r=`${t}[cause]: ${n[0]}`;for(let i=1,c=n.length;i<c;i++)r+=`
${t}${n[i]}`;return e.cause&&(r+=` {
${tU(e.cause,`${t}  `)}
${t}}`),r};class GS extends globalThis.Error{constructor(n){const r=typeof n=="object"&&n!==null,i=Error.stackTraceLimit;Error.stackTraceLimit=1;super(nU(n),r&&"cause"in n&&typeof n.cause<"u"?{cause:new GS(n.cause)}:void 0);y(this,"span");this.message===""&&(this.message="An error has occurred"),Error.stackTraceLimit=i,this.name=n instanceof Error?n.name:"Error",r&&(ih in n&&(this.span=n[ih]),Object.keys(n).forEach(c=>{c in this||(this[c]=n[c])})),this.stack=uY(`${this.name}: ${this.message}`,n instanceof Error&&n.stack?n.stack:"",this.span)}}const nU=e=>{if(typeof e=="string")return e;if(typeof e=="object"&&e!==null&&e instanceof Error)return e.message;try{if(Ae(e,"toString")&&Ah(e.toString)&&e.toString!==Object.prototype.toString&&e.toString!==globalThis.Array.prototype.toString)return e.toString()}catch{}return Vj(e)},lY=/\((.*)\)/g,KS=St("effect/Tracer/spanToTrace",()=>new WeakMap),uY=(e,t,n)=>{const r=[e],i=t.startsWith(e)?t.slice(e.length).split(`
`):t.split(`
`);for(let c=1;c<i.length;c++){if(i[c].includes(" at new BaseEffectError")||i[c].includes(" at new YieldableError")){c++;continue}if(i[c].includes("Generator.next")||i[c].includes("effect_internal_function"))break;r.push(i[c].replace(/at .*effect_instruction_i.*\((.*)\)/,"at $1").replace(/EffectPrimitive\.\w+/,"<anonymous>"))}if(n){let c=n,f=0;for(;c&&c._tag==="Span"&&f<10;){const m=KS.get(c);if(typeof m=="function"){const g=m();if(typeof g=="string"){const b=g.matchAll(lY);let S=!1;for(const[,v]of b)S=!0,r.push(`    at ${c.name} (${v})`);S||r.push(`    at ${c.name} (${g.replace(/^at /,"")})`)}else r.push(`    at ${c.name}`)}else r.push(`    at ${c.name}`);c=ba(c.parent),f++}}return r.join(`
`)},ih=Symbol.for("effect/SpanAnnotation"),lR=e=>F0(e,void 0,{emptyCase:()=>[],dieCase:(t,n)=>[new GS(n)],failCase:(t,n)=>[new GS(n)],interruptCase:()=>[],parallelCase:(t,n,r)=>[...n,...r],sequentialCase:(t,n,r)=>[...n,...r]}),w_="Pending",L0="Done",fY="effect/Deferred",rU=Symbol.for(fY),dY={_E:e=>e,_A:e=>e},hY=e=>({_tag:w_,joiners:e}),sU=e=>({_tag:L0,effect:e});class Lh{constructor(t){y(this,"self");y(this,"called",!1);this.self=t}next(t){return this.called?{value:t,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(t){return{value:t,done:!0}}throw(t){throw t}[Symbol.iterator](){return new Lh(this.self)}}const aU=(e,t)=>{const n=new mr("Blocked");return n.effect_instruction_i0=e,n.effect_instruction_i1=t,n},mY=e=>{const t=new mr("RunBlocked");return t.effect_instruction_i0=e,t},Bu=Symbol.for("effect/Effect");class gY{constructor(t,n){y(this,"patch");y(this,"op");y(this,"_op",bA);this.patch=t,this.op=n}}var KI;class mr{constructor(t){y(this,"_op");y(this,"effect_instruction_i0");y(this,"effect_instruction_i1");y(this,"effect_instruction_i2");y(this,"trace");y(this,KI,Ou);this._op=t}[(KI=Bu,Ze)](t){return this===t}[nt](){return Yt(this,a0(this))}pipe(){return xe(this,arguments)}toJSON(){return{_id:"Effect",_op:this._op,effect_instruction_i0:Cn(this.effect_instruction_i0),effect_instruction_i1:Cn(this.effect_instruction_i1),effect_instruction_i2:Cn(this.effect_instruction_i2)}}toString(){return hn(this.toJSON())}[Gt](){return this.toJSON()}[Symbol.iterator](){return new Lh(new Rh(this))}}var QI;class iU{constructor(t){y(this,"_op");y(this,"effect_instruction_i0");y(this,"effect_instruction_i1");y(this,"effect_instruction_i2");y(this,"trace");y(this,QI,Ou);this._op=t,this._tag=t}[(QI=Bu,Ze)](t){return V0(t)&&t._op==="Failure"&&Ge(this.effect_instruction_i0,t.effect_instruction_i0)}[nt](){return j(qn(this._tag),Qe(we(this.effect_instruction_i0)),Yt(this))}get cause(){return this.effect_instruction_i0}pipe(){return xe(this,arguments)}toJSON(){return{_id:"Exit",_tag:this._op,cause:this.cause.toJSON()}}toString(){return hn(this.toJSON())}[Gt](){return this.toJSON()}[Symbol.iterator](){return new Lh(new Rh(this))}}var YI;class oU{constructor(t){y(this,"_op");y(this,"effect_instruction_i0");y(this,"effect_instruction_i1");y(this,"effect_instruction_i2");y(this,"trace");y(this,YI,Ou);this._op=t,this._tag=t}[(YI=Bu,Ze)](t){return V0(t)&&t._op==="Success"&&Ge(this.effect_instruction_i0,t.effect_instruction_i0)}[nt](){return j(qn(this._tag),Qe(we(this.effect_instruction_i0)),Yt(this))}get value(){return this.effect_instruction_i0}pipe(){return xe(this,arguments)}toJSON(){return{_id:"Exit",_tag:this._op,value:Cn(this.value)}}toString(){return hn(this.toJSON())}[Gt](){return this.toJSON()}[Symbol.iterator](){return new Lh(new Rh(this))}}const ta=e=>Ae(e,Bu),yt=e=>{const t=new mr(Qj);return t.effect_instruction_i0=e,t},uR=D(3,(e,t,n)=>ks(r=>se(e,i=>se(ei(Ne(()=>r(t(i)))),c=>Ne(()=>n(i,c)).pipe(Ts({onFailure:f=>{switch(c._tag){case kr:return en(tr(c.effect_instruction_i0,f));case Cr:return en(f)}},onSuccess:()=>c})))))),rr=D(2,(e,t)=>se(e,()=>fe(t))),na=e=>rr(e,void 0),cU=function(){const e=new mr(l_);switch(arguments.length){case 2:{e.effect_instruction_i0=arguments[0],e.commit=arguments[1];break}case 3:{e.effect_instruction_i0=arguments[0],e.effect_instruction_i1=arguments[1],e.commit=arguments[2];break}case 4:{e.effect_instruction_i0=arguments[0],e.effect_instruction_i1=arguments[1],e.effect_instruction_i2=arguments[2],e.commit=arguments[3];break}default:throw new Error(s0("you're not supposed to end up here"))}return e},xp=(e,t=Oa)=>{const n=new mr(Zg);let r;return n.effect_instruction_i0=i=>{r=e(i)},n.effect_instruction_i1=t,bl(n,i=>ta(r)?r:it)},Vc=(e,t=Oa)=>Ne(()=>xp(e,t)),Lo=(e,t=Oa)=>cU(e,function(){let n,r;function i(g){n?n(g):r===void 0&&(r=g)}const c=new mr(Zg);c.effect_instruction_i0=g=>{n=g,r&&g(r)},c.effect_instruction_i1=t;let f,m;return this.effect_instruction_i0.length!==1?(m=new AbortController,f=nn(()=>this.effect_instruction_i0(i,m.signal))):f=nn(()=>this.effect_instruction_i0(i)),f||m?bl(c,g=>(m&&m.abort(),f??it)):c}),Uh=D(2,(e,t)=>{const n=new mr(eS);return n.effect_instruction_i0=e,n.effect_instruction_i1=t,n}),oh=D(2,(e,t)=>ji(e,{onFailure:t,onSuccess:fe})),pY=D(3,(e,t,n)=>Uh(e,r=>{const i=M0(r);switch(i._tag){case"Left":return t(i.left)?n(i.left):en(r);case"Right":return en(i.right)}})),Oq=Symbol.for("effect/OriginalAnnotation"),fR=(e,t)=>Zt(t)?new Proxy(e,{has(n,r){return r===ih||r===Oq||r in n},get(n,r){return r===ih?t.value:r===Oq?e:n[r]}}):e,Op=e=>Hi(e)&&!(ih in e)?yt(t=>en(ns(fR(e,kR(t))))):en(ns(e)),Dk=e=>lU(()=>ns(new JY(e))),ch=e=>ji(e,{onFailure:t=>fe(Ue(t)),onSuccess:t=>fe(He(t))}),ei=e=>uU(e,{onFailure:zt,onSuccess:Pt}),mn=e=>Hi(e)&&!(ih in e)?yt(t=>en(Hu(fR(e,kR(t))))):en(Hu(e)),U0=e=>se(he(e),mn),en=e=>{const t=new iU(kr);return t.effect_instruction_i0=e,t},lU=e=>se(he(e),en),E_=yt(e=>fe(e.id())),ff=e=>yt(t=>e(t.id())),se=D(2,(e,t)=>{const n=new mr(RS);return n.effect_instruction_i0=e,n.effect_instruction_i1=t,n}),_Y=D(2,(e,t)=>se(e,n=>{const r=typeof t=="function"?t(n):t;return ta(r)?r:Lj(r)?xp(i=>{r.then(c=>i(fe(c)),c=>i(mn(new bR(c,"An unknown error occurred in Effect.andThen"))))}):fe(r)})),yY=e=>{const t=new mr("OnStep");return t.effect_instruction_i0=e,t},zh=e=>se(e,Ie),uU=D(2,(e,t)=>Ts(e,{onFailure:n=>fe(t.onFailure(n)),onSuccess:n=>fe(t.onSuccess(n))})),Ts=D(2,(e,t)=>{const n=new mr(xS);return n.effect_instruction_i0=e,n.effect_instruction_i1=t.onFailure,n.effect_instruction_i2=t.onSuccess,n}),ji=D(2,(e,t)=>Ts(e,{onFailure:n=>{if(ZL(n).length>0)return en(nY(n));const i=XQ(n);return i.length>0?t.onFailure(S0(i)):en(n)},onSuccess:t.onSuccess})),Ao=D(2,(e,t)=>Ne(()=>{const n=Ht(e),r=o0(n.length);let i=0;return rr(gR({while:()=>i<n.length,body:()=>t(n[i],i),step:c=>{r[i++]=c}}),r)})),Vu=D(2,(e,t)=>Ne(()=>{const n=Ht(e);let r=0;return gR({while:()=>r<n.length,body:()=>t(n[r],r),step:()=>{r++}})})),Jn=se(E_,e=>dR(e)),dR=e=>en(Sa(e)),lh=e=>{const t=new mr(xh);return t.effect_instruction_i0=NQ(Ih),t.effect_instruction_i1=()=>e,t},fU=D(2,(e,t)=>ks(n=>se(ei(n(e)),r=>EU(t,r)))),Ye=D(2,(e,t)=>se(e,n=>he(()=>t(n)))),hR=D(2,(e,t)=>ji(e,{onFailure:n=>U0(()=>t.onFailure(n)),onSuccess:n=>he(()=>t.onSuccess(n))})),z0=D(2,(e,t)=>Ts(e,{onFailure:n=>{const r=M0(n);switch(r._tag){case"Left":return U0(()=>t(r.left));case"Right":return en(r.right)}},onSuccess:fe})),bY=D(2,(e,t)=>Uo(e,n=>vU(n)?it:t(n.effect_instruction_i0))),Uo=D(2,(e,t)=>ks(n=>Ts(n(e),{onFailure:r=>{const i=zt(r);return Ts(t(i),{onFailure:c=>zt(tr(r,c)),onSuccess:()=>i})},onSuccess:r=>{const i=Pt(r);return Nt(t(i),i)}}))),bl=D(2,(e,t)=>Uo(e,G0({onFailure:n=>I0(n)?na(t(cR(n))):it,onSuccess:()=>it}))),mR=e=>SY(e,Ie),SY=D(2,(e,t)=>ji(e,{onFailure:n=>Op(t(n)),onSuccess:fe})),fe=e=>{const t=new oU(Cr);return t.effect_instruction_i0=e,t},Ne=e=>{const t=new mr(l_);return t.commit=e,t},he=e=>{const t=new mr(Kj);return t.effect_instruction_i0=e,t},zo=D(e=>e.length===3||e.length===2&&!(Hi(e[1])&&"onlyEffect"in e[1]),(e,t)=>se(e,n=>{const r=typeof t=="function"?t(n):t;return ta(r)?rr(r,n):Lj(r)?xp(i=>{r.then(c=>i(fe(n)),c=>i(mn(new bR(c,"An unknown error occurred in Effect.tap"))))}):fe(n)})),vY=e=>yt(t=>{const n=t.getFiberRef(Nk),r=j(n,yn(()=>t.scope()));return e(df(Nk,pe(r)))}),Yo=e=>{const t=new mr(xh);return t.effect_instruction_i0=KL(Ih),t.effect_instruction_i1=()=>e,t},ks=e=>cU(e,function(){const t=new mr(xh);return t.effect_instruction_i0=KL(Ih),t.effect_instruction_i1=n=>VL(n)?nn(()=>this.effect_instruction_i0(lh)):nn(()=>this.effect_instruction_i0(Yo)),t}),it=fe(void 0),wY=e=>{const t=new mr(xh);return t.effect_instruction_i0=e,t.effect_instruction_i1=void 0,t},P0=D(2,(e,t)=>se(t,n=>n?j(e,Ye(pe)):fe(me()))),gR=e=>{const t=new mr(OS);return t.effect_instruction_i0=e.while,t.effect_instruction_i1=e.body,t.effect_instruction_i2=e.step,t},QS=e=>Ne(()=>{const t=new mr(ep);return t.effect_instruction_i0=e(),t}),EY=function(){const e=arguments.length===1?arguments[0]:arguments[1].bind(arguments[0]);return QS(()=>e(j))},TY=(e,...t)=>Object.defineProperty(t.length===0?function(...n){return QS(()=>e.apply(this,n))}:function(...n){let r=QS(()=>e.apply(this,n));for(const i of t)r=i(r,...n);return r},"length",{value:e.length,configurable:!0}),kY=D(2,(e,t)=>{const n=new mr(xh);return n.effect_instruction_i0=t,n.effect_instruction_i1=()=>e,n}),T_=e=>{const t=new mr(tS);return typeof(e==null?void 0:e.priority)<"u"?PY(t,e.priority):t},dU=D(2,(e,t)=>se(e,n=>Ye(t,r=>[n,r]))),Zc=D(2,(e,t)=>se(e,n=>rr(t,n))),Nt=D(2,(e,t)=>se(e,()=>t)),hU=D(3,(e,t,n)=>se(e,r=>Ye(t,i=>n(r,i)))),CY=Vc(()=>{const e=setInterval(()=>{},2147483647);return he(()=>clearInterval(e))}),Dp=e=>se(E_,t=>j(e,Ro(t))),Ro=D(2,(e,t)=>se(e.interruptAsFork(t),()=>e.await)),AY={_tag:"All",syslog:0,label:"ALL",ordinal:Number.MIN_SAFE_INTEGER,pipe(){return xe(this,arguments)}},RY={_tag:"Fatal",syslog:2,label:"FATAL",ordinal:5e4,pipe(){return xe(this,arguments)}},xY={_tag:"Error",syslog:3,label:"ERROR",ordinal:4e4,pipe(){return xe(this,arguments)}},OY={_tag:"Warning",syslog:4,label:"WARN",ordinal:3e4,pipe(){return xe(this,arguments)}},mU={_tag:"Info",syslog:6,label:"INFO",ordinal:2e4,pipe(){return xe(this,arguments)}},gU={_tag:"Debug",syslog:7,label:"DEBUG",ordinal:1e4,pipe(){return xe(this,arguments)}},DY={_tag:"Trace",syslog:7,label:"TRACE",ordinal:0,pipe(){return xe(this,arguments)}},qY={_tag:"None",syslog:7,label:"OFF",ordinal:Number.MAX_SAFE_INTEGER,pipe(){return xe(this,arguments)}},NY="effect/FiberRef",$Y=Symbol.for(NY),IY={_A:e=>e},k_=e=>yt(t=>Pt(t.getFiberRef(e))),Ph=D(2,(e,t)=>se(k_(e),t)),YS=D(2,(e,t)=>MY(e,()=>[void 0,t])),MY=D(2,(e,t)=>yt(n=>{const[r,i]=t(n.getFiberRef(e));return n.setFiberRef(e,i),fe(r)})),df=D(3,(e,t,n)=>uR(Zc(k_(t),YS(t,n)),()=>e,r=>YS(t,r))),pR=D(3,(e,t,n)=>Ph(t,r=>df(e,t,n(r)))),Kr=(e,t)=>Hh(e,{differ:zL(),fork:(t==null?void 0:t.fork)??Ie,join:t==null?void 0:t.join}),jY=e=>{const t=yQ();return Hh(e,{differ:t,fork:t.empty})},FY=e=>{const t=bQ(zL());return Hh(e,{differ:t,fork:t.empty})},pU=e=>{const t=_Q();return Hh(e,{differ:t,fork:t.empty})},Hh=(e,t)=>({...f_,[$Y]:IY,initial:e,commit(){return k_(this)},diff:(r,i)=>t.differ.diff(r,i),combine:(r,i)=>t.differ.combine(r,i),patch:r=>i=>t.differ.patch(r,i),fork:t.fork,join:t.join??((r,i)=>i)}),LY=e=>Hh(e,{differ:kq,fork:kq.empty}),ai=St(Symbol.for("effect/FiberRef/currentContext"),()=>pU(Iu())),hf=St(Symbol.for("effect/FiberRef/currentSchedulingPriority"),()=>Kr(0)),_U=St(Symbol.for("effect/FiberRef/currentMaxOpsBeforeYield"),()=>Kr(2048)),yU=St(Symbol.for("effect/FiberRef/currentLogAnnotation"),()=>Kr(D0())),UY=St(Symbol.for("effect/FiberRef/currentLogLevel"),()=>Kr(mU)),zY=St(Symbol.for("effect/FiberRef/currentLogSpan"),()=>Kr(nh())),PY=D(2,(e,t)=>df(e,hf,t)),HY=St(Symbol.for("effect/FiberRef/currentConcurrency"),()=>Kr("unbounded")),BY=St(Symbol.for("effect/FiberRef/currentRequestBatching"),()=>Kr(!0)),_R=St(Symbol.for("effect/FiberRef/currentUnhandledErrorLogLevel"),()=>Kr(pe(gU))),VY=D(2,(e,t)=>df(e,_R,t)),qk=St(Symbol.for("effect/FiberRef/currentMetricLabels"),()=>FY(rl())),Nk=St(Symbol.for("effect/FiberRef/currentForkScopeOverride"),()=>Kr(me(),{fork:()=>me(),join:(e,t)=>e})),Fb=St(Symbol.for("effect/FiberRef/currentInterruptedCause"),()=>Kr(Fo,{fork:()=>Fo,join:(e,t)=>e})),GY=St(Symbol.for("effect/FiberRef/currentTracerEnabled"),()=>Kr(!0)),H0=St(Symbol.for("effect/FiberRef/currentTracerTiming"),()=>Kr(!0)),KY=St(Symbol.for("effect/FiberRef/currentTracerSpanAnnotations"),()=>Kr(D0())),QY=St(Symbol.for("effect/FiberRef/currentTracerSpanLinks"),()=>Kr(an())),Dq=Symbol.for("effect/Scope"),qq=Symbol.for("effect/CloseableScope"),bU=(e,t)=>e.addFinalizer(()=>na(t)),qp=(e,t)=>e.addFinalizer(t),$k=(e,t)=>e.close(t),B0=(e,t)=>e.fork(t),YY=e=>WY(Ie)(e),WY=D(2,(e,t)=>{const n=j(e,eU,bu(t));switch(n._tag){case"None":return j(ZL(e),b0,Bt({onNone:()=>{const r=Ht(cR(e)).flatMap(i=>Ht(eR(i)).map(c=>`#${c}`));return new XY(r?`Interrupted by fibers: ${r.join(", ")}`:void 0)},onSome:Ie}));case"Some":return n.value}}),yR=(function(){class e extends globalThis.Error{commit(){return mn(this)}toJSON(){const n={...this};return this.message&&(n.message=this.message),this.cause&&(n.cause=this.cause),n}[Gt](){return this.toString!==globalThis.Error.prototype.toString?this.stack?`${this.toString()}
${this.stack.split(`
`).slice(1).join(`
`)}`:this.toString():"Bun"in globalThis?yl(Hu(this),{renderErrorCause:!0}):this}}return Object.assign(e.prototype,R7),e})(),C_=(e,t)=>{class n extends yR{constructor(){super(...arguments);y(this,"_tag",t)}}return Object.assign(n.prototype,e),n.prototype.name=t,n},Nq=Symbol.for("effect/Cause/errors/RuntimeException"),JY=C_({[Nq]:Nq},"RuntimeException"),Ik=Symbol.for("effect/Cause/errors/InterruptedException"),XY=C_({[Ik]:Ik},"InterruptedException"),ZY=e=>Ae(e,Ik),$q=Symbol.for("effect/Cause/errors/IllegalArgument"),eW=C_({[$q]:$q},"IllegalArgumentException"),Iq=Symbol.for("effect/Cause/errors/NoSuchElement"),A_=C_({[Iq]:Iq},"NoSuchElementException"),Mq=Symbol.for("effect/Cause/errors/Timeout"),tW=C_({[Mq]:Mq},"TimeoutException"),nW=e=>new tW(`Operation timed out after '${mL(e)}'`),jq=Symbol.for("effect/Cause/errors/UnknownException"),bR=(function(){class e extends yR{constructor(r,i){super(i??"An unknown error occurred",{cause:r});y(this,"_tag","UnknownException");y(this,"error");this.error=r}}return Object.assign(e.prototype,{[jq]:jq,name:"UnknownException"}),e})(),V0=e=>ta(e)&&"_tag"in e&&(e._tag==="Success"||e._tag==="Failure"),SU=e=>e._tag==="Failure",vU=e=>e._tag==="Success",rW=e=>{switch(e._tag){case kr:return oR(e.effect_instruction_i0);case Cr:return!1}},lS=D(2,(e,t)=>{switch(e._tag){case kr:return zt(e.effect_instruction_i0);case Cr:return Pt(t)}}),xT=e=>lS(e,void 0),Fd=(e,t)=>oW(e,t!=null&&t.parallel?Mi:tr),Ad=e=>zt(ns(e)),Np=e=>zt(Hu(e)),zt=e=>{const t=new iU(kr);return t.effect_instruction_i0=e,t},sW=D(2,(e,t)=>{switch(e._tag){case kr:return zt(e.effect_instruction_i0);case Cr:return t(e.effect_instruction_i0)}}),aW=e=>j(e,sW(Ie)),SR=e=>zt(Sa(e)),uS=D(2,(e,t)=>{switch(e._tag){case kr:return zt(e.effect_instruction_i0);case Cr:return Pt(t(e.effect_instruction_i0))}}),G0=D(2,(e,{onFailure:t,onSuccess:n})=>{switch(e._tag){case kr:return t(e.effect_instruction_i0);case Cr:return n(e.effect_instruction_i0)}}),Mk=D(2,(e,{onFailure:t,onSuccess:n})=>{switch(e._tag){case kr:return t(e.effect_instruction_i0);case Cr:return n(e.effect_instruction_i0)}}),Pt=e=>{const t=new oU(Cr);return t.effect_instruction_i0=e,t},Pr=Pt(void 0),iW=D(2,(e,t)=>vR(e,t,{onSuccess:(n,r)=>[n,r],onFailure:tr})),wU=D(2,(e,t)=>vR(e,t,{onSuccess:(n,r)=>r,onFailure:tr})),vR=D(3,(e,t,{onFailure:n,onSuccess:r})=>{switch(e._tag){case kr:switch(t._tag){case Cr:return zt(e.effect_instruction_i0);case kr:return zt(n(e.effect_instruction_i0,t.effect_instruction_i0))}case Cr:switch(t._tag){case Cr:return Pt(r(e.effect_instruction_i0,t.effect_instruction_i0));case kr:return zt(t.effect_instruction_i0)}}}),oW=(e,t)=>{const n=Mu(e);return Ii(n)?j(Co(n),CA(j(Ri(n),uS(Sn)),(r,i)=>j(r,vR(i,{onSuccess:(c,f)=>j(c,Gr(f)),onFailure:t}))),uS(jo),uS(r=>xa(r)),pe):me()},R_=e=>({...f_,[rU]:dY,state:cf(hY([])),commit(){return Fi(this)},blockingOn:e}),x_=()=>se(E_,e=>cW(e)),cW=e=>he(()=>R_(e)),Fi=e=>Vc(t=>{const n=Dt(e.state);switch(n._tag){case L0:return t(n.effect);case w_:return n.joiners.push(t),hW(e,t)}},e.blockingOn),lW=D(2,(e,t)=>fU(t,e)),Bh=D(2,(e,t)=>he(()=>{const n=Dt(e.state);switch(n._tag){case L0:return!1;case w_:{lf(e.state,sU(t));for(let r=0,i=n.joiners.length;r<i;r++)n.joiners[r](t);return!0}}})),EU=D(2,(e,t)=>Bh(e,t)),uW=D(2,(e,t)=>Bh(e,mn(t))),TU=D(2,(e,t)=>Bh(e,en(t))),fW=e=>se(E_,t=>Bh(e,dR(t))),wR=D(2,(e,t)=>Bh(e,dR(t))),dW=e=>he(()=>Dt(e.state)._tag===L0),O_=D(2,(e,t)=>Bh(e,fe(t))),D_=(e,t)=>{const n=Dt(e.state);if(n._tag===w_){lf(e.state,sU(t));for(let r=0,i=n.joiners.length;r<i;r++)n.joiners[r](t)}},hW=(e,t)=>he(()=>{const n=Dt(e.state);if(n._tag===w_){const r=n.joiners.indexOf(t);r>=0&&n.joiners.splice(r,1)}}),mW=yt(e=>Pt(e.currentContext)),Vh=()=>mW,Gh=e=>se(Vh(),e),ER=D(2,(e,t)=>df(ai,t)(e)),TR=D(2,(e,t)=>pR(ai,n=>_l(n,t))(e)),kU=D(2,(e,t)=>Gh(n=>ER(e,t(n)))),kR=e=>{const t=e.currentSpan;return t!==void 0&&t._tag==="Span"?pe(t):me()},gW={_tag:"Span",spanId:"noop",traceId:"noop",sampled:!1,status:{_tag:"Ended",startTime:BigInt(0),endTime:BigInt(0),exit:Pr},attributes:new Map,links:[],kind:"internal",attribute(){},event(){},end(){},addLinks(){}},pW=e=>Object.assign(Object.create(gW),e),eu=rU,xt=x_,gn=Fi,_W=lW,Sl=EU,CR=uW,Eu=TU,Fq=fW,jk=dW,dn=O_,AR=D_,yW=V0,Kh=SU,WS=vU,bW=rW,SW=Fd,JS=Ad,Qh=Np,dr=zt,vW=aW,wW=SR,EW=uS,xi=G0,$n=Pt,ea=Pr,Lq=iW,$p=wU,Uq=Symbol.for("effect/MutableHashMap"),TW={[Uq]:Uq,[Symbol.iterator](){return new RR(this)},toString(){return hn(this.toJSON())},toJSON(){return{_id:"MutableHashMap",values:Array.from(this).map(Cn)}},[Gt](){return this.toJSON()},pipe(){return xe(this,arguments)}};class RR{constructor(t){y(this,"self");y(this,"referentialIterator");y(this,"bucketIterator");this.self=t,this.referentialIterator=t.referential[Symbol.iterator]()}next(){if(this.bucketIterator!==void 0)return this.bucketIterator.next();const t=this.referentialIterator.next();return t.done?(this.bucketIterator=new kW(this.self.buckets.values()),this.next()):t}[Symbol.iterator](){return new RR(this.self)}}class kW{constructor(t){y(this,"backing");y(this,"currentBucket");this.backing=t}next(){if(this.currentBucket===void 0){const n=this.backing.next();if(n.done)return n;this.currentBucket=n.value[Symbol.iterator]()}const t=this.currentBucket.next();return t.done?(this.currentBucket=void 0,this.next()):t}}const CW=()=>{const e=Object.create(TW);return e.referential=new Map,e.buckets=new Map,e.bucketsSize=0,e},iu=D(2,(e,t)=>{if(AS(t)===!1)return e.referential.has(t)?pe(e.referential.get(t)):me();const n=t[nt](),r=e.buckets.get(n);return r===void 0?me():AW(e,r,t)}),AW=(e,t,n,r=!1)=>{for(let i=0,c=t.length;i<c;i++)if(n[Ze](t[i][0])){const f=t[i][1];return r&&(t.splice(i,1),e.bucketsSize--),pe(f)}return me()},kg=D(2,(e,t)=>Zt(iu(e,t))),Cg=D(3,(e,t,n)=>{if(AS(t)===!1)return e.referential.set(t,n),e;const r=t[nt](),i=e.buckets.get(r);return i===void 0?(e.buckets.set(r,[[t,n]]),e.bucketsSize++,e):(RW(e,i,t),i.push([t,n]),e.bucketsSize++,e)}),RW=(e,t,n)=>{for(let r=0,i=t.length;r<i;r++)if(n[Ze](t[r][0])){t.splice(r,1),e.bucketsSize--;return}},zq=Symbol.for("effect/MutableList"),xW={[zq]:zq,[Symbol.iterator](){let e=!1,t=this.head;return{next(){if(e)return this.return();if(t==null)return e=!0,this.return();const n=t.value;return t=t.next,{done:e,value:n}},return(n){return e||(e=!0),{done:!0,value:n}}}},toString(){return hn(this.toJSON())},toJSON(){return{_id:"MutableList",values:Array.from(this).map(Cn)}},[Gt](){return this.toJSON()},pipe(){return xe(this,arguments)}},OW=e=>({value:e,removed:!1,prev:void 0,next:void 0}),DW=()=>{const e=Object.create(xW);return e.head=void 0,e.tail=void 0,e._length=0,e},CU=e=>xR(e)===0,xR=e=>e._length,qW=D(2,(e,t)=>{const n=OW(t);return e.head===void 0&&(e.head=n),e.tail===void 0||(e.tail.next=n,n.prev=e.tail),e.tail=n,e._length+=1,e}),NW=e=>{const t=e.head;if(t!==void 0)return $W(e,t),t.value},$W=(e,t)=>{t.removed||(t.removed=!0,t.prev!==void 0&&t.next!==void 0?(t.prev.next=t.next,t.next.prev=t.prev):t.prev!==void 0?(e.tail=t.prev,t.prev.next=void 0):t.next!==void 0?(e.head=t.next,t.next.prev=void 0):(e.tail=void 0,e.head=void 0),e._length>0&&(e._length-=1))},Pq=Symbol.for("effect/MutableQueue"),Vn=Symbol.for("effect/mutable/MutableQueue/Empty"),IW={[Pq]:Pq,[Symbol.iterator](){return Array.from(this.queue)[Symbol.iterator]()},toString(){return hn(this.toJSON())},toJSON(){return{_id:"MutableQueue",values:Array.from(this).map(Cn)}},[Gt](){return this.toJSON()},pipe(){return xe(this,arguments)}},AU=e=>{const t=Object.create(IW);return t.queue=DW(),t.capacity=e,t},OR=e=>AU(e),K0=()=>AU(void 0),DR=e=>xR(e.queue),Tu=e=>CU(e.queue),MW=e=>e.capacity===void 0?1/0:e.capacity,uh=D(2,(e,t)=>{const n=xR(e.queue);return e.capacity!==void 0&&n===e.capacity?!1:(qW(t)(e.queue),!0)}),qR=D(2,(e,t)=>{const n=t[Symbol.iterator]();let r,i=an(),c=!0;for(;c&&(r=n.next())&&!r.done;)c=uh(r.value)(e);for(;r!=null&&!r.done;)i=Gr(r.value)(i),r=n.next();return jo(i)}),qo=D(2,(e,t)=>CU(e.queue)?t:NW(e.queue)),Q0=D(2,(e,t)=>{let n=an(),r=0;for(;r<t;){const i=qo(Vn)(e);if(i===Vn)break;n=Gr(i)(n),r+=1}return jo(n)}),jW="effect/Clock",Hq=Symbol.for(jW),mf=Cs("effect/Clock"),FW=2**31-1,Bq={unsafeSchedule(e,t){const n=Xd(t);if(n>FW)return Ni;let r=!1;const i=setTimeout(()=>{r=!0,e()},n);return()=>(clearTimeout(i),!r)}},Vq=(function(){const e=BigInt(1e6);if(typeof performance>"u")return()=>BigInt(Date.now())*e;let t;return()=>(t===void 0&&(t=BigInt(Date.now())*e-BigInt(Math.round(performance.now()*1e6))),t+BigInt(Math.round(performance.now()*1e6)))})(),LW=(function(){const e=typeof process=="object"&&"hrtime"in process&&typeof process.hrtime.bigint=="function"?process.hrtime:void 0;if(!e)return Vq;const t=Vq()-e.bigint();return()=>t+e.bigint()})();var WI;WI=Hq;class UW{constructor(){y(this,WI,Hq);y(this,"currentTimeMillis",he(()=>this.unsafeCurrentTimeMillis()));y(this,"currentTimeNanos",he(()=>this.unsafeCurrentTimeNanos()))}unsafeCurrentTimeMillis(){return Date.now()}unsafeCurrentTimeNanos(){return LW()}scheduler(){return fe(Bq)}sleep(t){return Lo(n=>{const r=Bq.unsafeSchedule(()=>n(it),t);return na(he(r))})}}const zW=()=>new UW,RU="And",xU="Or",OU="InvalidData",DU="MissingData",qU="SourceUnavailable",NU="Unsupported",PW="effect/ConfigError",Gq=Symbol.for(PW),Yh={_tag:"ConfigError",[Gq]:Gq},$U=(e,t)=>{const n=Object.create(Yh);return n._op=RU,n.left=e,n.right=t,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`${this.left} and ${this.right}`}}),Object.defineProperty(n,"message",{enumerable:!1,get(){return this.toString()}}),n},IU=(e,t)=>{const n=Object.create(Yh);return n._op=xU,n.left=e,n.right=t,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`${this.left} or ${this.right}`}}),Object.defineProperty(n,"message",{enumerable:!1,get(){return this.toString()}}),n},HW=(e,t,n={pathDelim:"."})=>{const r=Object.create(Yh);return r._op=OU,r.path=e,r.message=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`(Invalid data at ${j(this.path,Dh(n.pathDelim))}: "${this.message}")`}}),r},Gu=(e,t,n={pathDelim:"."})=>{const r=Object.create(Yh);return r._op=DU,r.path=e,r.message=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`(Missing data at ${j(this.path,Dh(n.pathDelim))}: "${this.message}")`}}),r},BW=(e,t,n,r={pathDelim:"."})=>{const i=Object.create(Yh);return i._op=qU,i.path=e,i.message=t,i.cause=n,Object.defineProperty(i,"toString",{enumerable:!1,value(){return`(Source unavailable at ${j(this.path,Dh(r.pathDelim))}: "${this.message}")`}}),i},VW=(e,t,n={pathDelim:"."})=>{const r=Object.create(Yh);return r._op=NU,r.path=e,r.message=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`(Unsupported operation at ${j(this.path,Dh(n.pathDelim))}: "${this.message}")`}}),r},fu=D(2,(e,t)=>{switch(e._op){case RU:return $U(fu(e.left,t),fu(e.right,t));case xU:return IU(fu(e.left,t),fu(e.right,t));case OU:return HW([...t,...e.path],e.message);case DU:return Gu([...t,...e.path],e.message);case qU:return BW([...t,...e.path],e.message,e.cause);case NU:return VW([...t,...e.path],e.message)}}),GW={_tag:"Empty"},OT=D(2,(e,t)=>{let n=nR(t),r=e;for(;tR(n);){const i=n.head;switch(i._tag){case"Empty":{n=n.tail;break}case"AndThen":{n=zu(i.first,zu(i.second,n.tail));break}case"MapName":{r=Su(r,i.f),n=n.tail;break}case"Nested":{r=NS(r,i.name),n=n.tail;break}case"Unnested":{if(j(tp(r),X7(i.name)))r=Du(r),n=n.tail;else return Ue(Gu(r,`Expected ${i.name} to be in path in ConfigProvider#unnested`));break}}}return He(r)}),KW="Constant",QW="Fail",YW="Fallback",WW="Described",JW="Lazy",XW="MapOrFail",ZW="Nested",eJ="Primitive",tJ="Sequence",nJ="HashMap",rJ="ZipWith";var Kq={};const XS=(e,t)=>[...e,...t],sJ="effect/ConfigProvider",Qq=Symbol.for(sJ),aJ=Cs("effect/ConfigProvider"),iJ="effect/ConfigProviderFlat",Yq=Symbol.for(iJ),oJ=e=>({[Qq]:Qq,pipe(){return xe(this,arguments)},...e}),cJ=e=>({[Yq]:Yq,patch:e.patch,load:(t,n,r=!0)=>e.load(t,n,r),enumerateChildren:e.enumerateChildren}),lJ=e=>oJ({load:t=>se(ga(e,rl(),t,!1),n=>Bt(tp(n),{onNone:()=>mn(Gu(rl(),`Expected a single value having structure: ${t}`)),onSome:fe})),flattened:e}),uJ=e=>{const{pathDelim:t,seqDelim:n}=Object.assign({},{pathDelim:"_",seqDelim:","},e),r=g=>j(g,Dh(t)),i=g=>g.split(t),c=()=>typeof process<"u"&&"env"in process&&typeof Kq=="object"?Kq:{};return lJ(cJ({load:(g,b,S=!0)=>{const v=r(g),q=c(),k=v in q?pe(q[v]):me();return j(k,z0(()=>Gu(g,`Expected ${v} to exist in the process context`)),se(N=>gJ(N,g,b,n,S)))},enumerateChildren:g=>he(()=>{const b=c(),q=Object.keys(b).map(k=>i(k.toUpperCase())).filter(k=>{for(let N=0;N<g.length;N++){const H=j(g,uF(N)),x=k[N];if(x===void 0||H!==x)return!1}return!0}).flatMap(k=>k.slice(g.length,g.length+1));return nK(q)}),patch:GW}))},fJ=(e,t,n,r)=>{const i=sq(n.length,g=>g>=r.length?me():pe([e(g),g+1])),c=sq(r.length,g=>g>=n.length?me():pe([t(g),g+1])),f=XS(n,i),m=XS(r,c);return[f,m]},dJ=(e,t)=>{let n=t;if(n._tag==="Nested"){const r=e.slice();for(;n._tag==="Nested";)r.push(n.name),n=n.config;return r}return e},ga=(e,t,n,r)=>{const i=n;switch(i._tag){case KW:return fe(pa(i.value));case WW:return Ne(()=>ga(e,t,i.config,r));case QW:return mn(Gu(t,i.message));case YW:return j(Ne(()=>ga(e,t,i.first,r)),oh(c=>i.condition(c)?j(ga(e,t,i.second,r),oh(f=>mn(IU(c,f)))):mn(c)));case JW:return Ne(()=>ga(e,t,i.config(),r));case XW:return Ne(()=>j(ga(e,t,i.original,r),se(Ao(c=>j(i.mapOrFail(c),z0(fu(dJ(t,i.original))))))));case ZW:return Ne(()=>ga(e,XS(t,pa(i.name)),i.config,r));case eJ:return j(OT(t,e.patch),se(c=>j(e.load(c,i,r),se(f=>{if(f.length===0){const m=j(pV(c),yn(()=>"<n/a>"));return mn(Gu([],`Expected ${i.description} with name ${m}`))}return fe(f)}))));case tJ:return j(OT(t,e.patch),se(c=>j(e.enumerateChildren(c),se(_J),se(f=>f.length===0?Ne(()=>Ye(ga(e,t,i.config,!0),pa)):j(Ao(f,m=>ga(e,uV(t,`[${m}]`),i.config,!0)),Ye(m=>{const g=AV(m);return g.length===0?pa(rl()):pa(g)}))))));case nJ:return Ne(()=>j(OT(t,e.patch),se(c=>j(e.enumerateChildren(c),se(f=>j(f,Ao(m=>ga(e,XS(c,pa(m)),i.valueConfig,r)),Ye(m=>m.length===0?pa(D0()):j(pJ(m),Su(g=>pK(rq(Ht(f),g)))))))))));case rJ:return Ne(()=>j(ga(e,t,i.left,r),ch,se(c=>j(ga(e,t,i.right,r),ch,se(f=>{if(vr(c)&&vr(f))return mn($U(c.left,f.left));if(vr(c)&&Ci(f))return mn(c.left);if(Ci(c)&&vr(f))return mn(f.left);if(Ci(c)&&Ci(f)){const m=j(t,Dh(".")),g=hJ(t,m),[b,S]=fJ(g,g,j(c.right,Su(He)),j(f.right,Su(He)));return j(b,rq(S),Ao(([v,q])=>j(dU(v,q),Ye(([k,N])=>i.zip(k,N)))))}throw new Error("BUG: ConfigProvider.fromFlatLoop - please report an issue at https://github.com/Effect-TS/effect/issues")})))))}},hJ=(e,t)=>n=>Ue(Gu(e,`The element at index ${n} in a sequence at path "${t}" was missing`)),mJ=(e,t)=>e.split(new RegExp(`\\s*${IS(t)}\\s*`)),gJ=(e,t,n,r,i)=>i?j(mJ(e,r),Ao(c=>n.parse(c.trim())),z0(fu(t))):j(n.parse(e),hR({onFailure:fu(t),onSuccess:pa})),pJ=e=>Object.keys(e[0]).map(t=>e.map(n=>n[t])),_J=e=>j(Ao(e,bJ),hR({onFailure:()=>rl(),onSuccess:bp(Yd)}),ch,Ye(U7)),yJ=/^(\[(\d+)\])$/,bJ=e=>{const t=e.match(yJ);if(t!==null){const n=t[2];return j(n!==void 0&&n.length>0?pe(n):me(),Oh(SJ))}return me()},SJ=e=>{const t=Number.parseInt(e);return Number.isNaN(t)?me():pe(t)},Wq=Symbol.for("effect/Console"),Y0=Cs("effect/Console"),vJ={[Wq]:Wq,assert(e,...t){return he(()=>{console.assert(e,...t)})},clear:he(()=>{console.clear()}),count(e){return he(()=>{console.count(e)})},countReset(e){return he(()=>{console.countReset(e)})},debug(...e){return he(()=>{console.debug(...e)})},dir(e,t){return he(()=>{console.dir(e,t)})},dirxml(...e){return he(()=>{console.dirxml(...e)})},error(...e){return he(()=>{console.error(...e)})},group(e){return e!=null&&e.collapsed?he(()=>console.groupCollapsed(e==null?void 0:e.label)):he(()=>console.group(e==null?void 0:e.label))},groupEnd:he(()=>{console.groupEnd()}),info(...e){return he(()=>{console.info(...e)})},log(...e){return he(()=>{console.log(...e)})},table(e,t){return he(()=>{console.table(e,t)})},time(e){return he(()=>console.time(e))},timeEnd(e){return he(()=>console.timeEnd(e))},timeLog(e,...t){return he(()=>{console.timeLog(e,...t)})},trace(...e){return he(()=>{console.trace(...e)})},warn(...e){return he(()=>{console.warn(...e)})},unsafe:console},wJ="effect/Random",Jq=Symbol.for(wJ),EJ=Cs("effect/Random");var JI;JI=Jq;class TJ{constructor(t){y(this,"seed");y(this,JI,Jq);y(this,"PRNG");this.seed=t,this.PRNG=new d7(t)}get next(){return he(()=>this.PRNG.number())}get nextBoolean(){return Ye(this.next,t=>t>.5)}get nextInt(){return he(()=>this.PRNG.integer(Number.MAX_SAFE_INTEGER))}nextRange(t,n){return Ye(this.next,r=>(n-t)*r+t)}nextIntBetween(t,n){return he(()=>this.PRNG.integer(n-t)+t)}shuffle(t){return kJ(t,n=>this.nextIntBetween(0,n))}}const kJ=(e,t)=>Ne(()=>j(he(()=>Array.from(e)),se(n=>{const r=[];for(let i=n.length;i>=2;i=i-1)r.push(i);return j(r,Vu(i=>j(t(i),Ye(c=>CJ(n,i-1,c)))),rr(Mu(n)))}))),CJ=(e,t,n)=>{const r=e[t];return e[t]=e[n],e[n]=r,e},AJ=e=>new TJ(we(e)),Xq=Symbol.for("effect/Tracer"),MU=e=>({[Xq]:Xq,...e}),q_=Cs("effect/Tracer"),Li=Cs("effect/ParentSpan"),Zq=(function(){const e="abcdef0123456789",t=e.length;return function(n){let r="";for(let i=0;i<n;i++)r+=e.charAt(Math.floor(Math.random()*t));return r}})();class RJ{constructor(t,n,r,i,c,f){y(this,"name");y(this,"parent");y(this,"context");y(this,"startTime");y(this,"kind");y(this,"_tag","Span");y(this,"spanId");y(this,"traceId","native");y(this,"sampled",!0);y(this,"status");y(this,"attributes");y(this,"events",[]);y(this,"links");this.name=t,this.parent=n,this.context=r,this.startTime=c,this.kind=f,this.status={_tag:"Started",startTime:c},this.attributes=new Map,this.traceId=n._tag==="Some"?n.value.traceId:Zq(32),this.spanId=Zq(16),this.links=Array.from(i)}end(t,n){this.status={_tag:"Ended",endTime:t,exit:n,startTime:this.status.startTime}}attribute(t,n){this.attributes.set(t,n)}event(t,n,r){this.events.push([t,n,r??{}])}addLinks(t){this.links.push(...t)}}const xJ=MU({span:(e,t,n,r,i,c)=>new RJ(e,t,n,r,i,c),context:e=>e()}),No=e=>{if((e==null?void 0:e.captureStackTrace)===!1)return e;if((e==null?void 0:e.captureStackTrace)!==void 0&&typeof e.captureStackTrace!="boolean")return e;const t=Error.stackTraceLimit;Error.stackTraceLimit=3;const n=new Error;Error.stackTraceLimit=t;let r=!1;return{...e,captureStackTrace:()=>{if(r!==!1)return r;if(n.stack!==void 0){const i=n.stack.split(`
`);if(i[3]!==void 0)return r=i[3].trim(),r}}}},ZS=g0()("effect/Tracer/DisablePropagation",{defaultValue:Ni}),OJ=j(Iu(),Ks(mf,zW()),Ks(Y0,vJ),Ks(EJ,AJ(Math.random())),Ks(aJ,uJ()),Ks(q_,xJ)),Ui=St(Symbol.for("effect/DefaultServices/currentServices"),()=>pU(OJ)),DJ=e=>{const t=Zs(e);return W0(n=>n.sleep(t))},jU=e=>yt(t=>e(t.currentDefaultServices)),W0=e=>jU(t=>e(t.unsafeMap.get(mf.key))),qJ=W0(e=>e.currentTimeMillis),NJ=e=>jU(t=>e(t.unsafeMap.get(q_.key))),FU=DJ,$J=qJ,IJ=W0,MJ=mf;function jJ(e){return new al(e)}function FJ(){return jJ(new Map)}const eN=Symbol.for("effect/FiberRefs");var XI;XI=eN;class al{constructor(t){y(this,"locals");y(this,XI,eN);this.locals=t}pipe(){return xe(this,arguments)}}const LJ=(e,t,n,r=!1)=>{const i=e;let c=t,f=n,m=r,g;for(;g===void 0;)if(bn(c)&&bn(f)){const b=Ss(c)[0],S=Du(c),v=Ss(f)[0],q=Ss(f)[1],k=Du(f);b.startTimeMillis<v.startTimeMillis?(f=k,m=!0):b.startTimeMillis>v.startTimeMillis?c=S:b.id<v.id?(f=k,m=!0):b.id>v.id?c=S:g=[q,m]}else g=[i.initial,!0];return g},UJ=D(3,(e,t,n)=>{const r=new Map(e.locals);return n.locals.forEach((i,c)=>{const f=i[0][1];if(!i[0][0][Ze](t)){if(!r.has(c)){if(Ge(f,c.initial))return;r.set(c,[[t,c.join(c.initial,f)]]);return}const m=r.get(c),[g,b]=LJ(c,m,i);if(b){const S=c.diff(g,f),v=m[0][1],q=c.join(v,c.patch(S)(v));if(!Ge(v,q)){let k;const N=m[0][0];N[Ze](t)?k=[[N,q],...m.slice(1)]:k=[[t,q],...m],r.set(c,k)}}}}),new al(r)}),zJ=D(2,(e,t)=>{const n=new Map;return LU(e,n,t),new al(n)}),LU=(e,t,n)=>{e.locals.forEach((r,i)=>{const c=r[0][1],f=i.patch(i.fork)(c);Ge(c,f)?t.set(i,r):t.set(i,[[n,f],...r])})},UU=D(2,(e,t)=>{const n=new Map(e.locals);return n.delete(t),new al(n)}),zU=D(2,(e,t)=>e.locals.has(t)?pe(Ss(e.locals.get(t))[1]):me()),Ip=D(2,(e,t)=>j(zU(e,t),yn(()=>t.initial))),Fk=D(2,(e,{fiberId:t,fiberRef:n,value:r})=>{if(e.locals.size===0)return new al(new Map([[n,[[t,r]]]]));const i=new Map(e.locals);return Lk(i,t,n,r),new al(i)}),Lk=(e,t,n,r)=>{const i=e.get(n)??[];let c;if(bn(i)){const[f,m]=Ss(i);if(f[Ze](t)){if(Ge(m,r))return;c=[[t,r],...i.slice(1)]}else c=[[t,r],...i]}else c=[[t,r]];e.set(n,c)},PJ=D(2,(e,{entries:t,forkAs:n})=>{if(e.locals.size===0)return new al(new Map(t));const r=new Map(e.locals);return n!==void 0&&LU(e,r,n),t.forEach(([i,c])=>{c.length===1?Lk(r,c[0][0],i,c[0][1]):c.forEach(([f,m])=>{Lk(r,f,i,m)})}),new al(r)}),tN=zU,NR=Ip,HJ=PJ,BJ=FJ,VJ=AY,GJ=RY,PU=xY,HU=OY,KJ=mU,$R=gU,QJ=DY,YJ=qY,WJ=j(Yd,oF(e=>e.ordinal)),JJ=H7(WJ),XJ=e=>{switch(e){case"All":return VJ;case"Debug":return $R;case"Error":return PU;case"Fatal":return GJ;case"Info":return KJ;case"Trace":return QJ;case"None":return YJ;case"Warning":return HU}},BU=e=>e.replace(/[\s="]/g,"_"),IR=e=>t=>`${BU(t.label)}=${e-t.startTime}ms`,ZJ=u_,eX=x7;let Gi=class extends eX{};const il=Symbol.for("effect/Readable"),MR=Symbol.for("effect/Ref"),jR={_A:e=>e};var ZI,eM,tM;class tX extends(tM=Gi,eM=MR,ZI=il,tM){constructor(n){super();y(this,"ref");y(this,eM,jR);y(this,ZI,il);y(this,"get");this.ref=n,this.get=he(()=>Dt(this.ref))}commit(){return this.get}modify(n){return he(()=>{const r=Dt(this.ref),[i,c]=n(r);return r!==c&&lf(c)(this.ref),i})}}const VU=e=>new tX(cf(e)),ev=e=>he(()=>VU(e)),el=e=>e.get,Mp=D(2,(e,t)=>e.modify(()=>[void 0,t])),GU=D(2,(e,t)=>e.modify(t)),Uk=D(2,(e,t)=>e.modify(n=>[void 0,t(n)])),nX=MR,J0=ev,rp=el,Ag=GU,FR=Mp,rX=Uk,KU=Li,QU=MU,sX=NJ,YU="Empty",WU="Add",JU="Remove",XU="Update",ZU="AndThen",aX={_tag:YU},ez=(e,t)=>{const n=new Map(e.locals);let r=aX;for(const[i,c]of t.locals.entries()){const f=Ss(c)[1],m=n.get(i);if(m!==void 0){const g=Ss(m)[1];Ge(g,f)||(r=DT({_tag:XU,fiberRef:i,patch:i.diff(g,f)})(r))}else r=DT({_tag:WU,fiberRef:i,value:f})(r);n.delete(i)}for(const[i]of n.entries())r=DT({_tag:JU,fiberRef:i})(r);return r},DT=D(2,(e,t)=>({_tag:ZU,first:e,second:t})),tz=D(3,(e,t,n)=>{let r=n,i=pa(e);for(;bn(i);){const c=Ss(i),f=Du(i);switch(c._tag){case YU:{i=f;break}case WU:{r=Fk(r,{fiberId:t,fiberRef:c.fiberRef,value:c.value}),i=f;break}case JU:{r=UU(r,c.fiberRef),i=f;break}case XU:{const m=Ip(r,c.fiberRef);r=Fk(r,{fiberId:t,fiberRef:c.fiberRef,value:c.fiberRef.patch(c.patch)(m)}),i=f;break}case ZU:{i=NS(c.first)(NS(c.second)(f));break}}}return r}),nz="effect/MetricLabel",zk=Symbol.for(nz);var nM;class iX{constructor(t,n){y(this,"key");y(this,"value");y(this,nM,zk);y(this,"_hash");this.key=t,this.value=n,this._hash=qn(nz+this.key+this.value)}[(nM=zk,nt)](){return this._hash}[Ze](t){return cX(t)&&this.key===t.key&&this.value===t.value}pipe(){return xe(this,arguments)}}const oX=(e,t)=>new iX(e,t),cX=e=>Ae(e,zk),lX=D(e=>ta(e[0]),function(){const e=arguments;return pR(e[0],yU,typeof e[1]=="string"?BS(e[1],e[2]):t=>Object.entries(e[1]).reduce((n,[r,i])=>BS(n,r,i),t))}),uX=e=>Ye(e,pe),fX=e=>{let t,n;return typeof e=="function"?t=e:(t=e.try,n=e.catch),Ne(()=>{try{return fe(nn(t))}catch(r){return mn(n?nn(()=>n(r)):new bR(r,"An unknown error occurred in Effect.try"))}})},dX=D(2,(e,t)=>Uh(e,n=>{const r=j0(n,i=>aR(i)?pe(i):me());switch(r._tag){case"None":return en(n);case"Some":return t(r.value.defect)}})),hX=D(2,(e,t)=>Ts(e,{onFailure:n=>{const r=t(n);switch(r._tag){case"None":return en(n);case"Some":return r.value}},onSuccess:fe})),mX=D(e=>ta(e[0]),(e,...t)=>{const n=t[t.length-1];let r;return t.length===2?r=mA(t[0]):r=i=>{const c=Ae(i,"_tag")?i._tag:void 0;if(!c)return!1;for(let f=0;f<t.length-1;f++)if(t[f]===c)return!0;return!1},pY(e,r,n)}),gX=IJ,pX=gX(fe),rz=D(2,(e,t)=>Nt(FU(t),e)),_X=e=>CX(e,yX,ez),sz=D(2,(e,t)=>ji(e,{onFailure:n=>fe(t.onFailure(n)),onSuccess:n=>fe(t.onSuccess(n))})),LR=e=>{const t=se(se(e,()=>T_()),()=>t);return t},yX=yt(e=>fe(e.getFiberRefs())),az=e=>sz(e,{onFailure:_p,onSuccess:_p}),bX=e=>Ts(e,{onFailure:t=>iz(t,"An error was silently ignored because it is not anticipated to be useful"),onSuccess:()=>it}),X0=e=>(...t)=>{const n=of(e);let r;for(let i=0,c=t.length;i<c;i++){const f=t[i];sR(f)&&(r!==void 0?r=tr(r,f):r=f,t=[...t.slice(0,i),...t.slice(i+1)],i--)}return r===void 0&&(r=Fo),yt(i=>(i.log(t,r,n),it))},SX=X0(),iz=X0($R),vX=X0(HU),wX=X0(PU),nN=D(2,(e,t)=>Ts(e,{onFailure:n=>lU(()=>t(n)),onSuccess:fe})),EX=e=>Ye(e,t=>!t),TX=e=>qX((t,n)=>j(e,tz(t,n))),kX=e=>e.length>=1?Lo((t,n)=>{try{e(n).then(r=>t(Pt(r)),r=>t(Ad(r)))}catch(r){t(Ad(r))}}):Lo(t=>{try{e().then(n=>t(Pt(n)),n=>t(Ad(n)))}catch(n){t(Ad(n))}}),jp=D(3,(e,t,n)=>Gh(r=>ER(e,Ks(r,t,n)))),UR=FU,Fp=fe(me()),CX=D(3,(e,t,n)=>se(t,r=>se(e,i=>Ye(t,c=>[n(r,c),i])))),AX=D(2,(e,t)=>Uh(e,n=>Bt(tY(n),{onNone:()=>en(n),onSome:r=>Nt(t(r),en(n))}))),RX=D(2,(e,t)=>Ts(e,{onFailure:n=>{const r=M0(n);switch(r._tag){case"Left":return Nt(t(r.left),en(n));case"Right":return en(n)}},onSuccess:fe})),xX=D(2,(e,t)=>Ts(e,{onFailure:n=>Nt(t(n),en(n)),onSuccess:fe})),OX=sX,DX=OX(fe),qX=e=>yt(t=>(t.setFiberRefs(e(t.id(),t.getFiberRefs())),it)),NX=D(2,(e,t)=>Ne(()=>t()?Ye(e,pe):fe(me()))),$X=e=>Ye(Vh(),Xs(e)),IX=function(){const e=arguments;return az(se(oz,t=>he(()=>{if(typeof e[0]=="string")t.attribute(e[0],e[1]);else for(const n in e[0])t.attribute(n,e[0][n])})))},oz=se(Vh(),e=>{const t=e.unsafeMap.get(Li.key);return t!==void 0&&t._tag==="Span"?fe(t):mn(new A_)}),cz=BigInt(0),lz=Oh(e=>Ws(e.context,ZS)?e._tag==="Span"?lz(e.parent):me():pe(e)),zR=(e,t,n)=>{const r=!e.getFiberRef(GY)||n.context&&Ws(n.context,ZS),i=e.getFiberRef(ai),c=n.parent?pe(n.parent):n.root?me():lz(Xs(i,Li));let f;if(r)f=pW({name:t,parent:c,context:Ks(n.context??Iu(),ZS,!0)});else{const m=e.getFiberRef(Ui),g=Ws(m,q_),b=Ws(m,MJ),S=e.getFiberRef(H0),v=e.getFiberRefs(),q=tN(v,KY),k=tN(v,QY),N=k._tag==="Some"?n.links!==void 0?[...xa(k.value),...n.links??[]]:xa(k.value):n.links??rl();f=g.span(t,c,n.context??Iu(),N,S?b.unsafeCurrentTimeNanos():cz,n.kind??"internal"),q._tag==="Some"&&SK(q.value,(H,x)=>f.attribute(x,H)),n.attributes!==void 0&&Object.entries(n.attributes).forEach(([H,x])=>f.attribute(H,x))}return typeof n.captureStackTrace=="function"&&KS.set(f,n.captureStackTrace),f},MX=(e,t)=>(t=No(t),yt(n=>fe(zR(n,e,t)))),tv=(e,t,n,r)=>he(()=>{e.status._tag!=="Ended"&&(SU(t)&&KS.has(e)&&e.attribute("code.stacktrace",KS.get(e)()),e.end(r?n.unsafeCurrentTimeNanos():cz,t))}),rN=(e,...t)=>{const n=No(t.length===1?void 0:t[0]),r=t[t.length-1];return yt(i=>{const c=zR(i,e,n),f=i.getFiberRef(H0),m=Ws(i.getFiberRef(Ui),mf);return Uo(r(c),g=>tv(c,g,m,f))})},Pk=D(2,(e,t)=>jp(e,Li,t)),jX=function(){const e=typeof arguments[0]!="string",t=e?arguments[1]:arguments[0],n=No(e?arguments[2]:arguments[1]);if(e){const r=arguments[0];return rN(t,n,i=>Pk(r,i))}return r=>rN(t,n,i=>Pk(r,i))},uz="Sequential",fz="Parallel",FX="ParallelN",N_={_tag:uz},LX={_tag:fz},UX=e=>({_tag:FX,parallelism:e}),zX=e=>e._tag===uz,PX=e=>e._tag===fz,nv=N_,Hk=LX,Bk=UX,Lp=ez,Up=tz,Z0="effect/FiberStatus",Ku=Symbol.for(Z0),rv="Done",sN="Running",aN="Suspended",HX=qn(`${Z0}-${rv}`);var rM;let BX=class{constructor(){y(this,rM,Ku);y(this,"_tag",rv)}[(rM=Ku,nt)](){return HX}[Ze](t){return PR(t)&&t._tag===rv}};var sM;class VX{constructor(t){y(this,"runtimeFlags");y(this,sM,Ku);y(this,"_tag",sN);this.runtimeFlags=t}[(sM=Ku,nt)](){return j(we(Z0),Qe(we(this._tag)),Qe(we(this.runtimeFlags)),Yt(this))}[Ze](t){return PR(t)&&t._tag===sN&&this.runtimeFlags===t.runtimeFlags}}var aM;class GX{constructor(t,n){y(this,"runtimeFlags");y(this,"blockingOn");y(this,aM,Ku);y(this,"_tag",aN);this.runtimeFlags=t,this.blockingOn=n}[(aM=Ku,nt)](){return j(we(Z0),Qe(we(this._tag)),Qe(we(this.runtimeFlags)),Qe(we(this.blockingOn)),Yt(this))}[Ze](t){return PR(t)&&t._tag===aN&&this.runtimeFlags===t.runtimeFlags&&Ge(this.blockingOn,t.blockingOn)}}const KX=new BX,QX=e=>new VX(e),YX=(e,t)=>new GX(e,t),PR=e=>Ae(e,Ku),WX=e=>e._tag===rv,JX=KX,dz=QX,XX=YX,ZX=WX,eZ=Symbol.for("effect/Micro"),sv=Symbol.for("effect/Micro/MicroExit"),iN=Symbol.for("effect/Micro/MicroCause"),tZ={_E:Ie};var iM;class hz extends globalThis.Error{constructor(n,r,i){const c=`MicroCause.${n}`;let f,m,g;if(r instanceof globalThis.Error){f=`(${c}) ${r.name}`,m=r.message;const b=m.split(`
`).length;g=r.stack?`(${c}) ${r.stack.split(`
`).slice(0,b+3).join(`
`)}`:`${f}: ${m}`}else f=c,m=xu(r,0),g=`${f}: ${m}`;i.length>0&&(g+=`
    ${i.join(`
    `)}`);super(m);y(this,"_tag");y(this,"traces");y(this,iM);this._tag=n,this.traces=i,this[iN]=tZ,this.name=f,this.stack=g}pipe(){return xe(this,arguments)}toString(){return this.stack}[(iM=iN,Gt)](){return this.stack}}class nZ extends hz{constructor(n,r=[]){super("Die",n,r);y(this,"defect");this.defect=n}}const rZ=(e,t=[])=>new nZ(e,t);class sZ extends hz{constructor(t=[]){super("Interrupt","interrupted",t)}}const aZ=(e=[])=>new sZ(e),iZ=e=>e._tag==="Interrupt",oN=Symbol.for("effect/Micro/MicroFiber"),oZ={_A:Ie,_E:Ie};var oM;oM=oN;class cZ{constructor(t,n=!0){y(this,"context");y(this,"interruptible");y(this,oM);y(this,"_stack",[]);y(this,"_observers",[]);y(this,"_exit");y(this,"_children");y(this,"currentOpCount",0);y(this,"_interrupted",!1);y(this,"_yielded");this.context=t,this.interruptible=n,this[oN]=oZ}getRef(t){return H9(this.context,t)}addObserver(t){return this._exit?(t(this._exit),_p):(this._observers.push(t),()=>{const n=this._observers.indexOf(t);n>=0&&this._observers.splice(n,1)})}unsafeInterrupt(){this._exit||(this._interrupted=!0,this.interruptible&&this.evaluate(KR))}unsafePoll(){return this._exit}evaluate(t){if(this._exit)return;if(this._yielded!==void 0){const i=this._yielded;this._yielded=void 0,i()}const n=this.runLoop(t);if(n===Lb)return;const r=cN.interruptChildren&&cN.interruptChildren(this);if(r!==void 0)return this.evaluate(iv(r,()=>n));this._exit=n;for(let i=0;i<this._observers.length;i++)this._observers[i](n);this._observers.length=0}runLoop(t){let n=!1,r=t;this.currentOpCount=0;try{for(;;){if(this.currentOpCount++,!n&&this.getRef(QR).shouldYield(this)){n=!0;const i=r;r=iv(hZ,()=>i)}if(r=r[Vk](this),r===Lb){const i=this._yielded;return sv in i?(this._yielded=void 0,i):Lb}}}catch(i){return Ae(r,Vk)?Gk(i):Gk(`MicroFiber.runLoop: Not a valid effect: ${String(r)}`)}}getCont(t){for(;;){const n=this._stack.pop();if(!n)return;const r=n[av]&&n[av](this);if(r)return{[t]:r};if(n[t])return n}}yieldWith(t){return this._yielded=t,Lb}children(){return this._children??(this._children=new Set)}}const cN=St("effect/Micro/fiberMiddleware",()=>({interruptChildren:void 0})),mz=Symbol.for("effect/Micro/identifier"),Tr=Symbol.for("effect/Micro/args"),Vk=Symbol.for("effect/Micro/evaluate"),fh=Symbol.for("effect/Micro/successCont"),Ld=Symbol.for("effect/Micro/failureCont"),av=Symbol.for("effect/Micro/ensureCont"),Lb=Symbol.for("effect/Micro/Yield"),lZ={_A:Ie,_E:Ie,_R:Ie},uZ={...ZJ,_op:"Micro",[eZ]:lZ,pipe(){return xe(this,arguments)},[Symbol.iterator](){return new Uj(new Rh(this))},toJSON(){return{_id:"Micro",op:this[mz],...Tr in this?{args:this[Tr]}:void 0}},toString(){return hn(this)},[Gt](){return hn(this)}};function fZ(e){return Gk("Micro.evaluate: Not implemented")}const ew=e=>({...uZ,[mz]:e.op,[Vk]:e.eval??fZ,[fh]:e.contA,[Ld]:e.contE,[av]:e.ensure}),HR=e=>{const t=ew(e);return function(){const n=Object.create(t);return n[Tr]=e.single===!1?arguments:arguments[0],n}},gz=e=>{const t={...ew(e),[sv]:sv,_tag:e.op,get[e.prop](){return this[Tr]},toJSON(){return{_id:"MicroExit",_tag:e.op,[e.prop]:this[Tr]}},[Ze](n){return pZ(n)&&n._tag===e.op&&Ge(this[Tr],n[Tr])},[nt](){return Yt(this,Qe(qn(e.op))(we(this[Tr])))}};return function(n){const r=Object.create(t);return r[Tr]=n,r[fh]=void 0,r[Ld]=void 0,r[av]=void 0,r}},BR=gz({op:"Success",prop:"value",eval(e){const t=e.getCont(fh);return t?t[fh](this[Tr],e):e.yieldWith(this)}}),pz=gz({op:"Failure",prop:"cause",eval(e){let t=e.getCont(Ld);for(;iZ(this[Tr])&&t&&e.interruptible;)t=e.getCont(Ld);return t?t[Ld](this[Tr],e):e.yieldWith(this)}}),dZ=HR({op:"Yield",eval(e){let t=!1;return e.getRef(QR).scheduleTask(()=>{t||e.evaluate(_Z)},this[Tr]??0),e.yieldWith(()=>{t=!0})}}),hZ=dZ(0),mZ=BR(void 0),VR=HR({op:"WithMicroFiber",eval(e){return this[Tr](e)}}),iv=D(2,(e,t)=>{const n=Object.create(gZ);return n[Tr]=e,n[fh]=t,n}),gZ=ew({op:"OnSuccess",eval(e){return e._stack.push(this),this[Tr]}}),pZ=e=>Ae(e,sv),_z=BR,GR=pz,KR=GR(aZ()),Gk=e=>GR(rZ(e)),_Z=_z(void 0),yZ="setImmediate"in globalThis?globalThis.setImmediate:e=>setTimeout(e,0);class yz{constructor(){y(this,"tasks",[]);y(this,"running",!1);y(this,"afterScheduled",()=>{this.running=!1,this.runTasks()})}scheduleTask(t,n){this.tasks.push(t),this.running||(this.running=!0,yZ(this.afterScheduled))}runTasks(){const t=this.tasks;this.tasks=[];for(let n=0,r=t.length;n<r;n++)t[n]()}shouldYield(t){return t.currentOpCount>=t.getRef(vZ)}flush(){for(;this.tasks.length>0;)this.runTasks()}}const bZ=D(2,(e,t)=>VR(n=>{const r=n.context;return n.context=t(r),TZ(e,()=>(n.context=r,mZ))})),SZ=D(2,(e,t)=>bZ(e,_l(t)));class vZ extends g0()("effect/Micro/currentMaxOpsBeforeYield",{defaultValue:()=>2048}){}class QR extends g0()("effect/Micro/currentScheduler",{defaultValue:()=>new yz}){}const wZ=D(2,(e,t)=>{const n=Object.create(EZ);return n[Tr]=e,n[fh]=t.onSuccess,n[Ld]=t.onFailure,n}),EZ=ew({op:"OnSuccessAndFailure",eval(e){return e._stack.push(this),this[Tr]}}),TZ=D(2,(e,t)=>CZ(n=>wZ(n(e),{onFailure:r=>iv(t(GR(r)),()=>pz(r)),onSuccess:r=>iv(t(_z(r)),()=>BR(r))}))),bz=HR({op:"SetInterruptible",ensure(e){if(e.interruptible=this[Tr],e._interrupted&&e.interruptible)return()=>KR}}),kZ=e=>VR(t=>t.interruptible?e:(t.interruptible=!0,t._stack.push(bz(!1)),t._interrupted?KR:e)),CZ=e=>VR(t=>t.interruptible?(t.interruptible=!1,t._stack.push(bz(!0)),e(kZ)):e(Ie)),AZ=(e,t)=>{const n=new cZ(QR.context(new yz));return n.evaluate(e),n};class Sz{constructor(){y(this,"buckets",[])}scheduleTask(t,n){const r=this.buckets.length;let i,c=0;for(;c<r&&this.buckets[c][0]<=n;c++)i=this.buckets[c];i&&i[0]===n?i[1].push(t):c===r?this.buckets.push([n,[t]]):this.buckets.splice(c,0,[n,[t]])}}class RZ{constructor(t){y(this,"maxNextTickBeforeTimer");y(this,"running",!1);y(this,"tasks",new Sz);this.maxNextTickBeforeTimer=t}starveInternal(t){const n=this.tasks.buckets;this.tasks.buckets=[];for(const[r,i]of n)for(let c=0;c<i.length;c++)i[c]();this.tasks.buckets.length===0?this.running=!1:this.starve(t)}starve(t=0){t>=this.maxNextTickBeforeTimer?setTimeout(()=>this.starveInternal(0),0):Promise.resolve(void 0).then(()=>this.starveInternal(t+1))}shouldYield(t){return t.currentOpCount>t.getFiberRef(_U)?t.getFiberRef(hf):!1}scheduleTask(t,n){this.tasks.scheduleTask(t,n),this.running||(this.running=!0,this.starve())}}const vz=St(Symbol.for("effect/Scheduler/defaultScheduler"),()=>new RZ(2048));class wz{constructor(){y(this,"tasks",new Sz);y(this,"deferred",!1)}scheduleTask(t,n){this.deferred?vz.scheduleTask(t,n):this.tasks.scheduleTask(t,n)}shouldYield(t){return t.currentOpCount>t.getFiberRef(_U)?t.getFiberRef(hf):!1}flush(){for(;this.tasks.buckets.length>0;){const t=this.tasks.buckets;this.tasks.buckets=[];for(const[n,r]of t)for(let i=0;i<r.length;i++)r[i]()}this.deferred=!0}}const tw=St(Symbol.for("effect/FiberRef/currentScheduler"),()=>Kr(vz)),Ez=St(Symbol.for("effect/FiberRef/currentRequestMap"),()=>Kr(new Map)),lN=(e,t,n,r)=>{switch(e){case void 0:return t();case"unbounded":return n();case"inherit":return Ph(HY,i=>i==="unbounded"?n():i>1?r(i):t());default:return e>1?r(e):t()}},YR="InterruptSignal",WR="Stateful",JR="Resume",XR="YieldNow",qT=e=>({_tag:YR,cause:e}),fS=e=>({_tag:WR,onFiber:e}),gd=e=>({_tag:JR,effect:e}),xZ=()=>({_tag:XR}),OZ="effect/FiberScope",ov=Symbol.for(OZ);var cM;cM=ov;class DZ{constructor(){y(this,cM,ov);y(this,"fiberId",Oa);y(this,"roots",new Set)}add(t,n){this.roots.add(n),n.addObserver(()=>{this.roots.delete(n)})}}var lM;lM=ov;class qZ{constructor(t,n){y(this,"fiberId");y(this,"parent");y(this,lM,ov);this.fiberId=t,this.parent=n}add(t,n){this.parent.tell(fS(r=>{r.addChild(n),n.addObserver(()=>{r.removeChild(n)})}))}}const NZ=e=>new qZ(e.id(),e),$_=St(Symbol.for("effect/FiberScope/Global"),()=>new DZ),$Z="effect/Fiber",IZ=Symbol.for($Z),MZ={_E:e=>e,_A:e=>e},jZ="effect/Fiber",FZ=Symbol.for(jZ),Tz=e=>e.await,LZ=e=>e.inheritAll,UZ=D(2,(e,t)=>j(Vu(e,kz(t)),Nt(j(e,Vu(Tz))))),kz=D(2,(e,t)=>e.interruptAsFork(t)),dh=e=>Zc(zh(e.await),e.inheritAll);({...f_});const Lc="effect/FiberCurrent",zZ=()=>of(globalThis[Lc]),PZ="effect/Logger",HZ=Symbol.for(PZ),BZ={_Message:e=>e,_Output:e=>e},I_=e=>({[HZ]:BZ,log:e,pipe(){return xe(this,arguments)}}),VZ=/^[^\s"=]*$/,GZ=(e,t)=>({annotations:n,cause:r,date:i,fiberId:c,logLevel:f,message:m,spans:g})=>{const b=N=>N.match(VZ)?N:e(N),S=(N,H)=>`${BU(N)}=${b(H)}`,v=(N,H)=>" "+S(N,H);let q=S("timestamp",i.toISOString());q+=v("level",f.label),q+=v("fiber",O0(c));const k=TA(m);for(let N=0;N<k.length;N++)q+=v("message",xu(k[N],t));WQ(r)||(q+=v("cause",yl(r,{renderErrorCause:!0})));for(const N of g)q+=" "+IR(i.getTime())(N);for(const[N,H]of n)q+=v(N,xu(H,t));return q},KZ=e=>`"${e.replace(/\\([\s\S])|(")/g,"\\$1$2")}"`,QZ=I_(GZ(KZ)),Cz=e=>{switch(typeof e){case"bigint":case"function":case"symbol":return String(e);default:return Cn(e)}},YZ=(e,...t)=>{let n="";for(let r=0;r<t.length;r++)n+=`\x1B[${t[r]}m`;return n+e+"\x1B[0m"},WZ=(e,...t)=>e,_a={bold:"1",red:"31",green:"32",yellow:"33",blue:"34",cyan:"36",white:"37",gray:"90",black:"30",bgBrightRed:"101"},JZ={None:[],All:[],Trace:[_a.gray],Debug:[_a.blue],Info:[_a.green],Warning:[_a.yellow],Error:[_a.red],Fatal:[_a.bgBrightRed,_a.black]},XZ={None:"",All:"",Trace:"color:gray",Debug:"color:blue",Info:"color:green",Warning:"color:orange",Error:"color:red",Fatal:"background-color:red;color:white"},ZZ=e=>`${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}:${e.getSeconds().toString().padStart(2,"0")}.${e.getMilliseconds().toString().padStart(3,"0")}`,Az=typeof process=="object"&&process!==null&&typeof process.stdout=="object"&&process.stdout!==null,eee=Az&&process.stdout.isTTY===!0,tee=Az||"Deno"in globalThis,nee=e=>{const t=(e==null?void 0:e.mode)??"auto",r=(t==="auto"?tee?"tty":"browser":t)==="browser",i=typeof(e==null?void 0:e.colors)=="boolean"?e.colors:eee||r,c=(e==null?void 0:e.formatDate)??ZZ;return r?see({colors:i,formatDate:c}):ree({colors:i,formatDate:c,stderr:(e==null?void 0:e.stderr)===!0})},ree=e=>{const t=typeof process=="object"&&"isBun"in process&&process.isBun===!0,n=e.colors?YZ:WZ;return I_(({annotations:r,cause:i,context:c,date:f,fiberId:m,logLevel:g,message:b,spans:S})=>{const v=NR(c,Ui),q=Ws(v,Y0).unsafe,k=e.stderr===!0?q.error:q.log,N=TA(b);let H=n(`[${e.formatDate(f)}]`,_a.white)+` ${n(g.label,...JZ[g._tag])} (${O0(m)})`;if(tR(S)){const C=f.getTime(),E=IR(C);for(const $ of S)H+=" "+E($)}H+=":";let x=0;if(N.length>0){const C=Cz(N[0]);typeof C=="string"&&(H+=" "+n(C,_a.bold,_a.cyan),x++)}if(k(H),t||q.group(),iR(i)||k(yl(i,{renderErrorCause:!0})),x<N.length)for(;x<N.length;x++)k(yp(N[x]));if($L(r)>0)for(const[C,E]of r)k(n(`${C}:`,_a.bold,_a.white),yp(E));t||q.groupEnd()})},see=e=>{const t=e.colors?"%c":"";return I_(({annotations:n,cause:r,context:i,date:c,fiberId:f,logLevel:m,message:g,spans:b})=>{const S=NR(i,Ui),v=Ws(S,Y0).unsafe,q=TA(g);let k=`${t}[${e.formatDate(c)}]`;const N=[];if(e.colors&&N.push("color:gray"),k+=` ${t}${m.label}${t} (${O0(f)})`,e.colors&&N.push(XZ[m._tag],""),tR(b)){const x=c.getTime(),C=IR(x);for(const E of b)k+=" "+C(E)}k+=":";let H=0;if(q.length>0){const x=Cz(q[0]);typeof x=="string"&&(k+=` ${t}${x}`,e.colors&&N.push("color:deepskyblue"),H++)}if(v.groupCollapsed(k,...N),iR(r)||v.error(yl(r,{renderErrorCause:!0})),H<q.length)for(;H<q.length;H++)v.log(yp(q[H]));if($L(n)>0)for(const[x,C]of n){const E=yp(C);e.colors?v.log(`%c${x}:`,"color:gray",E):v.log(`${x}:`,E)}v.groupEnd()})},Rz="effect/MetricBoundaries",Kk=Symbol.for(Rz);var uM;class aee{constructor(t){y(this,"values");y(this,uM,Kk);y(this,"_hash");this.values=t,this._hash=j(qn(Rz),Qe(c_(this.values)))}[(uM=Kk,nt)](){return this._hash}[Ze](t){return iee(t)&&Ge(this.values,t.values)}pipe(){return xe(this,arguments)}}const iee=e=>Ae(e,Kk),oee=e=>{const t=j(e,kA(Sn(Number.POSITIVE_INFINITY)),xV);return new aee(t)},cee=e=>j(oV(e.count-1,t=>e.start*Math.pow(e.factor,t)),Bn,oee),lee="effect/MetricKeyType",xz=Symbol.for(lee),Oz="effect/MetricKeyType/Counter",Qk=Symbol.for(Oz),uee="effect/MetricKeyType/Frequency",fee=Symbol.for(uee),dee="effect/MetricKeyType/Gauge",hee=Symbol.for(dee),Dz="effect/MetricKeyType/Histogram",Yk=Symbol.for(Dz),mee="effect/MetricKeyType/Summary",gee=Symbol.for(mee),qz={_In:e=>e,_Out:e=>e};var fM,dM;class pee{constructor(t,n){y(this,"incremental");y(this,"bigint");y(this,dM,qz);y(this,fM,Qk);y(this,"_hash");this.incremental=t,this.bigint=n,this._hash=qn(Oz)}[(dM=xz,fM=Qk,nt)](){return this._hash}[Ze](t){return Nz(t)}pipe(){return xe(this,arguments)}}var hM,mM;class _ee{constructor(t){y(this,"boundaries");y(this,mM,qz);y(this,hM,Yk);y(this,"_hash");this.boundaries=t,this._hash=j(qn(Dz),Qe(we(this.boundaries)))}[(mM=xz,hM=Yk,nt)](){return this._hash}[Ze](t){return $z(t)&&Ge(this.boundaries,t.boundaries)}pipe(){return xe(this,arguments)}}const yee=e=>new pee((e==null?void 0:e.incremental)??!1,(e==null?void 0:e.bigint)??!1),bee=e=>new _ee(e),Nz=e=>Ae(e,Qk),See=e=>Ae(e,fee),vee=e=>Ae(e,hee),$z=e=>Ae(e,Yk),wee=e=>Ae(e,gee),Eee="effect/MetricKey",Iz=Symbol.for(Eee),Tee={_Type:e=>e},kee=h_(Ge);var gM;class ZR{constructor(t,n,r,i=[]){y(this,"name");y(this,"keyType");y(this,"description");y(this,"tags");y(this,gM,Tee);y(this,"_hash");this.name=t,this.keyType=n,this.description=r,this.tags=i,this._hash=j(qn(this.name+this.description),Qe(we(this.keyType)),Qe(c_(this.tags)))}[(gM=Iz,nt)](){return this._hash}[Ze](t){return Cee(t)&&this.name===t.name&&Ge(this.keyType,t.keyType)&&Ge(this.description,t.description)&&kee(this.tags,t.tags)}pipe(){return xe(this,arguments)}}const Cee=e=>Ae(e,Iz),Aee=(e,t)=>new ZR(e,yee(t),of(t==null?void 0:t.description)),Ree=(e,t,n)=>new ZR(e,bee(t),of(n)),xee=D(2,(e,t)=>t.length===0?e:new ZR(e.name,e.keyType,e.description,rS(e.tags,t))),Oee="effect/MetricState",M_=Symbol.for(Oee),Mz="effect/MetricState/Counter",Wk=Symbol.for(Mz),jz="effect/MetricState/Frequency",Jk=Symbol.for(jz),Fz="effect/MetricState/Gauge",Xk=Symbol.for(Fz),Lz="effect/MetricState/Histogram",Zk=Symbol.for(Lz),Uz="effect/MetricState/Summary",eC=Symbol.for(Uz),j_={_A:e=>e};var pM,_M;class Dee{constructor(t){y(this,"count");y(this,_M,j_);y(this,pM,Wk);this.count=t}[(_M=M_,pM=Wk,nt)](){return j(we(Mz),Qe(we(this.count)),Yt(this))}[Ze](t){return Pee(t)&&this.count===t.count}pipe(){return xe(this,arguments)}}const qee=h_(Ge);var yM,bM;class Nee{constructor(t){y(this,"occurrences");y(this,bM,j_);y(this,yM,Jk);y(this,"_hash");this.occurrences=t}[(bM=M_,yM=Jk,nt)](){return j(qn(jz),Qe(c_(Ht(this.occurrences.entries()))),Yt(this))}[Ze](t){return Hee(t)&&qee(Ht(this.occurrences.entries()),Ht(t.occurrences.entries()))}pipe(){return xe(this,arguments)}}var SM,vM;class $ee{constructor(t){y(this,"value");y(this,vM,j_);y(this,SM,Xk);this.value=t}[(vM=M_,SM=Xk,nt)](){return j(we(Fz),Qe(we(this.value)),Yt(this))}[Ze](t){return Bee(t)&&this.value===t.value}pipe(){return xe(this,arguments)}}var wM,EM;class Iee{constructor(t,n,r,i,c){y(this,"buckets");y(this,"count");y(this,"min");y(this,"max");y(this,"sum");y(this,EM,j_);y(this,wM,Zk);this.buckets=t,this.count=n,this.min=r,this.max=i,this.sum=c}[(EM=M_,wM=Zk,nt)](){return j(we(Lz),Qe(we(this.buckets)),Qe(we(this.count)),Qe(we(this.min)),Qe(we(this.max)),Qe(we(this.sum)),Yt(this))}[Ze](t){return Vee(t)&&Ge(this.buckets,t.buckets)&&this.count===t.count&&this.min===t.min&&this.max===t.max&&this.sum===t.sum}pipe(){return xe(this,arguments)}}var TM,kM;class Mee{constructor(t,n,r,i,c,f){y(this,"error");y(this,"quantiles");y(this,"count");y(this,"min");y(this,"max");y(this,"sum");y(this,kM,j_);y(this,TM,eC);this.error=t,this.quantiles=n,this.count=r,this.min=i,this.max=c,this.sum=f}[(kM=M_,TM=eC,nt)](){return j(we(Uz),Qe(we(this.error)),Qe(we(this.quantiles)),Qe(we(this.count)),Qe(we(this.min)),Qe(we(this.max)),Qe(we(this.sum)),Yt(this))}[Ze](t){return Gee(t)&&this.error===t.error&&Ge(this.quantiles,t.quantiles)&&this.count===t.count&&this.min===t.min&&this.max===t.max&&this.sum===t.sum}pipe(){return xe(this,arguments)}}const jee=e=>new Dee(e),Fee=e=>new Nee(e),Lee=e=>new $ee(e),Uee=e=>new Iee(e.buckets,e.count,e.min,e.max,e.sum),zee=e=>new Mee(e.error,e.quantiles,e.count,e.min,e.max,e.sum),Pee=e=>Ae(e,Wk),Hee=e=>Ae(e,Jk),Bee=e=>Ae(e,Xk),Vee=e=>Ae(e,Zk),Gee=e=>Ae(e,eC),Kee="effect/MetricHook",Qee=Symbol.for(Kee),Yee={_In:e=>e,_Out:e=>e},F_=e=>({[Qee]:Yee,pipe(){return xe(this,arguments)},...e}),uN=BigInt(0),Wee=e=>{let t=e.keyType.bigint?uN:0;const n=e.keyType.incremental?e.keyType.bigint?i=>i>=uN:i=>i>=0:i=>!0,r=i=>{n(i)&&(t=t+i)};return F_({get:()=>jee(t),update:r,modify:r})},Jee=e=>{const t=new Map;for(const r of e.keyType.preregisteredWords)t.set(r,0);const n=r=>{const i=t.get(r)??0;t.set(r,i+1)};return F_({get:()=>Fee(t),update:n,modify:n})},Xee=(e,t)=>{let n=t;return F_({get:()=>Lee(n),update:r=>{n=r},modify:r=>{n=n+r}})},Zee=e=>{const t=e.keyType.boundaries.values,n=t.length,r=new Uint32Array(n+1),i=new Float32Array(n);let c=0,f=0,m=Number.MAX_VALUE,g=Number.MIN_VALUE;j(t,bp(Yd),Su((v,q)=>{i[q]=v}));const b=v=>{let q=0,k=n;for(;q!==k;){const N=Math.floor(q+(k-q)/2),H=i[N];v<=H?k=N:q=N,k===q+1&&(v<=i[q]?k=q:q=k)}r[q]=r[q]+1,c=c+1,f=f+v,v<m&&(m=v),v>g&&(g=v)},S=()=>{const v=o0(n);let q=0;for(let k=0;k<n;k++){const N=i[k],H=r[k];q=q+H,v[k]=[N,q]}return v};return F_({get:()=>Uee({buckets:S(),count:c,min:m,max:g,sum:f}),update:b,modify:b})},ete=e=>{const{error:t,maxAge:n,maxSize:r,quantiles:i}=e.keyType,c=j(i,bp(Yd)),f=o0(r);let m=0,g=0,b=0,S=Number.MAX_VALUE,v=Number.MIN_VALUE;const q=N=>{const H=[];let x=0;for(;x!==r-1;){const C=f[x];if(C!=null){const[E,$]=C,R=ju(N-E);vG(R,UA)&&hL(R,n)&&H.push($)}x=x+1}return tte(t,c,bp(H,Yd))},k=(N,H)=>{if(r>0){m=m+1;const x=m%r;f[x]=[H,N]}g=g+1,b=b+N,N<S&&(S=N),N>v&&(v=N)};return F_({get:()=>zee({error:t,quantiles:q(Date.now()),count:g,min:S,max:v,sum:b}),update:([N,H])=>k(N,H),modify:([N,H])=>k(N,H)})},tte=(e,t,n)=>{const r=n.length;if(!bn(t))return rl();const i=t[0],c=t.slice(1),f=fN(e,r,me(),0,i,n),m=pa(f);return c.forEach(g=>{m.push(fN(e,r,f.value,f.consumed,g,f.rest))}),Su(m,g=>[g.quantile,g.value])},fN=(e,t,n,r,i,c)=>{let f=e,m=t,g=n,b=r,S=i,v=c,q=e,k=t,N=n,H=r,x=i,C=c;for(;;){if(!bn(v))return{quantile:S,value:me(),consumed:b,rest:[]};if(S===1)return{quantile:S,value:pe(fF(v)),consumed:b+v.length,rest:[]};const E=Ss(v),$=dF(v,K=>K===E),R=S*m,I=f/2*R,z=b+$[0].length,V=Math.abs(z-R);if(z<R-I){q=f,k=m,N=tp(v),H=z,x=S,C=$[1],f=q,m=k,g=N,b=H,S=x,v=C;continue}if(z>R+I){const K=_n(g)?pe(E):g;return{quantile:S,value:K,consumed:b,rest:v}}switch(g._tag){case"None":{q=f,k=m,N=tp(v),H=z,x=S,C=$[1],f=q,m=k,g=N,b=H,S=x,v=C;continue}case"Some":{const K=Math.abs(R-g.value);if(V<K){q=f,k=m,N=tp(v),H=z,x=S,C=$[1],f=q,m=k,g=N,b=H,S=x,v=C;continue}return{quantile:S,value:pe(g.value),consumed:b,rest:v}}}}throw new Error("BUG: MetricHook.resolveQuantiles - please report an issue at https://github.com/Effect-TS/effect/issues")},nte="effect/MetricPair",rte=Symbol.for(nte),ste={_Type:e=>e},ate=(e,t)=>({[rte]:ste,metricKey:e,metricState:t,pipe(){return xe(this,arguments)}}),ite="effect/MetricRegistry",dN=Symbol.for(ite);var CM;CM=dN;class ote{constructor(){y(this,CM,dN);y(this,"map",CW())}snapshot(){const t=[];for(const[n,r]of this.map)t.push(ate(n,r.get()));return t}get(t){const n=j(this.map,iu(t),ba);if(n==null){if(Nz(t.keyType))return this.getCounter(t);if(vee(t.keyType))return this.getGauge(t);if(See(t.keyType))return this.getFrequency(t);if($z(t.keyType))return this.getHistogram(t);if(wee(t.keyType))return this.getSummary(t);throw new Error("BUG: MetricRegistry.get - unknown MetricKeyType - please report an issue at https://github.com/Effect-TS/effect/issues")}else return n}getCounter(t){let n=j(this.map,iu(t),ba);if(n==null){const r=Wee(t);j(this.map,kg(t))||j(this.map,Cg(t,r)),n=r}return n}getFrequency(t){let n=j(this.map,iu(t),ba);if(n==null){const r=Jee(t);j(this.map,kg(t))||j(this.map,Cg(t,r)),n=r}return n}getGauge(t){let n=j(this.map,iu(t),ba);if(n==null){const r=Xee(t,t.keyType.bigint?BigInt(0):0);j(this.map,kg(t))||j(this.map,Cg(t,r)),n=r}return n}getHistogram(t){let n=j(this.map,iu(t),ba);if(n==null){const r=Zee(t);j(this.map,kg(t))||j(this.map,Cg(t,r)),n=r}return n}getSummary(t){let n=j(this.map,iu(t),ba);if(n==null){const r=ete(t);j(this.map,kg(t))||j(this.map,Cg(t,r)),n=r}return n}}const cte=()=>new ote,lte="effect/Metric",ute=Symbol.for(lte),fte={_Type:e=>e,_In:e=>e,_Out:e=>e},hN=St(Symbol.for("effect/Metric/globalMetricRegistry"),()=>cte()),zz=function(e,t,n,r){const i=Object.assign(c=>zo(c,f=>gte(i,f)),{[ute]:fte,keyType:e,unsafeUpdate:t,unsafeValue:n,unsafeModify:r,register(){return this.unsafeValue([]),this},pipe(){return xe(this,arguments)}});return i},nw=(e,t)=>Pz(Aee(e,t)),Pz=e=>{let t;const n=new WeakMap,r=i=>{if(i.length===0)return t!==void 0||(t=hN.get(e)),t;let c=n.get(i);return c!==void 0||(c=hN.get(xee(e,i)),n.set(i,c)),c};return zz(e.keyType,(i,c)=>r(c).update(i),i=>r(i).get(),(i,c)=>r(c).modify(i))},dte=(e,t,n)=>Pz(Ree(e,t,n)),hte=D(3,(e,t,n)=>mte(e,[oX(t,n)])),mte=D(2,(e,t)=>zz(e.keyType,(n,r)=>e.unsafeUpdate(n,rS(t,r)),n=>e.unsafeValue(rS(t,n)),(n,r)=>e.unsafeModify(n,rS(t,r)))),gte=D(2,(e,t)=>Ph(qk,n=>he(()=>e.unsafeUpdate(t,n)))),pte="effect/Request",_te=Symbol.for(pte),yte={_E:e=>e,_A:e=>e},bte={...SA,[_te]:yte},Ste=(function(){function e(t){t&&Object.assign(this,t)}return e.prototype=bte,e})(),vte=D(2,(e,t)=>Ph(Ez,n=>he(()=>{if(n.has(e)){const r=n.get(e);r.state.completed||(r.state.completed=!0,D_(r.result,t))}}))),wte="effect/Supervisor",rw=Symbol.for(wte),e2={_T:e=>e};var AM;AM=rw;const Qx=class Qx{constructor(t,n){y(this,"underlying");y(this,"value0");y(this,AM,e2);this.underlying=t,this.value0=n}get value(){return this.value0}onStart(t,n,r,i){this.underlying.onStart(t,n,r,i)}onEnd(t,n){this.underlying.onEnd(t,n)}onEffect(t,n){this.underlying.onEffect(t,n)}onSuspend(t){this.underlying.onSuspend(t)}onResume(t){this.underlying.onResume(t)}map(t){return new Qx(this,j(this.value,Ye(t)))}zip(t){return new lv(this,t)}};let cv=Qx;var RM;RM=rw;const Yx=class Yx{constructor(t,n){y(this,"left");y(this,"right");y(this,"_tag","Zip");y(this,RM,e2);this.left=t,this.right=n}get value(){return dU(this.left.value,this.right.value)}onStart(t,n,r,i){this.left.onStart(t,n,r,i),this.right.onStart(t,n,r,i)}onEnd(t,n){this.left.onEnd(t,n),this.right.onEnd(t,n)}onEffect(t,n){this.left.onEffect(t,n),this.right.onEffect(t,n)}onSuspend(t){this.left.onSuspend(t),this.right.onSuspend(t)}onResume(t){this.left.onResume(t),this.right.onResume(t)}map(t){return new cv(this,j(this.value,Ye(t)))}zip(t){return new Yx(this,t)}};let lv=Yx;const Hz=e=>Ae(e,rw)&&mA(e,"Zip");var xM;xM=rw;class Ete{constructor(t){y(this,"effect");y(this,xM,e2);this.effect=t}get value(){return this.effect}onStart(t,n,r,i){}onEnd(t,n){}onEffect(t,n){}onSuspend(t){}onResume(t){}map(t){return new cv(this,j(this.value,Ye(t)))}zip(t){return new lv(this,t)}onRun(t,n){return t()}}const Tte=e=>new Ete(e),sw=St("effect/Supervisor/none",()=>Tte(it)),kte=$h,Bz="Empty",Vz="AddSupervisor",Gz="RemoveSupervisor",Kz="AndThen",sp={_tag:Bz},dS=(e,t)=>({_tag:Kz,first:e,second:t}),Cte=(e,t)=>Ate(t,Sn(e)),Ate=(e,t)=>{let n=e,r=t;for(;Ii(r);){const i=Ri(r);switch(i._tag){case Bz:{r=Co(r);break}case Vz:{n=n.zip(i.supervisor),r=Co(r);break}case Gz:{n=tC(n,i.supervisor),r=Co(r);break}case Kz:{r=Gr(i.first)(Gr(i.second)(Co(r)));break}}}return n},tC=(e,t)=>Ge(e,t)?sw:Hz(e)?tC(e.left,t).zip(tC(e.right,t)):e,uv=e=>Ge(e,sw)?Lu():Hz(e)?j(uv(e.left),kp(uv(e.right))):R0(e),Rte=(e,t)=>{if(Ge(e,t))return sp;const n=uv(e),r=uv(t),i=j(r,bq(n),Cp(sp,(f,m)=>dS(f,{_tag:Vz,supervisor:m}))),c=j(n,bq(r),Cp(sp,(f,m)=>dS(f,{_tag:Gz,supervisor:m})));return dS(i,c)},xte=kte({empty:sp,patch:Cte,combine:dS,diff:Rte}),Ote=nw("effect_fiber_started",{incremental:!0}),mN=nw("effect_fiber_active"),Dte=nw("effect_fiber_successes",{incremental:!0}),qte=nw("effect_fiber_failures",{incremental:!0}),Nte=hte(dte("effect_fiber_lifetimes",cee({start:.5,factor:2,count:35})),"time_unit","milliseconds"),Rg="Continue",$te="Done",gN="Yield",Ite={_E:e=>e,_A:e=>e},Ub=e=>{throw new Error(`BUG: FiberRuntime - ${xu(e)} - please report an issue at https://github.com/Effect-TS/effect/issues`)},_o=Symbol.for("effect/internal/fiberRuntime/YieldedOp"),yo=St("effect/internal/fiberRuntime/yieldedOpChannel",()=>({currentOp:null})),xg={[RS]:(e,t,n)=>nn(()=>t.effect_instruction_i1(n)),OnStep:(e,t,n)=>Pt(Pt(n)),[xS]:(e,t,n)=>nn(()=>t.effect_instruction_i2(n)),[bA]:(e,t,n)=>(e.patchRuntimeFlags(e.currentRuntimeFlags,t.patch),Uc(e.currentRuntimeFlags)&&e.isInterrupted()?zt(e.getInterruptedCause()):Pt(n)),[OS]:(e,t,n)=>(nn(()=>t.effect_instruction_i2(n)),nn(()=>t.effect_instruction_i0())?(e.pushStack(t),nn(()=>t.effect_instruction_i1())):it),[ep]:(e,t,n)=>{const r=nn(()=>t.effect_instruction_i0.next(n));return r.done?Pt(r.value):(e.pushStack(t),Pj(r.value))}},Mte={[YR]:(e,t,n,r)=>(e.processNewInterruptSignal(r.cause),Uc(t)?zt(r.cause):n),[JR]:(e,t,n,r)=>{throw new Error("It is illegal to have multiple concurrent run loops in a single fiber")},[WR]:(e,t,n,r)=>(r.onFiber(e,dz(t)),n),[XR]:(e,t,n,r)=>se(T_(),()=>n)},jte=e=>Vu($Q(e),t=>$o(QQ(t),([n,r])=>{const i=new Map,c=[];for(const m of r){c.push(xa(m));for(const g of m)i.set(g.request,g)}const f=c.flat();return df(ane(n.runAll(c),f,()=>f.forEach(m=>{m.listeners.interrupted=!0})),Ez,i)},!1,!1)),Fte=t0();var OM,DM;class Qz extends Gi{constructor(n,r,i){super();y(this,DM,MZ);y(this,OM,Ite);y(this,"_fiberRefs");y(this,"_fiberId");y(this,"_queue",new Array);y(this,"_children",null);y(this,"_observers",new Array);y(this,"_running",!1);y(this,"_stack",[]);y(this,"_asyncInterruptor",null);y(this,"_asyncBlockingOn",null);y(this,"_exitValue",null);y(this,"_steps",[]);y(this,"_isYielding",!1);y(this,"currentRuntimeFlags");y(this,"currentOpCount",0);y(this,"currentSupervisor");y(this,"currentScheduler");y(this,"currentTracer");y(this,"currentSpan");y(this,"currentContext");y(this,"currentDefaultServices");y(this,"run",()=>{this.drainQueueOnCurrentThread()});if(this.currentRuntimeFlags=i,this._fiberId=n,this._fiberRefs=r,Tq(i)){const c=this.getFiberRef(qk);Ote.unsafeUpdate(1,c),mN.unsafeUpdate(1,c)}this.refreshRefCache()}commit(){return dh(this)}id(){return this._fiberId}resume(n){this.tell(gd(n))}get status(){return this.ask((n,r)=>r)}get runtimeFlags(){return this.ask((n,r)=>ZX(r)?n.currentRuntimeFlags:r.runtimeFlags)}scope(){return NZ(this)}get children(){return this.ask(n=>Array.from(n.getChildren()))}getChildren(){return this._children===null&&(this._children=new Set),this._children}getInterruptedCause(){return this.getFiberRef(Fb)}fiberRefs(){return this.ask(n=>n.getFiberRefs())}ask(n){return Ne(()=>{const r=R_(this._fiberId);return this.tell(fS((i,c)=>{D_(r,he(()=>n(i,c)))})),Fi(r)})}tell(n){this._queue.push(n),this._running||(this._running=!0,this.drainQueueLaterOnExecutor())}get await(){return Lo(n=>{const r=i=>n(fe(i));return this.tell(fS((i,c)=>{i._exitValue!==null?r(this._exitValue):i.addObserver(r)})),he(()=>this.tell(fS((i,c)=>{i.removeObserver(r)})))},this.id())}get inheritAll(){return yt((n,r)=>{const i=n.id(),c=n.getFiberRefs(),f=r.runtimeFlags,m=this.getFiberRefs(),g=UJ(c,i,m);n.setFiberRefs(g);const b=n.getFiberRef(bN),S=j(wu(f,b),Cq(Ih),Cq(xk));return wY(S)})}get poll(){return he(()=>of(this._exitValue))}unsafePoll(){return this._exitValue}interruptAsFork(n){return he(()=>this.tell(qT(Sa(n))))}unsafeInterruptAsFork(n){this.tell(qT(Sa(n)))}addObserver(n){this._exitValue!==null?n(this._exitValue):this._observers.push(n)}removeObserver(n){this._observers=this._observers.filter(r=>r!==n)}getFiberRefs(){return this.setFiberRef(bN,this.currentRuntimeFlags),this._fiberRefs}unsafeDeleteFiberRef(n){this._fiberRefs=UU(this._fiberRefs,n)}getFiberRef(n){return this._fiberRefs.locals.has(n)?this._fiberRefs.locals.get(n)[0][1]:n.initial}setFiberRef(n,r){this._fiberRefs=Fk(this._fiberRefs,{fiberId:this._fiberId,fiberRef:n,value:r}),this.refreshRefCache()}refreshRefCache(){this.currentDefaultServices=this.getFiberRef(Ui),this.currentTracer=this.currentDefaultServices.unsafeMap.get(q_.key),this.currentSupervisor=this.getFiberRef(rne),this.currentScheduler=this.getFiberRef(tw),this.currentContext=this.getFiberRef(ai),this.currentSpan=this.currentContext.unsafeMap.get(Li.key)}setFiberRefs(n){this._fiberRefs=n,this.refreshRefCache()}addChild(n){this.getChildren().add(n)}removeChild(n){this.getChildren().delete(n)}transferChildren(n){const r=this._children;if(this._children=null,r!==null&&r.size>0)for(const i of r)i._exitValue===null&&n.add(this.currentRuntimeFlags,i)}drainQueueOnCurrentThread(){let n=!0;for(;n;){let r=Rg;const i=globalThis[Lc];globalThis[Lc]=this;try{for(;r===Rg;)r=this._queue.length===0?$te:this.evaluateMessageWhileSuspended(this._queue.splice(0,1)[0])}finally{this._running=!1,globalThis[Lc]=i}this._queue.length>0&&!this._running?(this._running=!0,r===gN?(this.drainQueueLaterOnExecutor(),n=!1):n=!0):n=!1}}drainQueueLaterOnExecutor(){this.currentScheduler.scheduleTask(this.run,this.getFiberRef(hf))}drainQueueWhileRunning(n,r){let i=r;for(;this._queue.length>0;){const c=this._queue.splice(0,1)[0];i=Mte[c._tag](this,n,i,c)}return i}isInterrupted(){return!iR(this.getFiberRef(Fb))}addInterruptedCause(n){const r=this.getFiberRef(Fb);this.setFiberRef(Fb,tr(r,n))}processNewInterruptSignal(n){this.addInterruptedCause(n),this.sendInterruptSignalToAllChildren()}sendInterruptSignalToAllChildren(){if(this._children===null||this._children.size===0)return!1;let n=!1;for(const r of this._children)r.tell(qT(Sa(this.id()))),n=!0;return n}interruptAllChildren(){if(this.sendInterruptSignalToAllChildren()){const n=this._children.values();this._children=null;let r=!1;return gR({while:()=>!r,body:()=>{const c=n.next();return c.done?he(()=>{r=!0}):na(c.value.await)},step:()=>{}})}return null}reportExitValue(n){if(Tq(this.currentRuntimeFlags)){const r=this.getFiberRef(qk),i=this.id().startTimeMillis,c=Date.now();switch(Nte.unsafeUpdate(c-i,r),mN.unsafeUpdate(-1,r),n._tag){case Cr:{Dte.unsafeUpdate(1,r);break}case kr:{qte.unsafeUpdate(1,r);break}}}if(n._tag==="Failure"){const r=this.getFiberRef(_R);!I0(n.cause)&&r._tag==="Some"&&this.log("Fiber terminated with an unhandled error",n.cause,r)}}setExitValue(n){this._exitValue=n,this.reportExitValue(n);for(let r=this._observers.length-1;r>=0;r--)this._observers[r](n);this._observers=[]}getLoggers(){return this.getFiberRef(aw)}log(n,r,i){const c=Zt(i)?i.value:this.getFiberRef(UY),f=this.getFiberRef(Yz);if(JJ(f,c))return;const m=this.getFiberRef(zY),g=this.getFiberRef(yU),b=this.getLoggers(),S=this.getFiberRefs();if(WA(b)>0){const v=Ws(this.getFiberRef(Ui),mf),q=new Date(v.unsafeCurrentTimeMillis());v7(S,()=>{for(const k of b)k.log({fiberId:this.id(),logLevel:c,message:n,cause:r,context:S,spans:m,annotations:g,date:q})})}}evaluateMessageWhileSuspended(n){switch(n._tag){case XR:return gN;case YR:return this.processNewInterruptSignal(n.cause),this._asyncInterruptor!==null&&(this._asyncInterruptor(zt(n.cause)),this._asyncInterruptor=null),Rg;case JR:return this._asyncInterruptor=null,this._asyncBlockingOn=null,this.evaluateEffect(n.effect),Rg;case WR:return n.onFiber(this,this._exitValue!==null?JX:XX(this.currentRuntimeFlags,this._asyncBlockingOn)),Rg;default:return Ub(n)}}evaluateEffect(n){this.currentSupervisor.onResume(this);try{let r=Uc(this.currentRuntimeFlags)&&this.isInterrupted()?zt(this.getInterruptedCause()):n;for(;r!==null;){const i=r,c=this.runLoop(i);if(c===_o){const f=yo.currentOp;yo.currentOp=null,f._op===tS?xQ(this.currentRuntimeFlags)?(this.tell(xZ()),this.tell(gd(Pr)),r=null):r=Pr:f._op===Zg&&(r=null)}else{this.currentRuntimeFlags=j(this.currentRuntimeFlags,OQ(xk));const f=this.interruptAllChildren();f!==null?r=se(f,()=>c):(this._queue.length===0?this.setExitValue(c):this.tell(gd(c)),r=null)}}}finally{this.currentSupervisor.onSuspend(this)}}start(n){if(this._running)this.tell(gd(n));else{this._running=!0;const r=globalThis[Lc];globalThis[Lc]=this;try{this.evaluateEffect(n)}finally{this._running=!1,globalThis[Lc]=r,this._queue.length>0&&this.drainQueueLaterOnExecutor()}}}startFork(n){this.tell(gd(n))}patchRuntimeFlags(n,r){const i=jd(n,r);return globalThis[Lc]=this,this.currentRuntimeFlags=i,i}initiateAsync(n,r){let i=!1;const c=f=>{i||(i=!0,this.tell(gd(f)))};Uc(n)&&(this._asyncInterruptor=c);try{r(c)}catch(f){c(en(ns(f)))}}pushStack(n){this._stack.push(n),n._op==="OnStep"&&this._steps.push({refs:this.getFiberRefs(),flags:this.currentRuntimeFlags})}popStack(){const n=this._stack.pop();if(n)return n._op==="OnStep"&&this._steps.pop(),n}getNextSuccessCont(){let n=this.popStack();for(;n;){if(n._op!==eS)return n;n=this.popStack()}}getNextFailCont(){let n=this.popStack();for(;n;){if(n._op!==RS&&n._op!==OS&&n._op!==ep)return n;n=this.popStack()}}[(DM=IZ,OM=FZ,w7)](n){return he(()=>m0(this.currentContext,n))}Left(n){return mn(n.left)}None(n){return mn(new A_)}Right(n){return Pt(n.right)}Some(n){return Pt(n.value)}Micro(n){return xp(r=>{let i=r;const c=AZ(SZ(n,this.currentContext));return c.addObserver(f=>{if(f._tag==="Success")return i(Pt(f.value));switch(f.cause._tag){case"Interrupt":return i(zt(Sa(Oa)));case"Fail":return i(mn(f.cause.error));case"Die":return i(Op(f.cause.defect))}}),xp(f=>{i=m=>{f(it)},c.unsafeInterrupt()})})}[Kj](n){const r=nn(()=>n.effect_instruction_i0()),i=this.getNextSuccessCont();return i!==void 0?(i._op in xg||Ub(i),xg[i._op](this,i,r)):(yo.currentOp=Pt(r),_o)}[Cr](n){const r=n,i=this.getNextSuccessCont();return i!==void 0?(i._op in xg||Ub(i),xg[i._op](this,i,r.effect_instruction_i0)):(yo.currentOp=r,_o)}[kr](n){const r=n.effect_instruction_i0,i=this.getNextFailCont();if(i!==void 0)switch(i._op){case eS:case xS:return Uc(this.currentRuntimeFlags)&&this.isInterrupted()?zt(Aq(r)):nn(()=>i.effect_instruction_i1(r));case"OnStep":return Uc(this.currentRuntimeFlags)&&this.isInterrupted()?zt(Aq(r)):Pt(zt(r));case bA:return this.patchRuntimeFlags(this.currentRuntimeFlags,i.patch),Uc(this.currentRuntimeFlags)&&this.isInterrupted()?zt(tr(r,this.getInterruptedCause())):zt(r);default:Ub(i)}else return yo.currentOp=zt(r),_o}[Qj](n){return nn(()=>n.effect_instruction_i0(this,dz(this.currentRuntimeFlags)))}Blocked(n){const r=this.getFiberRefs(),i=this.currentRuntimeFlags;if(this._steps.length>0){const c=[],f=this._steps[this._steps.length-1];let m=this.popStack();for(;m&&m._op!=="OnStep";)c.push(m),m=this.popStack();this.setFiberRefs(f.refs),this.currentRuntimeFlags=f.flags;const g=Lp(f.refs,r),b=wu(f.flags,i);return Pt(aU(n.effect_instruction_i0,yt(S=>{for(;c.length>0;)S.pushStack(c.pop());return S.setFiberRefs(Up(S.id(),S.getFiberRefs())(g)),S.currentRuntimeFlags=jd(b)(S.currentRuntimeFlags),n.effect_instruction_i1})))}return ks(c=>se(mh(mY(n.effect_instruction_i0)),()=>c(n.effect_instruction_i1)))}RunBlocked(n){return jte(n.effect_instruction_i0)}[xh](n){const r=n.effect_instruction_i0,i=this.currentRuntimeFlags,c=jd(i,r);if(Uc(c)&&this.isInterrupted())return zt(this.getInterruptedCause());if(this.patchRuntimeFlags(this.currentRuntimeFlags,r),n.effect_instruction_i1){const f=wu(c,i);return this.pushStack(new gY(f,n)),nn(()=>n.effect_instruction_i1(i))}else return Pr}[RS](n){return this.pushStack(n),n.effect_instruction_i0}OnStep(n){return this.pushStack(n),n.effect_instruction_i0}[eS](n){return this.pushStack(n),n.effect_instruction_i0}[xS](n){return this.pushStack(n),n.effect_instruction_i0}[Zg](n){return this._asyncBlockingOn=n.effect_instruction_i1,this.initiateAsync(this.currentRuntimeFlags,n.effect_instruction_i0),yo.currentOp=n,_o}[tS](n){return this._isYielding=!1,yo.currentOp=n,_o}[OS](n){const r=n.effect_instruction_i0,i=n.effect_instruction_i1;return r()?(this.pushStack(n),i()):Pr}[ep](n){return xg[ep](this,n,void 0)}[l_](n){return nn(()=>n.commit())}runLoop(n){let r=n;for(this.currentOpCount=0;;){if((this.currentRuntimeFlags&RQ)!==0&&this.currentSupervisor.onEffect(this,r),this._queue.length>0&&(r=this.drainQueueWhileRunning(this.currentRuntimeFlags,r)),!this._isYielding){this.currentOpCount+=1;const i=this.currentScheduler.shouldYield(this);if(i!==!1){this._isYielding=!0,this.currentOpCount=0;const c=r;r=se(T_({priority:i}),()=>c)}}try{if(r=this.currentTracer.context(()=>Fte!==r[Bu]._V?Dk(`Cannot execute an Effect versioned ${r[Bu]._V} with a Runtime of version ${t0()}`):this[r._op](r),this),r===_o){const i=yo.currentOp;return i._op===tS||i._op===Zg?_o:(yo.currentOp=null,i._op===Cr||i._op===kr?i:zt(ns(i)))}}catch(i){r!==_o&&!Ae(r,"_op")||!(r._op in this)?r=Dk(`Not a valid effect: ${xu(r)}`):ZY(i)?r=zt(tr(ns(i),Sa(Oa))):r=Op(i)}}}}const Yz=St("effect/FiberRef/currentMinimumLogLevel",()=>Kr(XJ("Info"))),Lte=e=>I_(t=>{const n=NR(t.context,Ui);Ws(n,Y0).unsafe.log(e.log(t))}),Wz=St(Symbol.for("effect/Logger/defaultLogger"),()=>Lte(QZ)),Jz=St(Symbol.for("effect/Logger/tracerLogger"),()=>I_(({annotations:e,cause:t,context:n,fiberId:r,logLevel:i,message:c})=>{const f=Xs(Ip(n,ai),Li);if(f._tag==="None"||f.value._tag==="ExternalSpan")return;const m=m0(Ip(n,Ui),mf),g={};for(const[b,S]of e)g[b]=S;g["effect.fiberId"]=gK(r),g["effect.logLevel"]=i.label,t!==null&&t._tag!=="Empty"&&(g["effect.cause"]=yl(t,{renderErrorCause:!0})),f.value.event(xu(Array.isArray(c)?c[0]:c),m.unsafeCurrentTimeNanos(),g)})),aw=St(Symbol.for("effect/FiberRef/currentLoggers"),()=>jY(R0(Wz,Jz))),t2=D(e=>ta(e[0]),(e,t)=>Yo(zo(e,n=>Xz(r=>t(n,r))))),Xz=e=>yt(t=>{const n=t.getFiberRefs(),r=t.currentRuntimeFlags;return se(t4,i=>qp(i,c=>yt(f=>{const m=f.getFiberRefs(),g=f.currentRuntimeFlags,b=Lp(m,n),S=wu(g,r),v=Lp(n,m);return f.setFiberRefs(Up(b,f.id(),n)),gh(kY(e(c),S),he(()=>{f.setFiberRefs(Up(v,f.id(),f.getFiberRefs()))}))})))}),Ute=e=>{if(Array.isArray(e)||gA(e))return[e,me()];const t=Object.keys(e),n=t.length;return[t.map(r=>e[r]),pe(r=>{const i={};for(let c=0;c<n;c++)i[t[c]]=r[c];return i})]},zte=(e,t,n)=>{const r=[];for(const i of e)r.push(ch(i));return se(hh(r,Ie,{concurrency:n==null?void 0:n.concurrency,batching:n==null?void 0:n.batching,concurrentFinalizers:n==null?void 0:n.concurrentFinalizers}),i=>{const c=me(),f=i.length,m=new Array(f),g=new Array(f);let b=!1;for(let S=0;S<f;S++){const v=i[S];v._tag==="Left"?(m[S]=pe(v.left),b=!0):(g[S]=v.right,m[S]=c)}return b?t._tag==="Some"?mn(t.value(m)):mn(m):n!=null&&n.discard?it:t._tag==="Some"?fe(t.value(g)):fe(g)})},Pte=(e,t,n)=>{const r=[];for(const i of e)r.push(ch(i));return n!=null&&n.discard?hh(r,Ie,{concurrency:n==null?void 0:n.concurrency,batching:n==null?void 0:n.batching,discard:!0,concurrentFinalizers:n==null?void 0:n.concurrentFinalizers}):Ye(hh(r,Ie,{concurrency:n==null?void 0:n.concurrency,batching:n==null?void 0:n.batching,concurrentFinalizers:n==null?void 0:n.concurrentFinalizers}),i=>t._tag==="Some"?t.value(i):i)},iw=(e,t)=>{const[n,r]=Ute(e);return(t==null?void 0:t.mode)==="validate"?zte(n,r,t):(t==null?void 0:t.mode)==="either"?Pte(n,r,t):(t==null?void 0:t.discard)!==!0&&r._tag==="Some"?Ye(hh(n,Ie,t),r.value):hh(n,Ie,t)},Hte=D(2,(e,t)=>Array.from({length:t},()=>e)),Bte=D(e=>ta(e[0]),(e,t,n)=>iw(Hte(e,t),n)),hh=D(e=>gA(e[0]),(e,t,n)=>yt(r=>{const i=(n==null?void 0:n.batching)===!0||(n==null?void 0:n.batching)==="inherit"&&r.getFiberRef(BY);return n!=null&&n.discard?lN(n.concurrency,()=>pd(nv,n==null?void 0:n.concurrentFinalizers)(c=>i?$o(e,(f,m)=>c(t(f,m)),!0,!1,1):Vu(e,(f,m)=>c(t(f,m)))),()=>pd(Hk,n==null?void 0:n.concurrentFinalizers)(c=>$o(e,(f,m)=>c(t(f,m)),i,!1)),c=>pd(Bk(c),n==null?void 0:n.concurrentFinalizers)(f=>$o(e,(m,g)=>f(t(m,g)),i,!1,c))):lN(n==null?void 0:n.concurrency,()=>pd(nv,n==null?void 0:n.concurrentFinalizers)(c=>i?nC(e,1,(f,m)=>c(t(f,m)),!0):Ao(e,(f,m)=>c(t(f,m)))),()=>pd(Hk,n==null?void 0:n.concurrentFinalizers)(c=>n2(e,(f,m)=>c(t(f,m)),i)),c=>pd(Bk(c),n==null?void 0:n.concurrentFinalizers)(f=>nC(e,c,(m,g)=>f(t(m,g)),i)))})),n2=(e,t,n)=>Ne(()=>{const r=Ht(e),i=new Array(r.length);return Nt($o(r,(f,m)=>se(t(f,m),g=>he(()=>i[m]=g)),n,!1),fe(i))}),$o=(e,t,n,r,i)=>ks(c=>vY(f=>yt(m=>{let g=Array.from(e).reverse(),b=g.length;if(b===0)return it;let S=0,v=!1;const q=i?Math.min(g.length,i):g.length,k=new Set,N=new Array,H=()=>k.forEach(K=>{K.currentScheduler.scheduleTask(()=>{K.unsafeInterruptAsFork(m.id())},0)}),x=new Array,C=new Array,E=new Array,$=()=>{const K=N.filter(({exit:Y})=>Y._tag==="Failure").sort((Y,P)=>Y.index<P.index?-1:Y.index===P.index?0:1).map(({exit:Y})=>Y);return K.length===0&&K.push(Pr),K},R=(K,Y=!1)=>{const P=Yo(f(K)),ne=Gte(P,m,m.currentRuntimeFlags,$_);return m.currentScheduler.scheduleTask(()=>{Y&&ne.unsafeInterruptAsFork(m.id()),ne.resume(P)},0),ne},I=()=>{r||(b-=g.length,g=[]),v=!0,H()},z=n?yY:ei,V=R(Lo(K=>{const Y=(ne,Se)=>{ne._op==="Blocked"?E.push(ne):(N.push({index:Se,exit:ne}),ne._op==="Failure"&&!v&&I())},P=()=>{if(g.length>0){const ne=g.pop();let Se=S++;const Re=()=>{const Te=g.pop();return Se=S++,se(T_(),()=>se(z(c(t(Te,Se))),ge))},ge=Te=>g.length>0&&(Y(Te,Se),g.length>0)?Re():fe(Te),Ve=se(z(c(t(ne,Se))),ge),oe=R(Ve);x.push(oe),k.add(oe),v&&oe.currentScheduler.scheduleTask(()=>{oe.unsafeInterruptAsFork(m.id())},0),oe.addObserver(Te=>{let Ee;if(Te._op==="Failure"?Ee=Te:Ee=Te.effect_instruction_i0,C.push(oe),k.delete(oe),Y(Ee,Se),N.length===b)K(fe(yn(Fd($(),{parallel:!0}),()=>Pr)));else if(E.length+N.length===b){const pt=$(),Q=E.map(ue=>ue.effect_instruction_i0).reduce(QL);K(fe(aU(Q,$o([yn(Fd(pt,{parallel:!0}),()=>Pr),...E.map(ue=>ue.effect_instruction_i1)],ue=>ue,n,!0,i))))}else P()})}};for(let ne=0;ne<q;ne++)P()}));return na(Uo(zh(c(dh(V))),G0({onFailure:K=>{I();const Y=E.length+1,P=Math.min(typeof i=="number"?i:E.length,E.length),ne=Array.from(E);return Lo(Se=>{let Re=0,ge=0;const Ve=(Te,Ee)=>pt=>{Re++,Re===Y&&Se(Pt(zt(K))),ne.length>0&&Ee&&oe()},oe=()=>{R(ne.pop(),!0).addObserver(Ve(ge,!0)),ge++};V.addObserver(Ve(ge,!1)),ge++;for(let Te=0;Te<P;Te++)oe()})},onSuccess:()=>Ao(C,K=>K.inheritAll)})))}))),nC=(e,t,n,r)=>Ne(()=>{const i=Ht(e),c=new Array(i.length);return Nt($o(i,(m,g)=>Ye(n(m,g),b=>c[g]=b),r,!1,t),fe(c))}),Vte=e=>yt((t,n)=>fe(r2(e,t,n.runtimeFlags))),mh=e=>Kte(e,$_),r2=(e,t,n,r=null)=>{const i=fv(e,t,n,r);return i.resume(e),i},Gte=(e,t,n,r=null)=>fv(e,t,n,r),fv=(e,t,n,r=null)=>{const i=DL(),c=t.getFiberRefs(),f=zJ(c,i),m=new Qz(i,f,n),g=Ip(f,ai),b=m.currentSupervisor;return b.onStart(g,e,pe(t),m),m.addObserver(v=>b.onEnd(v,m)),(r!==null?r:j(t.getFiberRef(Nk),yn(()=>t.scope()))).add(n,m),m},Kte=(e,t)=>yt((n,r)=>fe(r2(e,n,r.runtimeFlags,t))),pN=e=>Gh(t=>Bt(Xs(t,ii),{onNone:()=>e,onSome:n=>{switch(n.strategy._tag){case"Parallel":return e;case"Sequential":case"ParallelN":return se(B0(n,Hk),r=>gf(e,r))}}})),_N=e=>t=>Gh(n=>Bt(Xs(n,ii),{onNone:()=>t,onSome:r=>r.strategy._tag==="ParallelN"&&r.strategy.parallelism===e?t:se(B0(r,Bk(e)),i=>gf(t,i))})),pd=(e,t)=>n=>Gh(r=>Bt(Xs(r,ii),{onNone:()=>n(Ie),onSome:i=>{if(t===!0){const c=e._tag==="Parallel"?pN:e._tag==="Sequential"?yN:_N(e.parallelism);switch(i.strategy._tag){case"Parallel":return c(n(pN));case"Sequential":return c(n(yN));case"ParallelN":return c(n(_N(i.strategy.parallelism)))}}else return n(Ie)}})),Zz=e=>se(ii,e),e4=e=>se(Wh(),t=>Uo(e(t),n=>t.close(n))),Qte=e=>se(Wh(),t=>ene(e,t)),yN=e=>Gh(t=>Bt(Xs(t,ii),{onNone:()=>e,onSome:n=>{switch(n.strategy._tag){case"Sequential":return e;case"Parallel":case"ParallelN":return se(B0(n,nv),r=>gf(e,r))}}})),Yte=D(e=>ta(e[1]),(e,t,n)=>L_(e,t,(r,i)=>[r,i],n)),Wte=D(e=>ta(e[1]),(e,t,n)=>(n==null?void 0:n.concurrent)!==!0&&((n==null?void 0:n.batching)===void 0||n.batching===!1)?Zc(e,t):L_(e,t,(r,i)=>r,n)),Jte=D(e=>ta(e[1]),(e,t,n)=>(n==null?void 0:n.concurrent)!==!0&&((n==null?void 0:n.batching)===void 0||n.batching===!1)?Nt(e,t):L_(e,t,(r,i)=>i,n)),L_=D(e=>ta(e[1]),(e,t,n,r)=>Ye(iw([e,t],{concurrency:r!=null&&r.concurrent?2:1,batching:r==null?void 0:r.batching,concurrentFinalizers:r==null?void 0:r.concurrentFinalizers}),([i,c])=>n(i,c))),ii=Cs("effect/Scope"),t4=ii,Xte=(e,t)=>{e.state._tag==="Open"&&e.state.finalizers.set({},t)},Zte={[Dq]:Dq,[qq]:qq,pipe(){return xe(this,arguments)},fork(e){return he(()=>{const t=n4(e);if(this.state._tag==="Closed")return t.state=this.state,t;const n={},r=i=>t.close(i);return this.state.finalizers.set(n,r),Xte(t,i=>he(()=>{this.state._tag==="Open"&&this.state.finalizers.delete(n)})),t})},close(e){return Ne(()=>{if(this.state._tag==="Closed")return it;const t=Array.from(this.state.finalizers.values()).reverse();return this.state={_tag:"Closed",exit:e},t.length===0?it:zX(this.strategy)?j(Ao(t,n=>ei(n(e))),se(n=>j(Fd(n),bu(xT),yn(()=>Pr)))):PX(this.strategy)?j(n2(t,n=>ei(n(e)),!1),se(n=>j(Fd(n,{parallel:!0}),bu(xT),yn(()=>Pr)))):j(nC(t,this.strategy.parallelism,n=>ei(n(e)),!1),se(n=>j(Fd(n,{parallel:!0}),bu(xT),yn(()=>Pr))))})},addFinalizer(e){return Ne(()=>this.state._tag==="Closed"?e(this.state.exit):(this.state.finalizers.set({},e),it))}},n4=(e=N_)=>{const t=Object.create(Zte);return t.strategy=e,t.state={_tag:"Open",finalizers:new Map},t},Wh=(e=N_)=>he(()=>n4(e)),gf=D(2,(e,t)=>kU(e,_l(h0(ii,t)))),ene=D(2,(e,t)=>j(e,gf(t),Uo(n=>t.close(n)))),tne=e=>Hh(e,{differ:xte,fork:sp}),nne=D(2,(e,t)=>na(t2(se(k_(e),n=>rr(YS(e,t),n)),n=>YS(e,n)))),s2=D(2,(e,t)=>Ph(e,n=>nne(e,t(n)))),bN=LY(DQ),rne=tne(sw),r4=D(3,(e,t,n)=>a4(e,t,{onSelfWin:(r,i)=>se(r.await,c=>{switch(c._tag){case Cr:return se(r.inheritAll,()=>n.onSelfDone(c,i));case kr:return n.onSelfDone(c,i)}}),onOtherWin:(r,i)=>se(r.await,c=>{switch(c._tag){case Cr:return se(r.inheritAll,()=>n.onOtherDone(c,i));case kr:return n.onOtherDone(c,i)}})})),sne=e=>ks(t=>ff(n=>se(mh(t(e)),r=>j(t(dh(r)),bl(()=>j(r,kz(n))))))),s4=D(2,(e,t)=>ff(n=>r4(e,t,{onSelfDone:(r,i)=>Mk(r,{onFailure:c=>j(dh(i),nN(f=>Mi(c,f))),onSuccess:c=>j(i,Ro(n),rr(c))}),onOtherDone:(r,i)=>Mk(r,{onFailure:c=>j(dh(i),nN(f=>Mi(f,c))),onSuccess:c=>j(i,Ro(n),rr(c))})}))),a4=D(3,(e,t,n)=>yt((r,i)=>{const c=i.runtimeFlags,f=cf(!0),m=fv(e,r,c,n.selfScope),g=fv(t,r,c,n.otherScope);return Lo(b=>{m.addObserver(()=>SN(m,g,n.onSelfWin,f,b)),g.addObserver(()=>SN(g,m,n.onOtherWin,f,b)),m.startFork(e),g.startFork(t)},Xc(m.id(),g.id()))})),SN=(e,t,n,r,i)=>{sK(!0,!1)(r)&&i(n(e,t))},gh=D(2,(e,t)=>ks(n=>Ts(n(e),{onFailure:r=>Ts(t,{onFailure:i=>en(tr(r,i)),onSuccess:()=>en(r)}),onSuccess:r=>rr(t,r)}))),ane=(e,t,n)=>ff(r=>se(se(mh(lh(e)),i=>Lo(c=>{const f=t.map(b=>b.listeners.count),m=()=>{f.every(b=>b===0)&&t.every(b=>b.result.state.current._tag==="Pending"?!0:!!(b.result.state.current._tag==="Done"&&V0(b.result.state.current.effect)&&b.result.state.current.effect._tag==="Failure"&&oR(b.result.state.current.effect.cause)))&&(g.forEach(b=>b()),n==null||n(),c(Dp(i)))};i.addObserver(b=>{g.forEach(S=>S()),c(b)});const g=t.map((b,S)=>{const v=q=>{f[S]=q,m()};return b.listeners.addObserver(v),()=>b.listeners.removeObserver(v)});return m(),he(()=>{g.forEach(b=>b())})})),()=>Ne(()=>{const i=t.flatMap(c=>c.state.completed?[]:[c]);return Vu(i,c=>vte(c.request,SR(r)))}))),vN=(e,t)=>(t=No(t),Yo(yt(n=>{const r=m0(n.getFiberRef(ai),ii),i=zR(n,e,t),c=n.getFiberRef(H0),f=Ws(n.getFiberRef(Ui),mf);return rr(qp(r,m=>tv(i,m,f,c)),i)}))),ine=e=>s2(Ui,Ks(q_,e)),one=function(){const e=typeof arguments[0]!="string",t=e?arguments[1]:arguments[0],n=No(e?arguments[2]:arguments[1]);if(e){const r=arguments[0];return se(vN(t,No(n)),i=>jp(r,Li,i))}return r=>se(vN(t,No(n)),i=>jp(r,Li,i))},cne=Fo,ol=Hu,Qu=ns,ow=Sa,lne=Mi,une=tr,fne=sR,i4=JQ,dne=aR,o4=oR,tl=I0,hne=cR,cw=M0,mne=ZQ,a2=rY,wN=YY,c4=F0,gne=eW,lw=A_,zp=yl,pne=lR,_ne="effect/ScheduleInterval",dv=Symbol.for(_ne),l4={[dv]:dv,startMillis:0,endMillis:0},i2=(e,t)=>e>t?l4:{[dv]:dv,startMillis:e,endMillis:t},yne=D(2,(e,t)=>bne(e,t)===e),bne=D(2,(e,t)=>e.endMillis<=t.startMillis?e:t.endMillis<=e.startMillis?t:e.startMillis<t.startMillis?e:t.startMillis<e.startMillis?t:e.endMillis<=t.endMillis?e:t),Sne=e=>e.startMillis>=e.endMillis,vne=D(2,(e,t)=>{const n=Math.max(e.startMillis,t.startMillis),r=Math.min(e.endMillis,t.endMillis);return i2(n,r)}),wne=e=>ju(e.endMillis-e.startMillis),Ene=e=>i2(e,Number.POSITIVE_INFINITY),EN=i2,u4=l4,Tne=yne,kne=Sne,Cne=vne,Ane=wne,rC=Ene,Rne="effect/ScheduleIntervals",TN=Symbol.for(Rne),f4=e=>({[TN]:TN,intervals:e}),xne=D(2,(e,t)=>One(e.intervals,t.intervals,an())),One=(e,t,n)=>{let r=e,i=t,c=n;for(;Ii(r)&&Ii(i);){const f=j(Ri(r),Cne(Ri(i))),m=kne(f)?c:j(c,Gr(f));j(Ri(r),Tne(Ri(i)))?r=Co(r):i=Co(i),c=m}return f4(jo(c))},sC=e=>j(e.intervals,b0,yn(()=>u4)).startMillis,Dne=e=>j(e.intervals,b0,yn(()=>u4)).endMillis,d4=D(2,(e,t)=>sC(e)<sC(t)),qne=e=>Ii(e.intervals),Nne=D(2,(e,t)=>d4(e,t)?t:e),$ne=f4,Ine=xne,aC=sC,iC=Dne,Mne=d4,jne=qne,Fne=Nne,o2="Continue",h4="Done",Lne=e=>({_tag:o2,intervals:e}),Une=e=>({_tag:o2,intervals:$ne(Sn(e))}),zne={_tag:h4},Pne=e=>e._tag===o2,Hne=e=>e._tag===h4,m4=Lne,hv=Une,Yu=zne,kN=Pne,cl=Hne,Bne=ii,ll=bU,Vne=qp,Xn=$k,U_=gf,g4=B0,z_=Wh,Gne=q0,p4=(function(){const e=Symbol.for("effect/Data/Error/plainArgs");return{BaseEffectError:class extends yR{constructor(n){super(n==null?void 0:n.message,n!=null&&n.cause?{cause:n.cause}:void 0),n&&(Object.assign(this,n),Object.defineProperty(this,e,{value:n,enumerable:!1}))}toJSON(){return{...this[e],...this}}}}.BaseEffectError})(),Kne=e=>{const t={BaseEffectError:class extends p4{constructor(){super(...arguments);y(this,"_tag",e)}}};return t.BaseEffectError.prototype.name=e,t.BaseEffectError},Qne="effect/Schedule",_4=Symbol.for(Qne),y4=e=>Ae(e,_4),Yne="effect/ScheduleDriver",Wne=Symbol.for(Yne),Jne={_Out:e=>e,_In:e=>e,_R:e=>e},Xne={_Out:e=>e,_In:e=>e,_R:e=>e};var qM;qM=_4;class Zne{constructor(t,n){y(this,"initial");y(this,"step");y(this,qM,Jne);this.initial=t,this.step=n}pipe(){return xe(this,arguments)}}var NM;NM=Wne;class ere{constructor(t,n){y(this,"schedule");y(this,"ref");y(this,NM,Xne);this.schedule=t,this.ref=n}get state(){return Ye(el(this.ref),t=>t[1])}get last(){return se(el(this.ref),([t,n])=>{switch(t._tag){case"None":return U0(()=>new A_);case"Some":return fe(t.value)}})}get reset(){return Mp(this.ref,[me(),this.schedule.initial])}next(t){return j(Ye(el(this.ref),n=>n[1]),se(n=>j($J,se(r=>j(Ne(()=>this.schedule.step(r,t,n)),se(([i,c,f])=>{const m=Mp(this.ref,[pe(c),i]);if(cl(f))return Nt(m,mn(me()));const g=aC(f.intervals)-r;return g<=0?rr(m,c):j(m,Nt(UR(ju(g))),rr(c))}))))))}}const Wo=(e,t)=>new Zne(e,t),b4=D(2,(e,t)=>tre(e,n=>he(()=>t(n)))),tre=D(2,(e,t)=>lre(e,(n,r)=>Ye(t(n),i=>SG(r,Zs(i))))),nre=D(2,(e,t)=>Wo([e.initial,t.initial,!0],(n,r,i)=>i[2]?se(e.step(n,r,i[0]),([c,f,m])=>cl(m)?Ye(t.step(n,r,i[1]),([g,b,S])=>[[c,g,!1],He(b),S]):fe([[c,i[1],!0],Ue(f),m])):Ye(t.step(n,r,i[1]),([c,f,m])=>[[i[0],c,!1],He(f),m]))),rre=D(2,(e,t)=>c2(e,(n,r)=>he(()=>t(n,r)))),c2=D(2,(e,t)=>Wo(e.initial,(n,r,i)=>se(e.step(n,r,i),([c,f,m])=>cl(m)?fe([c,f,Yu]):Ye(t(r,f),g=>g?[c,f,m]:[c,f,Yu])))),sre=D(2,(e,t)=>Wo([e.initial,t.initial],(n,r,i)=>se(e.step(n,r,i[0]),([c,f,m])=>Ye(t.step(n,f,i[1]),([g,b,S])=>cl(m)?[[c,g],b,Yu]:cl(S)?[[c,g],b,Yu]:[[c,g],b,m4(j(m.intervals,Fne(S.intervals)))])))),are=e=>b4(e,t=>t),S4=e=>j(ev([me(),e.initial]),Ye(t=>new ere(e,t))),ire=(e,t=2)=>{const n=Zs(e);return are(w4(P_,r=>bG(n,Math.pow(t,r))))},v4=D(2,(e,t)=>ore(e,t,Ine)),ore=D(3,(e,t,n)=>Wo([e.initial,t.initial],(r,i,c)=>j(hU(e.step(r,i,c[0]),t.step(r,i,c[1]),(f,m)=>[f,m]),se(([[f,m,g],[b,S,v]])=>kN(g)&&kN(v)?oC(e,t,i,f,m,g.intervals,b,S,v.intervals,n):fe([[f,b],[m,S],Yu]))))),oC=(e,t,n,r,i,c,f,m,g,b)=>{const S=b(c,g);return jne(S)?fe([[r,f],[i,m],m4(S)]):j(c,Mne(g))?se(e.step(iC(c),n,r),([v,q,k])=>cl(k)?fe([[v,f],[q,m],Yu]):oC(e,t,n,v,q,k.intervals,f,m,g,b)):se(t.step(iC(g),n,f),([v,q,k])=>cl(k)?fe([[r,v],[i,q],Yu]):oC(e,t,n,r,i,c,v,q,k.intervals,b))},w4=D(2,(e,t)=>cre(e,n=>he(()=>t(n)))),cre=D(2,(e,t)=>Wo(e.initial,(n,r,i)=>se(e.step(n,r,i),([c,f,m])=>Ye(t(f),g=>[c,g,m])))),lre=D(2,(e,t)=>Wo(e.initial,(n,r,i)=>se(e.step(n,r,i),([c,f,m])=>{if(cl(m))return fe([c,f,m]);const g=m.intervals,b=Ane(EN(n,aC(g)));return Ye(t(f,b),S=>{const v=Zs(S),q=aC(g),k=n+Xd(v),N=k-q,H=Math.max(0,iC(g)+N),x=EN(k,H);return[c,f,hv(x)]})}))),ure=e=>Wo(e.initial,(t,n,r)=>j(e.step(t,n,r),Ye(([i,c,f])=>[i,n,f]))),E4=e=>C4(P_,t=>t<e),fre=e=>b4(P_,()=>e),dre=(e,t)=>Wo(e,(n,r,i)=>he(()=>[t(i),i,hv(rC(n))])),T4=D(2,(e,t)=>c2(e,(n,r)=>EX(t(n)))),k4=D(2,(e,t)=>c2(e,(n,r)=>t(n))),C4=D(2,(e,t)=>rre(e,(n,r)=>t(r))),hS=Symbol.for("effect/Schedule/ScheduleDefect");var $M;$M=hS;class hre{constructor(t){y(this,"error");y(this,$M);this.error=t,this[hS]=hS}}const mre=e=>Ae(e,hS),mv=e=>oh(e,t=>Op(new hre(t))),A4=e=>Uh(e,t=>Bt(j0(t,n=>aR(n)&&mre(n.defect)?pe(n.defect):me()),{onNone:()=>en(t),onSome:n=>mn(n.error)})),CN=D(2,(e,t)=>pre(e,t,(n,r)=>mn(n))),gre=D(2,(e,t)=>{if(y4(t))return CN(e,t);const n=t.schedule??ure(P_),r=t.while?k4(n,f=>{const m=t.while(f);return typeof m=="boolean"?fe(m):mv(m)}):n,i=t.until?T4(r,f=>{const m=t.until(f);return typeof m=="boolean"?fe(m):mv(m)}):r,c=t.times?v4(i,E4(t.times)).pipe(w4(f=>f[0])):i;return A4(CN(e,c))}),pre=D(3,(e,t,n)=>se(S4(t),r=>ji(e,{onFailure:i=>n(i,me()),onSuccess:i=>R4(e,r,n,i)}))),R4=(e,t,n,r)=>ji(t.next(r),{onFailure:()=>mR(t.last),onSuccess:i=>ji(e,{onFailure:c=>n(c,pe(i)),onSuccess:c=>R4(e,t,n,c)})}),AN=D(2,(e,t)=>yre(e,t,(n,r)=>mn(n))),_re=D(2,(e,t)=>{if(y4(t))return AN(e,t);const n=t.schedule??P_,r=t.while?k4(n,f=>{const m=t.while(f);return typeof m=="boolean"?fe(m):mv(m)}):n,i=t.until?T4(r,f=>{const m=t.until(f);return typeof m=="boolean"?fe(m):mv(m)}):r,c=t.times?v4(i,E4(t.times)):i;return A4(AN(e,c))}),yre=D(3,(e,t,n)=>se(S4(t),r=>x4(e,r,n))),x4=(e,t,n)=>oh(e,r=>ji(t.next(r),{onFailure:()=>j(t.last,mR,se(i=>n(r,i))),onSuccess:()=>x4(e,t,n)})),bre=Wo(me(),(e,t,n)=>{switch(n._tag){case"None":return fe([pe(e),UA,hv(rC(e))]);case"Some":return fe([pe(n.value),ju(e-n.value),hv(rC(e))])}}),P_=dre(0,e=>e+1);class Sre{constructor(t){y(this,"permits");y(this,"waiters",new Set);y(this,"taken",0);y(this,"take",t=>Vc(n=>{if(this.free<t){const r=()=>{this.free<t||(this.waiters.delete(r),this.taken+=t,n(fe(t)))};return this.waiters.add(r),he(()=>{this.waiters.delete(r)})}return this.taken+=t,n(fe(t))}));y(this,"updateTaken",t=>yt(n=>(this.taken=t(this.taken),this.waiters.size>0&&n.getFiberRef(tw).scheduleTask(()=>{const r=this.waiters.values();let i=r.next();for(;i.done===!1&&this.free>0;)i.value(),i=r.next()},n.getFiberRef(hf)),fe(this.free))));y(this,"release",t=>this.updateTaken(n=>n-t));y(this,"releaseAll",this.updateTaken(t=>0));y(this,"withPermits",t=>n=>ks(r=>se(r(this.take(t)),i=>gh(r(n),this.release(i)))));y(this,"withPermitsIfAvailable",t=>n=>ks(r=>Ne(()=>this.free<t?Fp:(this.taken+=t,gh(r(uX(n)),this.release(t))))));this.permits=t}get free(){return this.permits-this.taken}}const ap=e=>new Sre(e),vre=e=>he(()=>ap(e));class wre extends Gi{constructor(n){super();y(this,"isOpen");y(this,"waiters",[]);y(this,"scheduled",!1);y(this,"flushWaiters",()=>{this.scheduled=!1;const n=this.waiters;this.waiters=[];for(let r=0;r<n.length;r++)n[r](Pr)});y(this,"open",yt(n=>this.isOpen?it:(this.isOpen=!0,this.unsafeSchedule(n))));y(this,"release",yt(n=>this.isOpen?it:this.unsafeSchedule(n)));y(this,"await",Vc(n=>this.isOpen?n(it):(this.waiters.push(n),he(()=>{const r=this.waiters.indexOf(n);r!==-1&&this.waiters.splice(r,1)}))));y(this,"close",he(()=>{this.isOpen=!1}));y(this,"whenOpen",n=>Nt(this.await,n));this.isOpen=n}commit(){return this.await}unsafeSchedule(n){return this.scheduled||this.waiters.length===0||(this.scheduled=!0,n.currentScheduler.scheduleTask(this.flushWaiters,n.getFiberRef(hf))),it}unsafeOpen(){this.isOpen||(this.isOpen=!0,this.flushWaiters())}unsafeClose(){this.isOpen=!1}}const O4=e=>new wre(e??!1),Ere=e=>he(()=>O4(e)),gv=D(2,(e,t)=>yt((n,r)=>{const i=t,c=r2(e,n,r.runtimeFlags,$_);if(i.state._tag==="Open"){const f=()=>ff(g=>Ge(g,c.id())?it:na(Dp(c))),m={};i.state.finalizers.set(m,f),c.addObserver(()=>{i.state._tag!=="Closed"&&i.state.finalizers.delete(m)})}else c.unsafeInterruptAsFork(n.id());return fe(c)})),Tre=e=>Zz(t=>gv(e,t)),kre=D(2,(e,t)=>j(ei(e),s4(ei(t)),n=>zh(n))),Cre=D(2,(e,t)=>Are(e,{onTimeout:()=>nW(t),duration:t})),Are=D(2,(e,{duration:t,onTimeout:n})=>zh(Rre(e,{onTimeout:()=>U0(n),onSuccess:fe,duration:t}))),Rre=D(2,(e,{duration:t,onSuccess:n,onTimeout:r})=>ff(i=>ks(c=>a4(c(e),lh(UR(t)),{onSelfWin:(f,m)=>se(f.await,g=>g._tag==="Success"?se(f.inheritAll,()=>rr(Ro(m,i),n(g.value))):se(Ro(m,i),()=>zt(g.cause))),onOtherWin:(f,m)=>se(f.await,g=>g._tag==="Success"?se(f.inheritAll,()=>rr(Ro(m,i),r())):se(Ro(m,i),()=>zt(g.cause))),otherScope:$_})))),xre="effect/Ref/SynchronizedRef",D4=Symbol.for(xre),q4={_A:e=>e};var IM,MM,jM,FM;class Ore extends(FM=Gi,jM=D4,MM=MR,IM=il,FM){constructor(n,r){super();y(this,"ref");y(this,"withLock");y(this,jM,q4);y(this,MM,jR);y(this,IM,il);y(this,"get");this.ref=n,this.withLock=r,this.get=el(this.ref)}commit(){return this.get}modify(n){return this.modifyEffect(r=>fe(n(r)))}modifyEffect(n){return this.withLock(j(se(el(this.ref),n),se(([r,i])=>rr(Mp(this.ref,i),r))))}}const Dre=e=>he(()=>N4(e)),N4=e=>{const t=VU(e),n=ap(1);return new Ore(t,n.withPermits(1))},qre=Symbol.for("effect/ManagedRuntime"),Nre="Fold",$re="Fresh",Ire="FromEffect",Mre="Scoped",jre="Suspend",Fre="Provide",$4="ProvideMerge",Lre="ZipWith",I4=Tz,Ure=zZ,RN=LZ,Js=Dp,uw=Ro,zre=UZ,Gc=dh,Jh=e=>function(){if(arguments.length===1){const t=arguments[0];return(n,...r)=>e(t,n,...r)}return e.apply(this,arguments)},H_=Jh((e,t,n)=>{const r=DL(),i=[[ai,[[r,e.context]]]];n!=null&&n.scheduler&&i.push([tw,[[r,n.scheduler]]]);let c=HJ(e.fiberRefs,{entries:i,forkAs:r});n!=null&&n.updateRefs&&(c=n.updateRefs(c,r));const f=new Qz(r,c,e.runtimeFlags);let m=t;n!=null&&n.scope&&(m=se(g4(n.scope,N_),b=>Nt(bU(b,ff(S=>Ge(S,f.id())?it:Ro(f,S))),Uo(t,S=>Xn(b,S)))));const g=f.currentSupervisor;return g!==sw&&(g.onStart(e.context,m,me(),f),f.addObserver(b=>g.onEnd(b,f))),$_.add(e.runtimeFlags,f),(n==null?void 0:n.immediate)===!1?f.resume(m):f.start(m),f}),M4=Jh((e,t,n={})=>{const r=H_(e,t,n);return n.onExit&&r.addObserver(i=>{n.onExit(i)}),(i,c)=>M4(e)(j(r,uw(i??Oa)),{...c,onExit:c!=null&&c.onExit?f=>c.onExit(vW(f)):void 0})}),Pre=Jh((e,t)=>{const n=Gre(e)(t);if(n._tag==="Failure")throw j4(n.effect_instruction_i0);return n.effect_instruction_i0});class Hre extends Error{constructor(n){super(`Fiber #${n.id().id} cannot be resolved synchronously. This is caused by using runSync on an effect that performs async work`);y(this,"fiber");y(this,"_tag","AsyncFiberException");this.fiber=n,this.name=this._tag,this.stack=this.message}}const Bre=e=>{const t=Error.stackTraceLimit;Error.stackTraceLimit=0;const n=new Hre(e);return Error.stackTraceLimit=t,n},NT=Symbol.for("effect/Runtime/FiberFailure"),zb=Symbol.for("effect/Runtime/FiberFailure/Cause");var LM,UM;class Vre extends Error{constructor(n){const r=lR(n)[0];super((r==null?void 0:r.message)||"An error has occurred");y(this,UM);y(this,LM);this[NT]=NT,this[zb]=n,this.name=r?`(FiberFailure) ${r.name}`:"FiberFailure",r!=null&&r.stack&&(this.stack=r.stack)}toJSON(){return{_id:"FiberFailure",cause:this[zb].toJSON()}}toString(){return"(FiberFailure) "+yl(this[zb],{renderErrorCause:!0})}[(UM=NT,LM=zb,Gt)](){return this.toString()}}const j4=e=>{const t=Error.stackTraceLimit;Error.stackTraceLimit=0;const n=new Vre(e);return Error.stackTraceLimit=t,n},F4=e=>{const t=e;switch(t._op){case"Failure":case"Success":return t;case"Left":return Np(t.left);case"Right":return Pt(t.right);case"Some":return Pt(t.value);case"None":return Np(A_())}},Gre=Jh((e,t)=>{const n=F4(t);if(n)return n;const r=new wz,i=H_(e)(t,{scheduler:r});r.flush();const c=i.unsafePoll();return c||Ad(fR(Bre(i),kR(i)))}),Kre=Jh((e,t,n)=>Qre(e,t,n).then(r=>{switch(r._tag){case Cr:return r.effect_instruction_i0;case kr:throw j4(r.effect_instruction_i0)}})),Qre=Jh((e,t,n)=>new Promise(r=>{const i=F4(t);i&&r(i);const c=H_(e)(t);c.addObserver(f=>{r(f)}),(n==null?void 0:n.signal)!==void 0&&(n.signal.aborted?c.unsafeInterruptAsFork(c.id()):n.signal.addEventListener("abort",()=>{c.unsafeInterruptAsFork(c.id())},{once:!0}))}));class L4{constructor(t,n,r){y(this,"context");y(this,"runtimeFlags");y(this,"fiberRefs");this.context=t,this.runtimeFlags=n,this.fiberRefs=r}pipe(){return xe(this,arguments)}}const U4=e=>new L4(e.context,e.runtimeFlags,e.fiberRefs),Yre=()=>yt((e,t)=>fe(new L4(e.getFiberRef(ai),t.runtimeFlags,e.getFiberRefs()))),Wre=GL(Ih,BL,HL),ph=U4({context:Iu(),runtimeFlags:Wre,fiberRefs:BJ()}),Jre=D(2,(e,t)=>U4({context:t(e.context),runtimeFlags:e.runtimeFlags,fiberRefs:e.fiberRefs})),Xre=M4(ph),Zre=H_(ph),ese=Kre(ph),tse=Pre(ph),nse=D(2,(e,t)=>e.modifyEffect(t)),rse="effect/Layer",z4=Symbol.for(rse),sse={_RIn:e=>e,_E:e=>e,_ROut:e=>e},ul={[z4]:sse,pipe(){return xe(this,arguments)}},ase="effect/Layer/MemoMap",$T=Symbol.for(ase),ise=g0()("effect/Layer/CurrentMemoMap",{defaultValue:()=>use()}),ose=e=>Ae(e,z4),cse=e=>e._op_layer===$re;var zM;zM=$T;class P4{constructor(t){y(this,"ref");y(this,zM);this.ref=t,this[$T]=$T}getOrElseMemoize(t,n){return j(nse(this.ref,r=>{const i=r.get(t);if(i!==void 0){const[c,f]=i,m=j(c,se(([g,b])=>j(TX(g),rr(b))),Uo(G0({onFailure:()=>it,onSuccess:()=>qp(n,f)})));return fe([m,r])}return j(ev(0),se(c=>j(x_(),se(f=>j(ev(()=>it),Ye(m=>{const g=ks(S=>j(Wh(),se(v=>j(S(se(B4(t,v,!0),q=>_X(q(this)))),ei,se(q=>{switch(q._tag){case kr:return j(TU(f,q.effect_instruction_i0),Nt($k(v,q)),Nt(en(q.effect_instruction_i0)));case Cr:return j(Mp(m,k=>j($k(v,k),P0(GU(c,N=>[N===1,N-1])),na)),Nt(Uk(c,k=>k+1)),Nt(qp(n,k=>j(he(()=>r.delete(t)),Nt(el(m)),se(N=>N(k))))),Nt(O_(f,q.effect_instruction_i0)),rr(q.effect_instruction_i0[1]))}}))))),b=[j(Fi(f),Uo(Mk({onFailure:()=>it,onSuccess:()=>Uk(c,S=>S+1)}))),S=>j(el(m),se(v=>v(S)))];return[g,cse(t)?r:r.set(t,b)]}))))))}),zh)}}const lse=Ne(()=>Ye(Dre(new Map),e=>new P4(e))),use=()=>new P4(N4(new Map)),H4=D(2,(e,t)=>se(lse,n=>fse(e,n,t))),fse=D(3,(e,t,n)=>se(B4(e,n),r=>jp(r(t),ise,t))),B4=(e,t,n=!1)=>{const r=e;switch(r._op_layer){case"Locally":return he(()=>i=>r.f(i.getOrElseMemoize(r.self,t)));case"ExtendScope":return he(()=>i=>Zz(c=>i.getOrElseMemoize(r.layer,c)));case"Fold":return he(()=>i=>j(i.getOrElseMemoize(r.layer,t),Ts({onFailure:c=>i.getOrElseMemoize(r.failureK(c),t),onSuccess:c=>i.getOrElseMemoize(r.successK(c),t)})));case"Fresh":return he(()=>i=>j(r.layer,H4(t)));case"FromEffect":return he(n?()=>i=>r.effect:()=>i=>i.getOrElseMemoize(e,t));case"Provide":return he(()=>i=>j(i.getOrElseMemoize(r.first,t),se(c=>j(i.getOrElseMemoize(r.second,t),ER(c)))));case"Scoped":return he(n?()=>i=>gf(r.effect,t):()=>i=>i.getOrElseMemoize(e,t));case"Suspend":return he(()=>i=>i.getOrElseMemoize(r.evaluate(),t));case"ProvideMerge":return he(()=>i=>j(i.getOrElseMemoize(r.first,t),hU(i.getOrElseMemoize(r.second,t),r.zipK)));case"ZipWith":return he(()=>i=>j(i.getOrElseMemoize(r.first,t),L_(i.getOrElseMemoize(r.second,t),r.zipK,{concurrent:!0})))}},dse=()=>fw(Vh()),hse=e=>V4(ol(e)),V4=e=>fw(en(e)),l2=D(2,(e,t)=>gse(e,{onFailure:hse,onSuccess:t})),G4=D(2,(e,t)=>{const n=FA(e),r=n?e:t;return fw(Ye(n?t:e,c=>h0(r,c)))});function fw(e){const t=Object.create(ul);return t._op_layer=Ire,t.effect=e,t}const mse=D(2,(e,{onFailure:t,onSuccess:n})=>{const r=Object.create(ul);return r._op_layer=Nre,r.layer=e,r.failureK=t,r.successK=n,r}),gse=D(2,(e,{onFailure:t,onSuccess:n})=>mse(e,{onFailure:r=>{const i=cw(r);switch(i._tag){case"Left":return t(i.left);case"Right":return V4(i.right)}},onSuccess:n})),K4=D(2,(e,t)=>bse(e,t,(n,r)=>_l(n,r))),Q4=(...e)=>{let t=e[0];for(let n=1;n<e.length;n++)t=K4(t,e[n]);return t},pse=D(2,(e,t)=>{const n=FA(e),r=n?e:t;return Y4(Ye(n?t:e,c=>h0(r,c)))}),u2=e=>Y4(j(e,rr(Iu()))),Y4=e=>{const t=Object.create(ul);return t._op_layer=Mre,t.effect=e,t},_se=D(2,(e,t)=>{const n=FA(e);return fw(fe(h0(n?e:t,n?t:e)))}),W4=e=>{const t=Object.create(ul);return t._op_layer=jre,t.evaluate=e,t},J4=D(2,(e,t)=>W4(()=>{const n=Object.create(ul);return n._op_layer=Fre,n.first=Object.create(ul,{_op_layer:{value:$4,enumerable:!0},first:{value:dse(),enumerable:!0},second:{value:Array.isArray(t)?Q4(...t):t},zipK:{value:(r,i)=>j(r,_l(i))}}),n.second=e,n})),yse=D(2,(e,t)=>{const n=Object.create(ul);return n._op_layer=$4,n.first=t,n.second=J4(e,t),n.zipK=(r,i)=>j(r,_l(i)),n}),bse=D(3,(e,t,n)=>W4(()=>{const r=Object.create(ul);return r._op_layer=Lre,r.first=e,r.second=t,r.zipK=n,r})),Sse=e=>{const t=Cs("effect/Layer/unwrapEffect/Layer.Layer<R1, E1, A>");return l2(G4(t,e),n=>Ws(n,t))},vse=e=>{const t=Cs("effect/Layer/unwrapScoped/Layer.Layer<R1, E1, A>");return l2(pse(t,e),n=>Ws(n,t))},xN=D(2,(e,t)=>e4(n=>se(H4(t,n),r=>TR(e,r)))),ON=D(2,(e,t)=>{const n=Lp(ph.fiberRefs,t.fiberRefs),r=wu(ph.runtimeFlags,t.runtimeFlags);return ks(i=>yt(c=>{const f=c.getFiberRef(ai),m=c.getFiberRefs(),g=Up(c.id(),m)(n),b=c.currentRuntimeFlags,S=jd(r)(b),v=Lp(g,m),q=wu(S,b);return c.setFiberRefs(g),c.currentRuntimeFlags=S,gh(TR(i(e),_l(f,t.context)),yt(k=>(k.setFiberRefs(Up(k.id(),k.getFiberRefs())(v)),k.currentRuntimeFlags=jd(q)(k.currentRuntimeFlags),it)))}))}),wse=D(2,(e,t)=>Array.isArray(t)?xN(e,Q4(...t)):ose(t)?xN(e,t):Q9(t)?TR(e,t):qre in t?se(t.runtimeEffect,n=>ON(e,n)):ON(e,t)),Ese=Ste,DN=Bu,vl=ta,dw=iw,Hr=hh,f2=Lo,_h=yt,Wu=mn,Da=en,Pp=Op,Tse=Dk,ye=EY,d2=CY,Ju=kX,Gn=fe,Nn=Ne,Ke=he,ot=it,kse=T_,h2=oh,Xh=Uh,X4=dX,IT=hX,Xu=mX,Cse=az,m2=bX,hw=_re,B_=fX,Ase=sne,zc=Jn,kn=lh,Rse=bl,Rd=Yo,Zh=ks,Io=rr,g2=na,Tt=Ye,xse=hR,pf=z0,wn=t2,p2=uR,rs=Xz,xd=gh,Ose=bY,Z4=t4,cC=e4,Zu=Qte,eP=ff,_2=Vte,tP=mh,vs=gv,En=Tre,Dse=pX,y2=UR,yh=Cre,qse=Vh,ss=wse,b2=jp,Nse=$X,_d=ch,In=ei,mw=fU,$se=NX,Xe=se,Hp=_Y,Hc=zh,MT=s4,nP=kre,rP=r4,Ns=zo,Ise=AX,Mse=RX,Ys=xX,bh=LR,qN=gre,jse=pR,Fse=sz,pv=uU,Ti=Ts,Lse=ji,S2=SX,Ur=iz,Xa=vX,Bp=wX,nl=lX,Use=VY,va=mR,em=Yre,gw=vre,NN=Ere,oi=Zre,sP=Xre,pw=ese,ya=tse,lC=Yte,v2=Wte,sn=Jte,_w=L_,zse=DX,uC=IX,w2=oz,Pse=MX,At=jX,E2=one,Od=Pk,yw=function(e,...t){const n=Error.stackTraceLimit;Error.stackTraceLimit=2;const r=new Error;if(Error.stackTraceLimit=n,typeof e!="string")return $N(e.length,function(...f){const m=Error.stackTraceLimit;Error.stackTraceLimit=2;const g=new Error;return Error.stackTraceLimit=m,IN({self:this,body:e,args:f,pipeables:t,spanName:"<anonymous>",spanOptions:{context:ZS.context(!0)},errorDef:r,errorCall:g})});const i=e,c=t[0];return(f,...m)=>$N(f.length,{[i](...g){const b=Error.stackTraceLimit;Error.stackTraceLimit=2;const S=new Error;return Error.stackTraceLimit=b,IN({self:this,body:f,args:g,pipeables:m,spanName:i,spanOptions:c,errorDef:r,errorCall:S})}}[i])};function $N(e,t){return Object.defineProperty(t,"length",{value:e,configurable:!0})}function IN(e){let t,n;if(_7(e.body))t=QS(()=>e.body.apply(e.self,e.args));else try{t=e.body.apply(e.self,e.args)}catch(f){n=f,t=Pp(f)}if(e.pipeables.length>0)try{for(const f of e.pipeables)t=f(t,...e.args)}catch(f){t=n?Da(tr(ns(n),ns(f))):Pp(f)}let r=!1;const i=()=>{if(r!==!1)return r;if(e.errorCall.stack){const f=e.errorDef.stack.trim().split(`
`),m=e.errorCall.stack.trim().split(`
`);let g=f.slice(2).join(`
`).trim();g.includes("(")||(g=g.replace(/at (.*)/,"at ($1)"));let b=m.slice(2).join(`
`).trim();return b.includes("(")||(b=b.replace(/at (.*)/,"at ($1)")),r=`${g}
${b}`,r}},c=e.spanOptions&&"captureStackTrace"in e.spanOptions?e.spanOptions:{captureStackTrace:i,...e.spanOptions};return At(t,e.spanName,c)}const Hse=TY,Bse=k_,Vse=Ph,aP=ai,Gse=hf,Kse=aw,iP=tw,Qse=H0,Yse=D(2,(e,t)=>df(Yz,t)(e)),Wse=e=>u2(s2(aw,Md(e))),Jse=e=>u2(s2(aw,JA(e))),Xse=D(2,(e,t)=>l2(Jse(e),()=>Wse(t))),Zse=e=>u2(ine(e)),eae=G4,tae=K4,V_=_se,nae=J4,rae=yse,oP=Sse,sae=vse,cP=Zse,aae="effect/QueueEnqueue",lP=Symbol.for(aae),iae="effect/QueueDequeue",T2=Symbol.for(iae),oae="effect/QueueStrategy",k2=Symbol.for(oae),cae="effect/BackingQueue",lae=Symbol.for(cae),C2={_A:e=>e},uae={_A:e=>e},uP={_In:e=>e},A2={_Out:e=>e};var PM,HM,BM;class fae extends(BM=Gi,HM=lP,PM=T2,BM){constructor(n,r,i,c,f){super();y(this,"queue");y(this,"takers");y(this,"shutdownHook");y(this,"shutdownFlag");y(this,"strategy");y(this,HM,uP);y(this,PM,A2);this.queue=n,this.takers=r,this.shutdownHook=i,this.shutdownFlag=c,this.strategy=f}pipe(){return xe(this,arguments)}commit(){return this.take}capacity(){return this.queue.capacity()}get size(){return Ne(()=>oh(this.unsafeSize(),()=>Jn))}unsafeSize(){return Dt(this.shutdownFlag)?me():pe(this.queue.length()-DR(this.takers)+this.strategy.surplusSize())}get isEmpty(){return Ye(this.size,n=>n<=0)}get isFull(){return Ye(this.size,n=>n>=this.capacity())}get shutdown(){return Yo(yt(n=>(j(this.shutdownFlag,lf(!0)),j($o(Ud(this.takers),r=>wR(r,n.id()),!1,!1),Nt(this.strategy.shutdown),P0(O_(this.shutdownHook,void 0)),na))))}get isShutdown(){return he(()=>Dt(this.shutdownFlag))}get awaitShutdown(){return Fi(this.shutdownHook)}isActive(){return!Dt(this.shutdownFlag)}unsafeOffer(n){if(Dt(this.shutdownFlag))return!1;let r;if(this.queue.length()===0){const c=j(this.takers,qo(Vn));c!==Vn?(ku(c,n),r=!0):r=!1}else r=!1;if(r)return!0;const i=this.queue.offer(n);return du(this.strategy,this.queue,this.takers),i}offer(n){return Ne(()=>{if(Dt(this.shutdownFlag))return Jn;let r;if(this.queue.length()===0){const c=j(this.takers,qo(Vn));c!==Vn?(ku(c,n),r=!0):r=!1}else r=!1;if(r)return fe(!0);const i=this.queue.offer(n);return du(this.strategy,this.queue,this.takers),i?fe(!0):this.strategy.handleSurplus([n],this.queue,this.takers,this.shutdownFlag)})}offerAll(n){return Ne(()=>{if(Dt(this.shutdownFlag))return Jn;const r=Ht(n),i=this.queue.length()===0?Ht(Dae(this.takers,r.length)):rl,[c,f]=j(r,mF(i.length));for(let g=0;g<i.length;g++){const b=i[g],S=c[g];ku(b,S)}if(f.length===0)return fe(!0);const m=this.queue.offerAll(f);return du(this.strategy,this.queue,this.takers),y0(m)?fe(!0):this.strategy.handleSurplus(m,this.queue,this.takers,this.shutdownFlag)})}get take(){return yt(n=>{if(Dt(this.shutdownFlag))return Jn;const r=this.queue.poll(Vn);if(r!==Vn)return this.strategy.unsafeOnQueueEmptySpace(this.queue,this.takers),fe(r);{const i=R_(n.id());return j(Ne(()=>(j(this.takers,uh(i)),du(this.strategy,this.queue,this.takers),Dt(this.shutdownFlag)?Jn:Fi(i))),bl(()=>he(()=>qae(this.takers,i))))}})}get takeAll(){return Ne(()=>Dt(this.shutdownFlag)?Jn:he(()=>{const n=this.queue.pollUpTo(Number.POSITIVE_INFINITY);return this.strategy.unsafeOnQueueEmptySpace(this.queue,this.takers),Mu(n)}))}takeUpTo(n){return Ne(()=>Dt(this.shutdownFlag)?Jn:he(()=>{const r=this.queue.pollUpTo(n);return this.strategy.unsafeOnQueueEmptySpace(this.queue,this.takers),Mu(r)}))}takeBetween(n,r){return Ne(()=>fP(this,n,r,an()))}}const fP=(e,t,n,r)=>n<t?fe(r):j(Tae(e,n),se(i=>{const c=t-i.length;return c===1?j(fC(e),Ye(f=>j(r,pn(i),wp(f)))):c>1?j(fC(e),se(f=>fP(e,c-1,n-i.length-1,j(r,pn(i),wp(f))))):fe(j(r,pn(i)))})),dae=e=>j(he(()=>OR(e)),se(t=>bw(Sw(t),Cae()))),hae=e=>j(he(()=>OR(e)),se(t=>bw(Sw(t),dP()))),mae=e=>j(he(()=>OR(e)),se(t=>bw(Sw(t),Aae()))),R2=()=>j(he(()=>K0()),se(e=>bw(Sw(e),dP()))),gae=(e,t,n,r,i)=>new fae(e,t,n,r,i),bw=(e,t)=>j(x_(),Ye(n=>gae(e,K0(),n,cf(!1),t)));var VM;VM=lae;class pae{constructor(t){y(this,"mutable");y(this,VM,uae);this.mutable=t}poll(t){return qo(this.mutable,t)}pollUpTo(t){return Q0(this.mutable,t)}offerAll(t){return qR(this.mutable,t)}offer(t){return uh(this.mutable,t)}capacity(){return MW(this.mutable)}length(){return DR(this.mutable)}}const Sw=e=>new pae(e),_ae=e=>e.size,yae=e=>e.isShutdown,bae=e=>e.awaitShutdown,Sae=e=>e.shutdown,vae=D(2,(e,t)=>e.offer(t)),wae=D(2,(e,t)=>e.offerAll(t)),fC=e=>e.take,Eae=e=>e.takeAll,Tae=D(2,(e,t)=>e.takeUpTo(t)),kae=D(3,(e,t,n)=>e.takeBetween(t,n)),Cae=()=>new Rae,dP=()=>new xae,Aae=()=>new Oae;var GM;GM=k2;class Rae{constructor(){y(this,GM,C2);y(this,"putters",K0())}surplusSize(){return DR(this.putters)}onCompleteTakersWithEmptyQueue(t){for(;!Tu(this.putters)&&!Tu(t);){const n=qo(t,void 0),r=qo(this.putters,void 0);r[2]&&ku(r[1],!0),ku(n,r[0])}}get shutdown(){return j(E_,se(t=>j(he(()=>Ud(this.putters)),se(n=>$o(n,([r,i,c])=>c?j(wR(i,t),na):it,!1,!1)))))}handleSurplus(t,n,r,i){return yt(c=>{const f=R_(c.id());return j(Ne(()=>(this.unsafeOffer(t,f),this.unsafeOnQueueEmptySpace(n,r),du(this,n,r),Dt(i)?Jn:Fi(f))),bl(()=>he(()=>this.unsafeRemove(f))))})}unsafeOnQueueEmptySpace(t,n){let r=!0;for(;r&&(t.capacity()===Number.POSITIVE_INFINITY||t.length()<t.capacity());){const i=j(this.putters,qo(Vn));if(i===Vn)r=!1;else{const c=t.offer(i[0]);c&&i[2]?ku(i[1],!0):c||_v(this.putters,j(Ud(this.putters),Gr(i))),du(this,t,n)}}}unsafeOffer(t,n){const r=Ht(t);for(let i=0;i<r.length;i++){const c=r[i];i===r.length-1?j(this.putters,uh([c,n,!0])):j(this.putters,uh([c,n,!1]))}}unsafeRemove(t){_v(this.putters,j(Ud(this.putters),_0(([,n])=>n!==t)))}}var KM;let xae=(KM=k2,class{constructor(){y(this,KM,C2)}surplusSize(){return 0}get shutdown(){return it}onCompleteTakersWithEmptyQueue(){}handleSurplus(t,n,r,i){return fe(!1)}unsafeOnQueueEmptySpace(t,n){}});var QM;QM=k2;class Oae{constructor(){y(this,QM,C2)}surplusSize(){return 0}get shutdown(){return it}onCompleteTakersWithEmptyQueue(){}handleSurplus(t,n,r,i){return he(()=>(this.unsafeOffer(n,t),du(this,n,r),!0))}unsafeOnQueueEmptySpace(t,n){}unsafeOffer(t,n){const r=n[Symbol.iterator]();let i,c=!0;for(;!(i=r.next()).done&&c;){if(t.capacity()===0)return;t.poll(Vn),c=t.offer(i.value)}}}const ku=(e,t)=>D_(e,fe(t)),_v=(e,t)=>j(e,qR(t)),Ud=e=>j(e,Q0(Number.POSITIVE_INFINITY)),Dae=(e,t)=>j(e,Q0(t)),qae=(e,t)=>{_v(e,j(Ud(e),_0(n=>t!==n)))},du=(e,t,n)=>{let r=!0;for(;r&&t.length()!==0;){const i=j(n,qo(Vn));if(i!==Vn){const c=t.poll(Vn);c!==Vn?(ku(i,c),e.unsafeOnQueueEmptySpace(t,n)):_v(n,j(Ud(n),Gr(i))),r=!0}else r=!1}r&&t.length()===0&&!Tu(n)&&e.onCompleteTakersWithEmptyQueue(n)},Ei=Symbol.for("effect/PubSub/AbsentValue"),hP=(e,t)=>n=>{n.has(e)||n.set(e,new Set),n.get(e).add(t)},Nae=(e,t)=>n=>{if(!n.has(e))return;const r=n.get(e);r.delete(t),r.size===0&&n.delete(e)},$ae=e=>Ne(()=>{const t=Fae(e);return Vae(t,new Xae)}),Iae=e=>e.shutdown,Mae=D(2,(e,t)=>e.publish(t)),jae=e=>e.subscribe,Fae=e=>new zae(e!=null&&e.replay?new tie(e.replay):void 0),Lae=(e,t,n)=>Ye(x_(),r=>Uae(e,t,e.subscribe(),K0(),r,cf(!1),n)),Uae=(e,t,n,r,i,c,f)=>new Hae(e,t,n,r,i,c,f,e.replayWindow());class zae{constructor(t){y(this,"replayBuffer");y(this,"publisherHead",{value:Ei,subscribers:0,next:null});y(this,"publisherTail",this.publisherHead);y(this,"publisherIndex",0);y(this,"subscribersIndex",0);y(this,"capacity",Number.MAX_SAFE_INTEGER);this.replayBuffer=t}replayWindow(){return this.replayBuffer?new nie(this.replayBuffer):rie}isEmpty(){return this.publisherHead===this.publisherTail}isFull(){return!1}size(){return this.publisherIndex-this.subscribersIndex}publish(t){const n=this.publisherTail.subscribers;return n!==0&&(this.publisherTail.next={value:t,subscribers:n,next:null},this.publisherTail=this.publisherTail.next,this.publisherIndex+=1),this.replayBuffer&&this.replayBuffer.offer(t),!0}publishAll(t){if(this.publisherTail.subscribers!==0)for(const n of t)this.publish(n);else this.replayBuffer&&this.replayBuffer.offerAll(t);return an()}slide(){this.publisherHead!==this.publisherTail&&(this.publisherHead=this.publisherHead.next,this.publisherHead.value=Ei,this.subscribersIndex+=1),this.replayBuffer&&this.replayBuffer.slide()}subscribe(){return this.publisherTail.subscribers+=1,new Pae(this,this.publisherTail,this.publisherIndex,!1)}}class Pae{constructor(t,n,r,i){y(this,"self");y(this,"subscriberHead");y(this,"subscriberIndex");y(this,"unsubscribed");this.self=t,this.subscriberHead=n,this.subscriberIndex=r,this.unsubscribed=i}isEmpty(){if(this.unsubscribed)return!0;let t=!0,n=!0;for(;n;)this.subscriberHead===this.self.publisherTail?n=!1:this.subscriberHead.next.value!==Ei?(t=!1,n=!1):(this.subscriberHead=this.subscriberHead.next,this.subscriberIndex+=1);return t}size(){return this.unsubscribed?0:this.self.publisherIndex-Math.max(this.subscriberIndex,this.self.subscribersIndex)}poll(t){if(this.unsubscribed)return t;let n=!0,r=t;for(;n;)if(this.subscriberHead===this.self.publisherTail)n=!1;else{const i=this.subscriberHead.next.value;i!==Ei&&(r=i,this.subscriberHead.subscribers-=1,this.subscriberHead.subscribers===0&&(this.self.publisherHead=this.self.publisherHead.next,this.self.publisherHead.value=Ei,this.self.subscribersIndex+=1),n=!1),this.subscriberHead=this.subscriberHead.next,this.subscriberIndex+=1}return r}pollUpTo(t){const n=[],r=Ei;let i=0;for(;i!==t;){const c=this.poll(r);c===r?i=t:(n.push(c),i+=1)}return Mu(n)}unsubscribe(){if(!this.unsubscribed)for(this.unsubscribed=!0,this.self.publisherTail.subscribers-=1;this.subscriberHead!==this.self.publisherTail;)this.subscriberHead.next.value!==Ei&&(this.subscriberHead.subscribers-=1,this.subscriberHead.subscribers===0&&(this.self.publisherHead=this.self.publisherHead.next,this.self.publisherHead.value=Ei,this.self.subscribersIndex+=1)),this.subscriberHead=this.subscriberHead.next}}var YM,WM;class Hae extends(WM=Gi,YM=T2,WM){constructor(n,r,i,c,f,m,g,b){super();y(this,"pubsub");y(this,"subscribers");y(this,"subscription");y(this,"pollers");y(this,"shutdownHook");y(this,"shutdownFlag");y(this,"strategy");y(this,"replayWindow");y(this,YM,A2);this.pubsub=n,this.subscribers=r,this.subscription=i,this.pollers=c,this.shutdownHook=f,this.shutdownFlag=m,this.strategy=g,this.replayWindow=b}commit(){return this.take}pipe(){return xe(this,arguments)}capacity(){return this.pubsub.capacity}isActive(){return!Dt(this.shutdownFlag)}get size(){return Ne(()=>Dt(this.shutdownFlag)?Jn:fe(this.subscription.size()+this.replayWindow.remaining))}unsafeSize(){return Dt(this.shutdownFlag)?me():pe(this.subscription.size()+this.replayWindow.remaining)}get isFull(){return Ne(()=>Dt(this.shutdownFlag)?Jn:fe(this.subscription.size()===this.capacity()))}get isEmpty(){return Ye(this.size,n=>n===0)}get shutdown(){return Yo(yt(n=>(lf(this.shutdownFlag,!0),j(n2(x2(this.pollers),r=>wR(r,n.id()),!1),Nt(he(()=>{this.subscribers.delete(this.subscription),this.subscription.unsubscribe(),this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers)})),P0(O_(this.shutdownHook,void 0)),na))))}get isShutdown(){return he(()=>Dt(this.shutdownFlag))}get awaitShutdown(){return Fi(this.shutdownHook)}get take(){return yt(n=>{if(Dt(this.shutdownFlag))return Jn;if(this.replayWindow.remaining>0){const i=this.replayWindow.take();return fe(i)}const r=Tu(this.pollers)?this.subscription.poll(Vn):Vn;if(r===Vn){const i=R_(n.id());return j(Ne(()=>(j(this.pollers,uh(i)),j(this.subscribers,hP(this.subscription,this.pollers)),this.strategy.unsafeCompletePollers(this.pubsub,this.subscribers,this.subscription,this.pollers),Dt(this.shutdownFlag)?Jn:Fi(i))),bl(()=>he(()=>Jae(this.pollers,i))))}else return this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers),fe(r)})}get takeAll(){return Ne(()=>{if(Dt(this.shutdownFlag))return Jn;const n=Tu(this.pollers)?Qae(this.subscription):an();return this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers),this.replayWindow.remaining>0?fe(pn(this.replayWindow.takeAll(),n)):fe(n)})}takeUpTo(n){return Ne(()=>{if(Dt(this.shutdownFlag))return Jn;let r;if(this.replayWindow.remaining>=n){const c=this.replayWindow.takeN(n);return fe(c)}else this.replayWindow.remaining>0&&(r=this.replayWindow.takeAll(),n=n-r.length);const i=Tu(this.pollers)?Yae(this.subscription,n):an();return this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers),fe(r?pn(r,i):i)})}takeBetween(n,r){return Ne(()=>mP(this,n,r,an()))}}const mP=(e,t,n,r)=>n<t?fe(r):j(e.takeUpTo(n),se(i=>{const c=t-i.length;return c===1?j(e.take,Ye(f=>j(r,pn(i),wp(f)))):c>1?j(e.take,se(f=>mP(e,c-1,n-i.length-1,j(r,pn(i),wp(f))))):fe(j(r,pn(i)))}));var JM,XM;XM=lP,JM=T2;class Bae{constructor(t,n,r,i,c,f){y(this,"pubsub");y(this,"subscribers");y(this,"scope");y(this,"shutdownHook");y(this,"shutdownFlag");y(this,"strategy");y(this,XM,uP);y(this,JM,A2);this.pubsub=t,this.subscribers=n,this.scope=r,this.shutdownHook=i,this.shutdownFlag=c,this.strategy=f}capacity(){return this.pubsub.capacity}get size(){return Ne(()=>Dt(this.shutdownFlag)?Jn:he(()=>this.pubsub.size()))}unsafeSize(){return Dt(this.shutdownFlag)?me():pe(this.pubsub.size())}get isFull(){return Ye(this.size,t=>t===this.capacity())}get isEmpty(){return Ye(this.size,t=>t===0)}get awaitShutdown(){return Fi(this.shutdownHook)}get isShutdown(){return he(()=>Dt(this.shutdownFlag))}get shutdown(){return Yo(yt(t=>(j(this.shutdownFlag,lf(!0)),j(this.scope.close(SR(t.id())),Nt(this.strategy.shutdown),P0(O_(this.shutdownHook,void 0)),na))))}publish(t){return Ne(()=>Dt(this.shutdownFlag)?Jn:this.pubsub.publish(t)?(this.strategy.unsafeCompleteSubscribers(this.pubsub,this.subscribers),fe(!0)):this.strategy.handleSurplus(this.pubsub,this.subscribers,Sn(t),this.shutdownFlag))}isActive(){return!Dt(this.shutdownFlag)}unsafeOffer(t){return Dt(this.shutdownFlag)?!1:this.pubsub.publish(t)?(this.strategy.unsafeCompleteSubscribers(this.pubsub,this.subscribers),!0):!1}publishAll(t){return Ne(()=>{if(Dt(this.shutdownFlag))return Jn;const n=Wae(this.pubsub,t);return this.strategy.unsafeCompleteSubscribers(this.pubsub,this.subscribers),y0(n)?fe(!0):this.strategy.handleSurplus(this.pubsub,this.subscribers,n,this.shutdownFlag)})}get subscribe(){const t=zo(iw([this.scope.fork(N_),Lae(this.pubsub,this.subscribers,this.strategy)]),n=>n[0].addFinalizer(()=>n[1].shutdown));return Ye(t2(t,(n,r)=>n[0].close(r)),n=>n[1])}offer(t){return this.publish(t)}offerAll(t){return this.publishAll(t)}pipe(){return xe(this,arguments)}}const Vae=(e,t)=>se(Wh(),n=>Ye(x_(),r=>Gae(e,new Map,n,r,cf(!1),t))),Gae=(e,t,n,r,i,c)=>new Bae(e,t,n,r,i,c),Kae=(e,t)=>{D_(e,fe(t))},gP=(e,t)=>j(e,qR(t)),x2=e=>j(e,Q0(Number.POSITIVE_INFINITY)),Qae=e=>e.pollUpTo(Number.POSITIVE_INFINITY),Yae=(e,t)=>e.pollUpTo(t),Wae=(e,t)=>e.publishAll(t),Jae=(e,t)=>{gP(e,j(x2(e),_0(n=>n!==t)))};class Xae{get shutdown(){return it}handleSurplus(t,n,r,i){return fe(!1)}unsafeOnPubSubEmptySpace(t,n){}unsafeCompletePollers(t,n,r,i){return Zae(this,t,n,r,i)}unsafeCompleteSubscribers(t,n){return eie(this,t,n)}}const Zae=(e,t,n,r,i)=>{let c=!0;for(;c&&!r.isEmpty();){const f=j(i,qo(Vn));if(f===Vn)j(n,Nae(r,i)),Tu(i)?c=!1:j(n,hP(r,i));else{const m=r.poll(Vn);m===Vn?gP(i,j(x2(i),Gr(f))):(Kae(f,m),e.unsafeOnPubSubEmptySpace(t,n))}}},eie=(e,t,n)=>{for(const[r,i]of n)for(const c of i)e.unsafeCompletePollers(t,n,r,c)};class tie{constructor(t){y(this,"capacity");y(this,"head",{value:Ei,next:null});y(this,"tail",this.head);y(this,"size",0);y(this,"index",0);this.capacity=t}slide(){this.index++}offer(t){this.tail.value=t,this.tail.next={value:Ei,next:null},this.tail=this.tail.next,this.size===this.capacity?this.head=this.head.next:this.size+=1}offerAll(t){for(const n of t)this.offer(n)}}class nie{constructor(t){y(this,"buffer");y(this,"head");y(this,"index");y(this,"remaining");this.buffer=t,this.index=t.index,this.remaining=t.size,this.head=t.head}fastForward(){for(;this.index<this.buffer.index;)this.head=this.head.next,this.index++}take(){if(this.remaining===0)return;this.index<this.buffer.index&&this.fastForward(),this.remaining--;const t=this.head.value;return this.head=this.head.next,t}takeN(t){if(this.remaining===0)return an();this.index<this.buffer.index&&this.fastForward();const n=Math.min(t,this.remaining),r=new Array(n);for(let i=0;i<n;i++){const c=this.head.value;this.head=this.head.next,r[i]=c}return this.remaining-=n,Bn(r)}takeAll(){return this.takeN(this.remaining)}}const rie={remaining:0,take:()=>{},takeN:()=>an(),takeAll:()=>an()},pP=$ae,dC=Iae,O2=Mae,MN=jae,D2=dae,sie=hae,aie=mae,qs=R2,iie=_ae,oie=yae,cie=bae,ys=Sae,Tn=vae,q2=wae,Sh=fC,lie=Eae,_P=kae,yP="Continue",uie="Close",fie="Yield",die="effect/ChannelChildExecutorDecision",jN=Symbol.for(die),hie={[jN]:jN},bP=e=>{const t=Object.create(hie);return t._tag=yP,t},mS="ContinuationK",mie="ContinuationFinalizer",SP=Symbol.for("effect/ChannelContinuation"),vP={_Env:e=>e,_InErr:e=>e,_InElem:e=>e,_InDone:e=>e,_OutErr:e=>e,_OutDone:e=>e,_OutErr2:e=>e,_OutElem:e=>e,_OutDone2:e=>e};var ZM;ZM=SP;class N2{constructor(t,n){y(this,"onSuccess");y(this,"onHalt");y(this,"_tag",mS);y(this,ZM,vP);this.onSuccess=t,this.onHalt=n}onExit(t){return Kh(t)?this.onHalt(t.cause):this.onSuccess(t.value)}}var ej;ej=SP;class gie{constructor(t){y(this,"finalizer");y(this,"_tag",mie);y(this,ej,vP);this.finalizer=t}}const wP="PullAfterNext",pie="PullAfterAllEnqueued",_ie="effect/ChannelUpstreamPullStrategy",yie=Symbol.for(_ie),bie={_A:e=>e},Sie={[yie]:bie},EP=e=>{const t=Object.create(Sie);return t._tag=wP,t.emitSeparator=e,t},TP="BracketOut",kP="Bridge",$2="ConcatAll",CP="Emit",AP="Ensuring",RP="Fail",I2="Fold",xP="FromEffect",OP="PipeTo",DP="Provide",qP="Read",NP="Succeed",$P="SucceedNow",IP="Suspend",vie="effect/Channel",yv=Symbol.for(vie),wie={_Env:e=>e,_InErr:e=>e,_InElem:e=>e,_InDone:e=>e,_OutErr:e=>e,_OutElem:e=>e,_OutDone:e=>e},os={[yv]:wie,pipe(){return xe(this,arguments)}},MP=e=>Ae(e,yv)||vl(e),Eie=D(2,(e,t)=>{const n=Object.create(os);return n._tag=TP,n.acquire=()=>e,n.finalizer=t,n}),M2=D(2,(e,t)=>{const n=Object.create(os);return n._tag=I2,n.channel=e,n.k=new N2(_f,t),n}),jP=(e,t,n)=>{const r=Object.create(os);return r._tag=$2,r.combineInners=t,r.combineAll=n,r.onPull=()=>EP(me()),r.onEmit=()=>bP,r.value=()=>e,r.k=Ie,r},Tie=D(4,(e,t,n,r)=>{const i=Object.create(os);return i._tag=$2,i.combineInners=n,i.combineAll=r,i.onPull=()=>EP(me()),i.onEmit=()=>bP,i.value=()=>e,i.k=t,i}),j2=D(2,(e,t)=>{const n=Object.create(os);return n._tag=kP,n.input=t,n.channel=e,n}),FP=D(2,(e,t)=>{const n=Object.create(os);return n._tag=AP,n.channel=e,n.finalizer=t,n}),tm=e=>Kn(ol(e)),Kn=e=>LP(()=>e),LP=e=>{const t=Object.create(os);return t._tag=RP,t.error=e,t},$t=D(2,(e,t)=>{const n=Object.create(os);return n._tag=I2,n.channel=e,n.k=new N2(t,Kn),n}),wr=e=>{const t=Object.create(os);return t._tag=xP,t.effect=()=>e,t},Br=D(2,(e,t)=>{const n=Object.create(os);return n._tag=OP,n.left=()=>e,n.right=()=>t,n}),FN=D(2,(e,t)=>{const n=Object.create(os);return n._tag=DP,n.context=()=>t,n.inner=e,n}),G_=e=>Ki({onInput:e.onInput,onFailure:t=>zr(cw(t),{onLeft:e.onFailure,onRight:Kn}),onDone:e.onDone}),Ki=e=>{const t=Object.create(os);return t._tag=qP,t.more=e.onInput,t.done=new N2(e.onDone,e.onFailure),t},_f=e=>UP(()=>e),zi=e=>{const t=Object.create(os);return t._tag=$P,t.terminal=e,t},K_=e=>{const t=Object.create(os);return t._tag=IP,t.channel=e,t},UP=e=>{const t=Object.create(os);return t._tag=NP,t.evaluate=e,t},ws=zi(void 0),Qt=e=>{const t=Object.create(os);return t._tag=CP,t.out=e,t},Q_="Done",Y_="Emit",nm="FromEffect",W_="Read",kie=Symbol.for("effect/ChannelState"),Cie={_E:e=>e,_R:e=>e},vw={[kie]:Cie},yd=()=>{const e=Object.create(vw);return e._tag=Q_,e},jT=()=>{const e=Object.create(vw);return e._tag=Y_,e},Og=e=>{const t=Object.create(vw);return t._tag=nm,t.effect=e,t},FT=(e,t,n,r)=>{const i=Object.create(vw);return i._tag=W_,i.upstream=e,i.onEffect=t,i.onEmit=n,i.onDone=r,i},bv=e=>e._tag===nm,Aie=e=>bv(e)?e.effect:ot,LN=e=>bv(e)?Cse(e.effect):void 0,zP="PullFromChild",hC="PullFromUpstream",mC="DrainChildExecutors",PP="Emit";class Pb{constructor(t,n,r){y(this,"childExecutor");y(this,"parentSubexecutor");y(this,"onEmit");y(this,"_tag",zP);this.childExecutor=t,this.parentSubexecutor=n,this.onEmit=r}close(t){const n=this.childExecutor.close(t),r=this.parentSubexecutor.close(t);return n!==void 0&&r!==void 0?_w(In(n),In(r),(i,c)=>j(i,$p(c))):n!==void 0?n:r!==void 0?r:void 0}enqueuePullFromChild(t){return this}}class ou{constructor(t,n,r,i,c,f,m,g){y(this,"upstreamExecutor");y(this,"createChild");y(this,"lastDone");y(this,"activeChildExecutors");y(this,"combineChildResults");y(this,"combineWithChildResult");y(this,"onPull");y(this,"onEmit");y(this,"_tag",hC);this.upstreamExecutor=t,this.createChild=n,this.lastDone=r,this.activeChildExecutors=i,this.combineChildResults=c,this.combineWithChildResult=f,this.onPull=m,this.onEmit=g}close(t){const n=this.upstreamExecutor.close(t),i=[...this.activeChildExecutors.map(c=>c!==void 0?c.childExecutor.close(t):void 0),n].reduce((c,f)=>c!==void 0&&f!==void 0?_w(c,In(f),(m,g)=>$p(m,g)):c!==void 0?c:f!==void 0?In(f):void 0,void 0);return i}enqueuePullFromChild(t){return new ou(this.upstreamExecutor,this.createChild,this.lastDone,[...this.activeChildExecutors,t],this.combineChildResults,this.combineWithChildResult,this.onPull,this.onEmit)}}class Dd{constructor(t,n,r,i,c,f,m){y(this,"upstreamExecutor");y(this,"lastDone");y(this,"activeChildExecutors");y(this,"upstreamDone");y(this,"combineChildResults");y(this,"combineWithChildResult");y(this,"onPull");y(this,"_tag",mC);this.upstreamExecutor=t,this.lastDone=n,this.activeChildExecutors=r,this.upstreamDone=i,this.combineChildResults=c,this.combineWithChildResult=f,this.onPull=m}close(t){const n=this.upstreamExecutor.close(t),i=[...this.activeChildExecutors.map(c=>c!==void 0?c.childExecutor.close(t):void 0),n].reduce((c,f)=>c!==void 0&&f!==void 0?_w(c,In(f),(m,g)=>$p(m,g)):c!==void 0?c:f!==void 0?In(f):void 0,void 0);return i}enqueuePullFromChild(t){return new Dd(this.upstreamExecutor,this.lastDone,[...this.activeChildExecutors,t],this.upstreamDone,this.combineChildResults,this.combineWithChildResult,this.onPull)}}class LT{constructor(t,n){y(this,"value");y(this,"next");y(this,"_tag",PP);this.value=t,this.next=n}close(t){const n=this.next.close(t);return n}enqueuePullFromChild(t){return this}}const Rie="Pulled",xie="NoUpstream",Oie="effect/ChannelUpstreamPullRequest",Die=Symbol.for(Oie),qie={_A:e=>e},HP={[Die]:qie},UN=e=>{const t=Object.create(HP);return t._tag=Rie,t.value=e,t},Nie=e=>{const t=Object.create(HP);return t._tag=xie,t.activeDownstreamCount=e,t};class hu{constructor(t,n,r){y(this,"_activeSubexecutor");y(this,"_cancelled");y(this,"_closeLastSubstream");y(this,"_currentChannel");y(this,"_done");y(this,"_doneStack",[]);y(this,"_emitted");y(this,"_executeCloseLastSubstream");y(this,"_input");y(this,"_inProgressFinalizer");y(this,"_providedEnv");this._currentChannel=t,this._executeCloseLastSubstream=r,this._providedEnv=n}run(){let t;for(;t===void 0;)if(this._cancelled!==void 0)t=this.processCancellation();else if(this._activeSubexecutor!==void 0)t=this.runSubexecutor();else try{if(this._currentChannel===void 0)t=yd();else switch(vl(this._currentChannel)&&(this._currentChannel=wr(this._currentChannel)),this._currentChannel._tag){case TP:{t=this.runBracketOut(this._currentChannel);break}case kP:{const n=this._currentChannel.input;if(this._currentChannel=this._currentChannel.channel,this._input!==void 0){const r=this._input;this._input=void 0;const i=()=>Xe(n.awaitRead(),()=>Nn(()=>{const c=r.run();switch(c._tag){case Q_:return xi(r.getDone(),{onFailure:f=>n.error(f),onSuccess:f=>n.done(f)});case Y_:return Xe(n.emit(r.getEmit()),()=>i());case nm:return Ti(c.effect,{onFailure:f=>n.error(f),onSuccess:()=>i()});case W_:return F2(c,()=>i(),f=>n.error(f))}}));t=Og(Xe(tP(kn(i())),c=>Ke(()=>this.addFinalizer(f=>Xe(Js(c),()=>Nn(()=>{const m=this.restorePipe(f,r);return m!==void 0?m:ot}))))))}break}case $2:{const n=new hu(this._currentChannel.value(),this._providedEnv,i=>Ke(()=>{const c=this._closeLastSubstream===void 0?ot:this._closeLastSubstream;this._closeLastSubstream=j(c,sn(i))}));n._input=this._input;const r=this._currentChannel;this._activeSubexecutor=new ou(n,i=>r.k(i),void 0,[],(i,c)=>r.combineInners(i,c),(i,c)=>r.combineAll(i,c),i=>r.onPull(i),i=>r.onEmit(i)),this._closeLastSubstream=void 0,this._currentChannel=void 0;break}case CP:{this._emitted=this._currentChannel.out,this._currentChannel=this._activeSubexecutor!==void 0?void 0:ws,t=jT();break}case AP:{this.runEnsuring(this._currentChannel);break}case RP:{t=this.doneHalt(this._currentChannel.error());break}case I2:{this._doneStack.push(this._currentChannel.k),this._currentChannel=this._currentChannel.channel;break}case xP:{const n=this._providedEnv===void 0?this._currentChannel.effect():j(this._currentChannel.effect(),ss(this._providedEnv));t=Og(Ti(n,{onFailure:r=>{const i=this.doneHalt(r);return i!==void 0&&bv(i)?i.effect:ot},onSuccess:r=>{const i=this.doneSucceed(r);return i!==void 0&&bv(i)?i.effect:ot}}));break}case OP:{const n=this._input,r=new hu(this._currentChannel.left(),this._providedEnv,i=>this._executeCloseLastSubstream(i));r._input=n,this._input=r,this.addFinalizer(i=>{const c=this.restorePipe(i,n);return c!==void 0?c:ot}),this._currentChannel=this._currentChannel.right();break}case DP:{const n=this._providedEnv;this._providedEnv=this._currentChannel.context(),this._currentChannel=this._currentChannel.inner,this.addFinalizer(()=>Ke(()=>{this._providedEnv=n}));break}case qP:{const n=this._currentChannel;t=FT(this._input,Ie,r=>{try{this._currentChannel=n.more(r)}catch(i){this._currentChannel=n.done.onExit(JS(i))}},r=>{const i=c=>n.done.onExit(c);this._currentChannel=i(r)});break}case NP:{t=this.doneSucceed(this._currentChannel.evaluate());break}case $P:{t=this.doneSucceed(this._currentChannel.terminal);break}case IP:{this._currentChannel=this._currentChannel.channel();break}}}catch(n){this._currentChannel=Kn(Qu(n))}return t}getDone(){return this._done}getEmit(){return this._emitted}cancelWith(t){this._cancelled=t}clearInProgressFinalizer(){this._inProgressFinalizer=void 0}storeInProgressFinalizer(t){this._inProgressFinalizer=t}popAllFinalizers(t){const n=[];let r=this._doneStack.pop();for(;r;)r._tag==="ContinuationFinalizer"&&n.push(r.finalizer),r=this._doneStack.pop();const i=n.length===0?ot:zT(n,t);return this.storeInProgressFinalizer(i),i}popNextFinalizers(){const t=[];for(;this._doneStack.length!==0;){const n=this._doneStack[this._doneStack.length-1];if(n._tag===mS)return t;t.push(n),this._doneStack.pop()}return t}restorePipe(t,n){const r=this._input;return this._input=n,r!==void 0?r.close(t):ot}close(t){let n;const r=this._inProgressFinalizer;r!==void 0&&(n=j(r,xd(Ke(()=>this.clearInProgressFinalizer()))));let i;const c=this.popAllFinalizers(t);c!==void 0&&(i=j(c,xd(Ke(()=>this.clearInProgressFinalizer()))));const f=this._activeSubexecutor===void 0?void 0:this._activeSubexecutor.close(t);if(!(f===void 0&&n===void 0&&i===void 0))return j(In(UT(f)),lC(In(UT(n))),lC(In(UT(i))),Tt(([[m,g],b])=>j(m,$p(g),$p(b))),Rd,Xe(m=>Nn(()=>m)))}doneSucceed(t){if(this._doneStack.length===0)return this._done=$n(t),this._currentChannel=void 0,yd();const n=this._doneStack[this._doneStack.length-1];if(n._tag===mS){this._doneStack.pop(),this._currentChannel=n.onSuccess(t);return}const r=this.popNextFinalizers();if(this._doneStack.length===0)return this._doneStack=r.reverse(),this._done=$n(t),this._currentChannel=void 0,yd();const i=zT(r.map(f=>f.finalizer),$n(t));this.storeInProgressFinalizer(i);const c=j(i,xd(Ke(()=>this.clearInProgressFinalizer())),Rd,Xe(()=>Ke(()=>this.doneSucceed(t))));return Og(c)}doneHalt(t){if(this._doneStack.length===0)return this._done=dr(t),this._currentChannel=void 0,yd();const n=this._doneStack[this._doneStack.length-1];if(n._tag===mS){this._doneStack.pop();try{this._currentChannel=n.onHalt(t)}catch(f){this._currentChannel=Kn(Qu(f))}return}const r=this.popNextFinalizers();if(this._doneStack.length===0)return this._doneStack=r.reverse(),this._done=dr(t),this._currentChannel=void 0,yd();const i=zT(r.map(f=>f.finalizer),dr(t));this.storeInProgressFinalizer(i);const c=j(i,xd(Ke(()=>this.clearInProgressFinalizer())),Rd,Xe(()=>Ke(()=>this.doneHalt(t))));return Og(c)}processCancellation(){return this._currentChannel=void 0,this._done=this._cancelled,this._cancelled=void 0,yd()}runBracketOut(t){const n=Rd(Ti(this.provide(t.acquire()),{onFailure:r=>Ke(()=>{this._currentChannel=Kn(r)}),onSuccess:r=>Ke(()=>{this.addFinalizer(i=>this.provide(t.finalizer(r,i))),this._currentChannel=Qt(r)})}));return Og(n)}provide(t){return this._providedEnv===void 0?t:j(t,ss(this._providedEnv))}runEnsuring(t){this.addFinalizer(t.finalizer),this._currentChannel=t.channel}addFinalizer(t){this._doneStack.push(new gie(t))}runSubexecutor(){const t=this._activeSubexecutor;switch(t._tag){case zP:return this.pullFromChild(t.childExecutor,t.parentSubexecutor,t.onEmit,t);case hC:return this.pullFromUpstream(t);case mC:return this.drainChildExecutors(t);case PP:return this._emitted=t.value,this._activeSubexecutor=t.next,jT()}}replaceSubexecutor(t){this._currentChannel=void 0,this._activeSubexecutor=t}finishWithExit(t){const n=xi(t,{onFailure:r=>this.doneHalt(r),onSuccess:r=>this.doneSucceed(r)});return this._activeSubexecutor=void 0,n===void 0?ot:Aie(n)}finishSubexecutorWithCloseEffect(t,...n){this.addFinalizer(()=>j(n,Hr(i=>j(Ke(()=>i(t)),Xe(c=>c!==void 0?c:ot)),{discard:!0})));const r=j(t,xi({onFailure:i=>this.doneHalt(i),onSuccess:i=>this.doneSucceed(i)}));return this._activeSubexecutor=void 0,r}applyUpstreamPullStrategy(t,n,r){switch(r._tag){case wP:{const i=!t||n.some(c=>c!==void 0);return[r.emitSeparator,i?[void 0,...n]:n]}case pie:{const i=!t||n.some(c=>c!==void 0);return[r.emitSeparator,i?[...n,void 0]:n]}}}pullFromChild(t,n,r,i){return FT(t,Ie,c=>{const f=r(c);switch(f._tag){case yP:break;case uie:{this.finishWithDoneValue(t,n,f.value);break}case fie:{const m=n.enqueuePullFromChild(i);this.replaceSubexecutor(m);break}}this._activeSubexecutor=new LT(c,this._activeSubexecutor)},xi({onFailure:c=>{const f=this.handleSubexecutorFailure(t,n,c);return f===void 0?void 0:LN(f)},onSuccess:c=>{this.finishWithDoneValue(t,n,c)}}))}finishWithDoneValue(t,n,r){const i=n;switch(i._tag){case hC:{const c=new ou(i.upstreamExecutor,i.createChild,i.lastDone!==void 0?i.combineChildResults(i.lastDone,r):r,i.activeChildExecutors,i.combineChildResults,i.combineWithChildResult,i.onPull,i.onEmit);this._closeLastSubstream=t.close($n(r)),this.replaceSubexecutor(c);break}case mC:{const c=new Dd(i.upstreamExecutor,i.lastDone!==void 0?i.combineChildResults(i.lastDone,r):r,i.activeChildExecutors,i.upstreamDone,i.combineChildResults,i.combineWithChildResult,i.onPull);this._closeLastSubstream=t.close($n(r)),this.replaceSubexecutor(c);break}}}handleSubexecutorFailure(t,n,r){return this.finishSubexecutorWithCloseEffect(dr(r),i=>n.close(i),i=>t.close(i))}pullFromUpstream(t){if(t.activeChildExecutors.length===0)return this.performPullFromUpstream(t);const n=t.activeChildExecutors[0],r=new ou(t.upstreamExecutor,t.createChild,t.lastDone,t.activeChildExecutors.slice(1),t.combineChildResults,t.combineWithChildResult,t.onPull,t.onEmit);if(n===void 0)return this.performPullFromUpstream(r);this.replaceSubexecutor(new Pb(n.childExecutor,r,n.onEmit))}performPullFromUpstream(t){return FT(t.upstreamExecutor,n=>{const r=this._closeLastSubstream===void 0?ot:this._closeLastSubstream;return this._closeLastSubstream=void 0,j(this._executeCloseLastSubstream(r),sn(n))},n=>{if(this._closeLastSubstream!==void 0){const f=this._closeLastSubstream;return this._closeLastSubstream=void 0,j(this._executeCloseLastSubstream(f),Tt(()=>{const m=new hu(t.createChild(n),this._providedEnv,this._executeCloseLastSubstream);m._input=this._input;const[g,b]=this.applyUpstreamPullStrategy(!1,t.activeChildExecutors,t.onPull(UN(n)));this._activeSubexecutor=new Pb(m,new ou(t.upstreamExecutor,t.createChild,t.lastDone,b,t.combineChildResults,t.combineWithChildResult,t.onPull,t.onEmit),t.onEmit),Zt(g)&&(this._activeSubexecutor=new LT(g.value,this._activeSubexecutor))}))}const r=new hu(t.createChild(n),this._providedEnv,this._executeCloseLastSubstream);r._input=this._input;const[i,c]=this.applyUpstreamPullStrategy(!1,t.activeChildExecutors,t.onPull(UN(n)));this._activeSubexecutor=new Pb(r,new ou(t.upstreamExecutor,t.createChild,t.lastDone,c,t.combineChildResults,t.combineWithChildResult,t.onPull,t.onEmit),t.onEmit),Zt(i)&&(this._activeSubexecutor=new LT(i.value,this._activeSubexecutor))},n=>{if(t.activeChildExecutors.some(c=>c!==void 0)){const c=new Dd(t.upstreamExecutor,t.lastDone,[void 0,...t.activeChildExecutors],t.upstreamExecutor.getDone(),t.combineChildResults,t.combineWithChildResult,t.onPull);if(this._closeLastSubstream!==void 0){const f=this._closeLastSubstream;return this._closeLastSubstream=void 0,j(this._executeCloseLastSubstream(f),Tt(()=>this.replaceSubexecutor(c)))}this.replaceSubexecutor(c);return}const r=this._closeLastSubstream,i=this.finishSubexecutorWithCloseEffect(j(n,EW(c=>t.combineWithChildResult(t.lastDone,c))),()=>r,c=>t.upstreamExecutor.close(c));return i===void 0?void 0:LN(i)})}drainChildExecutors(t){if(t.activeChildExecutors.length===0){const c=this._closeLastSubstream;return c!==void 0&&this.addFinalizer(()=>Gn(c)),this.finishSubexecutorWithCloseEffect(t.upstreamDone,()=>c,f=>t.upstreamExecutor.close(f))}const n=t.activeChildExecutors[0],r=t.activeChildExecutors.slice(1);if(n===void 0){const[c,f]=this.applyUpstreamPullStrategy(!0,r,t.onPull(Nie(r.reduce((m,g)=>g!==void 0?m+1:m,0))));return this.replaceSubexecutor(new Dd(t.upstreamExecutor,t.lastDone,f,t.upstreamDone,t.combineChildResults,t.combineWithChildResult,t.onPull)),Zt(c)?(this._emitted=c.value,jT()):void 0}const i=new Dd(t.upstreamExecutor,t.lastDone,r,t.upstreamDone,t.combineChildResults,t.combineWithChildResult,t.onPull);this.replaceSubexecutor(new Pb(n.childExecutor,i,n.onEmit))}}const UT=e=>e!==void 0?e:ot,zT=(e,t)=>j(Hr(e,n=>In(n(t))),Tt(n=>j(SW(n),yn(()=>ea))),Xe(n=>Nn(()=>n))),F2=(e,t,n)=>{const r=[e],i=()=>{const c=r.pop();if(c===void 0||c.upstream===void 0)return Tse("Unexpected end of input for channel execution");const f=c.upstream.run();switch(f._tag){case Y_:{const m=c.onEmit(c.upstream.getEmit());return r.length===0?m===void 0?Nn(t):j(m,Ti({onFailure:n,onSuccess:t})):m===void 0?Nn(()=>i()):j(m,Ti({onFailure:n,onSuccess:()=>i()}))}case Q_:{const m=c.onDone(c.upstream.getDone());return r.length===0?m===void 0?Nn(t):j(m,Ti({onFailure:n,onSuccess:t})):m===void 0?Nn(()=>i()):j(m,Ti({onFailure:n,onSuccess:()=>i()}))}case nm:return r.push(c),j(c.onEffect(f.effect),Xh(m=>Nn(()=>{const g=c.onDone(dr(m));return g===void 0?ot:g})),Ti({onFailure:n,onSuccess:()=>i()}));case W_:return r.push(c),r.push(f),Nn(()=>i())}};return i()},BP=D(2,(e,t)=>{const n=(r,i,c)=>p2(Ke(()=>new hu(e,void 0,Ie)),f=>Nn(()=>gS(f.run(),f).pipe(mw(r),sn(gn(r)),v2(gn(i)))),(f,m)=>{const g=f.close(m);return g===void 0?ot:Ys(g,b=>ll(c,Da(b)))});return Zh(r=>dw([g4(t,nv),xt(),xt()]).pipe(Xe(([i,c,f])=>r(n(c,f,i)).pipe(vs(t),Xe(m=>t.addFinalizer(g=>{const b=Kh(g)?hne(g.cause):void 0;return jk(c).pipe(Xe(S=>S?dn(f,void 0).pipe(sn(I4(m)),sn(RN(m))):dn(f,void 0).pipe(sn(b&&WA(b)>0?uw(m,mK(b)):Js(m)),sn(RN(m)))))}).pipe(sn(r(gn(c)))))))))}),gS=(e,t)=>{const n=e;switch(n._tag){case nm:return j(n.effect,Xe(()=>gS(t.run(),t)));case Y_:return gS(t.run(),t);case Q_:return Nn(()=>t.getDone());case W_:return F2(n,()=>gS(t.run(),t),Da)}},$ie="Done",Iie="Await",Mie="effect/ChannelMergeDecision",jie=Symbol.for(Mie),Fie={[jie]:{_R:e=>e,_E0:e=>e,_Z0:e=>e,_E:e=>e,_Z:e=>e}},zN=e=>{const t=Object.create(Fie);return t._tag=Iie,t.f=e,t},VP="BothRunning",GP="LeftDone",KP="RightDone",Lie="effect/ChannelMergeState",PN=Symbol.for(Lie),L2={[PN]:PN},PT=(e,t)=>{const n=Object.create(L2);return n._tag=VP,n.left=e,n.right=t,n},HN=e=>{const t=Object.create(L2);return t._tag=GP,t.f=e,t},BN=e=>{const t=Object.create(L2);return t._tag=KP,t.f=e,t},QP="BackPressure",YP="BufferSliding",Uie="effect/ChannelMergeStrategy",VN=Symbol.for(Uie),WP={[VN]:VN},zie=e=>{const t=Object.create(WP);return t._tag=QP,t},Pie=e=>{const t=Object.create(WP);return t._tag=YP,t},Hie=D(2,(e,{onBackPressure:t,onBufferSliding:n})=>{switch(e._tag){case QP:return t();case YP:return n()}}),vd="Empty",zg="Emit",Pg="Error",Hg="Done",JP=e=>({_tag:vd,notifyProducer:e}),HT=e=>({_tag:zg,notifyConsumers:e}),Bie=e=>({_tag:Pg,cause:e}),Vie=e=>({_tag:Hg,done:e});class Gie{constructor(t){y(this,"ref");this.ref=t}awaitRead(){return Hc(Ag(this.ref,t=>t._tag===vd?[gn(t.notifyProducer),t]:[ot,t]))}get close(){return eP(t=>this.error(ow(t)))}done(t){return Hc(Ag(this.ref,n=>{switch(n._tag){case vd:return[gn(n.notifyProducer),n];case zg:return[Hr(n.notifyConsumers,r=>dn(r,Ue(t)),{discard:!0}),Vie(t)];case Pg:return[zc,n];case Hg:return[zc,n]}}))}emit(t){return Xe(xt(),n=>Hc(Ag(this.ref,r=>{switch(r._tag){case vd:return[gn(r.notifyProducer),r];case zg:{const i=r.notifyConsumers[0],c=r.notifyConsumers.slice(1);if(i!==void 0)return[dn(i,He(t)),c.length===0?JP(n):HT(c)];throw new Error("Bug: Channel.SingleProducerAsyncInput.emit - Queue was empty! please report an issue at https://github.com/Effect-TS/effect/issues")}case Pg:return[zc,r];case Hg:return[zc,r]}})))}error(t){return Hc(Ag(this.ref,n=>{switch(n._tag){case vd:return[gn(n.notifyProducer),n];case zg:return[Hr(n.notifyConsumers,r=>Eu(r,t),{discard:!0}),Bie(t)];case Pg:return[zc,n];case Hg:return[zc,n]}}))}get take(){return this.takeWith(t=>dr(a2(t,Ue)),t=>$n(t),t=>Qh(He(t)))}takeWith(t,n,r){return Xe(xt(),i=>Hc(Ag(this.ref,c=>{switch(c._tag){case vd:return[sn(dn(c.notifyProducer,void 0),pv(gn(i),{onFailure:t,onSuccess:zr({onLeft:r,onRight:n})})),HT([i])];case zg:return[pv(gn(i),{onFailure:t,onSuccess:zr({onLeft:r,onRight:n})}),HT([...c.notifyConsumers,i])];case Pg:return[Gn(t(c.cause)),c];case Hg:return[Gn(r(c.done)),c]}})))}}const U2=()=>j(xt(),Xe(e=>J0(JP(e))),Tt(e=>new Gie(e))),gC=(e,t,n)=>$t(wr(J0(()=>ot)),r=>j(wr(Rd(Ns(e,i=>FR(r,c=>n(i,c))))),$t(t),FP(i=>Xe(rp(r),c=>c(i))))),Kie=D(2,(e,t)=>P2(e,()=>t)),Qie=D(2,(e,t)=>M2(e,n=>zr(cw(n),{onLeft:t,onRight:Kn}))),Sv=D(2,(e,t)=>Tie(e,t,()=>{},()=>{})),z2=e=>{const t=Ki({onInput:()=>t,onFailure:Kn,onDone:_f});return Br(e,t)},XP=D(2,(e,t)=>FP(e,()=>t)),Yie=e=>$t(e,Ie),ww=e=>qa(e.takeWith(Kn,t=>$t(Qt(t),()=>ww(e)),_f)),ZP=()=>G_({onInput:e=>$t(Qt(e),()=>ZP()),onFailure:tm,onDone:zi}),P2=D(2,(e,t)=>$t(e,n=>UP(()=>t(n)))),Wie=D(2,(e,t)=>Jie(e,a2(t))),Jie=D(2,(e,t)=>M2(e,n=>Kn(t(n)))),Ew=D(2,(e,t)=>{const n=G_({onInput:r=>$t(Qt(t(r)),()=>n),onFailure:tm,onDone:zi});return Br(e,n)}),Xie=D(2,(e,t)=>{const n=Ki({onInput:r=>j(wr(t(r)),$t(Qt),$t(()=>n)),onFailure:Kn,onDone:zi});return Br(e,n)}),Zie=D(3,(e,t,n)=>H2(r=>ye(function*(){const i=yield*U2(),c=ww(i),f=yield*D2(n);yield*ll(r,ys(f));const m=yield*xt(),g=n===Number.POSITIVE_INFINITY?v=>Ie:(yield*gw(n)).withPermits;yield*(yield*c.pipe(Br(e),zd(r))).pipe(Ti({onFailure:v=>Tn(f,Da(v)),onSuccess:zr({onLeft:v=>sn(kn(g(n)(ot)),g2(Tn(f,Gn(Ue(v))))),onRight:v=>ye(function*(){const q=yield*xt(),k=yield*xt();yield*Tn(f,Tt(gn(q),He)),yield*dn(k,void 0).pipe(sn(Zh(N=>In(N(gn(m))).pipe(nP(In(N(t(v)))),Xe(Ie))).pipe(Ys(N=>Eu(m,N)),mw(q))),g(1),vs(r)),yield*gn(k)})})}),bh,kn,vs(r));const S=qa(pv(Hc(Sh(f)),{onFailure:Kn,onSuccess:zr({onLeft:zi,onRight:v=>$t(Qt(v),()=>S)})}));return j2(S,i)}))),eoe=e=>t=>toe(e)(t,_p),toe=({bufferSize:e=16,concurrency:t,mergeStrategy:n=zie()})=>(r,i)=>H2(c=>ye(function*(){const f=t==="unbounded"?Number.MAX_SAFE_INTEGER:t,m=yield*U2(),g=ww(m),b=yield*D2(e);yield*ll(c,ys(b));const S=yield*qs();yield*ll(c,ys(S));const v=yield*J0(me()),q=yield*xt(),k=(yield*gw(f)).withPermits,N=yield*zd(Br(g,r),c);function H(C){return C.pipe(Xe(zr({onLeft:E=>Gn(pe(E)),onRight:E=>Io(Tn(b,Gn(He(E))),me())})),qN({until:E=>Zt(E)}),Xe(E=>rX(v,Bt({onNone:()=>pe(E.value),onSome:$=>pe(i($,E.value))}))),Xh(E=>o4(E)?Da(E):Tn(b,Da(E)).pipe(sn(dn(q,void 0)),g2)))}yield*N.pipe(Ti({onFailure:C=>Tn(b,Da(C)).pipe(sn(Gn(!1))),onSuccess:zr({onLeft:C=>rP(kn(gn(q)),kn(k(f)(ot)),{onSelfDone:(E,$)=>Io(Js($),!1),onOtherDone:(E,$)=>sn(Js($),rp(v).pipe(Xe(Bt({onNone:()=>Tn(b,Gn(Ue(C))),onSome:R=>Tn(b,Gn(Ue(i(R,C))))})),Io(!1)))}),onRight:C=>Hie(n,{onBackPressure:()=>ye(function*(){const E=yield*xt(),$=cC(I=>zd(Br(g,C),I).pipe(Xe(z=>MT(In(H(z)),In(kn(gn(q))))),Xe(Ie)));return yield*dn(E,void 0).pipe(sn($),k(1),vs(c)),yield*gn(E),!(yield*jk(q))}),onBufferSliding:()=>ye(function*(){const E=yield*xt(),$=yield*xt(),R=yield*iie(S);yield*Sh(S).pipe(Xe(V=>dn(V,void 0)),$se(()=>R>=f)),yield*Tn(S,E);const I=cC(V=>zd(Br(g,C),V).pipe(Xe(K=>In(H(K)).pipe(MT(In(kn(gn(q)))),MT(In(kn(gn(E)))))),Xe(Ie)));return yield*dn($,void 0).pipe(sn(I),k(1),vs(c)),yield*gn($),!(yield*jk(q))})})})}),qN({while:C=>C}),vs(c));const x=j(Sh(b),Hc,pv({onFailure:Kn,onSuccess:zr({onLeft:zi,onRight:C=>$t(Qt(C),()=>x)})}),qa);return j2(x,m)})),e6=D(3,(e,t,n)=>eoe(n)(Ew(e,t))),noe=D(2,(e,t)=>{function n(r){return ye(function*(){const i=yield*U2(),c=ww(i),f=yield*zd(Br(c,e),r),m=yield*zd(Br(c,t.other),r);function g(S,v,q){return(k,N,H)=>{function x(C){const E=C;return E._tag===$ie?Gn(wr(sn(Js(v),E.effect))):Tt(I4(v),xi({onFailure:$=>wr(E.f(dr($))),onSuccess:zr({onLeft:$=>wr(E.f($n($))),onRight:$=>J_(Qt($),b(H(E.f)))})}))}return xi(S,{onFailure:C=>x(k(dr(C))),onSuccess:zr({onLeft:C=>x(k($n(C))),onRight:C=>Gn($t(Qt(C),()=>$t(wr(vs(kn(q),r)),E=>b(N(E,v)))))})})}}function b(S){switch(S._tag){case VP:{const v=kn(Gc(S.left)),q=kn(Gc(S.right));return qa(rP(v,q,{onSelfDone:(k,N)=>sn(Js(N),g(k,S.right,f)(t.onSelfDone,PT,H=>HN(H))),onOtherDone:(k,N)=>sn(Js(N),g(k,S.left,m)(t.onOtherDone,(H,x)=>PT(x,H),H=>BN(H)))}))}case GP:return qa(Tt(In(m),xi({onFailure:v=>wr(S.f(dr(v))),onSuccess:zr({onLeft:v=>wr(S.f($n(v))),onRight:v=>$t(Qt(v),()=>b(HN(S.f)))})})));case KP:return qa(Tt(In(f),xi({onFailure:v=>wr(S.f(dr(v))),onSuccess:zr({onLeft:v=>wr(S.f($n(v))),onRight:v=>$t(Qt(v),()=>b(BN(S.f)))})})))}}return wr(_h(S=>{const v=_h(N=>(N.transferChildren(S.scope()),ot)),q=kn(f).pipe(xd(v),vs(r)),k=kn(m).pipe(xd(v),vs(r));return _w(q,k,(N,H)=>PT(N,H))})).pipe($t(b),j2(i))})}return H2(n)}),roe=D(2,(e,t)=>Qie(e,n=>LP(()=>Qu(t(n))))),t6=D(2,(e,t)=>K_(()=>{let n;const r=G_({onInput:c=>$t(Qt(c),()=>r),onFailure:c=>(n=ooe(c),Kn(Qu(n))),onDone:zi}),i=Ki({onInput:c=>j(Qt(c),$t(()=>i)),onFailure:c=>dne(c)&&coe(c.defect)&&Ge(c.defect,n)?tm(c.defect.error):Kn(c),onDone:zi});return Br(Br(Br(e,r),t),i)})),soe=e=>cC(t=>BP(e,t)),aoe=e=>soe(z2(e)),n6=e=>qa(Zh(t=>Tt(z_(),n=>Eie(Ys(t(U_(e,n)),r=>Xn(n,dr(r))),(r,i)=>Xn(n,i))))),r6=e=>s6(Tt(Z4,t=>$t(wr(e(t)),Qt))),zd=D(2,(e,t)=>lC(Ke(()=>new hu(e,void 0,Ie)),em()).pipe(Ns(([n,r])=>Vne(t,i=>{const c=n.close(i);return c!==void 0?ss(c,r):ot})),Rd,Tt(([n])=>Nn(()=>pC(n.run(),n))))),pC=(e,t)=>{const n=e;switch(n._tag){case Q_:return xi(t.getDone(),{onFailure:Da,onSuccess:r=>Gn(Ue(r))});case Y_:return Gn(He(t.getEmit()));case nm:return j(n.effect,Xe(()=>pC(t.run(),t)));case W_:return F2(n,()=>pC(t.run(),t),r=>Da(r))}},qa=e=>Yie(wr(e)),s6=e=>jP(n6(e),(t,n)=>t,(t,n)=>t),H2=e=>jP(r6(e),(t,n)=>t,(t,n)=>t),GN=function(){const e=typeof arguments[0]!="string",t=e?arguments[1]:arguments[0],n=No(e?arguments[2]:arguments[1]),r=dw([Pse(t,n),qse(),Dse,Bse(Qse)]);if(e){const i=arguments[0];return gC(r,([c,f])=>FN(i,Ks(f,Li,c)),([c,,f,m],g)=>tv(c,g,f,m))}return i=>gC(r,([c,f])=>FN(i,Ks(f,Li,c)),([c,,f,m],g)=>tv(c,g,f,m))},Tw=e=>a6(0,e.length,e),a6=(e,t,n)=>e===t?ws:j(Qt(j(n,Oo(e))),$t(()=>a6(e+1,t,n))),ioe=D(e=>MP(e[1]),(e,t,n)=>n!=null&&n.concurrent?noe(e,{other:t,onSelfDone:r=>zN(i=>Nn(()=>Lq(r,i))),onOtherDone:r=>zN(i=>Nn(()=>Lq(i,r)))}):$t(e,r=>P2(t,i=>[r,i]))),J_=D(e=>MP(e[1]),(e,t,n)=>n!=null&&n.concurrent?P2(ioe(e,t,{concurrent:!0}),r=>r[1]):$t(e,()=>t)),_C=Symbol.for("effect/Channel/ChannelException"),ooe=e=>({_tag:"ChannelException",[_C]:_C,error:e}),coe=e=>Ae(e,_C),yC=Symbol.for("effect/Sink"),loe={_A:e=>e,_In:e=>e,_L:e=>e,_E:e=>e,_R:e=>e};var tj;tj=yC;class X_{constructor(t){y(this,"channel");y(this,tj,loe);this.channel=t}pipe(){return xe(this,arguments)}}const uoe=e=>new X_(K_(()=>B2(e()))),foe=()=>new X_(i6(an())),i6=e=>Ki({onInput:t=>i6(j(e,pn(t))),onFailure:Kn,onDone:()=>_f(e)}),doe=new X_(z2(ZP())),hoe=(e,t,n)=>uoe(()=>new X_(o6(e,t,n))),o6=(e,t,n)=>t(e)?G_({onInput:r=>{const[i,c]=c6(e,r,t,n,0,r.length);return Ii(c)?j(Qt(c),Kie(i)):o6(i,t,n)},onFailure:tm,onDone:()=>zi(e)}):zi(e),c6=(e,t,n,r,i,c)=>{if(i===c)return[e,an()];const f=r(e,j(t,Oo(i)));return n(f)?c6(f,t,n,r,i+1,c):[f,j(t,Ai(i+1))]},moe=e=>new X_(wr(e)),goe=()=>hoe(me(),_n,(e,t)=>Bt(e,{onNone:()=>pe(t),onSome:()=>e})),B2=e=>vl(e)?B2(moe(e)):e.channel,l6=H_,poe=Jre,_oe=nre,yoe=sre,boe=bre,u6=ire,f6=fre,Soe=C4;class d6{constructor(t){y(this,"value");this.value=t}}const h6=(e,t)=>({ref:e,isNew:t,isChanged:!1,expected:e.versioned,newValue:e.versioned.value}),m6=e=>e.newValue,g6=(e,t)=>{e.isChanged=!0,e.newValue=t},voe=e=>{e.ref.versioned=new d6(e.newValue)},woe=e=>e.ref.versioned!==e.expected,Eoe=e=>e.isChanged,vv="Invalid",V2="ReadWrite",Toe="ReadOnly",p6=e=>{for(const t of e)voe(t[1])},_6=e=>{let t=Toe;for(const[,n]of e)if(t=woe(n)?vv:Eoe(n)?V2:t,t===vv)return t;return t},koe=e=>{const t=new Map;for(const[,n]of e){for(const r of n.ref.todos)t.set(r[0],r[1]);n.ref.todos=new Map}return t},Coe=e=>{const t=Array.from(e.entries()).sort((n,r)=>n[0]-r[0]);for(const[n,r]of t)r()},Aoe=(e,t,n)=>{let r=!1;for(const[,i]of t)i.ref.todos.has(e)||(i.ref.todos.set(e,n),r=!0);return r},y6="WithSTMRuntime",bC="OnFailure",KN="OnRetry",SC="OnSuccess",Roe="Provide",b6="Sync",S6="Succeed",v6="Retry",w6="Fail",E6="Die",T6="Interrupt",Pd="Fail",Hd="Die",Bd="Interrupt",Cu="Succeed",rm="Retry",G2="Done",K2="Suspend",pS="Done",vC="Interrupted",wv="Running",kw="effect/STM/State",ef=Symbol.for(kw),Q2=e=>Ae(e,ef),k6=e=>e._tag===wv,xoe=e=>e._tag===pS,Hb=e=>({[ef]:ef,_tag:pS,exit:e,[nt](){return j(we(kw),Qe(we(pS)),Qe(we(e)),Yt(this))},[Ze](t){return Q2(t)&&t._tag===pS&&Ge(e,t.exit)}}),Ooe=j(we(kw),Qe(we(vC)),Qe(we("interrupted"))),Doe={[ef]:ef,_tag:vC,[nt](){return Ooe},[Ze](e){return Q2(e)&&e._tag===vC}},qoe=j(we(kw),Qe(we(wv)),Qe(we("running"))),Noe={[ef]:ef,_tag:wv,[nt](){return qoe},[Ze](e){return Q2(e)&&e._tag===wv}},Bb=e=>{switch(e._tag){case Pd:return Hb(Qh(e.error));case Hd:return Hb(JS(e.defect));case Bd:return Hb(wW(e.fiberId));case Cu:return Hb($n(e.value));case rm:throw new Error("BUG: STM.STMState.fromTExit - please report an issue at https://github.com/Effect-TS/effect/issues")}},sm="effect/TExit",am=Symbol.for(sm),Z_={_A:e=>e,_E:e=>e},ey=e=>Ae(e,am),$oe=e=>e._tag===Cu,Ioe=e=>e._tag===rm,Moe=e=>({[am]:Z_,_tag:Pd,error:e,[nt](){return j(we(sm),Qe(we(Pd)),Qe(we(e)),Yt(this))},[Ze](t){return ey(t)&&t._tag===Pd&&Ge(e,t.error)}}),joe=e=>({[am]:Z_,_tag:Hd,defect:e,[nt](){return j(we(sm),Qe(we(Hd)),Qe(we(e)),Yt(this))},[Ze](t){return ey(t)&&t._tag===Hd&&Ge(e,t.defect)}}),Foe=e=>({[am]:Z_,_tag:Bd,fiberId:e,[nt](){return j(we(sm),Qe(we(Bd)),Qe(we(e)),Yt(this))},[Ze](t){return ey(t)&&t._tag===Bd&&Ge(e,t.fiberId)}}),QN=e=>({[am]:Z_,_tag:Cu,value:e,[nt](){return j(we(sm),Qe(we(Cu)),Qe(we(e)),Yt(this))},[Ze](t){return ey(t)&&t._tag===Cu&&Ge(e,t.value)}}),Loe=j(we(sm),Qe(we(rm)),Qe(we("retry"))),Uoe={[am]:Z_,_tag:rm,[nt](){return Loe},[Ze](e){return ey(e)&&Ioe(e)}},zoe=e=>({_tag:G2,exit:e}),C6=e=>({_tag:K2,journal:e}),YN={ref:0},Poe=()=>{const e=YN.ref+1;return YN.ref=e,e},Hoe="effect/STM",Boe=Symbol.for(Hoe),Vb={_R:e=>e,_E:e=>e,_A:e=>e};var nj,rj,sj,aj;class Jo{constructor(t){y(this,"effect_instruction_i0");y(this,"_op",l_);y(this,"effect_instruction_i1");y(this,"effect_instruction_i2");y(this,aj);y(this,sj);y(this,rj);y(this,nj);this.effect_instruction_i0=t,this[DN]=Ou,this[uk]=Vb,this[yC]=Vb,this[yv]=Vb}get[(aj=DN,sj=uk,rj=yC,nj=yv,Boe)](){return Vb}[Ze](t){return this===t}[nt](){return Yt(this,a0(this))}[Symbol.iterator](){return new Lh(new Rh(this))}commit(){return Voe(this,_p)}pipe(){return xe(this,arguments)}}const Voe=(e,t,n)=>yt(r=>{const i=r.id(),c=r.getFiberRef(aP),f=r.getFiberRef(iP),m=r.getFiberRef(Gse),g=Koe(i,e,c,f,m);switch(g._tag){case G2:return t(g.exit),g.exit;case K2:{const b=Poe(),S={value:Noe},v=f2(q=>A6(i,e,b,S,c,f,m,q));return Zh(q=>j(q(v),Xh(k=>{let N=S.value;return k6(N)&&(S.value=Doe),N=S.value,xoe(N)?(t(N.exit),N.exit):Da(k)})))}}}),Goe=(e,t,n,r,i,c)=>{const f=new Map,m=new R6(t,f,e,r).run(),g=_6(f);if(g===V2)p6(f);else if(g===vv)throw new Error("BUG: STM.TryCommit.tryCommit - please report an issue at https://github.com/Effect-TS/effect/issues");switch(m._tag){case Cu:return n.value=Bb(m),Kc($n(m.value),f,i,c);case Pd:{n.value=Bb(m);const b=ol(m.error);return Kc(dr(b),f,i,c)}case Hd:{n.value=Bb(m);const b=Qu(m.defect);return Kc(dr(b),f,i,c)}case Bd:{n.value=Bb(m);const b=ow(e);return Kc(dr(b),f,i,c)}case rm:return C6(f)}},Koe=(e,t,n,r,i)=>{const c=new Map,f=new R6(t,c,e,n).run(),m=_6(c);if(m===V2&&$oe(f))p6(c);else if(m===vv)throw new Error("BUG: STM.TryCommit.tryCommitSync - please report an issue at https://github.com/Effect-TS/effect/issues");switch(f._tag){case Cu:return Kc($n(f.value),c,r,i);case Pd:{const g=ol(f.error);return Kc(dr(g),c,r,i)}case Hd:{const g=Qu(f.defect);return Kc(dr(g),c,r,i)}case Bd:{const g=ow(e);return Kc(dr(g),c,r,i)}case rm:return C6(c)}},A6=(e,t,n,r,i,c,f,m)=>{if(k6(r.value)){const g=Goe(e,t,r,i,c,f);switch(g._tag){case G2:{Qoe(g.exit,m);break}case K2:{Aoe(n,g.journal,()=>A6(e,t,n,r,i,c,f,m));break}}}},Kc=(e,t,n,r)=>{const i=koe(t);return i.size>0&&n.scheduleTask(()=>Coe(i),r),zoe(e)},Qoe=(e,t)=>{t(e)};class R6{constructor(t,n,r,i){y(this,"self");y(this,"journal");y(this,"fiberId");y(this,"contStack",[]);y(this,"env");this.self=t,this.journal=n,this.fiberId=r,this.env=i}getEnv(){return this.env}pushStack(t){this.contStack.push(t)}popStack(){return this.contStack.pop()}nextSuccess(){let t=this.popStack();for(;t!==void 0&&t.effect_instruction_i0!==SC;)t=this.popStack();return t}nextFailure(){let t=this.popStack();for(;t!==void 0&&t.effect_instruction_i0!==bC;)t=this.popStack();return t}nextRetry(){let t=this.popStack();for(;t!==void 0&&t.effect_instruction_i0!==KN;)t=this.popStack();return t}run(){let t=this.self,n;for(;n===void 0&&t!==void 0;)try{const r=t;if(r)switch(r._op){case"Tag":{t=Cw((i,c,f)=>m0(f,r));break}case"Left":{t=wC(r.left);break}case"None":{t=wC(new lw);break}case"Right":{t=fr(r.right);break}case"Some":{t=fr(r.value);break}case"Commit":{switch(r.effect_instruction_i0){case E6:{n=joe(nn(()=>r.effect_instruction_i1()));break}case w6:{const i=this.nextFailure();i===void 0?n=Moe(nn(()=>r.effect_instruction_i1())):t=nn(()=>i.effect_instruction_i2(nn(()=>r.effect_instruction_i1())));break}case v6:{const i=this.nextRetry();i===void 0?n=Uoe:t=nn(()=>i.effect_instruction_i2());break}case T6:{n=Foe(this.fiberId);break}case y6:{t=nn(()=>r.effect_instruction_i1(this));break}case SC:case bC:case KN:{this.pushStack(r),t=r.effect_instruction_i1;break}case Roe:{const i=this.env;this.env=nn(()=>r.effect_instruction_i2(i)),t=j(r.effect_instruction_i1,Xoe(Y2(()=>this.env=i)));break}case S6:{const i=r.effect_instruction_i1,c=this.nextSuccess();c===void 0?n=QN(i):t=nn(()=>c.effect_instruction_i2(i));break}case b6:{const i=nn(()=>r.effect_instruction_i1()),c=this.nextSuccess();c===void 0?n=QN(i):t=nn(()=>c.effect_instruction_i2(i));break}}break}}}catch(r){t=Woe(r)}return n}}const Yoe=D(2,(e,t)=>{const n=new Jo(bC);return n.effect_instruction_i1=e,n.effect_instruction_i2=t,n}),Woe=e=>Joe(()=>e),Joe=e=>{const t=new Jo(E6);return t.effect_instruction_i1=e,t},Cw=e=>vi(t=>fr(e(t.journal,t.fiberId,t.getEnv()))),Xoe=D(2,(e,t)=>ece(e,{onFailure:n=>WN(t,wC(n)),onSuccess:n=>WN(t,fr(n))})),wC=e=>Zoe(()=>e),Zoe=e=>{const t=new Jo(w6);return t.effect_instruction_i1=e,t},im=D(2,(e,t)=>{const n=new Jo(SC);return n.effect_instruction_i1=e,n.effect_instruction_i2=t,n}),ece=D(2,(e,{onFailure:t,onSuccess:n})=>j(e,Vp(He),Yoe(r=>j(t(r),Vp(Ue))),im(r=>{switch(r._tag){case"Left":return fr(r.left);case"Right":return n(r.right)}}))),vi=e=>{const t=new Jo(y6);return t.effect_instruction_i1=e,t},jc=e=>{const t=new Jo(T6);return t.effect_instruction_i1=e,t},Vp=D(2,(e,t)=>j(e,im(n=>Y2(()=>t(n))))),wd=new Jo(v6),fr=e=>{const t=new Jo(S6);return t.effect_instruction_i1=e,t},Y2=e=>{const t=new Jo(b6);return t.effect_instruction_i1=e,t},WN=D(2,(e,t)=>j(e,im(()=>t))),JN="BackPressure",EC="Dropping",XN="Sliding",tce=e=>im(e,Ie),nce=(...e)=>rce(()=>{const n=(e.length===1?e[0]:e[1].bind(e[0]))(j),r=n.next(),i=c=>c.done?fr(c.value):im(Pj(c.value),f=>i(n.next(f)));return i(r)}),rce=e=>tce(Y2(e)),ZN=fr(void 0),sce="effect/TRef",ace=Symbol.for(sce),ice={_A:e=>e};var ij;ij=ace;class oce{constructor(t){y(this,ij,ice);y(this,"todos");y(this,"versioned");this.versioned=new d6(t),this.todos=new Map}modify(t){return Cw(n=>{const r=W2(this,n),[i,c]=t(m6(r));return g6(r,c),i})}pipe(){return xe(this,arguments)}}const x6=e=>Cw(t=>{const n=new oce(e);return t.set(n,h6(n,!0)),n}),cce=e=>e.modify(t=>[t,t]),lce=D(2,(e,t)=>e.modify(()=>[void 0,t])),uce=D(2,(e,t)=>e.modify(n=>[void 0,t(n)])),W2=(e,t)=>{if(t.has(e))return t.get(e);const n=h6(e,!1);return t.set(e,n),n},bo=D(2,(e,t)=>m6(W2(e,t))),So=D(3,(e,t,n)=>{const r=W2(e,n);g6(r,t)}),fce="effect/TQueue/TEnqueue",dce=Symbol.for(fce),hce="effect/TQueue/TDequeue",mce=Symbol.for(hce),gce={_tag:EC},pce={_Out:e=>e},_ce={_In:e=>e};var oj,cj;cj=mce,oj=dce;class yce{constructor(t,n,r){y(this,"ref");y(this,"requestedCapacity");y(this,"strategy");y(this,cj,pce);y(this,oj,_ce);y(this,"size",vi(t=>{const n=bo(this.ref,t.journal);return n===void 0?jc(t.fiberId):fr(n.length)}));y(this,"isFull",Vp(this.size,t=>t===this.requestedCapacity));y(this,"isEmpty",Vp(this.size,t=>t===0));y(this,"shutdown",vi(t=>(So(this.ref,void 0,t.journal),ZN)));y(this,"isShutdown",Cw(t=>bo(this.ref,t)===void 0));y(this,"awaitShutdown",im(this.isShutdown,t=>t?ZN:wd));y(this,"peek",vi(t=>{const n=bo(this.ref,t.journal);return n===void 0?jc(t.fiberId):n.length===0?wd:fr(n[0])}));y(this,"peekOption",vi(t=>{const n=bo(this.ref,t.journal);return n===void 0?jc(t.fiberId):fr(of(n[0]))}));y(this,"take",vi(t=>{const n=bo(this.ref,t.journal);if(n===void 0)return jc(t.fiberId);if(n.length===0)return wd;const r=n.shift();return So(this.ref,n,t.journal),fr(r)}));y(this,"takeAll",vi(t=>{const n=bo(this.ref,t.journal);return n===void 0?jc(t.fiberId):(So(this.ref,[],t.journal),fr(n))}));this.ref=t,this.requestedCapacity=n,this.strategy=r}capacity(){return this.requestedCapacity}offer(t){return vi(n=>{const r=j(this.ref,bo(n.journal));if(r===void 0)return jc(n.fiberId);if(r.length<this.requestedCapacity)return r.push(t),So(this.ref,r,n.journal),fr(!0);switch(this.strategy._tag){case JN:return wd;case EC:return fr(!1);case XN:return r.length===0||(r.shift(),r.push(t),So(this.ref,r,n.journal)),fr(!0)}})}offerAll(t){return vi(n=>{const r=Array.from(t),i=bo(this.ref,n.journal);if(i===void 0)return jc(n.fiberId);if(i.length+r.length<=this.requestedCapacity)return So(this.ref,[...i,...r],n.journal),fr(!0);switch(this.strategy._tag){case JN:return wd;case EC:{const c=r.slice(0,this.requestedCapacity-i.length);return So(this.ref,[...i,...c],n.journal),fr(!1)}case XN:{const c=r.slice(0,this.requestedCapacity-i.length),f=i.length+c.length-this.requestedCapacity,m=i.slice(f);return So(this.ref,[...m,...c],n.journal),fr(!0)}}})}takeUpTo(t){return vi(n=>{const r=bo(this.ref,n.journal);if(r===void 0)return jc(n.fiberId);const[i,c]=cL(Bn(r),t);return So(this.ref,Array.from(c),n.journal),fr(Array.from(i))})}}const bce=D(2,(e,t)=>e.offer(t)),Sce=e=>e.peek,vce=e=>e.take,wce=()=>Ece(Number.MAX_SAFE_INTEGER,gce),Ece=(e,t)=>Vp(x6([]),n=>new yce(n,e,t)),Tce=bce,kce=Sce,Cce=vce,Ace=wce,Rce=(e,t)=>{let n=!1,r=[],i=!1;function c(g){if(n)return!1;if(g.length<=5e4)r.push.apply(r,g);else for(let b=0;b<g.length;b++)r.push(g[0]);return i||(i=!0,t.scheduleTask(f,0)),!0}function f(){i=!1,r.length>0&&(e.unsafeOffer(r),r=[])}function m(g){n||(n=!0,g._tag==="Success"&&r.push(g.value),f(),e.unsafeOffer(g._tag==="Success"?ea:g))}return{single(g){return n?!1:(r.push(g),i||(i=!0,t.scheduleTask(f,0)),!0)},array:c,chunk(g){return c(xa(g))},done:m,end(){n||(n=!0,f(),e.unsafeOffer(ea))},halt(g){return m(dr(g))},fail(g){return m(Qh(g))},die(g){return m(JS(g))},dieMessage(g){return m(JS(new Error(g)))}}},xce="effect/Take",Oce=Symbol.for(xce),Dce={_A:e=>e,_E:e=>e};var lj;lj=Oce;class Aw{constructor(t){y(this,"exit");y(this,lj,Dce);this.exit=t}pipe(){return xe(this,arguments)}}const e$=e=>new Aw($n(e)),t$=new Aw(Qh(me())),qce=e=>new Aw(dr(j(e,a2(pe)))),Nce=e=>new Aw($n(Sn(e))),$ce=()=>Wu(me()),Ice=e=>pf(Da(e),pe),Mce="effect/Stream",O6=Symbol.for(Mce),jce={_R:e=>e,_E:e=>e,_A:e=>e};var uj;uj=O6;class on{constructor(t){y(this,"channel");y(this,uj,jce);this.channel=t}pipe(){return xe(this,arguments)}}const D6=e=>Ae(e,O6)||vl(e),J2=4096,Fce=e=>{if((e==null?void 0:e.bufferSize)==="unbounded"||(e==null?void 0:e.bufferSize)===void 0&&(e==null?void 0:e.strategy)===void 0)return qs();switch(e==null?void 0:e.strategy){case"sliding":return aie(e.bufferSize??16);default:return sie((e==null?void 0:e.bufferSize)??16)}},q6=(e,t)=>wn(Fce(t),ys).pipe(Ns(n=>Vse(iP,r=>e(Rce(n,r)))),Tt(n=>{const r=$t(Sh(n),i=>yW(i)?WS(i)?ws:Kn(i.cause):J_(Qt(Bn(i)),r));return r}),s6,$6),Lce=D(2,(e,t)=>Uce(e,n=>zr(cw(n),{onLeft:t,onRight:Hce}))),Uce=D(2,(e,t)=>new on(j(Xt(e),M2(n=>Xt(t(n)))))),zce=D(2,(e,t)=>new on(j(Xt(e),J_(Xt(t))))),Pce=e=>om(Pp(e)),TC=D(2,(e,t)=>new on(j(Xt(e),XP(t)))),Hce=e=>om(Da(e)),Bce=D(2,(e,t)=>j6(e,_0(t))),Vce=D(2,(e,t)=>{const n=r=>{const i=r.next();return i.done?Ki({onInput:c=>n(c[Symbol.iterator]()),onFailure:Kn,onDone:_f}):j(t(i.value),Tt(c=>c?j(Qt(Sn(i.value)),$t(()=>n(r))):n(r)),qa)};return new on(K_(()=>j(Xt(e),Br(n(an()[Symbol.iterator]())))))}),Gce=D(2,(e,t)=>j6(e,iL(t))),Rw=D(e=>D6(e[0]),(e,t,n)=>{const r=(n==null?void 0:n.bufferSize)??16;return n!=null&&n.switch?kC(n==null?void 0:n.concurrency,()=>n$(e,1,r,t),i=>n$(e,i,r,t)):kC(n==null?void 0:n.concurrency,()=>new on(Sv(Xt(e),i=>j(i,oL(c=>Xt(t(c))),iG(ws,(c,f)=>j(c,J_(f)))))),i=>new on(j(Xt(e),Sv(Tw),e6(c=>Xt(t(c)),n))))}),kC=(e,t,n)=>{switch(e){case void 0:return t();case"unbounded":return n(Number.MAX_SAFE_INTEGER);default:return e>1?n(e):t()}},n$=D(4,(e,t,n,r)=>new on(j(Xt(e),Sv(Tw),e6(i=>Xt(r(i)),{concurrency:t,mergeStrategy:Pie(),bufferSize:n})))),xw=D(e=>D6(e[0]),(e,t)=>Rw(e,Ie,t)),Kce=e=>{const t=Ki({onInput:n=>$t(Tw(n),()=>t),onFailure:Kn,onDone:()=>ws});return new on(j(Xt(e),Br(t)))},Qce=e=>{const t=(r,i)=>{const[c,f]=j(r,sG(g=>!WS(g))),m=j(b0(f),Bt({onNone:()=>i,onSome:xi({onFailure:g=>Bt(mne(g),{onNone:()=>ws,onSome:Kn}),onSuccess:()=>ws})}));return j(Qt(j(c,iL(g=>WS(g)?pe(g.value):me()))),$t(()=>m))},n=Ki({onInput:r=>t(r,n),onFailure:r=>Kn(r),onDone:()=>ws});return new on(j(Xt(e),Br(n)))},N6=e=>Kce(Qce(j(e,M6(t=>t.exit)))),$6=e=>new on(e),Xt=e=>{if("channel"in e)return e.channel;if(vl(e))return Xt(om(e));throw new TypeError("Expected a Stream.")},Yce=e=>new on(y0(e)?ws:Qt(e)),om=e=>j(e,pf(pe),Wce),Wce=e=>new on(qa(Fse(e,{onFailure:Bt({onNone:()=>ws,onSome:tm}),onSuccess:t=>Qt(Sn(t))}))),I6=(e,t)=>{const n=(t==null?void 0:t.maxChunkSize)??J2;if(t!=null&&t.scoped){const i=Tt(MN(e),c=>Gp(c,{maxChunkSize:n,shutdown:!0}));return t.shutdown?Tt(i,TC(dC(e))):i}const r=Rw(F6(MN(e)),i=>Gp(i,{maxChunkSize:n}));return t!=null&&t.shutdown?TC(r,dC(e)):r},Jce=e=>Z2(()=>p0(e)?Yce(e):Xce(e[Symbol.iterator]())),Xce=(e,t=J2)=>j(Ke(()=>{let n=[];const r=i=>j(Ke(()=>{let c=i.next();if(t===1)return c.done?ws:j(Qt(Sn(c.value)),$t(()=>r(i)));n=[];let f=0;for(;c.done===!1&&(n.push(c.value),f=f+1,!(f>=t));)c=i.next();return f>0?j(Qt(Bn(n)),$t(()=>r(i))):ws}),qa);return new on(r(e))}),L6),Gp=(e,t)=>j(_P(e,1,(t==null?void 0:t.maxChunkSize)??J2),Xh(n=>j(oie(e),Xe(r=>r&&o4(n)?$ce():Ice(n)))),ile,t!=null&&t.shutdown?TC(ys(e)):Ie),Zce=(...e)=>Jce(e),M6=D(2,(e,t)=>new on(j(Xt(e),Ew(oL(t))))),j6=D(2,(e,t)=>new on(j(Xt(e),Ew(t)))),ele=D(2,(e,t)=>new on(j(Xt(e),Xie(t)))),CC=D(2,(e,t)=>{const n=r=>{const i=r.next();if(i.done)return Ki({onInput:c=>n(c[Symbol.iterator]()),onFailure:Kn,onDone:_f});{const c=i.value;return qa(Tt(t(c),f=>$t(Qt(Sn(f)),()=>n(r))))}};return new on(j(Xt(e),Br(K_(()=>n(an()[Symbol.iterator]())))))}),tle=D(3,(e,t,n)=>new on(j(Xt(e),Sv(Tw),Zie(n,t),Ew(Sn)))),nle=D(2,(e,t)=>new on(j(Xt(e),Wie(t)))),rle=om(d2),sle=e=>j(e,ale(Ie)),ale=D(2,(e,t)=>new on(j(Xt(e),roe(t)))),ile=e=>hle(e,t=>j(Tt(t,n=>pe([n,t])),h2(Bt({onNone:()=>Gn(me()),onSome:Wu})))),X2=D(2,(e,t)=>Xt(e).pipe(t6(B2(t)),aoe)),ole=e=>X2(e,foe()),cle=e=>X2(e,doe),lle=e=>X2(e,goe()),F6=e=>new on(XP(n6(j(e,Tt(Sn))),ot)),ule=e=>new on(r6(t=>e(t).pipe(Tt(Sn)))),Z2=e=>new on(K_(()=>Xt(e()))),fle=D(2,(e,t)=>{if(!Number.isInteger(t))return Pce(new gne(`${t} must be an integer`));const n=r=>G_({onInput:i=>{const c=j(i,Jd(Math.min(r,Number.POSITIVE_INFINITY))),f=Math.max(0,r-c.length);return f>0?j(Qt(c),$t(()=>n(f))):Qt(c)},onFailure:tm,onDone:_f});return new on(j(Xt(e),t6(0<t?n(t):ws)))}),dle=D(2,(e,t)=>CC(e,n=>Io(t(n),n))),hle=(e,t)=>Z2(()=>{const n=r=>qa(Tt(t(r),Bt({onNone:()=>ws,onSome:([i,c])=>$t(Qt(i),()=>n(c))})));return new on(n(e))}),L6=e=>xw(om(e)),U6=e=>xw(F6(e)),mle=e=>xw(ule(t=>e(t))),gle=function(){const e=typeof arguments[0]!="string",t=e?arguments[1]:arguments[0],n=No(e?arguments[2]:arguments[1]);if(e){const r=arguments[0];return new on(GN(Xt(r),t,n))}return r=>new on(GN(Xt(r),t,n))},ple=(e,t,n)=>q6(r=>wn(Ke(()=>e.addEventListener(t,r.single,n)),()=>Ke(()=>e.removeEventListener(t,r.single,n))),{bufferSize:typeof n=="object"?n.bufferSize:void 0}),_le=gC,r$=Symbol.for("effect/Encoding/errors/Decode"),BT=(e,t)=>{const n={_tag:"DecodeException",[r$]:r$,input:e};return Es(t)&&(n.message=t),n},yle=new TextEncoder,s$=e=>{const t=e.length;let n="",r;for(r=2;r<t;r+=3)n+=vo[e[r-2]>>2],n+=vo[(e[r-2]&3)<<4|e[r-1]>>4],n+=vo[(e[r-1]&15)<<2|e[r]>>6],n+=vo[e[r]&63];return r===t+1&&(n+=vo[e[r-2]>>2],n+=vo[(e[r-2]&3)<<4],n+="=="),r===t&&(n+=vo[e[r-2]>>2],n+=vo[(e[r-2]&3)<<4|e[r-1]>>4],n+=vo[(e[r-1]&15)<<2],n+="="),n},ble=e=>{const t=Sle(e),n=t.length;if(n%4!==0)return Ue(BT(t,`Length must be a multiple of 4, but is ${n}`));const r=t.indexOf("=");if(r!==-1&&(r<n-2||r===n-2&&t[n-1]!=="="))return Ue(BT(t,"Found a '=' character, but it is not at the end"));try{const i=t.endsWith("==")?2:t.endsWith("=")?1:0,c=new Uint8Array(3*(n/4)-i);for(let f=0,m=0;f<n;f+=4,m+=3){const g=Gb(t.charCodeAt(f))<<18|Gb(t.charCodeAt(f+1))<<12|Gb(t.charCodeAt(f+2))<<6|Gb(t.charCodeAt(f+3));c[m]=g>>16,c[m+1]=g>>8&255,c[m+2]=g&255}return He(c)}catch(i){return Ue(BT(t,i instanceof Error?i.message:"Invalid input"))}},Sle=e=>e.replace(/[\n\r]/g,"");function Gb(e){if(e>=a$.length)throw new TypeError(`Invalid character ${String.fromCharCode(e)}`);const t=a$[e];if(t===255)throw new TypeError(`Invalid character ${String.fromCharCode(e)}`);return t}const vo=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],a$=[255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,62,255,255,255,63,52,53,54,55,56,57,58,59,60,61,255,255,255,0,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255,255,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],vle=e=>s$(typeof e=="string"?yle.encode(e):e),wle=e=>ble(e),AC=Symbol.for("effect/FiberHandle"),Ele=e=>Ae(e,AC),Tle={[AC]:AC,toString(){return hn(this.toJSON())},toJSON(){return{_id:"FiberHandle",state:this.state}},[Gt](){return this.toJSON()},pipe(){return xe(this,arguments)}},kle=e=>{const t=Object.create(Tle);return t.state={_tag:"Open",fiber:void 0},t.deferred=e,t},z6=()=>wn(Tt(xt(),e=>kle(e)),e=>_h(t=>{const n=e.state;return n._tag==="Closed"?ot:(e.state={_tag:"Closed"},n.fiber?mw(g2(uw(n.fiber,Xc(t.id(),ip))),e.deferred):Sl(e.deferred,ea))})),P6=-1,ip=OL(P6,0),Cle=c4(void 0,{emptyCase:Ni,failCase:Ni,dieCase:Ni,interruptCase:(e,t)=>YA(eR(t),P6),sequentialCase:(e,t,n)=>t||n,parallelCase:(e,t,n)=>t||n}),Ale=D(e=>Ele(e[0]),(e,t,n)=>{if(e.state._tag==="Closed"){t.unsafeInterruptAsFork(Xc((n==null?void 0:n.interruptAs)??Oa,ip));return}else if(e.state.fiber!==void 0){if((n==null?void 0:n.onlyIfMissing)===!0){t.unsafeInterruptAsFork(Xc((n==null?void 0:n.interruptAs)??Oa,ip));return}else if(e.state.fiber===t)return;e.state.fiber.unsafeInterruptAsFork(Xc((n==null?void 0:n.interruptAs)??Oa,ip)),e.state.fiber=void 0}e.state.fiber=t,t.addObserver(r=>{e.state._tag==="Open"&&t===e.state.fiber&&(e.state.fiber=void 0),Kh(r)&&((n==null?void 0:n.propagateInterruption)===!0?!Cle(r.cause):!tl(r.cause))&&AR(e.deferred,r)})}),Rle=e=>Zh(t=>_h(n=>e.state._tag==="Closed"||e.state.fiber===void 0?ot:sn(t(uw(e.state.fiber,Xc(n.id(),ip))),Ke(()=>{e.state._tag==="Open"&&(e.state.fiber=void 0)})))),xle=(function(){let e;return()=>(e===void 0&&(e=oi(zc)),e)})(),Ev=function(){const e=arguments[0];if(vl(arguments[1]))return i$(e,arguments[1],arguments[2]);const t=arguments[1];return n=>i$(e,n,t)},i$=(e,t,n)=>eP(r=>e.state._tag==="Closed"?zc:e.state.fiber!==void 0&&(n==null?void 0:n.onlyIfMissing)===!0?Ke(xle):Ns(tP(t),i=>Ale(e,i,{...n,interruptAs:r}))),RC=Symbol.for("effect/FiberSet"),Ole=e=>Ae(e,RC),Dle={[RC]:RC,[Symbol.iterator](){return this.state._tag==="Closed"?aV():this.state.backing[Symbol.iterator]()},toString(){return hn(this.toJSON())},toJSON(){return{_id:"FiberMap",state:this.state}},[Gt](){return this.toJSON()},pipe(){return xe(this,arguments)}},qle=(e,t)=>{const n=Object.create(Dle);return n.state={_tag:"Open",backing:e},n.deferred=t,n},Nle=()=>wn(Tt(xt(),e=>qle(new Set,e)),e=>_h(t=>{const n=e.state;if(n._tag==="Closed")return ot;e.state={_tag:"Closed"};const r=n.backing;return zre(r,Xc(t.id(),B6)).pipe(mw(e.deferred))})),H6=-1,B6=OL(H6,0),$le=c4(void 0,{emptyCase:Ni,failCase:Ni,dieCase:Ni,interruptCase:(e,t)=>YA(eR(t),H6),sequentialCase:(e,t,n)=>t||n,parallelCase:(e,t,n)=>t||n}),Ile=D(e=>Ole(e[0]),(e,t,n)=>{if(e.state._tag==="Closed"){t.unsafeInterruptAsFork(Xc((n==null?void 0:n.interruptAs)??Oa,B6));return}else if(e.state.backing.has(t))return;e.state.backing.add(t),t.addObserver(r=>{e.state._tag!=="Closed"&&(e.state.backing.delete(t),Kh(r)&&((n==null?void 0:n.propagateInterruption)===!0?!$le(r.cause):!tl(r.cause))&&AR(e.deferred,r))})}),Mle=e=>gn(e.deferred),jle="effect/GroupBy",V6=Symbol.for(jle),Fle={_R:e=>e,_E:e=>e,_K:e=>e,_V:e=>e},Lle=e=>Ae(e,V6),Ule=D(e=>Lle(e[0]),(e,t,n)=>Rw(e.grouped,([r,i])=>t(r,N6(Gp(i,{shutdown:!0}))),{concurrency:"unbounded",bufferSize:(n==null?void 0:n.bufferSize)??16})),zle=e=>({[V6]:Fle,pipe(){return xe(this,arguments)},grouped:e}),Ple=D(e=>typeof e[0]!="function",(e,t,n)=>n!=null&&n.key?Ule(Hle(e,n.key,{bufferSize:n.bufferSize}),(r,i)=>CC(i,t)):kC(n==null?void 0:n.concurrency,()=>CC(e,t),r=>n!=null&&n.unordered?Rw(e,i=>om(t(i)),{concurrency:r}):tle(e,r,t))),Hle=D(e=>typeof e[0]!="function",(e,t,n)=>{const r=(i,c)=>Ki({onInput:f=>$t(wr(Hr(Ble(f,t),([m,g])=>{const b=i.get(m);return b===void 0?j(D2((n==null?void 0:n.bufferSize)??16),Xe(S=>j(Ke(()=>{i.set(m,S)}),sn(Tn(c,Nce([m,S]))),sn(j(Tn(S,e$(g)),IT(v=>tl(v)?pe(ot):me())))))):IT(Tn(b,e$(g)),S=>tl(S)?pe(ot):me())},{discard:!0})),()=>r(i,c)),onFailure:f=>wr(Tn(c,qce(f))),onDone:()=>j(wr(j(Hr(i.entries(),([f,m])=>j(Tn(m,t$),IT(g=>tl(g)?pe(ot):me())),{discard:!0}),sn(Tn(c,t$)))))});return zle(mle(i=>ye(function*(){const c=new Map,f=yield*qs();return yield*ll(i,ys(f)),yield*Xt(e).pipe(Br(r(c,f)),z2,BP(i),vs(i),Io(N6(Gp(f,{shutdown:!0}))))})))}),Ble=D(2,(e,t)=>{const n=[],r=e[Symbol.iterator](),i=new Map;let c;for(;(c=r.next())&&!c.done;){const f=c.value,m=t(f);if(i.has(m))i.get(m).push(f);else{const g=[f];n.push([m,g]),i.set(m,g)}}return Bn(n.map(f=>[f[0],Bn(f[1])]))});class Lr{constructor(t,n,r){y(this,"path");y(this,"actual");y(this,"issue");y(this,"_tag","Pointer");this.path=t,this.actual=n,this.issue=r}}class o${constructor(t,n){y(this,"actual");y(this,"message");y(this,"_tag","Unexpected");this.actual=t,this.message=n}}class Dg{constructor(t,n){y(this,"ast");y(this,"message");y(this,"_tag","Missing");y(this,"actual");this.ast=t,this.message=n}}class zn{constructor(t,n,r,i){y(this,"ast");y(this,"actual");y(this,"issues");y(this,"output");y(this,"_tag","Composite");this.ast=t,this.actual=n,this.issues=r,this.output=i}}class VT{constructor(t,n,r,i){y(this,"ast");y(this,"actual");y(this,"kind");y(this,"issue");y(this,"_tag","Refinement");this.ast=t,this.actual=n,this.kind=r,this.issue=i}}class GT{constructor(t,n,r,i){y(this,"ast");y(this,"actual");y(this,"kind");y(this,"issue");y(this,"_tag","Transformation");this.ast=t,this.actual=n,this.kind=r,this.issue=i}}class Zn{constructor(t,n,r){y(this,"ast");y(this,"actual");y(this,"message");y(this,"_tag","Type");this.ast=t,this.actual=n,this.message=r}}class c${constructor(t,n,r){y(this,"ast");y(this,"actual");y(this,"message");y(this,"_tag","Forbidden");this.ast=t,this.actual=n,this.message=r}}const xC=Symbol.for("effect/Schema/ParseErrorTypeId"),l$=e=>Ae(e,xC);var fj;class Vle extends Kne("ParseError"){constructor(){super(...arguments);y(this,fj,xC)}get message(){return this.toString()}toString(){return cp.formatIssueSync(this.issue)}toJSON(){return{_id:"ParseError",message:this.toString()}}[(fj=xC,Gt)](){return this.toJSON()}}const cm=e=>new Vle({issue:e}),ti=He,fl=Ue,u$=j7,ms=rF,Qc=D(2,(e,t)=>ms(e)?zr(e,{onLeft:Ue,onRight:t}):Xe(e,t)),ps=D(2,(e,t)=>ms(e)?L7(e,t):Tt(e,t)),op=D(2,(e,t)=>ms(e)?d_(e,t):pf(e,t)),Gle=D(2,(e,t)=>ms(e)?F7(e,{onLeft:t.onFailure,onRight:t.onSuccess}):xse(e,t)),G6=D(2,(e,t)=>ms(e)?zr(e,{onLeft:t,onRight:He}):h2(e,t)),Ow=(e,t)=>t===void 0||Mo(t)?e:e===void 0?t:{...e,...t},Dw=(e,t,n)=>{const r=$r(e,t);return(i,c)=>r(i,Ow(n,c))},ex=(e,t,n)=>{const r=Dw(e,t,n);return(i,c)=>sF(r(i,c),cm)},K6=(e,t,n)=>{const r=$r(e,t);return(i,c)=>r(i,{...Ow(n,c),isEffectAllowed:!0})},Q6=(e,t)=>ex(e.ast,!0,t),Kle=(e,t)=>Dw(e.ast,!0,t),lm=(e,t)=>K6(e.ast,!0,t),tx=(e,t)=>ex(e.ast,!1,t),Qle=(e,t)=>Dw(e.ast,!1,t),yf=(e,t)=>K6(e.ast,!1,t),tf=Q6,Yle=lm,qw=(e,t)=>ex(Dn(e.ast),!0,t),Wle=(e,t)=>Dw(Dn(e.ast),!0,t),rn=(e,t)=>{const n=$r(Dn(e.ast),!0);return(r,i)=>Ci(n(r,{exact:!0,...Ow(t,i)}))},Yc=tx,Jle=yf,Xle=St(Symbol.for("effect/ParseResult/decodeMemoMap"),()=>new WeakMap),Zle=St(Symbol.for("effect/ParseResult/encodeMemoMap"),()=>new WeakMap),$r=(e,t)=>{const n=t?Xle:Zle,r=n.get(e);if(r)return r;const i=eue(e,t),c=KV(e),f=Zt(c)?(b,S)=>i(b,Ow(S,c.value)):i,m=QV(e),g=t&&Zt(m)?(b,S)=>Vg(G6(f(b,S),m.value),e,b,S):f;return n.set(e,g),g},KT=e=>ba(BV(e)),QT=e=>ba(VV(e)),eue=(e,t)=>{switch(e._tag){case"Refinement":if(t){const n=$r(e.from,!0);return(r,i)=>{i=i??ET;const c=(i==null?void 0:i.errors)==="all",f=Qc(G6(n(r,i),m=>{const g=new VT(e,r,"From",m);return c&&WV(e)&&Z6(m)?Bt(e.filter(r,i,e),{onNone:()=>Ue(g),onSome:b=>Ue(new zn(e,r,[g,new VT(e,r,"Predicate",b)]))}):Ue(g)}),m=>Bt(e.filter(m,i,e),{onNone:()=>He(m),onSome:g=>Ue(new VT(e,r,"Predicate",g))}));return Vg(f,e,r,i)}}else{const n=$r(Dn(e),!0),r=$r(W6(e.from),!1);return(i,c)=>Vg(Qc(n(i,c),f=>r(f,c)),e,i,c)}case"Transformation":{const n=nue(e.transformation,t),r=t?$r(e.from,!0):$r(e.to,!1),i=t?$r(e.to,!0):$r(e.from,!1);return(c,f)=>Vg(Qc(op(r(c,f),m=>new GT(e,c,t?"Encoded":"Type",m)),m=>Qc(op(n(m,f??ET,e,c),g=>new GT(e,c,"Transformation",g)),g=>op(i(g,f),b=>new GT(e,c,t?"Type":"Encoded",b)))),e,c,f)}case"Declaration":{const n=t?e.decodeUnknown(...e.typeParameters):e.encodeUnknown(...e.typeParameters);return(r,i)=>Vg(n(r,i??ET,e),e,r,i)}case"Literal":return Ps(e,n=>n===e.literal);case"UniqueSymbol":return Ps(e,n=>n===e.symbol);case"UndefinedKeyword":return Ps(e,t7);case"NeverKeyword":return Ps(e,n7);case"UnknownKeyword":case"AnyKeyword":case"VoidKeyword":return He;case"StringKeyword":return Ps(e,Es);case"NumberKeyword":return Ps(e,Mo);case"BooleanKeyword":return Ps(e,Ru);case"BigIntKeyword":return Ps(e,n0);case"SymbolKeyword":return Ps(e,kS);case"ObjectKeyword":return Ps(e,Hi);case"Enums":return Ps(e,n=>e.enums.some(([r,i])=>i===n));case"TemplateLiteral":{const n=QF(e);return Ps(e,r=>Es(r)&&n.test(r))}case"TupleType":{const n=e.elements.map(b=>$r(b.type,t)),r=e.rest.map(b=>$r(b.type,t));let i=e.elements.filter(b=>!b.isOptional);e.rest.length>0&&(i=i.concat(e.rest.slice(1)));const c=i.length,f=e.elements.length>0?e.elements.map((b,S)=>S).join(" | "):"never",m=KT(e),g=QT(e);return(b,S)=>{if(!fV(b))return Ue(new Zn(e,b));const v=(S==null?void 0:S.errors)==="all",q=[];let k=0;const N=[],H=b.length;for(let $=H;$<=c-1;$++){const R=new Lr($,b,new Dg(i[$-H]));if(v){q.push([k++,R]);continue}else return Ue(new zn(e,b,R,N))}if(e.rest.length===0)for(let $=e.elements.length;$<=H-1;$++){const R=new Lr($,b,new o$(b[$],`is unexpected, expected: ${f}`));if(v){q.push([k++,R]);continue}else return Ue(new zn(e,b,R,N))}let x=0,C;for(;x<n.length;x++)if(H<x+1){if(e.elements[x].isOptional)continue}else{const $=n[x],R=$(b[x],S);if(ms(R)){if(vr(R)){const I=new Lr(x,b,R.left);if(v){q.push([k++,I]);continue}else return Ue(new zn(e,b,I,Ba(N)))}N.push([k++,R.right])}else{const I=k++,z=x;C||(C=[]),C.push(({es:V,output:K})=>Xe(_d(R),Y=>{if(vr(Y)){const P=new Lr(z,b,Y.left);return v?(V.push([I,P]),ot):Ue(new zn(e,b,P,Ba(K)))}return K.push([I,Y.right]),ot}))}}if(bn(r)){const[$,...R]=r;for(;x<H-R.length;x++){const I=$(b[x],S);if(ms(I))if(vr(I)){const z=new Lr(x,b,I.left);if(v){q.push([k++,z]);continue}else return Ue(new zn(e,b,z,Ba(N)))}else N.push([k++,I.right]);else{const z=k++,V=x;C||(C=[]),C.push(({es:K,output:Y})=>Xe(_d(I),P=>{if(vr(P)){const ne=new Lr(V,b,P.left);return v?(K.push([z,ne]),ot):Ue(new zn(e,b,ne,Ba(Y)))}else return Y.push([z,P.right]),ot}))}}for(let I=0;I<R.length;I++)if(x+=I,!(H<x+1)){const z=R[I](b[x],S);if(ms(z)){if(vr(z)){const V=new Lr(x,b,z.left);if(v){q.push([k++,V]);continue}else return Ue(new zn(e,b,V,Ba(N)))}N.push([k++,z.right])}else{const V=k++,K=x;C||(C=[]),C.push(({es:Y,output:P})=>Xe(_d(z),ne=>{if(vr(ne)){const Se=new Lr(K,b,ne.left);return v?(Y.push([V,Se]),ot):Ue(new zn(e,b,Se,Ba(P)))}return P.push([V,ne.right]),ot}))}}}const E=({es:$,output:R})=>nS($)?Ue(new zn(e,b,Ba($),Ba(R))):He(Ba(R));if(C&&C.length>0){const $=C;return Nn(()=>{const R={es:Lg(q),output:Lg(N)};return Xe(Hr($,I=>I(R),{concurrency:m,batching:g,discard:!0}),()=>E(R))})}return E({output:N,es:q})}}case"TypeLiteral":{if(e.propertySignatures.length===0&&e.indexSignatures.length===0)return Ps(e,r7);const n=[],r={},i=[];for(const S of e.propertySignatures)n.push([$r(S.type,t),S]),r[S.name]=null,i.push(S.name);const c=e.indexSignatures.map(S=>[$r(S.parameter,t),$r(S.type,t),S.parameter]),f=Er.make(e.indexSignatures.map(S=>S.parameter).concat(i.map(S=>kS(S)?new UF(S):new jS(S)))),m=$r(f,t),g=KT(e),b=QT(e);return(S,v)=>{if(!a7(S))return Ue(new Zn(e,S));const q=(v==null?void 0:v.errors)==="all",k=[];let N=0;const H=(v==null?void 0:v.onExcessProperty)==="error",x=(v==null?void 0:v.onExcessProperty)==="preserve",C={};let E;if(H||x){E=Za(S);for(const z of E){const V=m(z,v);if(ms(V)&&vr(V))if(H){const K=new Lr(z,S,new o$(S[z],`is unexpected, expected: ${String(f)}`));if(q){k.push([N++,K]);continue}else return Ue(new zn(e,S,K,C))}else C[z]=S[z]}}let $;const R=(v==null?void 0:v.exact)===!0;for(let z=0;z<n.length;z++){const V=n[z][1],K=V.name,Y=Object.prototype.hasOwnProperty.call(S,K);if(!Y){if(V.isOptional)continue;if(R){const Se=new Lr(K,S,new Dg(V));if(q){k.push([N++,Se]);continue}else return Ue(new zn(e,S,Se,C))}}const P=n[z][0],ne=P(S[K],v);if(ms(ne)){if(vr(ne)){const Se=new Lr(K,S,Y?ne.left:new Dg(V));if(q){k.push([N++,Se]);continue}else return Ue(new zn(e,S,Se,C))}C[K]=ne.right}else{const Se=N++,Re=K;$||($=[]),$.push(({es:ge,output:Ve})=>Xe(_d(ne),oe=>{if(vr(oe)){const Te=new Lr(Re,S,Y?oe.left:new Dg(V));return q?(ge.push([Se,Te]),ot):Ue(new zn(e,S,Te,Ve))}return Ve[Re]=oe.right,ot}))}}for(let z=0;z<c.length;z++){const V=c[z],K=V[0],Y=V[1],P=_F(S,V[2]);for(const ne of P){const Se=K(ne,v);if(ms(Se)&&Ci(Se)){const Re=Y(S[ne],v);if(ms(Re))if(vr(Re)){const ge=new Lr(ne,S,Re.left);if(q){k.push([N++,ge]);continue}else return Ue(new zn(e,S,ge,C))}else Object.prototype.hasOwnProperty.call(r,ne)||(C[ne]=Re.right);else{const ge=N++,Ve=ne;$||($=[]),$.push(({es:oe,output:Te})=>Xe(_d(Re),Ee=>{if(vr(Ee)){const pt=new Lr(Ve,S,Ee.left);return q?(oe.push([ge,pt]),ot):Ue(new zn(e,S,pt,Te))}else return Object.prototype.hasOwnProperty.call(r,ne)||(Te[ne]=Ee.right),ot}))}}}}const I=({es:z,output:V})=>{if(nS(z))return Ue(new zn(e,S,Ba(z),V));if((v==null?void 0:v.propertyOrder)==="original"){const K=E||Za(S);for(const P of i)K.indexOf(P)===-1&&K.push(P);const Y={};for(const P of K)Object.prototype.hasOwnProperty.call(V,P)&&(Y[P]=V[P]);return He(Y)}return He(V)};if($&&$.length>0){const z=$;return Nn(()=>{const V={es:Lg(k),output:Object.assign({},C)};return Xe(Hr(z,K=>K(V),{concurrency:g,batching:b,discard:!0}),()=>I(V))})}return I({es:k,output:C})}}case"Union":{const n=Y6(e.types,t),r=Za(n.keys),i=r.length,c=e.types.length,f=new Map;for(let b=0;b<c;b++)f.set(e.types[b],$r(e.types[b],t));const m=KT(e)??1,g=QT(e);return(b,S)=>{const v=[];let q=0,k=[];if(i>0)if(r0(b))for(let x=0;x<i;x++){const C=r[x],E=n.keys[C].buckets;if(Object.prototype.hasOwnProperty.call(b,C)){const $=String(b[C]);if(Object.prototype.hasOwnProperty.call(E,$))k=k.concat(E[$]);else{const{candidates:R,literals:I}=n.keys[C],z=Er.make(I),V=R.length===c?new Ra([new On(C,z,!1,!0)],[]):Er.make(R);v.push([q++,new zn(V,b,new Lr(C,b,new Zn(z,b[C])))])}}else{const{candidates:$,literals:R}=n.keys[C],I=new On(C,Er.make(R),!1,!0),z=$.length===c?new Ra([I],[]):Er.make($);v.push([q++,new zn(z,b,new Lr(C,b,new Dg(I)))])}}else{const x=n.candidates.length===c?e:Er.make(n.candidates);v.push([q++,new Zn(x,b)])}n.otherwise.length>0&&(k=k.concat(n.otherwise));let N;for(let x=0;x<k.length;x++){const C=k[x],E=f.get(C)(b,S);if(ms(E)&&(!N||N.length===0)){if(Ci(E))return E;v.push([q++,E.left])}else{const $=q++;N||(N=[]),N.push(R=>Nn(()=>"finalResult"in R?ot:Xe(_d(E),I=>(Ci(I)?R.finalResult=I:R.es.push([$,I.left]),ot))))}}const H=x=>nS(x)?x.length===1&&x[0][1]._tag==="Type"?Ue(x[0][1]):Ue(new zn(e,b,Ba(x))):Ue(new Zn(e,b));if(N&&N.length>0){const x=N;return Nn(()=>{const C={es:Lg(v)};return Xe(Hr(x,E=>E(C),{concurrency:m,batching:g,discard:!0}),()=>"finalResult"in C?C.finalResult:H(C.es))})}return H(v)}}case"Suspend":{const n=AA(()=>$r(Nu(e.f(),e.annotations),t));return(r,i)=>n()(r,i)}}},Ps=(e,t)=>n=>t(n)?He(n):Ue(new Zn(e,n)),Bg=(e,t)=>{switch(e._tag){case"Declaration":{const n=qh(e);if(Zt(n))return Bg(n.value,t);break}case"TypeLiteral":{const n=[];for(let r=0;r<e.propertySignatures.length;r++){const i=e.propertySignatures[r],c=t?_k(i.type):Dn(i.type);np(c)&&!i.isOptional&&n.push([i.name,c])}return n}case"TupleType":{const n=[];for(let r=0;r<e.elements.length;r++){const i=e.elements[r],c=t?_k(i.type):Dn(i.type);np(c)&&!i.isOptional&&n.push([r,c])}return n}case"Refinement":return Bg(e.from,t);case"Suspend":return Bg(e.f(),t);case"Transformation":return Bg(t?e.from:e.to,t)}return[]},Y6=(e,t)=>{const n={},r=[],i=[];for(let c=0;c<e.length;c++){const f=e[c],m=Bg(f,t);if(m.length>0){i.push(f);for(let g=0;g<m.length;g++){const[b,S]=m[g],v=String(S.literal);n[b]=n[b]||{buckets:{},literals:[],candidates:[]};const q=n[b].buckets;if(Object.prototype.hasOwnProperty.call(q,v)){if(g<m.length-1)continue;q[v].push(f),n[b].literals.push(S),n[b].candidates.push(f)}else{q[v]=[f],n[b].literals.push(S),n[b].candidates.push(f);break}}}else r.push(f)}return{keys:n,otherwise:r,candidates:i}},W6=e=>$d(e)?W6(e.from):e,Vg=(e,t,n,r)=>{if((r==null?void 0:r.isEffectAllowed)===!0||ms(e))return e;const i=new wz,c=oi(e,{scheduler:i});i.flush();const f=c.unsafePoll();if(f){if(WS(f))return He(f.value);const m=f.cause;return i4(m)?Ue(m.error):Ue(new c$(t,n,zp(m)))}return Ue(new c$(t,n,"cannot be be resolved synchronously, this is caused by using runSync on an effect that performs async work"))},tue=([e],[t])=>e>t?1:e<t?-1:0;function Ba(e){return e.sort(tue).map(t=>t[1])}const nue=(e,t)=>{switch(e._tag){case"FinalTransformation":return t?e.decode:e.encode;case"ComposeTransformation":return He;case"TypeLiteralTransformation":return n=>{let r=He(n);for(const i of e.propertySignatureTransformations){const[c,f]=t?[i.from,i.to]:[i.to,i.from],m=t?i.decode:i.encode;r=ps(r,b=>{const S=m(Object.prototype.hasOwnProperty.call(b,c)?pe(b[c]):me());return delete b[c],Zt(S)&&(b[f]=S.value),b})}return r}}},ds=(e,t=[])=>({value:e,forest:t}),cp={formatIssue:e=>ps(Ed(e),rue),formatIssueSync:e=>{const t=cp.formatIssue(e);return ms(t)?z7(t):ya(t)},formatError:e=>cp.formatIssue(e.issue),formatErrorSync:e=>cp.formatIssueSync(e.issue)},rue=e=>e.value+J6(`
`,e.forest),J6=(e,t)=>{let n="";const r=t.length;let i;for(let c=0;c<r;c++){i=t[c];const f=c===r-1;n+=e+(f?"":"")+" "+i.value,n+=J6(e+(r>1&&!f?"  ":"   "),i.forest)}return n},sue=e=>{switch(e){case"Encoded":return"Encoded side transformation failure";case"Transformation":return"Transformation process failure";case"Type":return"Type side transformation failure"}},aue=e=>{switch(e){case"From":return"From side refinement failure";case"Predicate":return"Predicate refinement failure"}},X6=e=>"ast"in e?pe(e.ast):me(),OC=He(void 0),iue=e=>X6(e).pipe(Oh(PV),Bt({onNone:()=>OC,onSome:t=>{const n=t(e);return Es(n)?He({message:n,override:!1}):vl(n)?Tt(n,r=>({message:r,override:!1})):Es(n.message)?He({message:n.message,override:n.override}):Tt(n.message,r=>({message:r,override:n.override}))}})),nx=e=>t=>t._tag===e,Z6=nx("Composite"),f$=nx("Refinement"),d$=nx("Transformation"),lp=e=>Qc(iue(e),t=>t!==void 0?!t.override&&(Z6(e)||f$(e)&&e.kind==="From"||d$(e)&&e.kind!=="Transformation")?d$(e)||f$(e)?lp(e.issue):OC:He(t.message):OC),e5=e=>X6(e).pipe(Oh(GV),G7(t=>t(e)),ba);function oue(e){return LF(e).pipe(xo(()=>jF(e)),xo(()=>FF(e)),xo(()=>c0(e)),yn(()=>`{ ${e.from} | filter }`))}function cue(e){return e.message!==void 0?e.message:`Expected ${$d(e.ast)?oue(e.ast):String(e.ast)}, actual ${Aa(e.actual)}`}const lue=e=>ps(lp(e),t=>t??e5(e)??cue(e)),Kb=e=>e5(e)??String(e.ast),uue=e=>e.message??"is forbidden",fue=e=>e.message??"is unexpected",due=e=>{const t=HV(e.ast);if(Zt(t)){const n=t.value();return Es(n)?He(n):n}return He(e.message??"is missing")},Ed=e=>{switch(e._tag){case"Type":return ps(lue(e),ds);case"Forbidden":return He(ds(Kb(e),[ds(uue(e))]));case"Unexpected":return He(ds(fue(e)));case"Missing":return ps(due(e),ds);case"Transformation":return Qc(lp(e),t=>t!==void 0?He(ds(t)):ps(Ed(e.issue),n=>ds(Kb(e),[ds(sue(e.kind),[n])])));case"Refinement":return Qc(lp(e),t=>t!==void 0?He(ds(t)):ps(Ed(e.issue),n=>ds(Kb(e),[ds(aue(e.kind),[n])])));case"Pointer":return ps(Ed(e.issue),t=>ds(SF(e.path),[t]));case"Composite":return Qc(lp(e),t=>{if(t!==void 0)return He(ds(t));const n=Kb(e);return bF(e.issues)?ps(Hr(e.issues,Ed),r=>ds(n,r)):ps(Ed(e.issues),r=>ds(n,[r]))})}},h$=Symbol.for("effect/Pool"),hue={_E:e=>e,_A:e=>e},t5=e=>ks(t=>se(Vh(),n=>{const r=Ws(n,ii),i=kU(e.acquire,g=>_l(n,g)),c=new pue(r,i,e.concurrency??1,e.min,e.max,e.strategy,Math.min(Math.max(e.targetUtilization??1,.1),1)),f=zo(mh(t(c.resize)),g=>r.addFinalizer(()=>Dp(g))),m=zo(mh(t(e.strategy.run(c))),g=>r.addFinalizer(()=>Dp(g)));return fe(c).pipe(Zc(r.addFinalizer(()=>c.shutdown)),Zc(f),Zc(m))})),mue=e=>t5({...e,min:e.size,max:e.size,strategy:_ue()}),gue=e=>se(e.timeToLiveStrategy==="creation"?yue(e.timeToLive):bue(e.timeToLive),t=>t5({...e,strategy:t}));var dj,hj;class pue extends(hj=Gi,dj=h$,hj){constructor(n,r,i,c,f,m,g){super();y(this,"scope");y(this,"acquire");y(this,"concurrency");y(this,"minSize");y(this,"maxSize");y(this,"strategy");y(this,"targetUtilization");y(this,dj);y(this,"isShuttingDown",!1);y(this,"semaphore");y(this,"items",new Set);y(this,"available",new Set);y(this,"availableLatch",O4(!1));y(this,"invalidated",new Set);y(this,"waiters",0);y(this,"allocate",uR(Wh(),n=>this.acquire.pipe(gf(n),ei,se(r=>{const i={exit:r,finalizer:Uh(n.close(r),Sue),refCount:0,disableReclaim:!1};return this.items.add(i),this.available.add(i),rr(r._tag==="Success"?this.strategy.onAcquire(i):Nt(i.finalizer,this.strategy.onAcquire(i)),i)})),(n,r)=>r._tag==="Failure"?n.close(r):it));y(this,"resizeLoop",Ne(()=>{if(this.activeSize>=this.targetSize)return it;const n=this.targetSize-this.activeSize;return this.strategy.reclaim(this).pipe(se(Bt({onNone:()=>this.allocate,onSome:fe})),Bte(n,{concurrency:n}),Zc(this.availableLatch.open),se(r=>r.some(i=>i.exit._tag==="Failure")?it:this.resizeLoop))}));y(this,"resizeSemaphore",ap(1));y(this,"resize",this.resizeSemaphore.withPermits(1)(this.resizeLoop));y(this,"getPoolItem",ks(n=>n(this.semaphore.take(1)).pipe(Nt(ii),se(r=>Ne(()=>{if(this.waiters++,this.isShuttingDown)return Jn;if(this.targetSize>this.activeSize){const i=this;return se(this.resizeSemaphore.withPermitsIfAvailable(1)(gv(lh(this.resize),this.scope)),function c(){return i.isShuttingDown?Jn:i.available.size>0?fe(fk(i.available)):(i.availableLatch.unsafeClose(),se(i.availableLatch.await,c))})}return fe(fk(this.available))}).pipe(gh(he(()=>this.waiters--)),zo(i=>i.exit._tag==="Failure"?(this.items.delete(i),this.invalidated.delete(i),this.available.delete(i),this.semaphore.release(1)):(i.refCount++,this.available.delete(i),i.refCount<this.concurrency&&this.available.add(i),r.addFinalizer(()=>Nt(Ne(()=>(i.refCount--,this.invalidated.has(i)?this.invalidatePoolItem(i):(this.available.add(i),Pr))),this.semaphore.release(1))))),bl(()=>this.semaphore.release(1)))))));y(this,"get",se(Ne(()=>this.isShuttingDown?Jn:this.getPoolItem),n=>n.exit));this.scope=n,this.acquire=r,this.concurrency=i,this.minSize=c,this.maxSize=f,this.strategy=m,this.targetUtilization=g,this[h$]=hue,this.semaphore=ap(i*f)}get currentUsage(){let n=this.waiters;for(const r of this.items)n+=r.refCount;return n}get targetSize(){if(this.isShuttingDown)return 0;const n=this.currentUsage/this.targetUtilization,r=Math.ceil(n/this.concurrency);return Math.min(Math.max(this.minSize,r),this.maxSize)}get activeSize(){return this.items.size-this.invalidated.size}commit(){return this.get}invalidate(n){return Ne(()=>{if(this.isShuttingDown)return it;for(const r of this.items)if(r.exit._tag==="Success"&&r.exit.value===n)return r.disableReclaim=!0,Yo(this.invalidatePoolItem(r));return it})}invalidatePoolItem(n){return Ne(()=>{if(this.items.has(n)){if(n.refCount===0)return this.items.delete(n),this.available.delete(n),this.invalidated.delete(n),Nt(n.finalizer,gv(lh(this.resize),this.scope))}else return it;return this.invalidated.add(n),this.available.delete(n),it})}get shutdown(){return Ne(()=>{if(this.isShuttingDown)return it;this.isShuttingDown=!0;const n=this.items.size,r=ap(n);return Vu(this.items,i=>i.refCount>0?(i.finalizer=Zc(i.finalizer,r.release(1)),this.invalidated.add(i),r.take(1)):(this.items.delete(i),this.available.delete(i),this.invalidated.delete(i),i.finalizer)).pipe(Nt(this.semaphore.releaseAll),Nt(this.availableLatch.open),Nt(r.take(n)))})}pipe(){return xe(this,arguments)}}const _ue=()=>({run:e=>it,onAcquire:e=>it,reclaim:e=>Fp}),yue=e=>W0(t=>Ye(R2(),n=>{const r=Xd(e),i=new WeakMap;return Ie({run:c=>{const f=m=>Ne(()=>{if(!c.items.has(m)||c.invalidated.has(m))return it;const g=t.unsafeCurrentTimeMillis(),b=i.get(m),S=r-(g-b);return S>0?rz(f(m),S):c.invalidatePoolItem(m)});return n.take.pipe(zo(f),LR)},onAcquire:c=>Ne(()=>(i.set(c,t.unsafeCurrentTimeMillis()),n.offer(c))),reclaim:c=>Fp})})),bue=e=>Ye(R2(),t=>Ie({run:n=>{const r=Ne(()=>n.activeSize-n.targetSize<=0?it:t.take.pipe(zo(c=>n.invalidatePoolItem(c)),Nt(r)));return r.pipe(rz(e),LR)},onAcquire:n=>t.offer(n),reclaim(n){return Ne(()=>{if(n.invalidated.size===0)return Fp;const r=tV(iV(n.invalidated,i=>!i.disableReclaim));return r._tag==="None"?Fp:(n.invalidated.delete(r.value),r.value.refCount<n.concurrency&&n.available.add(r.value),rr(t.offer(r.value),r))})}})),Sue=e=>yt(t=>{const n=t.getFiberRef(_R);return n._tag==="Some"&&t.log("Unhandled error in pool finalizer",e,n),it}),vue=Xse,wue=Yse,Eue=Wz,Tue=nee,kue=Jz,DC=Symbol.for("effect/Mailbox"),m$=Symbol.for("effect/Mailbox/ReadonlyMailbox"),cu=an(),g$=Pt(cu),Qb=Pt(!1),Yb=Pt(!0),p$=[cu,!0];var mj,gj;class Cue extends Gi{constructor(n,r,i){super();y(this,"scheduler");y(this,"capacity");y(this,"strategy");y(this,gj,DC);y(this,mj,m$);y(this,"state",{_tag:"Open",takers:new Set,offers:new Set,awaiters:new Set});y(this,"messages",[]);y(this,"messagesChunk",an());y(this,"shutdown",he(()=>{if(this.state._tag==="Done")return!0;this.messages=[],this.messagesChunk=cu;const n=this.state.offers;if(this.finalize(this.state._tag==="Open"?Pr:this.state.exit),n.size>0){for(const r of n)r._tag==="Single"?r.resume(Qb):r.resume(Pt(Bn(r.remaining.slice(r.offset))));n.clear()}return!0}));y(this,"end",this.done(Pr));y(this,"clear",Ne(()=>{if(this.state._tag==="Done")return lS(this.state.exit,cu);const n=this.unsafeTakeAll();return this.releaseCapacity(),fe(n)}));y(this,"takeAll",Ne(()=>{if(this.state._tag==="Done")return lS(this.state.exit,p$);const n=this.unsafeTakeAll();return n.length===0?Nt(this.awaitTake,this.takeAll):fe([n,this.releaseCapacity()])}));y(this,"take",Ne(()=>this.unsafeTake()??Nt(this.awaitTake,this.take)));y(this,"await",Vc(n=>this.state._tag==="Done"?n(this.state.exit):(this.state.awaiters.add(n),he(()=>{this.state._tag!=="Done"&&this.state.awaiters.delete(n)}))));y(this,"size",he(()=>this.unsafeSize()));y(this,"awaitTake",Vc(n=>this.state._tag==="Done"?n(this.state.exit):(this.state.takers.add(n),he(()=>{this.state._tag!=="Done"&&this.state.takers.delete(n)}))));y(this,"scheduleRunning",!1);y(this,"releaseTaker",()=>{if(this.scheduleRunning=!1,this.state._tag==="Done")return;if(this.state.takers.size===0)return;const n=fk(this.state.takers);this.state.takers.delete(n),n(Pr)});this.scheduler=n,this.capacity=r,this.strategy=i}offer(n){return Ne(()=>{if(this.state._tag!=="Open")return Qb;if(this.messages.length+this.messagesChunk.length>=this.capacity)switch(this.strategy){case"dropping":return Qb;case"suspend":return this.capacity<=0&&this.state.takers.size>0?(this.messages.push(n),this.releaseTaker(),Yb):this.offerRemainingSingle(n);case"sliding":return this.unsafeTake(),this.messages.push(n),Yb}return this.messages.push(n),this.scheduleReleaseTaker(),Yb})}unsafeOffer(n){return this.state._tag!=="Open"?!1:this.messages.length+this.messagesChunk.length>=this.capacity?this.strategy==="sliding"?(this.unsafeTake(),this.messages.push(n),!0):this.capacity<=0&&this.state.takers.size>0?(this.messages.push(n),this.releaseTaker(),!0):!1:(this.messages.push(n),this.scheduleReleaseTaker(),!0)}offerAll(n){return Ne(()=>{if(this.state._tag!=="Open")return fe(Mu(n));const r=this.unsafeOfferAllArray(n);return r.length===0?g$:this.strategy==="dropping"?fe(Bn(r)):this.offerRemainingArray(r)})}unsafeOfferAll(n){return Bn(this.unsafeOfferAllArray(n))}unsafeOfferAllArray(n){if(this.state._tag!=="Open")return Ht(n);if(this.capacity===Number.POSITIVE_INFINITY||this.strategy==="sliding")return this.messages.length>0&&(this.messagesChunk=pn(this.messagesChunk,Bn(this.messages))),this.strategy==="sliding"?this.messagesChunk=this.messagesChunk.pipe(pn(Mu(n)),aG(this.capacity)):p0(n)?this.messagesChunk=pn(this.messagesChunk,n):this.messages=Ht(n),this.scheduleReleaseTaker(),[];const r=this.capacity<=0?this.state.takers.size:this.capacity-this.messages.length-this.messagesChunk.length;if(r===0)return Ht(n);const i=[];let c=0;for(const f of n)c<r?this.messages.push(f):i.push(f),c++;return this.scheduleReleaseTaker(),i}fail(n){return this.done(Np(n))}failCause(n){return this.done(zt(n))}unsafeDone(n){return this.state._tag!=="Open"?!1:this.state.offers.size===0&&this.messages.length===0&&this.messagesChunk.length===0?(this.finalize(n),!0):(this.state={...this.state,_tag:"Closing",exit:n},!0)}done(n){return he(()=>this.unsafeDone(n))}takeN(n){return Ne(()=>{if(this.state._tag==="Done")return lS(this.state.exit,p$);if(n<=0)return fe([cu,!1]);n=Math.min(n,this.capacity);let r;if(n<=this.messagesChunk.length)r=Jd(this.messagesChunk,n),this.messagesChunk=Ai(this.messagesChunk,n);else if(n<=this.messages.length+this.messagesChunk.length)this.messagesChunk=pn(this.messagesChunk,Bn(this.messages)),this.messages=[],r=Jd(this.messagesChunk,n),this.messagesChunk=Ai(this.messagesChunk,n);else return Nt(this.awaitTake,this.takeN(n));return fe([r,this.releaseCapacity()])})}unsafeTake(){if(this.state._tag==="Done")return wU(this.state.exit,Np(new lw));let n;if(this.messagesChunk.length>0)n=S0(this.messagesChunk),this.messagesChunk=Ai(this.messagesChunk,1);else if(this.messages.length>0)n=this.messages[0],this.messagesChunk=Ai(Bn(this.messages),1),this.messages=[];else return this.capacity<=0&&this.state.offers.size>0?(this.capacity=1,this.releaseCapacity(),this.capacity=0,this.messages.length>0?Pt(this.messages.pop()):void 0):void 0;return this.releaseCapacity(),Pt(n)}unsafeSize(){const n=this.messages.length+this.messagesChunk.length;return this.state._tag==="Done"?me():pe(n)}commit(){return this.takeAll}pipe(){return xe(this,arguments)}toJSON(){return{_id:"effect/Mailbox",state:this.state._tag,size:this.unsafeSize().toJSON()}}toString(){return hn(this)}[(gj=DC,mj=m$,Gt)](){return hn(this)}offerRemainingSingle(n){return Vc(r=>{if(this.state._tag!=="Open")return r(Qb);const i={_tag:"Single",message:n,resume:r};return this.state.offers.add(i),he(()=>{this.state._tag==="Open"&&this.state.offers.delete(i)})})}offerRemainingArray(n){return Vc(r=>{if(this.state._tag!=="Open")return r(Pt(Bn(n)));const i={_tag:"Array",remaining:n,offset:0,resume:r};return this.state.offers.add(i),he(()=>{this.state._tag==="Open"&&this.state.offers.delete(i)})})}releaseCapacity(){if(this.state._tag==="Done")return this.state.exit._tag==="Success";if(this.state.offers.size===0)return this.state._tag==="Closing"&&this.messages.length===0&&this.messagesChunk.length===0?(this.finalize(this.state.exit),this.state.exit._tag==="Success"):!1;let n=this.capacity-this.messages.length-this.messagesChunk.length;for(const r of this.state.offers){if(n===0)return!1;if(r._tag==="Single")this.messages.push(r.message),n--,r.resume(Yb),this.state.offers.delete(r);else{for(;r.offset<r.remaining.length;r.offset++){if(n===0)return!1;this.messages.push(r.remaining[r.offset]),n--}r.resume(g$),this.state.offers.delete(r)}}return!1}scheduleReleaseTaker(){this.scheduleRunning||(this.scheduleRunning=!0,this.scheduler.scheduleTask(this.releaseTaker,0))}unsafeTakeAll(){if(this.messagesChunk.length>0){const n=this.messages.length>0?pn(this.messagesChunk,Bn(this.messages)):this.messagesChunk;return this.messagesChunk=cu,this.messages=[],n}else if(this.messages.length>0){const n=Bn(this.messages);return this.messages=[],n}else if(this.state._tag!=="Done"&&this.state.offers.size>0)return this.capacity=1,this.releaseCapacity(),this.capacity=0,Sn(this.messages.pop());return cu}finalize(n){if(this.state._tag==="Done")return;const r=this.state;this.state={_tag:"Done",exit:n};for(const i of r.takers)i(n);r.takers.clear();for(const i of r.awaiters)i(n);r.awaiters.clear()}}const Aue=e=>yt(t=>fe(new Cue(t.currentScheduler,typeof e=="number"?e:(e==null?void 0:e.capacity)??Number.POSITIVE_INFINITY,typeof e=="number"?"suspend":(e==null?void 0:e.strategy)??"suspend"))),Rue=e=>{const t=$t(e.takeAll,([n,r])=>r?n.length===0?ws:Qt(n):J_(Qt(n),t));return t},xue=DC,Oue=e=>Ae(e,xue),Due=Aue,que=Rue,Nue=Symbol.for("@effect/matcher/Matcher"),$ue={[Nue]:{_input:Ie,_filters:Ie,_result:Ie,_return:Ie},_tag:"ValueMatcher",add(e){return this.value._tag==="Right"?this:e._tag==="When"&&e.guard(this.provided)===!0?qC(this.provided,He(e.evaluate(this.provided))):e._tag==="Not"&&e.guard(this.provided)===!1?qC(this.provided,He(e.evaluate(this.provided))):this},pipe(){return xe(this,arguments)}};function qC(e,t){const n=Object.create($ue);return n.provided=e,n.value=t,n}const n5=(e,t)=>({_tag:"When",guard:e,evaluate:t}),NC=e=>{if(typeof e=="function")return e;if(Array.isArray(e)){const t=e.map(NC),n=t.length;return r=>{if(!Array.isArray(r))return!1;for(let i=0;i<n;i++)if(t[i](r[i])===!1)return!1;return!0}}else if(e!==null&&typeof e=="object"){const t=Object.entries(e).map(([r,i])=>[r,NC(i)]),n=t.length;return r=>{if(typeof r!="object"||r===null)return!1;for(let i=0;i<n;i++){const[c,f]=t[i];if(!(c in r)||f(r[c])===!1)return!1}return!0}}return t=>t===e},Iue=e=>qC(e,Ue(e)),Mue=(e,t)=>n=>n.add(n5(NC(e),t)),jue=e=>(...t)=>{const n=t[t.length-1],r=t.slice(0,-1),i=r.length===1?c=>c[e]===r[0]:c=>r.includes(c[e]);return c=>c.add(n5(i,n))},Fue=jue("_tag"),Lue=e=>{if(e._tag==="ValueMatcher")return e.value;const t=e.cases.length;if(t===1){const n=e.cases[0];return r=>n._tag==="When"&&n.guard(r)===!0||n._tag==="Not"&&n.guard(r)===!1?He(n.evaluate(r)):Ue(r)}return n=>{for(let r=0;r<t;r++){const i=e.cases[r];if(i._tag==="When"&&i.guard(n)===!0)return He(i.evaluate(n));if(i._tag==="Not"&&i.guard(n)===!1)return He(i.evaluate(n))}return Ue(n)}},_$="effect/Match/exhaustive: absurd",Uue=e=>{const t=Lue(e);if(rF(t)){if(t._tag==="Right")return t.right;throw new Error(_$)}return n=>{const r=t(n);if(r._tag==="Right")return r.right;throw new Error(_$)}},r5=Iue,YT=Mue,WT=Fue,s5=Uue,zue=mue,Pue=gue,Hue=nce,Bue=wd,Vue=D(e=>Hi(e[0]),(e,...t)=>{const n={};for(const r of t)r in e&&(n[r]=e[r]);return n}),Gue=D(e=>Hi(e[0]),(e,...t)=>{const n={...e};for(const r of t)delete n[r];return n}),vh=Symbol.for("effect/Schema");function Vt(e){var t,n,r;return n=vh,t=vh,r=class{constructor(){y(this,n,$C)}static annotations(c){return Vt(ci(this.ast,c))}static pipe(){return xe(this,arguments)}static toString(){return String(e)}},y(r,"ast",e),y(r,"Type"),y(r,"Encoded"),y(r,"Context"),y(r,t,$C),r}const $C={_A:e=>e,_I:e=>e,_R:e=>e},y$={schemaId:LV,message:kF,missingMessage:xA,identifier:OA,title:Bi,description:m_,examples:CF,default:AF,documentation:UV,jsonSchema:RF,arbitrary:xF,pretty:OF,equivalence:DA,concurrency:DF,batching:qF,parseIssueTitle:NF,parseOptions:$F,decodingFallback:IF},wl=e=>{if(!e)return{};const t={...e};for(const n in y$)if(n in e){const r=y$[n];t[r]=e[n],delete t[n]}return t},ci=(e,t)=>Nu(e,wl(t));const um=e=>String(e.ast),Nw=e=>Vt(_k(e.ast)),Pi=e=>Vt(Dn(e.ast)),rx=(e,t)=>{const n=yf(e,t);return(r,i)=>op(n(r,i),cm)},Kue=(e,t)=>{const n=Qle(e,t);return(r,i)=>d_(n(r,i),cm)},sx=rx,Que=Kue,Tv=(e,t)=>{const n=lm(e,t);return(r,i)=>op(n(r,i),cm)},Yue=(e,t)=>{const n=Kle(e,t);return(r,i)=>d_(n(r,i),cm)},Gg=Tv,fm=Yue,Wue=(e,t)=>{const n=Wle(e,t);return(r,i)=>d_(n(r,i),cm)},si=e=>Ae(e,vh)&&Hi(e[vh]);function Jue(e){return NA(e)?Er.make(p9(e,t=>new jS(t))):new jS(e[0])}function a5(e,t=Jue(e)){var n;return n=class extends Vt(t){static annotations(i){return a5(this.literals,ci(this.ast,i))}},y(n,"literals",[...e]),n}function qe(...e){return bn(e)?a5(e):$w}const Xue=e=>Vt(new UF(e)),Zue=(e,t,n)=>ax(e,new u0(e.map(r=>r.ast),(...r)=>t.decode(...r.map(Vt)),(...r)=>t.encode(...r.map(Vt)),wl(n))),efe=(e,t)=>{const n=()=>(i,c,f)=>e(i)?ti(i):fl(new Zn(f,i)),r=n;return ax([],new u0([],n,r,wl(t)))};function ax(e,t){var n;return n=class extends Vt(t){static annotations(i){return ax(this.typeParameters,ci(this.ast,i))}},y(n,"typeParameters",[...e]),n}const bf=function(){if(Array.isArray(arguments[0])){const n=arguments[0],r=arguments[1],i=arguments[2];return Zue(n,r,i)}const e=arguments[0],t=arguments[1];return efe(e,t)},b$=Symbol.for("effect/SchemaId/Brand"),i5=(e,t)=>n=>lx(n,new __(n.ast,function(c,f,m){const g=e.either(c);return vr(g)?pe(new Zn(m,c,g.left.map(b=>b.message).join(", "))):me()},wl({schemaId:b$,[b$]:{constructor:e},...t})));class o5 extends Vt(Wd){}class Oi extends Vt(r9){}class Gs extends Vt(e9){}class $w extends Vt(f0){}class IC extends Vt(zF){}class sr extends Vt(PF){}class W extends Vt(dk){}class dt extends Vt(mk){}class Po extends Vt(gk){}const tfe=e=>Er.make(e.map(t=>t.ast));function c5(e,t=tfe(e)){var n;return n=class extends Vt(t){static annotations(i){return c5(this.members,ci(this.ast,i))}},y(n,"members",[...e]),n}function ze(...e){return NA(e)?c5(e):bn(e)?e[0]:$w}const l5=e=>ze(e,Gs),wh=e=>ze(e,o5),nfe=(e,t)=>new p_(e.map(n=>si(n)?new gl(n.ast,!1):n.ast),t.map(n=>si(n)?new g_(n.ast):n.ast),!0);function kv(e,t,n=nfe(e,t)){var r;return r=class extends Vt(n){static annotations(c){return kv(this.elements,this.rest,ci(this.ast,c))}},y(r,"elements",[...e]),y(r,"rest",[...t]),r}function u5(...e){return Array.isArray(e[0])?kv(e[0],e.slice(1)):kv(e,[])}function f5(e,t){var n;return n=class extends kv([],[e],t){static annotations(i){return f5(this.value,ci(this.ast,i))}},y(n,"value",e),n}const gt=e=>f5(e),MC=e=>e?'"?:"':'":"';class Iw extends gl{constructor(n,r,i,c,f){super(n,r,c);y(this,"isReadonly");y(this,"defaultValue");y(this,"_tag","PropertySignatureDeclaration");this.isReadonly=i,this.defaultValue=f}toString(){const n=MC(this.isOptional),r=String(this.type);return`PropertySignature<${n}, ${r}, never, ${n}, ${r}>`}}class rfe extends gl{constructor(n,r,i,c,f){super(n,r,c);y(this,"isReadonly");y(this,"fromKey");this.isReadonly=i,this.fromKey=f}}class Cv extends gl{constructor(n,r,i,c,f){super(n,r,c);y(this,"isReadonly");y(this,"defaultValue");this.isReadonly=i,this.defaultValue=f}}const sfe=e=>e===void 0?"never":Es(e)?JSON.stringify(e):String(e);class Av{constructor(t,n,r,i){y(this,"from");y(this,"to");y(this,"decode");y(this,"encode");y(this,"_tag","PropertySignatureTransformation");this.from=t,this.to=n,this.decode=r,this.encode=i}toString(){return`PropertySignature<${MC(this.to.isOptional)}, ${this.to.type}, ${sfe(this.from.fromKey)}, ${MC(this.from.isOptional)}, ${this.from.type}>`}}const d5=(e,t)=>{switch(e._tag){case"PropertySignatureDeclaration":return new Iw(e.type,e.isOptional,e.isReadonly,{...e.annotations,...t},e.defaultValue);case"PropertySignatureTransformation":return new Av(e.from,new Cv(e.to.type,e.to.isOptional,e.to.isReadonly,{...e.to.annotations,...t},e.to.defaultValue),e.decode,e.encode)}},h5=Symbol.for("effect/PropertySignature"),ix=e=>Ae(e,h5);var pj,_j;_j=vh,pj=h5;const Wx=class Wx{constructor(t){y(this,"ast");y(this,_j);y(this,pj,null);y(this,"_TypeToken");y(this,"_Key");y(this,"_EncodedToken");y(this,"_HasDefault");this.ast=t}pipe(){return xe(this,arguments)}annotations(t){return new Wx(d5(this.ast,wl(t)))}toString(){return String(this.ast)}};let Rv=Wx;const xv=e=>new Rv(e);class Mw extends Rv{constructor(n,r){super(n);y(this,"from");this.from=r}annotations(n){return new Mw(d5(this.ast,wl(n)),this.from)}}const m5=e=>new Mw(new Iw(e.ast,!1,!0,{},void 0),e),ox=D(2,(e,t)=>{const n=e.ast;switch(n._tag){case"PropertySignatureDeclaration":return xv(new Iw(n.type,n.isOptional,n.isReadonly,n.annotations,t));case"PropertySignatureTransformation":return xv(new Av(n.from,new Cv(n.to.type,n.to.isOptional,n.to.isReadonly,n.to.annotations,t),n.decode,n.encode))}}),S$=(e,t)=>Bt(e,{onNone:()=>pe(t()),onSome:n=>pe(n===void 0?t():n)}),Ov=e=>x9(e,Ov,t=>{const n=Ov(t.to);if(n)return new Ea(t.from,n,t.transformation)}),afe=D(2,(e,t)=>{const n=e.ast;switch(n._tag){case"PropertySignatureDeclaration":{const r=Dn(n.type);return xv(new Av(new rfe(n.type,n.isOptional,n.isReadonly,n.annotations),new Cv(Ov(r)??r,!1,!0,{},n.defaultValue),i=>S$(i,t),Ie))}case"PropertySignatureTransformation":{const r=n.to.type;return xv(new Av(n.from,new Cv(Ov(r)??r,!1,n.to.isReadonly,n.to.annotations,n.to.defaultValue),i=>S$(n.decode(i),t),n.encode))}}}),g5=D(2,(e,t)=>e.pipe(afe(t.decoding),ox(t.constructor))),tt=e=>{const t=e.ast===Wd||e.ast===f0?Wd:wh(e).ast;return new Mw(new Iw(t,!0,!0,{},void 0),e)},ife=WF([xA]),ofe=(e,t)=>{const n=Za(e),r=[];if(n.length>0){const c=[],f=[],m=[];for(let g=0;g<n.length;g++){const b=n[g],S=e[b];if(ix(S)){const v=S.ast;switch(v._tag){case"PropertySignatureDeclaration":{const q=v.type,k=v.isOptional,N=v.annotations;c.push(new On(b,q,k,!0,ife(v))),f.push(new On(b,Dn(q),k,!0,N)),r.push(new On(b,q,k,!0,N));break}case"PropertySignatureTransformation":{const q=v.from.fromKey??b;c.push(new On(q,v.from.type,v.from.isOptional,!0,v.from.annotations)),f.push(new On(b,v.to.type,v.to.isOptional,!0,v.to.annotations)),m.push(new S9(q,b,v.decode,v.encode));break}}}else c.push(new On(b,S.ast,!1,!0)),f.push(new On(b,Dn(S.ast),!1,!0)),r.push(new On(b,S.ast,!1,!0))}if(bn(m)){const g=[],b=[];for(const S of t){const{indexSignatures:v,propertySignatures:q}=dq(S.key.ast,S.value.ast);q.forEach(k=>{c.push(k),f.push(new On(k.name,Dn(k.type),k.isOptional,k.isReadonly,k.annotations))}),v.forEach(k=>{g.push(k),b.push(new Nh(k.parameter,Dn(k.type),k.isReadonly))})}return new Ea(new Ra(c,g,{[Nd]:"Struct (Encoded side)"}),new Ra(f,b,{[Nd]:"Struct (Type side)"}),new FS(m))}}const i=[];for(const c of t){const{indexSignatures:f,propertySignatures:m}=dq(c.key.ast,c.value.ast);m.forEach(g=>r.push(g)),f.forEach(g=>i.push(g))}return new Ra(r,i)},p5=(e,t)=>{const n=Za(e);for(const r of n){const i=e[r];if(t[r]===void 0&&ix(i)){const c=i.ast,f=c._tag==="PropertySignatureDeclaration"?c.defaultValue:c.to.defaultValue;f!==void 0&&(t[r]=f())}}return t};function cx(e,t,n=ofe(e,t)){var r;return r=class extends Vt(n){static annotations(c){return cx(this.fields,this.records,ci(this.ast,c))}static pick(...c){return ve(Vue(e,...c))}static omit(...c){return ve(Gue(e,...c))}},y(r,"fields",{...e}),y(r,"records",[...t]),y(r,"make",(c,f)=>{const m=p5(e,{...c});return Fw(f)?m:qw(r)(m)}),r}function ve(e,...t){return cx(e,t)}const cfe=e=>qe(e).pipe(m5,ox(()=>e)),ht=(e,t)=>ve({_tag:cfe(e),...t});function _5(e,t,n){var r;return r=class extends cx({},[{key:e,value:t}],n){static annotations(c){return _5(e,t,ci(this.ast,c))}},y(r,"key",e),y(r,"value",t),r}const dm=e=>_5(e.key,e.value),Kp=(...e)=>t=>Vt(wo(t.ast,e)),Qp=D(2,(e,t)=>{const n=uu(Dn(e.ast),t),r=Vt(n.isOptional?iS(n.type):n.type);return $a(e.pipe(Kp(t)),r,{strict:!0,decode:c=>c[t],encode:c=>n.isOptional&&c===void 0?{}:{[t]:c}})});function lx(e,t){var n;return n=class extends Vt(t){static annotations(i){return lx(this.from,ci(this.ast,i))}},y(n,"make",(i,c)=>Fw(c)?i:qw(n)(i)),y(n,"from",e),n}const lfe=(e,t)=>n=>{const r=Bt(MF(n.ast),{onNone:()=>[e],onSome:c=>[...c,e]}),i=Nu(n.ast,wl({[TF]:r,...t}));return lx(n,i)},Dv=e=>Vt(Ug(e.ast)),y5=e=>Vt(Sd(e.ast)),qg=(e,t,n)=>{if(fq(e)&&fq(t)){const r=[...e.propertySignatures];for(const i of t.propertySignatures){const c=i.name,f=r.findIndex(m=>m.name===c);if(f===-1)r.push(i);else{const{isOptional:m,type:g}=r[f];r[f]=new On(c,qv(g,i.type,n.concat(c)),m,!0)}}return new Ra(r,e.indexSignatures.concat(t.indexSignatures))}throw new Error(wF(e,t,n))},ufe=k9([OA]),Ng=(e,t)=>t.map(n=>new __(n,e.filter,ufe(e))),qv=(e,t,n)=>Er.make(Eo([e],[t],n)),tu=e=>$A(e)?e.types:[e],Eo=(e,t,n)=>$S(e,r=>$S(t,i=>{switch(i._tag){case"Literal":{if(Es(i.literal)&&hk(r)||Mo(i.literal)&&cq(r)||Ru(i.literal)&&lq(r))return[i];break}case"StringKeyword":{if(i===dk){if(hk(r)||np(r)&&Es(r.literal))return[r];if($d(r))return Ng(r,Eo(tu(r.from),[i],n))}else if(r===dk)return[i];break}case"NumberKeyword":{if(i===mk){if(cq(r)||np(r)&&Mo(r.literal))return[r];if($d(r))return Ng(r,Eo(tu(r.from),[i],n))}else if(r===mk)return[i];break}case"BooleanKeyword":{if(i===gk){if(lq(r)||np(r)&&Ru(r.literal))return[r];if($d(r))return Ng(r,Eo(tu(r.from),[i],n))}else if(r===gk)return[i];break}case"Union":return Eo(tu(r),i.types,n);case"Suspend":return[new qu(()=>qv(r,i.f(),n))];case"Refinement":return Ng(i,Eo(tu(r),tu(i.from),n));case"TypeLiteral":{switch(r._tag){case"Union":return Eo(r.types,[i],n);case"Suspend":return[new qu(()=>qv(r.f(),i,n))];case"Refinement":return Ng(r,Eo(tu(r.from),[i],n));case"TypeLiteral":return[qg(r,i,n)];case"Transformation":{const c=r.transformation,f=qg(r.from,i,n),m=qg(r.to,Dn(i),n);switch(c._tag){case"TypeLiteralTransformation":return[new Ea(f,m,new FS(c.propertySignatureTransformations))];case"ComposeTransformation":return[new Ea(f,m,IA)];case"FinalTransformation":return[new Ea(f,m,new VF((g,b,S,v)=>ps(c.decode(g,b,S,v),q=>({...g,...q})),(g,b,S,v)=>ps(c.encode(g,b,S,v),q=>({...g,...q}))))]}}}break}case"Transformation":{if(_9(r)){if(pk(i.transformation)&&pk(r.transformation))return[new Ea(qg(r.from,i.from,n),qg(r.to,i.to,n),new FS(i.transformation.propertySignatureTransformations.concat(r.transformation.propertySignatureTransformations)))]}else return Eo([i],[r],n);break}}throw new Error(wF(r,i,n))})),b5=D(2,(e,t)=>Vt(qv(e.ast,t.ast,[]))),ffe=D(e=>si(e[1]),(e,t)=>fx(e,t,A9(e.ast,t.ast))),Yp=e=>Vt(new qu(()=>e().ast)),S5=Symbol.for("effect/SchemaId/Refine");function v5(e,t,n){var r,i,c;return c=class extends(i=Vt(n),r=S5,i){static annotations(m){return v5(this.from,this.filter,ci(this.ast,m))}},y(c,r,e),y(c,"from",e),y(c,"filter",t),y(c,"make",(m,g)=>Fw(g)?m:qw(c)(m)),c}const v$=(e,t,n)=>{if(Ru(e))return e?me():pe(new Zn(t,n));if(Es(e))return pe(new Zn(t,n,e));if(e!==void 0){if("_tag"in e)return pe(e);const r=new Zn(t,n,e.message);return pe(bn(e.path)?new Lr(e.path,n,r):r)}return me()},dfe=(e,t,n)=>{if(OV(e))return v$(e,t,n);if(bn(e)){const r=gF(e,i=>v$(i,t,n));if(bn(r))return pe(r.length===1?r[0]:new zn(t,n,r))}return me()};function ux(e,t){return n=>{function r(c,f,m){return dfe(e(c,f,m),m,c)}const i=new __(n.ast,r,wl(t));return v5(n,r,i)}}function fx(e,t,n){var r;return r=class extends Vt(n){static annotations(c){return fx(this.from,this.to,ci(this.ast,c))}},y(r,"from",e),y(r,"to",t),r}const dl=D(e=>si(e[0])&&si(e[1]),(e,t,n)=>fx(e,t,new Ea(e.ast,t.ast,new VF(n.decode,n.encode)))),$a=D(e=>si(e[0])&&si(e[1]),(e,t,n)=>dl(e,t,{strict:!0,decode:(r,i,c,f)=>ti(n.decode(r,f)),encode:(r,i,c,f)=>ti(n.encode(r,f))})),hfe=D(2,(e,t)=>e.annotations(t)),w$=e=>e instanceof Error?e.message:String(e),mfe=e=>dl(W.annotations({description:"a string to be decoded into JSON"}),IC,{strict:!0,decode:(t,n,r)=>u$({try:()=>JSON.parse(t,e==null?void 0:e.reviver),catch:i=>new Zn(r,t,w$(i))}),encode:(t,n,r)=>u$({try:()=>JSON.stringify(t,e==null?void 0:e.replacer,e==null?void 0:e.space),catch:i=>new Zn(r,t,w$(i))})}).annotations({title:"parseJson",schemaId:ZV}),Eh=(e,t)=>si(e)?ffe(Eh(t),e):mfe(e),gfe=jV,pfe=e=>t=>t.pipe(ux(n=>Number.isSafeInteger(n),{schemaId:gfe,title:"int",description:"an integer",jsonSchema:{type:"integer"},...e})),_fe=FV,yfe=(e,t,n)=>r=>r.pipe(ux(i=>i>=e&&i<=t,{schemaId:_fe,title:`between(${e}, ${t})`,description:`a number between ${e} and ${t}`,jsonSchema:{minimum:e,maximum:t},...n}));class Nv extends dt.pipe(pfe({identifier:"Int"})){}const dx=(e,t,n,r)=>Gle(e,{onFailure:i=>new zn(n,r,i),onSuccess:t});class jw extends bf(s7,{identifier:"Uint8ArrayFromSelf",pretty:()=>t=>`new Uint8Array(${JSON.stringify(Array.from(t))})`,arbitrary:()=>t=>t.uint8Array(),equivalence:()=>h_(Ge)}){}class bfe extends dt.pipe(yfe(0,255,{identifier:"Uint8",description:"a 8-bit unsigned integer"})){}class w5 extends $a(gt(bfe).annotations({description:"an array of 8-bit unsigned integers to be decoded into a Uint8Array"}),jw,{strict:!0,decode:t=>Uint8Array.from(t),encode:t=>Array.from(t)}).annotations({identifier:"Uint8Array"}){}const Sfe=(e,t,n)=>dl(W.annotations({description:"a string to be decoded into a Uint8Array"}),jw,{strict:!0,decode:(r,i,c)=>d_(t(r),f=>new Zn(c,r,f.message)),encode:r=>ti(n(r))}).annotations({identifier:e}),vfe=Sfe("Uint8ArrayFromBase64",wle,vle),wfe=e=>Vt(aS(e.ast)),Kg=D(e=>si(e[0]),(e,t)=>dl(e,wfe(Pi(e)),{strict:!0,decode:(n,r,i)=>n.length>0?ti(n[0]):t?ti(t()):fl(new Zn(i,n,"Unable to retrieve the first element of an empty array")),encode:n=>ti(pa(n))})),E$=Symbol.for("effect/SchemaId/ValidDate"),Efe=e=>t=>t.pipe(ux(n=>!Number.isNaN(n.getTime()),{schemaId:E$,[E$]:{noInvalidDate:!0},title:"validDate",description:"a valid Date",...e})),T$=MV;class hx extends bf(Fj,{identifier:"DateFromSelf",schemaId:T$,[T$]:{noInvalidDate:!1},description:"a potentially invalid Date instance",pretty:()=>t=>`new Date(${JSON.stringify(t)})`,arbitrary:()=>t=>t.date({noInvalidDate:!1}),equivalence:()=>JB}){}class Tfe extends $a(W.annotations({description:"a string to be decoded into a Date"}),hx,{strict:!0,decode:t=>new Date(t),encode:t=>yF(t)}).annotations({identifier:"DateFromString"}){}class Wn extends Tfe.pipe(Efe({identifier:"Date"})){}class Sr extends $a(dt.annotations({description:"a number to be decoded into a Date"}),hx,{strict:!0,decode:t=>new Date(t),encode:t=>t.getTime()}).annotations({identifier:"DateFromNumber"}){}const kfe=ve({_tag:qe("None")}).annotations({description:"NoneEncoded"}),Cfe=e=>ve({_tag:qe("Some"),value:e}).annotations({description:`SomeEncoded<${um(e)}>`}),Afe=e=>ze(kfe,Cfe(e)).annotations({description:`OptionEncoded<${um(e)}>`}),E5=e=>e._tag==="None"?me():pe(e.value),Rfe=(e,t)=>n=>n.oneof(t,n.record({_tag:n.constant("None")}),n.record({_tag:n.constant("Some"),value:e(n)})).map(E5),xfe=e=>Bt({onNone:()=>"none()",onSome:t=>`some(${e(t)})`}),k$=e=>(t,n,r)=>B7(t)?_n(t)?ti(me()):dx(e(t.value,n),pe,r,t):fl(new Zn(r,t)),Ofe=e=>bf([e],{decode:t=>k$(lm(t)),encode:t=>k$(yf(t))},{description:`Option<${um(e)}>`,pretty:xfe,arbitrary:Rfe,equivalence:Y7}),Dfe={_tag:"None"},qfe=e=>({_tag:"Some",value:e});function up(e){const t=e;return $a(Afe(t),Ofe(Pi(t)),{strict:!0,decode:r=>E5(r),encode:r=>Bt(r,{onNone:()=>Dfe,onSome:qfe})})}const Nfe=(e,t)=>n=>{const r=n.array(e(n));return(t.depthIdentifier!==void 0?n.oneof(t,n.constant([]),r):r).map(i=>new Set(i))},$fe=e=>t=>`new Set([${Array.from(t.values()).map(n=>e(n)).join(", ")}])`,Ife=e=>{const t=h_(e);return Jc((n,r)=>t(Array.from(n.values()),Array.from(r.values())))},C$=e=>(t,n,r)=>e7(t)?dx(e(Array.from(t.values()),n),i=>new Set(i),r,t):fl(new Zn(r,t)),Mfe=(e,t)=>bf([e],{decode:n=>C$(lm(gt(n))),encode:n=>C$(yf(gt(n)))},{description:t,pretty:$fe,arbitrary:Nfe,equivalence:Ife}),jfe=e=>Mfe(e,`ReadonlySet<${um(e)}>`);function mx(e){return $a(gt(e),jfe(Pi(e)),{strict:!0,decode:t=>new Set(t),encode:t=>Array.from(t)})}const Ffe=e=>si(e)||ix(e),T5=e=>Za(e).every(t=>Ffe(e[t])),gx=e=>"fields"in e?e.fields:gx(e[S5]),px=e=>T5(e)?ve(e):si(e)?e:ve(gx(e)),_x=e=>T5(e)?e:gx(e),Sf=e=>(t,n)=>Vd({kind:"Class",identifier:e,schema:px(t),fields:_x(t),Base:Gne,annotations:n}),k5=e=>ox(m5(qe(e)),()=>e),li=e=>(t,n,r)=>{class i extends p4{}i.prototype.name=t;const c=_x(n),f=px(n),m={_tag:k5(t)},g=fp(m,c),b="message"in g;class S extends Vd({kind:"TaggedError",identifier:t,schema:b5(f,ve(m)),fields:g,Base:i,annotations:r,disableToString:!0}){}return y(S,"_tag",t),b||Object.defineProperty(S.prototype,"message",{get(){return`{ ${Za(c).map(v=>`${RA(v)}: ${Aa(this[v])}`).join(", ")} }`},enumerable:!1,configurable:!0}),S},fp=(e,t)=>{const n={...e};for(const r of Za(t)){if(r in e)throw new Error(EF(r));n[r]=t[r]}return n};function Fw(e){return Ru(e)?e:(e==null?void 0:e.disableValidation)??!1}const A$=St("effect/Schema/astCache",()=>new WeakMap),Lfe=e=>e===void 0?[]:Array.isArray(e)?e:[e],Vd=({Base:e,annotations:t,disableToString:n,fields:r,identifier:i,kind:c,schema:f})=>{var $,R;const m=Symbol.for(`effect/Schema/${c}/${i}`),[g,b,S]=Lfe(t),v=Pi(f),q=v.annotations({identifier:i,...g}),k=v.annotations({[Nd]:`${i} (Type side)`,...g}),N=f.annotations({[Nd]:`${i} (Constructor)`,...g}),H=f.annotations({[Nd]:`${i} (Encoded side)`,...S}),x=f.annotations({[l0]:i,...S,...g,...b}),C=I=>Ae(I,m)&&rn(k)(I),E=(R=class extends e{constructor(I={},z=!1){I={...I},c!=="Class"&&delete I._tag,I=p5(r,I),Fw(z)||(I=qw(N)(I)),super(I,!0)}static get ast(){let I=A$.get(this);if(I)return I;const z=bf([f],{decode:()=>(V,K,Y)=>V instanceof this||C(V)?ti(V):fl(new Zn(Y,V)),encode:()=>(V,K)=>V instanceof this?ti(V):ps(yf(k)(V,K),Y=>new this(Y,!0))},{identifier:i,pretty:V=>K=>`${i}(${V(K)})`,arbitrary:V=>K=>V(K).map(Y=>new this(Y)),equivalence:Ie,[MS]:q.ast,...g});return I=$a(H,z,{strict:!0,decode:V=>new this(V,!0),encode:Ie}).annotations({[MS]:x.ast,...b}).ast,A$.set(this,I),I}static pipe(){return xe(this,arguments)}static annotations(I){return Vt(this.ast).annotations(I)}static toString(){return`(${String(H)} <-> ${i})`}static make(...I){return new this(...I)}static extend(I){return(z,V)=>{const K=_x(z),Y=px(z),P=fp(r,K);return Vd({kind:c,identifier:I,schema:b5(f,Y),fields:P,Base:this,annotations:V})}}static transformOrFail(I){return(z,V,K)=>{const Y=fp(r,z);return Vd({kind:c,identifier:I,schema:dl(f,Pi(ve(Y)),V),fields:Y,Base:this,annotations:K})}}static transformOrFailFrom(I){return(z,V,K)=>{const Y=fp(r,z);return Vd({kind:c,identifier:I,schema:dl(Nw(f),ve(Y),V),fields:Y,Base:this,annotations:K})}}get[($=vh,m)](){return m}},y(R,$,$C),y(R,"fields",{...r}),y(R,"identifier",i),R);return n!==!0&&Object.defineProperty(E.prototype,"toString",{value(){return`${i}({ ${Za(r).map(I=>`${RA(I)}: ${Aa(this[I])}`).join(", ")} })`},configurable:!0,writable:!0}),E},Ufe=ve({_tag:qe("None")}).annotations({identifier:"FiberIdNoneEncoded"}),zfe=ve({_tag:qe("Runtime"),id:Nv,startTimeMillis:Nv}).annotations({identifier:"FiberIdRuntimeEncoded"}),Pfe=ve({_tag:qe("Composite"),left:Yp(()=>jC),right:Yp(()=>jC)}).annotations({identifier:"FiberIdCompositeEncoded"}),jC=ze(Ufe,zfe,Pfe).annotations({identifier:"FiberIdEncoded"}),Hfe=e=>e.letrec(t=>({None:e.record({_tag:e.constant("None")}),Runtime:e.record({_tag:e.constant("Runtime"),id:e.integer(),startTimeMillis:e.integer()}),Composite:e.record({_tag:e.constant("Composite"),left:t("FiberId"),right:t("FiberId")}),FiberId:e.oneof(t("None"),t("Runtime"),t("Composite"))})).FiberId.map($v),FC=e=>{switch(e._tag){case"None":return"FiberId.none";case"Runtime":return`FiberId.runtime(${e.id}, ${e.startTimeMillis})`;case"Composite":return`FiberId.composite(${FC(e.right)}, ${FC(e.left)})`}},$v=e=>{switch(e._tag){case"None":return Oa;case"Runtime":return dK(e.id,e.startTimeMillis);case"Composite":return hK($v(e.left),$v(e.right))}},Bfe=e=>ve({_tag:qe("Die"),defect:e}),Vfe=ve({_tag:qe("Empty")}),Gfe=e=>ve({_tag:qe("Fail"),error:e}),Kfe=ve({_tag:qe("Interrupt"),fiberId:jC});let Qfe=0;const LC=(e,t)=>{const n=e,r=t,i=Yp(()=>c),c=ze(Vfe,Gfe(n),Bfe(r),Kfe,ve({_tag:qe("Sequential"),left:i,right:i}),ve({_tag:qe("Parallel"),left:i,right:i})).annotations({title:`CauseEncoded<${um(e)}>`,[l0]:`CauseEncoded${Qfe++}`});return c},Yfe=(e,t)=>n=>n.letrec(r=>({Empty:n.record({_tag:n.constant("Empty")}),Fail:n.record({_tag:n.constant("Fail"),error:e(n)}),Die:n.record({_tag:n.constant("Die"),defect:t(n)}),Interrupt:n.record({_tag:n.constant("Interrupt"),fiberId:Hfe(n)}),Sequential:n.record({_tag:n.constant("Sequential"),left:r("Cause"),right:r("Cause")}),Parallel:n.record({_tag:n.constant("Parallel"),left:r("Cause"),right:r("Cause")}),Cause:n.oneof(r("Empty"),r("Fail"),r("Die"),r("Interrupt"),r("Sequential"),r("Parallel"))})).Cause.map(mu),Wfe=e=>t=>{const n=r=>{switch(r._tag){case"Empty":return"Cause.empty";case"Fail":return`Cause.fail(${e(r.error)})`;case"Die":return`Cause.die(${zp(r)})`;case"Interrupt":return`Cause.interrupt(${FC(r.fiberId)})`;case"Sequential":return`Cause.sequential(${n(r.left)}, ${n(r.right)})`;case"Parallel":return`Cause.parallel(${n(r.left)}, ${n(r.right)})`}};return n(t)},R$=e=>(t,n,r)=>fne(t)?dx(e(qd(t),n),mu,r,t):fl(new Zn(r,t)),Jfe=({defect:e,error:t})=>bf([t,e],{decode:(n,r)=>R$(lm(LC(n,r))),encode:(n,r)=>R$(yf(LC(n,r)))},{title:`Cause<${t.ast}>`,pretty:Wfe,arbitrary:Yfe});function mu(e){switch(e._tag){case"Empty":return cne;case"Fail":return ol(e.error);case"Die":return Qu(e.defect);case"Interrupt":return ow($v(e.fiberId));case"Sequential":return une(mu(e.left),mu(e.right));case"Parallel":return lne(mu(e.left),mu(e.right))}}function qd(e){switch(e._tag){case"Empty":return{_tag:"Empty"};case"Fail":return{_tag:"Fail",error:e.error};case"Die":return{_tag:"Die",defect:e.defect};case"Interrupt":return{_tag:"Interrupt",fiberId:e.fiberId};case"Sequential":return{_tag:"Sequential",left:qd(e.left),right:qd(e.right)};case"Parallel":return{_tag:"Parallel",left:qd(e.left),right:qd(e.right)}}}const Xfe=({defect:e,error:t})=>{const n=t,r=e;return $a(LC(n,r),Jfe({error:Pi(n),defect:Pi(r)}),{strict:!1,decode:c=>mu(c),encode:c=>qd(c)})};class Th extends $a(IC,IC,{strict:!0,decode:t=>{if(Hi(t)&&"message"in t&&typeof t.message=="string"){const n=new Error(t.message,{cause:t});return"name"in t&&typeof t.name=="string"&&(n.name=t.name),n.stack="stack"in t&&typeof t.stack=="string"?t.stack:"",n}return String(t)},encode:t=>t instanceof Error?{name:t.name,message:t.message}:nU(t)}).annotations({identifier:"Defect"}){}const C5=Symbol.for("effect/Schema/Serializable/symbol"),Zfe=e=>rx(e[C5])(e),yx=Symbol.for("effect/Schema/Serializable/symbolResult"),x$=e=>e[yx].failure,O$=e=>e[yx].success,hs=e=>(t,n,r)=>{var c;const i=fp({_tag:k5(t)},n.payload);return c=class extends Vd({kind:"TaggedRequest",identifier:t,schema:ve(i),fields:i,Base:Ese,annotations:r}){get[C5](){return this.constructor}get[yx](){return{failure:n.failure,success:n.success}}},y(c,"_tag",t),y(c,"success",n.success),y(c,"failure",n.failure),c},ede=e=>Va(e.ast,[]),tde=is(DA),Va=(e,t)=>{const n=tde(e);if(Zt(n))switch(e._tag){case"Declaration":return n.value(...e.typeParameters.map(r=>Va(r,t)));case"Refinement":return n.value(Va(e.from,t));default:return n.value()}switch(e._tag){case"NeverKeyword":throw new Error(DV(e,t));case"Transformation":return Va(e.to,t);case"Declaration":case"Literal":case"StringKeyword":case"TemplateLiteral":case"UniqueSymbol":case"SymbolKeyword":case"UnknownKeyword":case"AnyKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"UndefinedKeyword":case"VoidKeyword":case"Enums":case"ObjectKeyword":return Ge;case"Refinement":return Va(e.from,t);case"Suspend":{const r=AA(()=>Va(e.f(),t));return(i,c)=>r()(i,c)}case"TupleType":{const r=e.elements.map((c,f)=>Va(c.type,t.concat(f))),i=e.rest.map(c=>Va(c.type,t));return Jc((c,f)=>{const m=c.length;if(m!==f.length)return!1;let g=0;for(;g<Math.min(m,e.elements.length);g++)if(!r[g](c[g],f[g]))return!1;if(bn(i)){const[b,...S]=i;for(;g<m-S.length;g++)if(!b(c[g],f[g]))return!1;for(let v=0;v<S.length;v++)if(g+=v,!S[v](c[g],f[g]))return!1}return!0})}case"TypeLiteral":{if(e.propertySignatures.length===0&&e.indexSignatures.length===0)return Ge;const r=e.propertySignatures.map(c=>Va(c.type,t.concat(c.name))),i=e.indexSignatures.map(c=>Va(c.type,t));return Jc((c,f)=>{const m=Object.keys(c),g=Object.getOwnPropertySymbols(c);for(let v=0;v<r.length;v++){const q=e.propertySignatures[v],k=q.name,N=Object.prototype.hasOwnProperty.call(c,k),H=Object.prototype.hasOwnProperty.call(f,k);if(q.isOptional&&N!==H||N&&H&&!r[v](c[k],f[k]))return!1}let b,S;for(let v=0;v<i.length;v++){const q=e.indexSignatures[v],k=vp(q.parameter),N=qA(k);if(N){if(b=b||Object.getOwnPropertySymbols(f),g.length!==b.length)return!1}else if(S=S||Object.keys(f),m.length!==S.length)return!1;const H=N?g:m;for(let x=0;x<H.length;x++){const C=H[x];if(!Object.prototype.hasOwnProperty.call(f,C)||!i[v](c[C],f[C]))return!1}}return!0})}case"Union":{const r=Y6(e.types,!0),i=Za(r.keys),c=i.length;return Jc((f,m)=>{let g=[];if(c>0&&r0(f))for(let S=0;S<c;S++){const v=i[S],q=r.keys[v].buckets;if(Object.prototype.hasOwnProperty.call(f,v)){const k=String(f[v]);Object.prototype.hasOwnProperty.call(q,k)&&(g=g.concat(q[k]))}}r.otherwise.length>0&&(g=g.concat(r.otherwise));const b=g.map(S=>[Va(S,t),rn({ast:S})]);for(let S=0;S<b.length;S++){const[v,q]=b[S];if(q(f)&&q(m)&&v(f,m))return!0}return!1})}}},nde=q6,rde=Lce,Ho=Bce,A5=Vce,sde=Gce,hl=xw,ade=$6,R5=I6,nf=Gp,El=M6,ide=ele,x5=Ple,O5=nle,ode=rle,cde=sle,lde=ole,Vr=cle,ude=lle,D5=Z2,Iv=fle,$s=dle,fde=L6,dde=U6,hde=gle,Lw=ple,D$=Symbol.for("effect/Subscribable"),mde=D4,gde="effect/SubscriptionRef",pde=Symbol.for(gde),_de={_A:e=>e};var yj,bj,Sj,vj,wj,Ej;class yde extends(Ej=Gi,wj=il,vj=D$,Sj=nX,bj=mde,yj=pde,Ej){constructor(n,r,i){super();y(this,"ref");y(this,"pubsub");y(this,"semaphore");y(this,wj,il);y(this,vj,D$);y(this,Sj,jR);y(this,bj,q4);y(this,yj,_de);y(this,"get");this.ref=n,this.pubsub=r,this.semaphore=i,this.get=rp(this.ref)}commit(){return this.get}get changes(){return j(rp(this.ref),Xe(n=>Tt(I6(this.pubsub,{scoped:!0}),r=>zce(Zce(n),r))),this.semaphore.withPermits(1),U6)}modify(n){return this.modifyEffect(r=>Gn(n(r)))}modifyEffect(n){return j(rp(this.ref),Xe(n),Xe(([r,i])=>j(FR(this.ref,i),Io(r),v2(O2(this.pubsub,i)))),this.semaphore.withPermits(1))}}const bde=e=>j(dw([pP(),J0(e),gw(1)]),Tt(([t,n,r])=>new yde(n,t,r))),Sde=D(2,(e,t)=>j(FR(e.ref,t),v2(O2(e.pubsub,t)),e.semaphore.withPermits(1))),q5=bde,_S=Sde,bx=cce,vde=x6,N5=lce,wde=uce,Ede=e=>t=>$s(t,n=>Ke(()=>e(n))),$5=e=>t=>ide(t,n=>j(e(n),Tt(()=>n))),Tde=()=>vde([]),q$=(e,t)=>wde(e,n=>kA(n,t)),N$=e=>N5(e,[]),kde=(e,t,n)=>Hue(function*(){const r=yield*bx(e);if(r.length<t)return yield*Bue;{const i=r.splice(0,Math.min(n,r.length));return yield*N5(e,r),i}}),Cde=e=>bx(e),Ade=e=>bx(e).pipe(Tt(t=>t.length)),$$=D(2,(e,t)=>j(e.changes,Ho(t),Iv(1),lde,Tt(S0))),I$=Symbol.for("effect/Subscribable");var Tj,kj,Cj;class Rde extends(Cj=Gi,kj=I$,Tj=il,Cj){constructor(n,r){super();y(this,"get");y(this,"changes");y(this,kj,I$);y(this,Tj,il);this.get=n,this.changes=r}commit(){return this.get}}const Uw=e=>new Rde(e.get,e.changes);D(2,(e,t)=>Uw({get:Tt(e.get,t),changes:El(e.changes,t)}));D(2,(e,t)=>Uw({get:Xe(e.get,t),changes:x5(e.changes,t)}));Uw({get:d2,changes:ode});const xde=e=>`${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}:${e.getSeconds().toString().padStart(2,"0")}.${e.getMilliseconds().toString().padStart(3,"0")}`,Ode=e=>vue(Eue,Tue({formatDate:t=>`${xde(t)} ${e}`})),Dde={};var qde={};const Bo=()=>typeof process<"u"&&qde!==void 0||Dde!==void 0?!1:!!(typeof globalThis<"u"&&globalThis.__DEV__),I5=e=>{const t=e==null?void 0:e.toString();if(t!=="[object Object]")return t;try{return JSON.stringify(e,null,2)}catch(n){return console.log(e),"Error while printing error: "+n}},M$=(e,t)=>{try{return new e(t)}catch{return e(t)}},UC=e=>e!==void 0&&e.toLowerCase()!=="false"&&e.toLowerCase()!=="0",at=(e,...t)=>{if(console.error(e,...t),Bo())debugger;throw new Error(`This should never happen: ${e}`)};var Nde=typeof globalThis=="object"?globalThis:typeof self=="object"?self:typeof window=="object"?window:typeof global=="object"?global:{},gu="1.9.0",j$=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;function $de(e){var t=new Set([e]),n=new Set,r=e.match(j$);if(!r)return function(){return!1};var i={major:+r[1],minor:+r[2],patch:+r[3],prerelease:r[4]};if(i.prerelease!=null)return function(g){return g===e};function c(m){return n.add(m),!1}function f(m){return t.add(m),!0}return function(g){if(t.has(g))return!0;if(n.has(g))return!1;var b=g.match(j$);if(!b)return c(g);var S={major:+b[1],minor:+b[2],patch:+b[3],prerelease:b[4]};return S.prerelease!=null||i.major!==S.major?c(g):i.major===0?i.minor===S.minor&&i.patch<=S.patch?f(g):c(g):i.minor<=S.minor?f(g):c(g)}}var Ide=$de(gu),Mde=gu.split(".")[0],Wp=Symbol.for("opentelemetry.js.api."+Mde),Jp=Nde;function Sx(e,t,n,r){var i;r===void 0&&(r=!1);var c=Jp[Wp]=(i=Jp[Wp])!==null&&i!==void 0?i:{version:gu};if(!r&&c[e]){var f=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+e);return n.error(f.stack||f.message),!1}if(c.version!==gu){var f=new Error("@opentelemetry/api: Registration of version v"+c.version+" for "+e+" does not match previously registered API v"+gu);return n.error(f.stack||f.message),!1}return c[e]=t,n.debug("@opentelemetry/api: Registered a global for "+e+" v"+gu+"."),!0}function Xp(e){var t,n,r=(t=Jp[Wp])===null||t===void 0?void 0:t.version;if(!(!r||!Ide(r)))return(n=Jp[Wp])===null||n===void 0?void 0:n[e]}function vx(e,t){t.debug("@opentelemetry/api: Unregistering a global for "+e+" v"+gu+".");var n=Jp[Wp];n&&delete n[e]}var jde=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),i,c=[],f;try{for(;(t===void 0||t-- >0)&&!(i=r.next()).done;)c.push(i.value)}catch(m){f={error:m}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(f)throw f.error}}return c},Fde=function(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,c;r<i;r++)(c||!(r in t))&&(c||(c=Array.prototype.slice.call(t,0,r)),c[r]=t[r]);return e.concat(c||Array.prototype.slice.call(t))},Lde=(function(){function e(t){this._namespace=t.namespace||"DiagComponentLogger"}return e.prototype.debug=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return $g("debug",this._namespace,t)},e.prototype.error=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return $g("error",this._namespace,t)},e.prototype.info=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return $g("info",this._namespace,t)},e.prototype.warn=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return $g("warn",this._namespace,t)},e.prototype.verbose=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return $g("verbose",this._namespace,t)},e})();function $g(e,t,n){var r=Xp("diag");if(r)return n.unshift(t),r[e].apply(r,Fde([],jde(n),!1))}var Vs;(function(e){e[e.NONE=0]="NONE",e[e.ERROR=30]="ERROR",e[e.WARN=50]="WARN",e[e.INFO=60]="INFO",e[e.DEBUG=70]="DEBUG",e[e.VERBOSE=80]="VERBOSE",e[e.ALL=9999]="ALL"})(Vs||(Vs={}));function Ude(e,t){e<Vs.NONE?e=Vs.NONE:e>Vs.ALL&&(e=Vs.ALL),t=t||{};function n(r,i){var c=t[r];return typeof c=="function"&&e>=i?c.bind(t):function(){}}return{error:n("error",Vs.ERROR),warn:n("warn",Vs.WARN),info:n("info",Vs.INFO),debug:n("debug",Vs.DEBUG),verbose:n("verbose",Vs.VERBOSE)}}var zde=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),i,c=[],f;try{for(;(t===void 0||t-- >0)&&!(i=r.next()).done;)c.push(i.value)}catch(m){f={error:m}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(f)throw f.error}}return c},Pde=function(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,c;r<i;r++)(c||!(r in t))&&(c||(c=Array.prototype.slice.call(t,0,r)),c[r]=t[r]);return e.concat(c||Array.prototype.slice.call(t))},Hde="diag",Mv=(function(){function e(){function t(i){return function(){for(var c=[],f=0;f<arguments.length;f++)c[f]=arguments[f];var m=Xp("diag");if(m)return m[i].apply(m,Pde([],zde(c),!1))}}var n=this,r=function(i,c){var f,m,g;if(c===void 0&&(c={logLevel:Vs.INFO}),i===n){var b=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return n.error((f=b.stack)!==null&&f!==void 0?f:b.message),!1}typeof c=="number"&&(c={logLevel:c});var S=Xp("diag"),v=Ude((m=c.logLevel)!==null&&m!==void 0?m:Vs.INFO,i);if(S&&!c.suppressOverrideMessage){var q=(g=new Error().stack)!==null&&g!==void 0?g:"<failed to generate stacktrace>";S.warn("Current logger will be overwritten from "+q),v.warn("Current logger will overwrite one already registered from "+q)}return Sx("diag",v,n,!0)};n.setLogger=r,n.disable=function(){vx(Hde,n)},n.createComponentLogger=function(i){return new Lde(i)},n.verbose=t("verbose"),n.debug=t("debug"),n.info=t("info"),n.warn=t("warn"),n.error=t("error")}return e.instance=function(){return this._instance||(this._instance=new e),this._instance},e})();function Bde(e){return Symbol.for(e)}var Vde=(function(){function e(t){var n=this;n._currentContext=t?new Map(t):new Map,n.getValue=function(r){return n._currentContext.get(r)},n.setValue=function(r,i){var c=new e(n._currentContext);return c._currentContext.set(r,i),c},n.deleteValue=function(r){var i=new e(n._currentContext);return i._currentContext.delete(r),i}}return e})(),Gde=new Vde,Kde=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),i,c=[],f;try{for(;(t===void 0||t-- >0)&&!(i=r.next()).done;)c.push(i.value)}catch(m){f={error:m}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(f)throw f.error}}return c},Qde=function(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,c;r<i;r++)(c||!(r in t))&&(c||(c=Array.prototype.slice.call(t,0,r)),c[r]=t[r]);return e.concat(c||Array.prototype.slice.call(t))},Yde=(function(){function e(){}return e.prototype.active=function(){return Gde},e.prototype.with=function(t,n,r){for(var i=[],c=3;c<arguments.length;c++)i[c-3]=arguments[c];return n.call.apply(n,Qde([r],Kde(i),!1))},e.prototype.bind=function(t,n){return n},e.prototype.enable=function(){return this},e.prototype.disable=function(){return this},e})(),Wde=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),i,c=[],f;try{for(;(t===void 0||t-- >0)&&!(i=r.next()).done;)c.push(i.value)}catch(m){f={error:m}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(f)throw f.error}}return c},Jde=function(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,c;r<i;r++)(c||!(r in t))&&(c||(c=Array.prototype.slice.call(t,0,r)),c[r]=t[r]);return e.concat(c||Array.prototype.slice.call(t))},JT="context",Xde=new Yde,wx=(function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalContextManager=function(t){return Sx(JT,t,Mv.instance())},e.prototype.active=function(){return this._getContextManager().active()},e.prototype.with=function(t,n,r){for(var i,c=[],f=3;f<arguments.length;f++)c[f-3]=arguments[f];return(i=this._getContextManager()).with.apply(i,Jde([t,n,r],Wde(c),!1))},e.prototype.bind=function(t,n){return this._getContextManager().bind(t,n)},e.prototype._getContextManager=function(){return Xp(JT)||Xde},e.prototype.disable=function(){this._getContextManager().disable(),vx(JT,Mv.instance())},e})(),ml;(function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"})(ml||(ml={}));var M5="0000000000000000",j5="00000000000000000000000000000000",Zde={traceId:j5,spanId:M5,traceFlags:ml.NONE},dp=(function(){function e(t){t===void 0&&(t=Zde),this._spanContext=t}return e.prototype.spanContext=function(){return this._spanContext},e.prototype.setAttribute=function(t,n){return this},e.prototype.setAttributes=function(t){return this},e.prototype.addEvent=function(t,n){return this},e.prototype.addLink=function(t){return this},e.prototype.addLinks=function(t){return this},e.prototype.setStatus=function(t){return this},e.prototype.updateName=function(t){return this},e.prototype.end=function(t){},e.prototype.isRecording=function(){return!1},e.prototype.recordException=function(t,n){},e})(),Ex=Bde("OpenTelemetry Context Key SPAN");function Tx(e){return e.getValue(Ex)||void 0}function ehe(){return Tx(wx.getInstance().active())}function kx(e,t){return e.setValue(Ex,t)}function the(e){return e.deleteValue(Ex)}function nhe(e,t){return kx(e,new dp(t))}function F5(e){var t;return(t=Tx(e))===null||t===void 0?void 0:t.spanContext()}var rhe=/^([0-9a-f]{32})$/i,she=/^[0-9a-f]{16}$/i;function ahe(e){return rhe.test(e)&&e!==j5}function ihe(e){return she.test(e)&&e!==M5}function L5(e){return ahe(e.traceId)&&ihe(e.spanId)}function ohe(e){return new dp(e)}var XT=wx.getInstance(),U5=(function(){function e(){}return e.prototype.startSpan=function(t,n,r){r===void 0&&(r=XT.active());var i=!!(n!=null&&n.root);if(i)return new dp;var c=r&&F5(r);return che(c)&&L5(c)?new dp(c):new dp},e.prototype.startActiveSpan=function(t,n,r,i){var c,f,m;if(!(arguments.length<2)){arguments.length===2?m=n:arguments.length===3?(c=n,m=r):(c=n,f=r,m=i);var g=f??XT.active(),b=this.startSpan(t,c,g),S=kx(g,b);return XT.with(S,m,void 0,b)}},e})();function che(e){return typeof e=="object"&&typeof e.spanId=="string"&&typeof e.traceId=="string"&&typeof e.traceFlags=="number"}var lhe=new U5,uhe=(function(){function e(t,n,r,i){this._provider=t,this.name=n,this.version=r,this.options=i}return e.prototype.startSpan=function(t,n,r){return this._getTracer().startSpan(t,n,r)},e.prototype.startActiveSpan=function(t,n,r,i){var c=this._getTracer();return Reflect.apply(c.startActiveSpan,c,arguments)},e.prototype._getTracer=function(){if(this._delegate)return this._delegate;var t=this._provider.getDelegateTracer(this.name,this.version,this.options);return t?(this._delegate=t,this._delegate):lhe},e})(),fhe=(function(){function e(){}return e.prototype.getTracer=function(t,n,r){return new U5},e})(),dhe=new fhe,F$=(function(){function e(){}return e.prototype.getTracer=function(t,n,r){var i;return(i=this.getDelegateTracer(t,n,r))!==null&&i!==void 0?i:new uhe(this,t,n,r)},e.prototype.getDelegate=function(){var t;return(t=this._delegate)!==null&&t!==void 0?t:dhe},e.prototype.setDelegate=function(t){this._delegate=t},e.prototype.getDelegateTracer=function(t,n,r){var i;return(i=this._delegate)===null||i===void 0?void 0:i.getTracer(t,n,r)},e})(),lu;(function(e){e[e.INTERNAL=0]="INTERNAL",e[e.SERVER=1]="SERVER",e[e.CLIENT=2]="CLIENT",e[e.PRODUCER=3]="PRODUCER",e[e.CONSUMER=4]="CONSUMER"})(lu||(lu={}));var Wc;(function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"})(Wc||(Wc={}));var zC="[_0-9a-z-*/]",hhe="[a-z]"+zC+"{0,255}",mhe="[a-z0-9]"+zC+"{0,240}@[a-z]"+zC+"{0,13}",ghe=new RegExp("^(?:"+hhe+"|"+mhe+")$"),phe=/^[ -~]{0,255}[!-~]$/,_he=/,|=/;function yhe(e){return ghe.test(e)}function bhe(e){return phe.test(e)&&!_he.test(e)}var L$=32,She=512,U$=",",z$="=",vhe=(function(){function e(t){this._internalState=new Map,t&&this._parse(t)}return e.prototype.set=function(t,n){var r=this._clone();return r._internalState.has(t)&&r._internalState.delete(t),r._internalState.set(t,n),r},e.prototype.unset=function(t){var n=this._clone();return n._internalState.delete(t),n},e.prototype.get=function(t){return this._internalState.get(t)},e.prototype.serialize=function(){var t=this;return this._keys().reduce(function(n,r){return n.push(r+z$+t.get(r)),n},[]).join(U$)},e.prototype._parse=function(t){t.length>She||(this._internalState=t.split(U$).reverse().reduce(function(n,r){var i=r.trim(),c=i.indexOf(z$);if(c!==-1){var f=i.slice(0,c),m=i.slice(c+1,r.length);yhe(f)&&bhe(m)&&n.set(f,m)}return n},new Map),this._internalState.size>L$&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,L$))))},e.prototype._keys=function(){return Array.from(this._internalState.keys()).reverse()},e.prototype._clone=function(){var t=new e;return t._internalState=new Map(this._internalState),t},e})();function whe(e){return new vhe(e)}var Os=wx.getInstance(),ZT="trace",Ehe=(function(){function e(){this._proxyTracerProvider=new F$,this.wrapSpanContext=ohe,this.isSpanContextValid=L5,this.deleteSpan=the,this.getSpan=Tx,this.getActiveSpan=ehe,this.getSpanContext=F5,this.setSpan=kx,this.setSpanContext=nhe}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalTracerProvider=function(t){var n=Sx(ZT,this._proxyTracerProvider,Mv.instance());return n&&this._proxyTracerProvider.setDelegate(t),n},e.prototype.getTracerProvider=function(){return Xp(ZT)||this._proxyTracerProvider},e.prototype.getTracer=function(t,n){return this.getTracerProvider().getTracer(t,n)},e.prototype.disable=function(){vx(ZT,Mv.instance()),this._proxyTracerProvider=new F$},e})(),ts=Ehe.getInstance();const P$=1000000000n,ek=e=>[Number(e/P$),Number(e%P$)],tk=e=>Object.entries(e).reduce((t,[n,r])=>(t[n]=z5(r),t),{}),z5=e=>typeof e=="string"||typeof e=="number"||typeof e=="boolean"?e:typeof e=="bigint"?Number(e):xu(e),yS=Symbol.for("@effect/opentelemetry/Tracer/OtelSpan"),The={internal:lu.INTERNAL,client:lu.CLIENT,server:lu.SERVER,producer:lu.PRODUCER,consumer:lu.CONSUMER};var Aj;Aj=yS;class P5{constructor(t,n,r,i,c,f,m,g){y(this,"name");y(this,"parent");y(this,"context");y(this,"links");y(this,"kind");y(this,Aj);y(this,"_tag","Span");y(this,"span");y(this,"spanId");y(this,"traceId");y(this,"attributes",new Map);y(this,"sampled");y(this,"status");this.name=r,this.parent=i,this.context=c,this.links=f,this.kind=g,this[yS]=yS;const b=t.active();this.span=n.startSpan(r,{startTime:ek(m),links:f.length>0?f.map(v=>({context:HC(v.span),attributes:tk(v.attributes)})):void 0,kind:The[this.kind]},i._tag==="Some"?B5(b,i.value,c):ts.deleteSpan(b));const S=this.span.spanContext();this.spanId=S.spanId,this.traceId=S.traceId,this.status={_tag:"Started",startTime:m},this.sampled=(S.traceFlags&ml.SAMPLED)===ml.SAMPLED}attribute(t,n){this.span.setAttribute(t,z5(n)),this.attributes.set(t,n)}addLinks(t){this.links.push(...t),this.span.addLinks(t.map(n=>({context:HC(n.span),attributes:tk(n.attributes)})))}end(t,n){const r=ek(t);if(this.status={_tag:"Ended",endTime:t,exit:n,startTime:this.status.startTime},n._tag==="Success")this.span.setStatus({code:Wc.OK});else if(tl(n.cause))this.span.setStatus({code:Wc.OK,message:zp(n.cause)}),this.span.setAttribute("span.label"," Interrupted"),this.span.setAttribute("status.interrupted",!0);else{const i=pne(n.cause)[0];i?(i.stack=zp(n.cause,{renderErrorCause:!0}),this.span.recordException(i,r),this.span.setStatus({code:Wc.ERROR,message:i.message})):this.span.setStatus({code:Wc.OK})}this.span.end(r)}event(t,n,r){this.span.addEvent(t,r?tk(r):void 0,ek(n))}}const H5=Cs("@effect/opentelemetry/Tracer/OtelTracer"),khe=Tt(H5,e=>QU({span(t,n,r,i,c,f){return new P5(Os,e,t,n,r,i.slice(),c,f)},context(t,n){const r=n.currentSpan;return r===void 0?t():Os.with(B5(Os.active(),r),t)}})),PC=Cs("@effect/opentelemetry/Tracer/OtelTraceFlags"),jv=Cs("@effect/opentelemetry/Tracer/OtelTraceState"),Che=e=>{let t=Iu();return e.traceFlags&&(t=Ks(t,PC,e.traceFlags)),typeof e.traceState=="string"?t=Bt(Rhe(e.traceState),{onNone:()=>t,onSome:n=>Ks(t,jv,n)}):e.traceState&&(t=Ks(t,jv,e.traceState)),{_tag:"ExternalSpan",traceId:e.traceId,spanId:e.spanId,sampled:e.traceFlags?(e.traceFlags&ml.SAMPLED)===ml.SAMPLED:!0,context:t}},Ahe=Xe(w2,e=>yS in e?Gn(e.span):Wu(new lw)),Rhe=cF(whe),B5=(e,t,n)=>t instanceof P5?ts.setSpan(e,t.span):ts.setSpanContext(e,HC(t,n)),HC=(e,t)=>({spanId:e.spanId,traceId:e.traceId,isRemote:e._tag==="ExternalSpan",traceFlags:yn(t?H$(e,t,PC):Xs(e.context,PC),()=>ml.SAMPLED),traceState:ba(t?H$(e,t,jv):Xs(e.context,jv))}),H$=(e,t,n)=>xo(Xs(t,n),()=>Xs(e.context,n)),xhe=khe,Ohe=Che,zw=Ahe,V5=H5,Qg=(e,t,n=" ")=>e.split(`
`).map(r=>n.repeat(t)+r).join(`
`),Dhe=e=>e==null,qhe=e=>e!=null,B$=()=>{const e=performance.now(),t={_performanceStartTime:e,setAttribute:()=>null,setAttributes:()=>null,addEvent:()=>null,setStatus:()=>null,updateName:()=>null,recordException:()=>null,end:()=>{const r=performance.now()-e,i=r/1e3,c=r%1e3*1e6;t._duration=[i,c]},spanContext:()=>({traceId:"livestore-noop-trace-id",spanId:"livestore-noop-span-id"}),_duration:[0,0]};return t},Nhe=()=>new $he;class $he{constructor(){y(this,"startSpan",()=>B$())}startActiveSpan(t,n,r,i){let c;if(!(arguments.length<2))return arguments.length===2?c=n:arguments.length===3?c=r:c=i,c(B$())}}const V$={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};var G$={};const Zp=e=>{if(typeof process<"u"&&G$!==void 0)return G$[e];if(V$!==void 0)return V$[e]},Ig=Zp("LS_TRACE_VERBOSE")!==void 0||Zp("VITE_LS_TRACE_VERBOSE")!==void 0,Vo=UC(Zp("LS_DEV"))||UC(Zp("VITE_LS_DEV"));UC(Zp("CI"));const Cx=typeof navigator<"u"&&navigator.product==="ReactNative",Au=(e,t)=>{if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var n,r,i;if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(r=n;r--!==0;)if(!Au(e[r],t[r]))return!1;return!0}if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(r of e.entries())if(!t.has(r[0]))return!1;for(r of e.entries())if(!Au(r[1],t.get(r[0])))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(r of e.entries())if(!t.has(r[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(n=e.length,n!=t.length)return!1;for(r=n;r--!==0;)if(e[r]!==t[r])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==void 0&&e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==void 0&&e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(i=Object.keys(e),n=i.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!Object.prototype.hasOwnProperty.call(t,i[r]))return!1;for(r=n;r--!==0;){var c=i[r];if(!Au(e[c],t[c]))return!1}return!0}return e!==e&&t!==t},Ihe=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],Mhe=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],jhe=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],Fhe=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],K$=(e,t,n)=>{let r=e;return typeof t=="string"||Array.isArray(t)?r=e.toLocaleString(t,n):(t===!0||n!==void 0)&&(r=e.toLocaleString(void 0,n)),r};function Lhe(e,t){if(!Number.isFinite(e))throw new TypeError(`Expected a finite number, got ${typeof e}: ${e}`);t={bits:!1,binary:!1,space:!0,...t};const n=t.bits?t.binary?Fhe:jhe:t.binary?Mhe:Ihe,r=t.space?" ":"";if(t.signed&&e===0)return` 0${r}${n[0]}`;const i=e<0,c=i?"-":t.signed?"+":"";i&&(e=-e);let f;if(t.minimumFractionDigits!==void 0&&(f={minimumFractionDigits:t.minimumFractionDigits}),t.maximumFractionDigits!==void 0&&(f={maximumFractionDigits:t.maximumFractionDigits,...f}),e<1){const S=K$(e,t.locale,f);return c+S+r+n[0]}const m=Math.min(Math.floor(t.binary?Math.log(e)/Math.log(1024):Math.log10(e)/3),n.length-1);e/=(t.binary?1024:1e3)**m,f||(e=e.toPrecision(3));const g=K$(Number(e),t.locale,f),b=n[m];return c+g+r+b}const G5=e=>Array.isArray(e);function rf(e){debugger;throw new Error(`A case was not handled for value: ${Uhe(I5(e),1e3)}`)}const Q$=(e,t)=>{if(e===!1){debugger;throw new Error(`This should never happen: ${t}`)}},Uhe=(e,t)=>e.length>t?e.slice(0,t)+"...":e,Y$=e=>{debugger;throw new Error(`Not yet implemented: ${e}`)},W$=(e,t)=>{let n=!1,r=!1;const i=()=>{r?(e(),r=!1,setTimeout(i,t)):n=!1};return()=>{if(n){r=!0;return}e(),n=!0,setTimeout(i,t)}},zhe=e=>{const t=new Map;return(n=>{if(t.has(n))return t.get(n);const r=e(n);return t.set(n,r),r})},Phe=e=>typeof(e==null?void 0:e.then)=="function",vf=e=>ye(function*(){const t=yield*z_();return yield*rs(n=>Xn(t,n)),yield*e(t).pipe(U_(t))}),Hhe=e=>B_(()=>e()).pipe(Hp(t=>vl(t)?t:Phe(t)?Ju(()=>t):Gn(t))),Bhe=(...e)=>rs(()=>S2(...e)),Ft=e=>Ys(e,t=>ye(function*(){if(tl(t))return;const n=yield*zw.pipe(Xu("NoSuchElementException",i=>Gn(void 0))),r=t.toString().split(`
`)[0];yield*Bp(r,t).pipe(i=>n===void 0?i:nl({spanId:n.spanContext().spanId,traceId:n.spanContext().traceId})(i))})),wa=(e,t)=>jse(S2(e).pipe(nl(t??{})),Kse,()=>R0(kue)),Ax=({label:e,duration:t})=>n=>ye(function*(){const r=yield*em();let i=!1;const c=y2(t).pipe(Ns(()=>(i=!0,Xa(`${e}: Took longer than ${t}ms`))),ss(r),oi),f=Date.now(),m=yield*n.pipe(In,Rse(yw(function*(){const g=Date.now();yield*Js(c),i&&(yield*Xa(`${e}: Interrupted after ${g-f}ms`))})));if(i){const g=Date.now();yield*Xa(`${e}: Actual duration: ${g-f}ms`)}return yield*Js(c),yield*m}),Vhe=e=>t=>Ns(t,n=>Ke(()=>e(n))),K5=e=>t=>p2(Ke(()=>performance.mark(`${e}:start`)),()=>t,()=>Ke(()=>{performance.mark(`${e}:end`),performance.measure(e,`${e}:start`,`${e}:end`)})),Q5=()=>{const e=Ure();return e._tag==="None"||e.value.currentSpan===void 0?"No current fiber":""},Ghe=()=>console.log(Q5());globalThis.getSpanTrace=Q5;globalThis.logSpanTrace=Ghe;class Pw extends LA("@effect/platform/Transferable/Collector")(){}const Y5=()=>{let e=[];const t=i=>{e.push(...i)},n=()=>e,r=()=>{const i=e;return e=[],i};return Pw.of({unsafeAddAll:t,addAll:i=>Ke(()=>t(i)),unsafeRead:n,read:Ke(n),unsafeClear:r,clear:Ke(r)})},Khe=Ke(Y5),Qhe=e=>Xe(Nse(Pw),Bt({onNone:()=>ot,onSome:t=>t.addAll(e)})),W5=D(2,(e,t)=>dl(Nw(e),e,{strict:!0,decode:ti,encode:n=>Io(Qhe(t(n)),n)})),Hw=W5(sr,e=>[e]),Gd=W5(jw,e=>[e.buffer]),Yhe=Symbol.for("@effect/platform/WorkerError"),J$=Yhe;var Rj,xj;const Pc=class Pc extends(xj=li()("WorkerError",{reason:qe("spawn","decode","send","unknown","encode"),cause:Th}),Rj=J$,xj){constructor(){super(...arguments);y(this,Rj,J$)}get message(){switch(this.reason){case"send":return"An error occurred calling .postMessage";case"spawn":return"An error occurred while spawning a worker";case"decode":return"An error occurred during decoding";case"encode":return"An error occurred during encoding";case"unknown":return"An unexpected error occurred"}}};y(Pc,"Cause",Xfe({error:Pc,defect:Th})),y(Pc,"encodeCause",Yc(Pc.Cause)),y(Pc,"decodeCause",tf(Pc.Cause));let Go=Pc;const X$=Symbol.for("@effect/platform/Worker/PlatformWorker"),Rx=Cs("@effect/platform/Worker/PlatformWorker"),Z$=Symbol.for("@effect/platform/Worker/WorkerManager"),e_=Cs("@effect/platform/Worker/WorkerManager"),J5=Cs("@effect/platform/Worker/Spawner"),Whe=ye(function*(){const e=yield*Rx;let t=0;return e_.of({[Z$]:Z$,spawn({encode:n,initialMessage:r}){return ye(function*(){const i=t++;let c=0;const f=new Map,m=Y5(),g=n?x=>sn(m.clear,b2(n(x),Pw,m)):Gn,b=yield*xt(),S=yield*e.spawn(i);yield*S.run(x=>x[0]===0?_W(b,ot):v(x[1])).pipe(Ose(x=>Hr(f.values(),C=>eu in C?Eu(C,x):C.failCause(x))),Ys(Xa),hw(f6(1e3)),nl({package:"@effect/platform",module:"Worker"}),kn,En),yield*rs(()=>sn(Hr(f.values(),x=>eu in x?Fq(x):x.end,{discard:!0}),Ke(()=>f.clear())));const v=x=>Nn(()=>{const C=f.get(x[0]);if(!C)return ot;switch(x[1]){case 0:return eu in C?dn(C,x[2][0]):C.offerAll(x[2]);case 1:return x.length===2?eu in C?Fq(C):C.end:eu in C?dn(C,x[2][0]):sn(C.offerAll(x[2]),C.end);case 2:case 3:{if(x[1]===2)return eu in C?CR(C,x[2]):C.fail(x[2]);const E=Go.decodeCause(x[2]);return eu in C?Eu(C,E):C.failCause(E)}}}),q=(x,C)=>_h(E=>{const $=E.getFiberRef(aP),R=Xs($,KU).pipe(Q7(z=>z._tag==="Span")),I=c++;return C.pipe(Ns(z=>(f.set(I,z),g(x).pipe(Ns(V=>S.send([I,0,V,R._tag==="Some"?[R.value.traceId,R.value.spanId,R.value.sampled]:void 0],m.unsafeRead())),Xh(V=>Oue(z)?z.failCause(V):Eu(z,V))))),Tt(z=>({id:I,mailbox:z})))}),k=({id:x},C)=>{const E=Ke(()=>f.delete(x));return Kh(C)?sn(va(S.send([x,1])),E):E},N=x=>ade(_le(q(x,Due()),({mailbox:C})=>que(C),k)),H=x=>p2(q(x,xt()),({mailbox:C})=>gn(C),k);return yield*gn(b),r&&(yield*Ke(r).pipe(Xe(H),pf(x=>new Go({reason:"spawn",cause:x})))),{id:i,execute:N,executeEffect:H}})}})}),Jhe=eae(e_,Whe),X5=e=>ye(function*(){const n=yield*(yield*e_).spawn({...e,encode(c){return pf(Zfe(c),f=>new Go({reason:"encode",cause:f}))}}),r=c=>{const f=Gg(O$(c)),m=Gg(x$(c));return j(n.execute(c),rde(g=>Xe(m(g),Wu)),x5(f))},i=c=>{const f=Gg(O$(c)),m=Gg(x$(c));return Lse(n.executeEffect(c),{onFailure:g=>Xe(m(g),Wu),onSuccess:f})};return Ie({id:n.id,execute:r,executeEffect:i})}),Xhe=e=>ye(function*(){const t=yield*e_,n=new Set,r=j(X5(e),Ns(f=>Ke(()=>n.add(f))),Ns(f=>rs(()=>Ke(()=>n.delete(f)))),e.onCreate?Ns(e.onCreate):Ie,b2(e_,t)),i=yield*"timeToLive"in e?Pue({acquire:r,min:e.minSize,max:e.maxSize,concurrency:e.concurrency,targetUtilization:e.targetUtilization,timeToLive:e.timeToLive}):zue({acquire:r,size:e.size,concurrency:e.concurrency,targetUtilization:e.targetUtilization}),c={backing:i,broadcast:f=>Hr(n,m=>m.executeEffect(f),{concurrency:"unbounded",discard:!0}),execute:f=>dde(Tt(i.get,m=>m.execute(f))),executeEffect:f=>Zu(Xe(i.get,m=>m.executeEffect(f)))};return yield*Zu(i.get),c}),Zhe=e=>V_(J5,e),eme=()=>e=>Rx.of({[X$]:X$,spawn(t){return ye(function*(){const n=yield*J5;let r;const i=[];return{run:m=>Zh(g=>ye(function*(){const b=yield*Z4,S=yield*e.setup({worker:n(t),scope:b});r=S,yield*ll(b,Ke(()=>{r=void 0}));const v=(yield*em()).pipe(poe(Y9(Bne))),q=yield*Nle(),k=l6(v);if(yield*e.listen({port:S,scope:b,emit(N){Ile(q,k(m(N)))},deferred:q.deferred}),i.length>0){for(const[N,H]of i)S.postMessage([0,N],H);i.length=0}return yield*g(Mle(q))}).pipe(Zu)),send:(m,g)=>B_({try:()=>{r===void 0?i.push([m,g]):r.postMessage([0,m],g)},catch:b=>new Go({reason:"send",cause:b})})}})}}),tme=eme,nme=Rx,rme=Jhe,sme=X5,ame=Xhe,ime=Zhe,xx=(e,t)=>(n,r)=>ye(function*(){const i=yield*Khe;return[yield*sx(e,t)(n,r).pipe(b2(Pw,i)),i.unsafeRead()]}),Wb=(e,t)=>(n,r)=>{const i=Que(e,t)(n,r);return i._tag==="Left"?at("encodeSyncDebug failed:",i.left):i.right},ome=e=>dl(Pi(e),Nw(e),{decode:Jle(e),encode:Yle(e)});ome(vfe);const sf=ze(W,dt,Po,Gs,gt(Yp(()=>sf)),dm({key:W,value:Yp(()=>sf)})).annotations({title:"JsonValue"}),as=Symbol("WebChannel"),t_=ht("WebChannel.DebugPing",{message:W,payload:tt(W)}),Fv=ht("WebChannel.Ping",{requestId:W}),Lv=ht("WebChannel.Pong",{requestId:W}),cme=ze(Fv,Lv),eI=e=>({send:ze(e.send,t_,Fv,Lv),listen:ze(e.listen,t_,Fv,Lv)}),ty=e=>Ae(e,"send")&&Ae(e,"listen")?eI(e):eI({send:e,listen:e}),Bw=e=>t=>t.pipe(A5(yw(function*(n){return n._tag==="Right"&&rn(t_)(n.right)?(yield*Ur(`WebChannel:ping [${e}] ${n.right.message}`,n.right.payload),!1):!0}))),Ox=({channelName:e,schema:t})=>vf(n=>ye(function*(){const r=ty(t),i=new BroadcastChannel(e);yield*rs(()=>B_(()=>i.close()).pipe(m2));const c=b=>ye(function*(){const S=yield*sx(r.send)(b);i.postMessage(S)}),f=Lw(i,"message").pipe(El(b=>fm(r.listen)(b.data)),Bw(e)),m=yield*xt().pipe(wn(Sl(ea))),g=!1;return{[as]:as,send:c,listen:f,closedDeferred:m,shutdown:Xn(n,$n("shutdown")),schema:r,supportsTransferables:g}}).pipe(At(`WebChannel:broadcastChannel(${e})`))),BC=({listenWindow:e,sendWindow:t,targetOrigin:n="*",ids:r,schema:i})=>vf(c=>ye(function*(){const f=ty(i),m={sendTotal:0,listenTotal:0,targetOrigin:n,ids:r},g=ve({message:f.listen,from:qe(r.other),to:qe(r.own)}).annotations({title:"webmesh.WindowMessageListen"}),b=ve({message:f.send,from:qe(r.own),to:qe(r.other)}).annotations({title:"webmesh.WindowMessageSend"}),S=N=>ye(function*(){m.sendTotal++;const[H,x]=yield*xx(b)({message:N,from:r.own,to:r.other});t.postMessage(H,n,x)}),v=Lw(e,"message").pipe(Ho(N=>rn(Nw(g))(N.data)),El(N=>(m.listenTotal++,fm(f.listen)(N.data.message))),Bw("window")),q=yield*xt().pipe(wn(Sl(ea))),k=!0;return{[as]:as,send:S,listen:v,closedDeferred:q,shutdown:Xn(c,$n("shutdown")),schema:f,supportsTransferables:k,debugInfo:m}}).pipe(At("WebChannel:windowChannel"))),lme=({port:e,schema:t,debugId:n})=>vf(r=>ye(function*(){const i=ty(t),c=n===void 0?"messagePort":`messagePort:${n}`,f=S=>ye(function*(){const[v,q]=yield*xx(i.send)(S);e.postMessage(v,q)}),m=Lw(e,"message").pipe(El(S=>fm(i.listen)(S.data)),Bw(c));e.start();const g=yield*xt().pipe(wn(Sl(ea))),b=!0;return yield*rs(()=>B_(()=>e.close()).pipe(m2)),{[as]:as,send:f,listen:m,closedDeferred:g,shutdown:Xn(r,$n("shutdown")),schema:i,supportsTransferables:b}}).pipe(At("WebChannel:messagePortChannel")));St("livestore:sameThreadChannels",()=>new Map);const tI=({port:e,schema:t,debugId:n})=>vf(r=>ye(function*(){const i=ty(t),c=n===void 0?"messagePort":`messagePort:${n}`,f=new Map,m=ht("ChannelRequest",{id:W,payload:ze(i.listen,i.send)}).annotations({title:"webmesh.ChannelRequest"}),g=ht("ChannelRequestAck",{reqId:W}).annotations({title:"webmesh.ChannelRequestAck"}),b=ze(m,g).annotations({title:"webmesh.ChannelMessage"}),S={sendTotal:0,sendPending:0,listenTotal:0,id:n},v=H=>ye(function*(){S.sendTotal++,S.sendPending++;const x=crypto.randomUUID(),[C,E]=yield*xx(b)({_tag:"ChannelRequest",id:x,payload:H}),$=yield*xt();f.set(x,$),e.postMessage(C,E),yield*$,f.delete(x),S.sendPending--}),q=Lw(e,"message").pipe(El(H=>fm(b)(H.data)),$s(H=>ye(function*(){H._tag==="Right"&&(H.right._tag==="ChannelRequestAck"?yield*dn(f.get(H.right.reqId),void 0):H.right._tag==="ChannelRequest"&&(S.listenTotal++,e.postMessage(Yc(b)({_tag:"ChannelRequestAck",reqId:H.right.id}))))})),sde(H=>H._tag==="Left"?pe(H):H.right._tag==="ChannelRequest"?pe(He(H.right.payload)):me()),H=>H,Bw(c));e.start();const k=yield*xt().pipe(wn(Sl(ea))),N=!0;return yield*rs(()=>B_(()=>e.close()).pipe(m2)),{[as]:as,send:v,listen:q,closedDeferred:k,shutdown:Xn(r,$n("shutdown")),schema:i,supportsTransferables:N,debugInfo:S}}).pipe(At("WebChannel:messagePortChannelWithAck"))),nI=(e,t)=>ye(function*(){const n=yield*qs().pipe(wn(ys)),r={current:void 0};if(yield*e.listen.pipe(t!=null&&t.heartbeat?A5(yw(function*(c){if(c._tag==="Right"&&rn(cme)(c.right)){if(c.right._tag==="WebChannel.Ping")yield*e.send(Lv.make({requestId:c.right.requestId}));else{const{deferred:f,requestId:m}=r.current??at("No pending ping");m!==c.right.requestId&&at("Received pong for unexpected requestId",m,c.right.requestId),yield*dn(f,void 0)}return!1}return!0})):Ie,$5(c=>q2(n,c)),Vr,En),t!=null&&t.heartbeat){const{interval:c,timeout:f}=t.heartbeat;yield*ye(function*(){for(;;){yield*y2(c);const m=crypto.randomUUID();yield*e.send(Fv.make({requestId:m}));const g=yield*xt();r.current={deferred:g,requestId:m},yield*g.pipe(yh(f),Xu("TimeoutException",()=>e.shutdown))}}).pipe(At("WebChannel:heartbeat"),En)}const i=nf(n,{maxChunkSize:1});return{[as]:as,send:e.send,listen:i,closedDeferred:e.closedDeferred,shutdown:e.shutdown,schema:e.schema,supportsTransferables:e.supportsTransferables,debugInfo:{innerDebugInfo:e.debugInfo,listenQueueSize:n}}}),Z5=e=>t=>{if(Ae(console,"createTask")===!1)return t;const n=ye(function*(){const i=yield*zse;return QU({span:(c,...f)=>{const m=i.span(c,...f),g=e(c);return m.runInTask=b=>g.run(b),m},context:(c,f)=>{const m=Xs(KU)(f.currentContext);if(m._tag==="None")return i.context(c,f);const g=m.value;if(g._tag==="ExternalSpan")return i.context(c,f);const b=g;return"runInTask"in b&&typeof b.runInTask=="function"?b.runInTask(()=>i.context(c,f)):i.context(c,f)}})}),r=j(n,Tt(cP),oP);return ss(t,r)},ume=tme()({setup({scope:e,worker:t}){const n="port"in t?t.port:t;return Io(ll(e,Ke(()=>{n.postMessage([1])})),n)},listen({deferred:e,emit:t,port:n,scope:r}){function i(f){t(f.data)}function c(f){AR(e,new Go({reason:"unknown",cause:f.error??f.message}))}return n.addEventListener("message",i),n.addEventListener("error",c),"start"in n&&n.start(),ll(r,Ke(()=>{n.removeEventListener("message",i),n.removeEventListener("error",c)}))}}),fme=V_(nme,ume),dme=nae(rme,fme),hme=e=>tae(dme,ime(e)),rI=hme,mme=j(u6(ju(10),4),_oe(f6(US(1))),yoe(boe),Soe(hL(US(10)))),gme=(e,t)=>f2((n,r)=>{r.aborted||navigator.locks.request(t,{signal:r,mode:"exclusive",ifAvailable:!1},i=>(n(ot),pw(gn(e)))).catch(i=>{if(!(i.code===20&&i.message==="signal is aborted without reason"))throw i})}),pme=(e,t)=>f2((n,r)=>{navigator.locks.request(t,{mode:"exclusive",ifAvailable:!0},i=>{n(Gn(i!==null));const c=new Promise(f=>{r.addEventListener("abort",()=>{f()})});return Promise.race([pw(gn(e)),c])})}),_me=XF(),Uv=i5(_me)(Nv),yme=XF(),kh=i5(yme)(Nv),n_=0,ar=ve({global:kh,client:Uv}).annotations({title:"LiveStore.EventSequenceNumber"}),ni=e=>e.client===0?`e${e.global}`:`e${e.global}+${e.client}`,Dx=(e,t)=>e.global===t.global&&e.client===t.client,bme={global:0,client:n_},bS=(e,t)=>e.global>t.global||e.global===t.global&&e.client>t.client,zv=(e,t)=>e.global>t.global||e.global===t.global&&e.client>=t.client,Sme=(e,t)=>e.global>t.global||e.global===t.global&&e.client>t.client?e:t,vme=e=>rn(ar)(e)?e:tf(ar)(e),qx=(e,t)=>t?{seqNum:{global:e.global,client:e.client+1},parentSeqNum:e}:{seqNum:{global:e.global+1,client:n_},parentSeqNum:{global:e.global,client:n_}},eH=e=>{const t=["text","integer","real","blob"];return typeof e=="object"&&e!==null&&"columnType"in e&&t.includes(e.columnType)},Nx=Symbol.for("NoDefault"),wme=e=>typeof e=="object"&&e!==null&&"sql"in e&&typeof e.sql=="string",ny=e=>t=>{const n=(t==null?void 0:t.nullable)??!1,r=(t==null?void 0:t.schema)??nH(e),i=n===!0?l5(r):r,c=(t==null?void 0:t.default)===void 0||t.default===Nx?me():pe(t.default);return{columnType:e,schema:i,default:c,nullable:n,primaryKey:(t==null?void 0:t.primaryKey)??!1}},Eme=e=>ny(e),Wa=ny("text"),Qs=ny("integer"),Tme=ny("real"),tH=ny("blob"),Vw=(e,t)=>n=>{const r=(n==null?void 0:n.nullable)??!1,i=t._tag==="baseSchemaFn"?t.baseSchemaFn(n==null?void 0:n.schema):t.baseSchema,c=r===!0?l5(i):i,f=(n==null?void 0:n.default)===void 0||n.default===Nx?me():pe(n.default);return{columnType:e,schema:c,default:f,nullable:r,primaryKey:(n==null?void 0:n.primaryKey)??!1}},$x=Vw("text",{_tag:"baseSchemaFn",baseSchemaFn:e=>Eh(e??sr)}),kme=Vw("text",{_tag:"baseSchema",baseSchema:Wn}),Cme=Vw("integer",{_tag:"baseSchema",baseSchema:$a(dt,hx,{decode:e=>new Date(e),encode:e=>e.getTime()})}),Ame=Vw("integer",{_tag:"baseSchema",baseSchema:$a(dt,Po,{decode:e=>e===1,encode:e=>e?1:0})}),nH=e=>{switch(e){case"text":return W;case"integer":return dt;case"real":return dt;case"blob":return jw;default:return rf(e)}},Rme=e=>Array.isArray(e)?Object.fromEntries(e.map(t=>[t.name,t])):e,rH=(e,t,n)=>{const r={_tag:"table",name:e,columns:xme(t),indexes:Ome(n??[])};return{name:e,columns:t,indexes:n,ast:r}},sH=e=>ve(Object.fromEntries(e.ast.columns.map(t=>[t.name,t.schema]))).annotations({title:e.name}),aH=e=>ve(Object.fromEntries(e.ast.columns.map(t=>[t.name,t.nullable===!0||t.default._tag==="Some"?tt(t.schema):t.schema]))).annotations({title:e.name}),xme=e=>Object.entries(e).map(([t,n])=>({_tag:"column",name:t,schema:n.schema,default:n.default,nullable:n.nullable??!1,primaryKey:n.primaryKey??!1,type:{_tag:n.columnType}})),Ome=e=>e.map(t=>({_tag:"index",columns:t.columns,name:t.name,unique:t.isUnique??!1})),Dme=Object.freeze(Object.defineProperty({__proto__:null,NoDefault:Nx,blob:tH,boolean:Ame,column:Eme,datetime:kme,datetimeInteger:Cme,defaultSchemaForColumnType:nH,insertStructSchemaForTable:aH,integer:Qs,isColumnDefinition:eH,isSqlDefaultValue:wme,json:$x,makeDbSchema:Rme,real:Tme,structSchemaForTable:sH,table:rH,text:Wa},Symbol.toStringTag,{value:"Module"})),qme=e=>{let t=0,n,r;if(e.length===0)return t;for(n=0;n<e.length;n++)r=e.charCodeAt(n),t=(t<<5)-t+r,t=Math.trunc(t);return t},Nme=e=>qme(JSON.stringify(SS(e))),SS=e=>{switch(e._tag){case"table":return{_tag:"table",name:e.name,columns:e.columns.map(t=>SS(t)),indexes:e.indexes.map(t=>SS(t))};case"column":return{_tag:"column",name:e.name,type:e.type._tag,primaryKey:e.primaryKey,nullable:e.nullable,default:e.default};case"index":return{_tag:"index",columns:e.columns,name:e.name,unique:e.unique,primaryKey:e.primaryKey};case"foreignKey":return{_tag:"foreignKey",references:e.references,key:e.key,columns:e.columns};case"dbSchema":return{_tag:"dbSchema",tables:e.tables.map(SS)};default:throw new Error(`Unreachable: ${e}`)}},Ko=Symbol.for("QueryBuilderAst"),af=Symbol.for("QueryBuilder"),Di=e=>Ae(e,af),$me=ve({mergeCounter:dt,eventNum:ar});ve({fileName:W},{key:W,value:sr}).annotations({title:"LiveStore.PersistenceInfo"});const nk=ve({done:dt,total:dt}),Ime=ze(ve({stage:qe("loading")}),ve({stage:qe("migrating"),progress:nk}),ve({stage:qe("rehydrating"),progress:nk}),ve({stage:qe("syncing"),progress:nk}),ve({stage:qe("done")})).annotations({title:"BootStatus"}),ri=Symbol.for("@livestore/session-id"),To=class To extends li()("LiveStore.UnexpectedError",{cause:Th,note:tt(W),payload:tt(sr)}){};y(To,"mapToUnexpectedError",t=>t.pipe(pf(n=>rn(To)(n)?n:new To({cause:n})),X4(n=>new To({cause:n})))),y(To,"mapToUnexpectedErrorStream",t=>t.pipe(O5(n=>rn(To)(n)?n:new To({cause:n}))));let ft=To;class Pv extends li()("LiveStore.IntentionalShutdownCause",{reason:qe("devtools-reset","devtools-import","adapter-reset","manual")}){}class vS extends li()("LiveStore.StoreInterrupted",{reason:W}){}class Yg extends li()("LiveStore.SqliteError",{query:tt(ve({sql:W,bindValues:ze(dm({key:W,value:sr}),gt(sr))})),code:tt(ze(dt,W)),cause:Th,note:tt(W)}){}const Mme=ve({tableName:W,hashes:ve({expected:dt,actual:tt(dt)})}),jme=ve({migrations:gt(Mme)}),Jb=(e,t,n)=>e.length===0?"":`WHERE ${e.map(({col:i,op:c,value:f})=>{if(f===null){if(c!=="="&&c!=="!=")throw new Error(`Unsupported operator for NULL value: ${c}`);return`${i} ${c==="="?"IS":"IS NOT"} NULL`}const m=t.sqliteDef.columns[i];if(m===void 0)throw new Error(`Column ${i} not found`);if(c==="IN"||c==="NOT IN"){if(!Array.isArray(f))return at(`Expected array value for ${c} operator but got`,f);if(f.length===0)return c==="IN"?"0=1":"1=1";const b=f.map(v=>Yc(m.schema)(v));n.push(...b);const S=b.map(()=>"?").join(", ");return`${i} ${c} (${S})`}else{const b=Yc(m.schema)(f);return n.push(b),`${i} ${c} ?`}}).join(" AND ")}`,rk=e=>!e||e.length===0?"":` RETURNING ${e.join(", ")}`,sI=e=>{const t=[];if(e._tag==="InsertQuery"){const S=Object.keys(e.values),v=S.map(()=>"?").join(", "),q=Yc(e.tableDef.insertSchema)(e.values);S.forEach(x=>{t.push(q[x])});let k="INSERT",N="";if(e.onConflict)if(e.onConflict.action._tag==="replace")k="INSERT OR REPLACE";else if(N=` ON CONFLICT (${e.onConflict.targets.join(", ")}) `,e.onConflict.action._tag==="ignore")N+="DO NOTHING";else{const x=e.onConflict.action.update,C=Object.keys(x);if(C.length===0)throw new Error("No update columns provided for ON CONFLICT DO UPDATE");const E=C.map($=>x[$]===void 0?`${$} = excluded.${$}`:`${$} = ?`).join(", ");C.forEach($=>{const R=x[$];if(R!==void 0){const I=e.tableDef.sqliteDef.columns[$];if(I===void 0)throw new Error(`Column ${$} not found`);const z=Yc(I.schema)(R);t.push(z)}}),N+=`DO UPDATE SET ${E}`}let H=`${k} INTO '${e.tableDef.sqliteDef.name}' (${S.join(", ")}) VALUES (${v})`;return H+=N,H+=rk(e.returning),{query:H,bindValues:t}}if(e._tag==="UpdateQuery"){const S=Object.keys(e.values);if(S.length===0)return console.warn(`UPDATE query requires at least one column to set (for table ${e.tableDef.sqliteDef.name}). Running no-op query instead to skip this update query.`),{query:"SELECT 1",bindValues:[]};const v=Yc(Dv(e.tableDef.rowSchema))(e.values);S.forEach(N=>{t.push(v[N])});let q=`UPDATE '${e.tableDef.sqliteDef.name}' SET ${S.map(N=>`${N} = ?`).join(", ")}`;const k=Jb(e.where,e.tableDef,t);return k&&(q+=` ${k}`),q+=rk(e.returning),{query:q,bindValues:t}}if(e._tag==="DeleteQuery"){let S=`DELETE FROM '${e.tableDef.sqliteDef.name}'`;const v=Jb(e.where,e.tableDef,t);return v&&(S+=` ${v}`),S+=rk(e.returning),{query:S,bindValues:t}}if(e._tag==="CountQuery")return{query:[`SELECT COUNT(*) as count FROM '${e.tableDef.sqliteDef.name}'`,Jb(e.where,e.tableDef,t)].filter(v=>v.length>0).join(" "),bindValues:t};if(e._tag==="RowQuery"){const S=e.tableDef.sqliteDef.columns.id;if(S===void 0)throw new Error("Column id not found for ROW query");const v=e.id===ri?e.id:Yc(S.schema)(e.id);return{query:`SELECT * FROM '${e.tableDef.sqliteDef.name}' WHERE id = ?`,bindValues:[v]}}const r=`SELECT ${e.select.columns.length===0?"*":e.select.columns.join(", ")}`,i=`FROM '${e.tableDef.sqliteDef.name}'`,c=Jb(e.where,e.tableDef,t),f=e.orderBy.length>0?`ORDER BY ${e.orderBy.map(({col:S,direction:v})=>`${S} ${v}`).join(", ")}`:"",m=e.limit._tag==="Some"?"LIMIT ?":"",g=e.offset._tag==="Some"?"OFFSET ?":"";return e.offset._tag==="Some"&&t.push(e.offset.value),e.limit._tag==="Some"&&t.push(e.limit.value),{query:[r,i,c,f,g,m].map(S=>S.trim()).filter(S=>S.length>0).join(" "),bindValues:t}},es=(e,t=Fme(e))=>{const n={select(){Mg(t);const r=[...arguments];if(r.length===1){const[c]=r;return es(e,{...t,resultSchemaSingle:t.resultSchemaSingle.pipe(Qp(c)),select:{columns:[c]}})}const i=r;return es(e,{...t,resultSchemaSingle:i.length===0?t.resultSchemaSingle:t.resultSchemaSingle.pipe(Kp(...i)),select:{columns:i}})},where:function(){if(t._tag==="InsertQuery")return jg("Cannot use where with insert");if(t._tag==="RowQuery")return jg("Cannot use where with row");if(arguments.length===1){const g=arguments[0],b=Object.entries(g).filter(([,S])=>S!==void 0).map(([S,v])=>Ae(v,"op")&&Ae(v,"value")?{col:S,op:v.op,value:v.value}:{col:S,op:"=",value:v});switch(t._tag){case"CountQuery":case"SelectQuery":case"UpdateQuery":case"DeleteQuery":return es(e,{...t,where:[...t.where,...b]});default:return rf(t)}}const[r,i,c]=arguments,f=c===void 0?"=":i,m=c===void 0?i:c;switch(t._tag){case"CountQuery":case"SelectQuery":case"UpdateQuery":case"DeleteQuery":return es(e,{...t,where:[...t.where,{col:r,op:f,value:m}]});default:return rf(t)}},orderBy(){if(Mg(t),arguments.length===0||arguments.length>2)return jg();if(arguments.length===1){const c=arguments[0];return es(e,{...t,orderBy:[...t.orderBy,...c]})}const[r,i]=arguments;return es(e,{...t,orderBy:[...t.orderBy,{col:r,direction:i}]})},limit:r=>(Mg(t),es(e,{...t,limit:pe(r)})),offset:r=>(Mg(t),es(e,{...t,offset:pe(r)})),count:()=>zme(t)||t._tag==="InsertQuery"||t._tag==="UpdateQuery"||t._tag==="DeleteQuery"?jg():es(e,{_tag:"CountQuery",tableDef:e,where:t.where,resultSchema:ve({count:dt}).pipe(Qp("count"),gt,Kg())}),first:r=>(Mg(t),t.limit._tag==="Some"?jg(".first() can't be called after .limit()"):es(e,{...t,limit:pe(1),pickFirst:(r==null?void 0:r.fallback)!==void 0&&r.fallback!=="throws"?{fallback:r.fallback}:"throws"})),insert:r=>{const i=Object.fromEntries(Object.entries(r).filter(([,c])=>c!==void 0));return es(e,{_tag:"InsertQuery",tableDef:e,values:i,onConflict:void 0,returning:void 0,resultSchema:Oi})},onConflict:(r,i,c)=>{const f=Array.isArray(r)?r:[r];Lme(t);const m=r5(i).pipe(YT("ignore",()=>({targets:f,action:{_tag:"ignore"}})),YT("replace",()=>({targets:f,action:{_tag:"replace"}})),YT("update",()=>({targets:f,action:{_tag:"update",update:c}})),s5);return es(e,{...t,onConflict:m})},returning:(...r)=>(Ume(t),es(e,{...t,returning:r,resultSchema:e.rowSchema.pipe(Kp(...r),gt)})),update:r=>{const i=Object.fromEntries(Object.entries(r).filter(([,c])=>c!==void 0));return es(e,{_tag:"UpdateQuery",tableDef:e,values:i,where:[],returning:void 0,resultSchema:Oi})},delete:()=>es(e,{_tag:"DeleteQuery",tableDef:e,where:[],returning:void 0,resultSchema:Oi})};return{[af]:af,[Ko]:t,ResultType:"only-for-type-inference",asSql:()=>sI(t),toString:()=>{try{return sI(t).query}catch(r){return console.debug("QueryBuilder.toString(): Error converting query builder to string",r,t),"Error converting query builder to string"}},...n}},Fme=e=>({_tag:"SelectQuery",columns:[],pickFirst:!1,select:{columns:[]},orderBy:[],offset:me(),limit:me(),tableDef:e,where:[],resultSchemaSingle:e.rowSchema});function Mg(e){if(e._tag!=="SelectQuery")return at("Expected SelectQuery but got "+e._tag)}function Lme(e){if(e._tag!=="InsertQuery")return at("Expected InsertQuery but got "+e._tag)}function Ume(e){if(e._tag!=="InsertQuery"&&e._tag!=="UpdateQuery"&&e._tag!=="DeleteQuery")return at("Expected WriteQuery but got "+e._tag)}const zme=e=>e._tag==="RowQuery",jg=e=>at("Invalid query builder"+(e?`: ${e}`:"")),Gw=e=>{const t=e[Ko];switch(t._tag){case"SelectQuery":{const n=gt(t.resultSchemaSingle);if(t.pickFirst===!1)return n;if(t.pickFirst==="throws")return n.pipe(Kg());{const r=t.pickFirst.fallback();return ze(n,u5(qe(r))).pipe(Kg(()=>r))}}case"CountQuery":return ve({count:dt}).pipe(Qp("count"),gt,Kg());case"InsertQuery":case"UpdateQuery":case"DeleteQuery":return t.returning&&t.returning.length>0?t.tableDef.rowSchema.pipe(Kp(...t.returning),gt):dt;case"RowQuery":return t.tableDef.rowSchema.pipe(Qp("value"),hfe({title:`${t.tableDef.sqliteDef.name}.value`}),gt,Kg());default:rf(t)}},{integer:xn,text:ut}=Dme,Ds=e=>{const{name:t,columns:n,...r}=e,i=t,c={isClientDocumentTable:!1},f=eH(n)?{value:n}:n,m=rH(i,f,(r==null?void 0:r.indexes)??[]),g=sH(m),b=aH(m),S={sqliteDef:m,options:c,rowSchema:g,insertSchema:b},v=es(S);for(const q of Object.keys(v))S[q]=v[q];return S[Ko]=v[Ko],S[af]=v[af],S},Pme="__livestore_schema",Hme=Ds({name:Pme,columns:{tableName:Wa({primaryKey:!0}),schemaHash:Qs({nullable:!1}),updatedAt:Wa({nullable:!1})}}),Bme="__livestore_schema_event_defs",Vme=Ds({name:Bme,columns:{eventName:Wa({primaryKey:!0}),schemaHash:Qs({nullable:!1}),updatedAt:Wa({nullable:!1})}}),iH="__livestore_session_changeset",Gme=Ds({name:iH,columns:{seqNumGlobal:Qs({schema:kh}),seqNumClient:Qs({schema:Uv}),changeset:tH({nullable:!0}),debug:$x({nullable:!0})},indexes:[{columns:["seqNumGlobal","seqNumClient"],name:"idx_session_changeset_id"}]}),oH="__livestore_leader_merge_counter",Kme=Ds({name:oH,columns:{id:Qs({primaryKey:!0,schema:qe(0)}),mergeCounter:Qs({primaryKey:!0})}}),Ix=[Hme,Vme,Gme,Kme],Qme=e=>Ix.some(t=>t.sqliteDef.name===e),Yme="eventlog";Ds({name:Yme,columns:{seqNumGlobal:Qs({primaryKey:!0,schema:kh}),seqNumClient:Qs({primaryKey:!0,schema:Uv}),parentSeqNumGlobal:Qs({schema:kh}),parentSeqNumClient:Qs({schema:Uv}),name:Wa({}),argsJson:Wa({schema:Eh(sr)}),clientId:Wa({}),sessionId:Wa({}),schemaHash:Qs({}),syncMetadataJson:Wa({schema:Eh(up(sf))})},indexes:[{columns:["seqNumGlobal"],name:"idx_eventlog_seqNumGlobal"},{columns:["seqNumGlobal","seqNumClient"],name:"idx_eventlog_seqNum"}]});const Wme="__livestore_sync_status";Ds({name:Wme,columns:{head:Qs({primaryKey:!0})}});const aI=ze(W,dt,w5,Gs),cH=ze(gt(aI),dm({key:W,value:aI})).pipe(lfe("PreparedBindValues")),Kd=(e,...t)=>{let n="";for(const[r,i]of t.entries())n+=e[r]+String(i);return n+e[e.length-1]},hp=(e,t)=>{if(Array.isArray(e))return e;const n={};for(const[r,i]of Object.entries(e))t.includes(r)&&(n[`$${r}`]=i);return n},Mx=e=>{const{name:t,schema:n,...r}=e,i=c=>{const f=Wue(n)(c);return f._tag==="Left"&&at(`Invalid event args for event '${t}':`,f.left.message,`
`),{name:t,args:c}};return Object.defineProperty(i,"name",{value:t}),Object.defineProperty(i,"schema",{value:n}),Object.defineProperty(i,"encoded",{value:c=>({name:t,args:c})}),Object.defineProperty(i,"options",{value:{clientOnly:(r==null?void 0:r.clientOnly)??!1,facts:r!=null&&r.facts?(c,f)=>{var g,b;const m=r.facts(c,f);return{modify:{set:(g=m.modify)!=null&&g.set?new Set(m.modify.set):new Set,unset:(b=m.modify)!=null&&b.unset?new Set(m.modify.unset):new Set},require:m.require?new Set(m.require):new Set}}:void 0,derived:(r==null?void 0:r.derived)??!1}}),i},Nr=e=>Mx({...e,clientOnly:!1}),lH=(e,t)=>t,Jme=(e,t)=>t,Hv=Mx({name:"livestore.RawSql",schema:ve({sql:W,bindValues:tt(dm({key:W,value:sr})),writeTables:tt(mx(W))}),clientOnly:!0,derived:!0}),Xme=lH(Hv,({sql:e,bindValues:t,writeTables:n})=>({sql:e,bindValues:t??{},writeTables:n})),Zme=({name:e,schema:t,...n})=>{const r={partialSet:n.partialSet??!0,default:{id:n.default.id,value:n.default.value}},i={id:Wa({primaryKey:!0}),value:$x({schema:t})},c=Ds({name:e,columns:i});c.options.isClientDocumentTable=!0;const{eventDef:f,materializer:m}=tge({name:e,valueSchema:t,defaultValue:r.default.value,partialSet:r.partialSet}),g=(...v)=>{const[q,k=r.default.id]=v;return f({id:k,value:q})};Object.defineProperty(g,"name",{value:`${e}Set`}),Object.defineProperty(g,"schema",{value:ve({id:W,value:r.partialSet?Dv(t):t}).annotations({title:`${e}Set:Args`})}),Object.defineProperty(g,"options",{value:{derived:!0,clientOnly:!0,facts:void 0}});const b={get:nge(()=>S),set:g,Value:"only-for-type-inference",default:r.default,valueSchema:t,[Ch]:{derived:{setEventDef:f,setMaterializer:m},options:r}},S={...c,...b};return S},ege=(e,t)=>typeof e!="object"||typeof t!="object"||e===null||t===null?t:Object.keys(e).reduce((n,r)=>(n[r]=t[r]??e[r],n),{}),tge=({name:e,valueSchema:t,defaultValue:n,partialSet:r})=>{const i=Mx({name:`${e}Set`,schema:ve({id:ze(W,Xue(ri)),value:r?Dv(t):t}).annotations({title:`${e}Set:Args`}),clientOnly:!0,derived:!0}),c=lH(i,({id:f,value:m})=>{if(f===ri)return at("SessionIdSymbol needs to be replaced before materializing the set event");if(sS(t.ast).length===0||r===!1){const b=Eh(t),S=Wb(b)(m??n),v=Wb(b)(m);return{sql:`INSERT INTO '${e}' (id, value) VALUES (?, ?) ON CONFLICT (id) DO UPDATE SET value = ?`,bindValues:[f,S,v],writeTables:new Set([e])}}else{const b=Eh(Dv(t)),S=Wb(b)(ege(n,m));let v="value";const q=[],k=Object.keys(m),N=t.pipe(Kp(...k)),H=Wb(N)(m);for(const E in H){const $=H[E];$!==void 0&&(v=`json_set(${v}, ?, json(?))`,q.push(`$.${E}`,JSON.stringify($)))}const x=q.length>0?`ON CONFLICT (id) DO UPDATE SET value = ${v}`:"ON CONFLICT (id) DO NOTHING";return{sql:`
      INSERT INTO '${e}' (id, value)
      VALUES (?, ?)
      ${x}
    `,bindValues:[f,S,...q],writeTables:new Set([e])}}});return{eventDef:i,materializer:c}},Kw=e=>e.options.isClientDocumentTable===!0,nge=e=>((...t)=>{const n=e(),[r=n[Ch].options.default.id,i={}]=t,c=i.default??n[Ch].options.default.value,f={_tag:"RowQuery",tableDef:n,id:r,explicitDefaultValues:c},m=Kd`SELECT * FROM '${n.sqliteDef.name}' WHERE id = ?`;return{[af]:af,[Ko]:f,ResultType:"only-for-type-inference",asSql:()=>({query:m,bindValues:[r]}),toString:()=>m.toString()}}),Ch=Symbol("ClientDocumentTableDef"),rge=Symbol.for("livestore.LiveStoreSchema"),sge=e=>{var i;const t=e.state,n=e.state.sqlite.tables;for(const c of Ix)n.set(c.sqliteDef.name,c);const r=new Map;if(G5(e.events))for(const c of e.events)r.set(c.name,c);else for(const c of Object.values(e.events??{}))r.has(c.name)&&at(`Duplicate event name: ${c.name}. Please use unique names for events.`),r.set(c.name,c);r.set(Hv.name,Hv);for(const c of n.values())Kw(c)&&r.has(c.set.name)===!1&&r.set(c.set.name,c.set);return{LiveStoreSchemaSymbol:rge,_DbSchemaType:Symbol.for("livestore.DbSchemaType"),_EventDefMapType:Symbol.for("livestore.EventDefMapType"),state:t,eventsDefsMap:r,devtools:{alias:((i=e.devtools)==null?void 0:i.alias)??"default"}}},VC=(e,t)=>{const n=e.eventsDefsMap.get(t);if(n===void 0)return at(`No mutation definition found for \`${t}\`.`);const r=e.state.materializers.get(t);return r===void 0?at(`No materializer found for \`${t}\`.`):{eventDef:n,materializer:r}},age=({eventDef:e,materializer:t,dbState:n,event:r})=>{var g;const i=r.decoded===void 0?Q6(e.schema)(r.encoded.args):r.decoded.args,c=Dhe((g=r.decoded)==null?void 0:g.args)?void 0:tx(e.schema)(r.decoded.args);return uH(t(i,{eventDef:e,query:b=>{if(Di(b)){const{query:S,bindValues:v}=b.asSql(),q=n.select(S,hp(v,S)),k=Gw(b);return tf(k)(q)}else{const{query:S,bindValues:v}=b;return n.select(S,hp(v,S))}},currentFacts:new Map})).map(b=>{const S=b.sql,v=typeof b=="string"?c:b.bindValues,q=typeof b=="string"?void 0:b.writeTables;return{statementSql:S,bindValues:hp(v??{},S),writeTables:q}})},ige=e=>qn(JSON.stringify(e)),uH=e=>{if(G5(e))return e.flatMap(uH);if(Di(e)){const{query:t,bindValues:n}=e.asSql();return[{sql:t,bindValues:n,writeTables:void 0}]}else return typeof e=="string"?[{sql:e,bindValues:{},writeTables:void 0}]:[{sql:e.sql,bindValues:e.bindValues,writeTables:e.writeTables}]},fH=(e,t)=>{GC(e,ri,t)},GC=(e,t,n)=>{if(Array.isArray(e))for(const r in e)e[r]===t?e[r]=n:GC(e[r],t,n);else if(typeof e=="object"&&e!==null)for(const r in e)e[r]===t?e[r]=n:GC(e[r],t,n)},oge=e=>{const t=Array.isArray(e.tables)?e.tables:Object.values(e.tables),n=new Map;for(const c of t){const f=c.sqliteDef;n.has(f.ast.name)&&at(`Duplicate table name: ${f.ast.name}. Please use unique names for tables.`),n.set(f.ast.name,c)}for(const c of Ix)n.set(c.sqliteDef.name,c);const r=new Map;for(const[c,f]of Object.entries(e.materializers))r.set(c,f);r.set(Hv.name,Xme);for(const c of t)Kw(c)&&r.set(c[Ch].derived.setEventDef.name,c[Ch].derived.setMaterializer);const i=Nme({_tag:"dbSchema",tables:[...n.values()].map(c=>c.sqliteDef.ast)});return{sqlite:{tables:n,migrations:e.migrations??{strategy:"auto"},hash:i},materializers:r}};ve({name:W,args:sr,seqNum:ar,parentSeqNum:ar,clientId:W,sessionId:W}).annotations({title:"LiveStoreEvent.AnyDecoded"});const cge=ve({name:W,args:sr,seqNum:ar,parentSeqNum:ar,clientId:W,sessionId:W}).annotations({title:"LiveStoreEvent.AnyEncoded"}),lge=ve({name:W,args:sr,seqNum:kh,parentSeqNum:kh,clientId:W,sessionId:W}).annotations({title:"LiveStoreEvent.AnyEncodedGlobal"}),uge=ve({name:W,args:sr}),fge=e=>ze(...[...e.eventsDefsMap.values()].map(t=>ve({name:qe(t.name),args:t.schema,seqNum:ar,parentSeqNum:ar,clientId:W,sessionId:W}))).annotations({title:"EventDef"}),dH=zhe(fge),pp=class pp extends Sf("LiveStoreEvent.EncodedWithMeta")({name:W,args:sr,seqNum:ar,parentSeqNum:ar,clientId:W,sessionId:W,meta:ve({sessionChangeset:ze(ht("sessionChangeset",{data:w5,debug:sr.pipe(tt)}),ht("no-op",{}),ht("unset",{})),syncMetadata:up(sf),materializerHashLeader:up(dt),materializerHashSession:up(dt)}).pipe(y5,tt,g5({constructor:()=>({sessionChangeset:{_tag:"unset"},syncMetadata:me(),materializerHashLeader:me(),materializerHashSession:me()}),decoding:()=>({sessionChangeset:{_tag:"unset"},syncMetadata:me(),materializerHashLeader:me(),materializerHashSession:me()})}))}){constructor(){super(...arguments);y(this,"toJSON",()=>({seqNum:`${ni(this.seqNum)}  ${ni(this.parentSeqNum)} (${this.clientId}, ${this.sessionId})`,name:this.name,args:this.args}));y(this,"rebase",(n,r)=>new pp({...this,...qx(n,r)}));y(this,"toGlobal",()=>({...this,seqNum:this.seqNum.global,parentSeqNum:this.parentSeqNum.global}))}};y(pp,"fromGlobal",(n,r)=>new pp({...n,seqNum:{global:n.seqNum,client:n_},parentSeqNum:{global:n.parentSeqNum,client:n_},meta:{sessionChangeset:{_tag:"unset"},syncMetadata:r.syncMetadata,materializerHashLeader:r.materializerHashLeader,materializerHashSession:r.materializerHashSession}}));let Na=pp;const iI=(e,t)=>e.seqNum.global===t.seqNum.global&&e.seqNum.client===t.seqNum.client&&e.name===t.name&&e.clientId===t.clientId&&e.sessionId===t.sessionId&&JSON.stringify(e.args)===JSON.stringify(t.args);class abe extends li()("IsOfflineError",{}){}class ibe extends li()("InvalidPushError",{reason:ze(ht("Unexpected",{message:W}),ht("ServerAhead",{minimumExpectedNum:dt,providedNum:dt}))}){}class obe extends li()("InvalidPullError",{message:W}){}class dge extends li()("LeaderAheadError",{minimumExpectedNum:ar,providedNum:ar}){}class ki extends Sf("SyncState")({pending:gt(Na),upstreamHead:ar,localHead:ar}){constructor(){super(...arguments);y(this,"toJSON",()=>({pending:this.pending.map(n=>n.toJSON()),upstreamHead:ni(this.upstreamHead),localHead:ni(this.localHead)}))}}class hH extends ht("upstream-rebase",{rollbackEvents:gt(Na),newEvents:gt(Na)}){}class mH extends ht("upstream-advance",{newEvents:gt(Na)}){}class hge extends ht("local-push",{newEvents:gt(Na)}){}class mge extends ze(hH,mH,hge){}class gH extends ze(hH,mH){}class Qw extends Sf("MergeContext")({payload:mge,syncState:ki}){constructor(){super(...arguments);y(this,"toJSON",()=>({payload:r5(this.payload).pipe(WT("local-push",()=>({_tag:"local-push",newEvents:this.payload.newEvents.map(r=>r.toJSON())})),WT("upstream-advance",()=>({_tag:"upstream-advance",newEvents:this.payload.newEvents.map(r=>r.toJSON())})),WT("upstream-rebase",r=>({_tag:"upstream-rebase",newEvents:r.newEvents.map(i=>i.toJSON()),rollbackEvents:r.rollbackEvents.map(i=>i.toJSON())})),s5),syncState:this.syncState.toJSON()}))}}class Wg extends Sf("MergeResultAdvance")({_tag:qe("advance"),newSyncState:ki,newEvents:gt(Na),confirmedEvents:gt(Na),mergeContext:Qw}){constructor(){super(...arguments);y(this,"toJSON",()=>({_tag:this._tag,newSyncState:this.newSyncState.toJSON(),newEvents:this.newEvents.map(n=>n.toJSON()),confirmedEvents:this.confirmedEvents.map(n=>n.toJSON()),mergeContext:this.mergeContext.toJSON()}))}}class KC extends Sf("MergeResultRebase")({_tag:qe("rebase"),newSyncState:ki,newEvents:gt(Na),rollbackEvents:gt(Na),mergeContext:Qw}){constructor(){super(...arguments);y(this,"toJSON",()=>({_tag:this._tag,newSyncState:this.newSyncState.toJSON(),newEvents:this.newEvents.map(n=>n.toJSON()),rollbackEvents:this.rollbackEvents.map(n=>n.toJSON()),mergeContext:this.mergeContext.toJSON()}))}}class pH extends Sf("MergeResultReject")({_tag:qe("reject"),expectedMinimumId:ar,mergeContext:Qw}){constructor(){super(...arguments);y(this,"toJSON",()=>({_tag:this._tag,expectedMinimumId:ni(this.expectedMinimumId),mergeContext:this.mergeContext.toJSON()}))}}class _H extends Sf("MergeResultUnexpectedError")({_tag:qe("unexpected-error"),cause:ft}){}class cbe extends ze(Wg,KC,pH,_H){}const QC=e=>{if(Vo)debugger;return _H.make({_tag:"unexpected-error",cause:new ft({cause:e})})},oI=({syncState:e,payload:t,isClientEvent:n,isEqualEvent:r,ignoreClientEvents:i=!1})=>{var f,m,g;yH(e),gge(t);const c=Qw.make({payload:t,syncState:e});switch(t._tag){case"upstream-rebase":{const b=[...t.rollbackEvents,...e.pending],S=((f=t.newEvents.at(-1))==null?void 0:f.seqNum)??e.upstreamHead,v=cI({events:e.pending,baseEventSequenceNumber:S,isClientEvent:n});return nu(KC.make({_tag:"rebase",newSyncState:new ki({pending:v,upstreamHead:S,localHead:((m=v.at(-1))==null?void 0:m.seqNum)??S}),newEvents:[...t.newEvents,...v],rollbackEvents:b,mergeContext:c}))}case"upstream-advance":{if(t.newEvents.length===0)return nu(Wg.make({_tag:"advance",newSyncState:new ki({pending:e.pending,upstreamHead:e.upstreamHead,localHead:e.localHead}),newEvents:[],confirmedEvents:[],mergeContext:c}));for(let v=1;v<t.newEvents.length;v++)if(bS(t.newEvents[v-1].seqNum,t.newEvents[v].seqNum))return QC(`Events must be sorted in ascending order by event number. Received: [${t.newEvents.map(q=>ni(q.seqNum)).join(", ")}]`);if(bS(e.upstreamHead,t.newEvents[0].seqNum)||Dx(e.upstreamHead,t.newEvents[0].seqNum))return QC(`Incoming events must be greater than upstream head. Expected greater than: ${ni(e.upstreamHead)}. Received: [${t.newEvents.map(v=>ni(v.seqNum)).join(", ")}]`);const b=t.newEvents.at(-1).seqNum,S=YC({existingEvents:e.pending,incomingEvents:t.newEvents,isEqualEvent:r,isClientEvent:n,ignoreClientEvents:i});if(S===-1){const v=new Set(e.pending.map(x=>`${x.seqNum.global},${x.seqNum.client}`)),q=t.newEvents.filter(x=>!v.has(`${x.seqNum.global},${x.seqNum.client}`));let k=0;const[N,H]=EV(e.pending,(x,C)=>{if(i&&n(x))return k++,!1;const E=t.newEvents.at(C-k);return E?r(x,E)===!1:!0});return nu(Wg.make({_tag:"advance",newSyncState:new ki({pending:H,upstreamHead:b,localHead:((g=H.at(-1))==null?void 0:g.seqNum)??Sme(e.localHead,b)}),newEvents:q,confirmedEvents:N,mergeContext:c}))}else{const v=e.pending.slice(S),q=cI({events:v,baseEventSequenceNumber:b,isClientEvent:n}),k=YC({existingEvents:t.newEvents,incomingEvents:e.pending,isEqualEvent:r,isClientEvent:n,ignoreClientEvents:i});return nu(KC.make({_tag:"rebase",newSyncState:new ki({pending:q,upstreamHead:b,localHead:q.at(-1).seqNum}),newEvents:[...t.newEvents.slice(k),...q],rollbackEvents:v,mergeContext:c}))}}case"local-push":{if(t.newEvents.length===0)return nu(Wg.make({_tag:"advance",newSyncState:e,newEvents:[],confirmedEvents:[],mergeContext:c}));const b=t.newEvents.at(0);if(bS(b.seqNum,e.localHead)===!1){const v=qx(e.localHead,!0).seqNum;return nu(pH.make({_tag:"reject",expectedMinimumId:v,mergeContext:c}))}else return nu(Wg.make({_tag:"advance",newSyncState:new ki({pending:[...e.pending,...t.newEvents],upstreamHead:e.upstreamHead,localHead:t.newEvents.at(-1).seqNum}),newEvents:t.newEvents,confirmedEvents:[],mergeContext:c}))}default:rf(t)}},YC=({existingEvents:e,incomingEvents:t,isEqualEvent:n,isClientEvent:r,ignoreClientEvents:i})=>{if(i){const c=e.filter(g=>!r(g)),f=YC({existingEvents:c,incomingEvents:t,isEqualEvent:n,isClientEvent:r,ignoreClientEvents:!1});if(f===-1)return-1;const m=e[f].seqNum;return e.findIndex(g=>Dx(g.seqNum,m))}return e.findIndex((c,f)=>{const m=t[f];return m&&!n(c,m)})},cI=({events:e,baseEventSequenceNumber:t,isClientEvent:n})=>{let r=t;return e.map(i=>{const c=n(i),f=i.rebase(r,c);return r=f.seqNum,f})},gge=e=>{for(let t=1;t<e.newEvents.length;t++)if(zv(e.newEvents[t-1].seqNum,e.newEvents[t].seqNum))return QC(`Events must be ordered in monotonically ascending order by eventNum. Received: [${e.newEvents.map(n=>ni(n.seqNum)).join(", ")}]`)},yH=e=>{for(let t=0;t<e.pending.length;t++){const n=e.pending[t],r=e.pending[t+1];if(r===void 0)break;zv(n.seqNum,r.seqNum)&&at(`Events must be ordered in monotonically ascending order by eventNum. Received: [${e.pending.map(c=>ni(c.seqNum)).join(", ")}]`,{event:n,nextEvent:r}),r.seqNum.global>n.seqNum.global?r.seqNum.client!==0&&at(`New global events must point to clientId 0 in the parentSeqNum. Received: (${ni(r.seqNum)})`,e.pending,{event:n,nextEvent:r}):Dx(r.parentSeqNum,n.seqNum)===!1&&at("Events must be linked in a continuous chain via the parentSeqNum",e.pending,{event:n,nextEvent:r})}},nu=e=>(e._tag==="unexpected-error"||e._tag==="reject"||(yH(e.newSyncState),bS(e.newSyncState.upstreamHead,e.newSyncState.localHead)&&at("Local head must be greater than or equal to upstream head",{localHead:e.newSyncState.localHead,upstreamHead:e.newSyncState.upstreamHead}),zv(e.newSyncState.localHead,e.mergeContext.syncState.localHead)===!1&&at("New local head must be greater than or equal to the previous local head",{localHead:e.newSyncState.localHead,previousLocalHead:e.mergeContext.syncState.localHead}),zv(e.newSyncState.upstreamHead,e.mergeContext.syncState.upstreamHead)===!1&&at("New upstream head must be greater than or equal to the previous upstream head",{upstreamHead:e.newSyncState.upstreamHead,previousUpstreamHead:e.mergeContext.syncState.upstreamHead})),e),pge=({schema:e,clientSession:t,runtime:n,materializeEvent:r,rollback:i,refreshTables:c,span:f,params:m,confirmUnsavedChanges:g})=>{const b=dH(e),S={current:new ki({localHead:t.leaderThread.initialState.leaderHead,upstreamHead:t.leaderThread.initialState.leaderHead,pending:[]})},v=qs().pipe(ya),q=E=>VC(e,E.name).eventDef.options.clientOnly,k=Tde().pipe(ya),N=(E,{otelContext:$})=>{let R=S.current.localHead;const I=E.map(({name:K,args:Y})=>{const P=VC(e,K),ne=qx(R,P.eventDef.options.clientOnly);return R=ne.seqNum,new Na(tx(b)({name:K,args:Y,...ne,clientId:t.clientId,sessionId:t.sessionId}))}),z=oI({syncState:S.current,payload:{_tag:"local-push",newEvents:I},isClientEvent:q,isEqualEvent:iI});if(z._tag==="unexpected-error")return at("Unexpected error in client-session-sync-processor",z.cause);if(f.addEvent("local-push",{batchSize:I.length,mergeResult:Ig?JSON.stringify(z):void 0}),z._tag!=="advance")return at(`Expected advance, got ${z._tag}`);S.current=z.newSyncState,v.offer(z.newSyncState).pipe(ya);const V=new Set;for(const K of z.newEvents){const Y=tf(b)(K),{writeTables:P,sessionChangeset:ne,materializerHash:Se}=r(Y,{otelContext:$,withChangeset:!0,materializerHashLeader:me()});for(const Re of P)V.add(Re);K.meta.sessionChangeset=ne,K.meta.materializerHashSession=Se}return q$(k,I).pipe(ya),{writeTables:V}},H={rebaseCount:0,advanceCount:0,rejectCount:0},x=ts.setSpan(Os.active(),f),C=ye(function*(){if(g&&typeof window<"u"&&typeof window.addEventListener=="function"){const I=z=>{S.current.pending.length>0&&z.preventDefault()};yield*wn(Ke(()=>window.addEventListener("beforeunload",I)),()=>Ke(()=>window.removeEventListener("beforeunload",I)))}const E=yield*z6(),$=ye(function*(){const I=yield*kde(k,1,m.leaderPushBatchSize);yield*t.leaderThread.events.push(I).pipe(Xu("LeaderAheadError",()=>(H.rejectCount++,N$(k))))}).pipe(bh,kn,Ft);yield*Ev(E,$);const R=()=>{var I;return((I=t.sqliteDb.select(Kd`SELECT mergeCounter FROM ${oH} WHERE id = 0`)[0])==null?void 0:I.mergeCounter)??0};yield*D5(()=>t.leaderThread.events.pull({cursor:{mergeCounter:R(),eventNum:S.current.localHead}})).pipe($s(({payload:I,mergeCounter:z})=>ye(function*(){t.devtools.enabled&&(yield*t.devtools.pullLatch.await);const V=oI({syncState:S.current,payload:I,isClientEvent:q,isEqualEvent:iI});if(V._tag==="unexpected-error")return yield*Wu(V.cause);if(V._tag==="reject")return at("Unexpected reject in client-session-sync-processor",V);if(S.current=V.newSyncState,v.offer(V.newSyncState).pipe(ya),V._tag==="rebase"){f.addEvent("merge:pull:rebase",{payloadTag:I._tag,payload:Ig?JSON.stringify(I):void 0,newEventsCount:V.newEvents.length,rollbackCount:V.rollbackEvents.length,res:Ig?JSON.stringify(V):void 0,leaderMergeCounter:z}),H.rebaseCount++,yield*Rle(E),yield*N$(k),yield*Ev(E,$),Vo&&Ur("merge:pull:rebase: rollback",V.rollbackEvents.length,...V.rollbackEvents.slice(0,10).map(Y=>Y.toJSON()),{leaderMergeCounter:z}).pipe(ss(n),ya);for(let Y=V.rollbackEvents.length-1;Y>=0;Y--){const P=V.rollbackEvents[Y];P.meta.sessionChangeset._tag!=="no-op"&&P.meta.sessionChangeset._tag!=="unset"&&(i(P.meta.sessionChangeset.data),P.meta.sessionChangeset={_tag:"unset"})}yield*q$(k,V.newSyncState.pending)}else f.addEvent("merge:pull:advance",{payloadTag:I._tag,payload:Ig?JSON.stringify(I):void 0,newEventsCount:V.newEvents.length,res:Ig?JSON.stringify(V):void 0,leaderMergeCounter:z}),H.advanceCount++;if(V.newEvents.length===0)return;const K=new Set;for(const Y of V.newEvents){const P=tf(b)(Y),{writeTables:ne,sessionChangeset:Se,materializerHash:Re}=r(P,{otelContext:x,withChangeset:!0,materializerHashLeader:Y.meta.materializerHashLeader});for(const ge of ne)K.add(ge);Y.meta.sessionChangeset=Se,Y.meta.materializerHashSession=Re}c(K)}).pipe(Ft,Xh(V=>t.shutdown(V)))),Vr,bh,kn,At("client-session-sync-processor:pull"),Ft,En)});return{push:N,boot:C,syncState:Uw({get:ye(function*(){const E=S.current;return S===void 0?at("Not initialized"):E}),changes:nf(v)}),debug:{print:()=>ye(function*(){console.log("debugInfo",H),console.log("syncState",S.current);const E=yield*Ade(k);console.log("pushQueueSize",E);const $=yield*Cde(k);console.log("pushQueueItems",$.map(R=>R.toJSON()))}).pipe(ss(n),ya),debugInfo:()=>H}}},_ge="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let Ta=(e=21)=>{let t="",n=crypto.getRandomValues(new Uint8Array(e|=0));for(;e--;)t+=_ge[n[e]&63];return t};const bH=ht("RequestSessions",{}),SH=ht("SessionInfo",{storeId:W,clientId:W,sessionId:W,schemaAlias:W,isLeader:Po}),vH=ze(bH,SH),wH=({webChannel:e,sessionInfo:t})=>ye(function*(){yield*e.send(t),yield*e.listen.pipe(hl(),Ho(rn(bH)),$s(()=>e.send(t)),Vr)});var Ga,i_;class Bv{constructor(t){br(this,Ga,new Map);br(this,i_);y(this,"onEvict");y(this,"set",(t,n)=>{if(Ce(this,Ga).set(t,n),Ce(this,Ga).size>Ce(this,i_)){const r=Ce(this,Ga).keys().next().value,i=Ce(this,Ga).get(r);Ce(this,Ga).delete(r),this.onEvict&&this.onEvict(r,i)}});y(this,"get",t=>Ce(this,Ga).get(t));y(this,"delete",t=>{Ce(this,Ga).delete(t)});y(this,"keys",()=>Ce(this,Ga).keys());Zl(this,i_,t)}}Ga=new WeakMap,i_=new WeakMap;var Oj,pu,Yv;Oj=Symbol.iterator;class yge{constructor(t){br(this,pu);br(this,Yv,t=>{this.onEvict&&this.onEvict(t)});y(this,"onEvict");y(this,"add",t=>{Ce(this,pu).set(t,t)});y(this,Oj,()=>Ce(this,pu).keys());Zl(this,pu,new Bv(t)),Ce(this,pu).onEvict=Ce(this,Yv)}}pu=new WeakMap,Yv=new WeakMap;var Dj,Hs;Dj=Symbol.iterator;const Wv=class Wv{constructor(t){br(this,Hs,[]);y(this,"sizeLimit");y(this,"onEvict");y(this,"push",t=>{if(Ce(this,Hs).push(t),Ce(this,Hs).length>this.sizeLimit){const n=Ce(this,Hs).shift();n&&this.onEvict&&this.onEvict(n)}});y(this,"get",t=>Ce(this,Hs)[t]);y(this,"delete",t=>{Ce(this,Hs).splice(t,1)});y(this,Dj,()=>Ce(this,Hs)[Symbol.iterator]());y(this,"map",t=>Ce(this,Hs).map(t));y(this,"clear",()=>{Zl(this,Hs,[])});y(this,"sort",t=>Ce(this,Hs).sort(t));this.sizeLimit=t}get length(){return Ce(this,Hs).length}};Hs=new WeakMap,y(Wv,"make",(t,n=[])=>{const r=new Wv(t);for(const i of n)r.push(i);return r});let qi=Wv;const bge=ve({queryStr:W,bindValues:wh(cH),durationMs:dt,rowsCount:wh(dt),queriedTables:mx(W),startTimePerfNow:dt}),Sge=e=>bf([e],{decode:t=>(n,r,i)=>{if(n instanceof qi){const c=lm(gt(t))([...n],r);return ps(c,f=>qi.make(n.sizeLimit,f))}return fl(new Zn(i,n))},encode:t=>(n,r,i)=>{if(n instanceof qi){const c=yf(gt(t))([...n],r);return ps(c,f=>qi.make(n.sizeLimit,f))}return fl(new Zn(i,n))}},{description:`BoundArray<${um(e)}>`,pretty:()=>t=>`BoundArray(${t.length})`,arbitrary:()=>t=>t.anything(),equivalence:()=>(t,n)=>t===n}),lI=e=>$a(ve({size:dt,items:gt(e)}),Sge(Pi(e)),{encode:t=>({size:t.sizeLimit,items:[...t]}),decode:t=>qi.make(t.size,t.items)}),jx=ve({slowQueries:lI(bge),queryFrameDuration:dt,queryFrameCount:dt,events:lI(u5(W,sr))});y5(jx);const gs="0.3.1",uI=4,vge=ve({isConnected:Po,timestampMs:dt,latchClosed:Po}),mp=W,Fx=W,EH=W,wS=qe(gs),Yw=(e,t)=>ht(e,{liveStoreVersion:wS,...t}).annotations({identifier:e}),wge=(e,t)=>Yw(e,{clientId:Fx,...t}),Ege=(e,t)=>Yw(e,{clientId:Fx,sessionId:EH,...t}),gr=(e,t)=>Yw(e,{clientId:Fx,sessionId:EH,requestId:mp,...t}),Mn=(e,t)=>wge(e,{requestId:mp,...t}),Lx=(e,t)=>{const n=ht(`${e}.Response.Success`,{requestId:mp,liveStoreVersion:wS,...t.success}).annotations({identifier:`${e}.Response.Success`}),r=t.error?ht(`${e}.Response.Error`,{requestId:mp,liveStoreVersion:wS,...t.error}).annotations({identifier:`${e}.Response.Error`}):$w;return{Request:ht(`${e}.Request`,{requestId:mp,liveStoreVersion:wS,...t.payload}).annotations({identifier:`${e}.Request`}),Response:ze(n,r),Success:n,Error:r}};class Tge extends gr("LSD.ClientSession.DebugInfoReq",{}){}class TH extends gr("LSD.ClientSession.DebugInfoRes",{debugInfo:jx}){}class kge extends gr("LSD.ClientSession.DebugInfoHistorySubscribe",{subscriptionId:W}){}class kH extends gr("LSD.ClientSession.DebugInfoHistoryRes",{debugInfoHistory:gt(jx),subscriptionId:W}){}class Cge extends gr("LSD.ClientSession.DebugInfoHistoryUnsubscribe",{subscriptionId:W}){}class Age extends gr("LSD.ClientSession.DebugInfoResetReq",{}){}class CH extends gr("LSD.ClientSession.DebugInfoResetRes",{}){}class Rge extends gr("LSD.ClientSession.DebugInfoRerunQueryReq",{queryStr:W,bindValues:wh(cH),queriedTables:mx(W)}){}class AH extends gr("LSD.ClientSession.DebugInfoRerunQueryRes",{}){}let xge=class extends gr("LSD.ClientSession.SyncHeadSubscribe",{subscriptionId:W}){},Oge=class extends gr("LSD.ClientSession.SyncHeadUnsubscribe",{subscriptionId:W}){},RH=class extends gr("LSD.ClientSession.SyncHeadRes",{local:ar,upstream:ar,subscriptionId:W}){};class Dge extends gr("LSD.ClientSession.ReactivityGraphSubscribe",{includeResults:Po,subscriptionId:W}){}class qge extends gr("LSD.ClientSession.ReactivityGraphUnsubscribe",{subscriptionId:W}){}class xH extends gr("LSD.ClientSession.ReactivityGraphRes",{reactivityGraph:sr,subscriptionId:W}){}class Nge extends gr("LSD.ClientSession.LiveQueriesSubscribe",{subscriptionId:W}){}class $ge extends gr("LSD.ClientSession.LiveQueriesUnsubscribe",{subscriptionId:W}){}class Ige extends ve({_tag:qe("computed","db","graphql","signal"),id:dt,label:W,hash:W,runs:dt,executionTimes:gt(dt),lastestResult:sr,activeSubscriptions:gt(ve({frames:gt(ve({name:W,filePath:W}))}))}){}class OH extends gr("LSD.ClientSession.LiveQueriesRes",{liveQueries:gt(Ige),subscriptionId:W}){}let Mge=class extends gr("LSD.ClientSession.Ping",{}){},DH=class extends gr("LSD.ClientSession.Pong",{}){},Ux=class extends Ege("LSD.ClientSession.Disconnect",{}){};const jge=ze(Tge,kge,Cge,Age,Rge,Dge,qge,Nge,$ge,Ux,Mge,xge,Oge).annotations({identifier:"LSD.ClientSession.MessageToApp"}),Fge=ze(TH,kH,CH,AH,xH,OH,Ux,DH,RH).annotations({identifier:"LSD.ClientSession.MessageFromApp"});class gbe extends Mn("LSD.Leader.ResetAllDataReq",{mode:qe("all-data","only-app-db")}){}class Lge extends Mn("LSD.Leader.DatabaseFileInfoReq",{}){}class fI extends ve({fileSize:dt,persistenceInfo:ve({fileName:W},{key:W,value:sr})}){}class Uge extends Mn("LSD.Leader.DatabaseFileInfoRes",{state:fI,eventlog:fI}){}class zge extends Mn("LSD.Leader.NetworkStatusSubscribe",{subscriptionId:W}){}class Pge extends Mn("LSD.Leader.NetworkStatusUnsubscribe",{subscriptionId:W}){}class Hge extends Mn("LSD.Leader.NetworkStatusRes",{networkStatus:vge,subscriptionId:W}){}class Bge extends Mn("LSD.Leader.SyncingInfoReq",{}){}class Vge extends ve({enabled:Po,metadata:dm({key:W,value:sr})}){}class Gge extends Mn("LSD.Leader.SyncingInfoRes",{syncingInfo:Vge}){}class Kge extends Mn("LSD.Leader.SyncHistorySubscribe",{subscriptionId:W}){}class Qge extends Mn("LSD.Leader.SyncHistoryUnsubscribe",{subscriptionId:W}){}class Yge extends Mn("LSD.Leader.SyncHistoryRes",{eventEncoded:lge,metadata:up(sf),subscriptionId:W}){}class Wge extends Mn("LSD.Leader.SyncHeadSubscribe",{subscriptionId:W}){}class Jge extends Mn("LSD.Leader.SyncHeadUnsubscribe",{subscriptionId:W}){}class Xge extends Mn("LSD.Leader.SyncHeadRes",{local:ar,upstream:ar,subscriptionId:W}){}class Zge extends Mn("LSD.Leader.SnapshotReq",{}){}class epe extends Mn("LSD.Leader.SnapshotRes",{snapshot:Gd}){}const qH=Lx("LSD.Leader.LoadDatabaseFile",{payload:{data:Gd},success:{},error:{cause:ze(ht("unsupported-file",{}),ht("unsupported-database",{}),ht("unexpected-error",{cause:Th}))}});class tpe extends Yw("LSD.Leader.SyncPull",{payload:gH}){}class npe extends Mn("LSD.Leader.CommitEventReq",{eventEncoded:uge}){}class rpe extends Mn("LSD.Leader.CommitEventRes",{}){}class spe extends Mn("LSD.Leader.EventlogReq",{}){}class ape extends Mn("LSD.Leader.EventlogRes",{eventlog:Gd}){}class ipe extends Mn("LSD.Leader.Ping",{}){}class ope extends Mn("LSD.Leader.Pong",{}){}class NH extends Mn("LSD.Leader.Disconnect",{}){}const zx=Lx("LSD.Leader.SetSyncLatch",{payload:{closeLatch:Po},success:{}}),Px=Lx("LSD.Leader.ResetAllData",{payload:{mode:qe("all-data","only-app-db")},success:{}}),cpe=ze(Zge,qH.Request,spe,Px.Request,zge,Pge,NH,npe,ipe,Lge,Kge,Qge,Bge,Wge,Jge,zx.Request).annotations({identifier:"LSD.Leader.MessageToApp"});ze(epe,qH.Response,ape,NH,tpe,Hge,rpe,ope,Uge,Yge,Gge,Xge,Px.Success,zx.Success).annotations({identifier:"LSD.Leader.MessageFromApp"});const lpe=ze(ht("node",{url:W}),ht("web",{}),ht("browser-extension",{}));lpe.pipe(Qp("_tag"),Pi);const upe={client:{session:({storeId:e,clientId:t,sessionId:n})=>`client-session-${e}-${t}-${n}`,leader:({storeId:e,clientId:t})=>`client-leader-${e}-${t}`}},$H={sessionInfo:()=>"session-info",devtoolsClientSession:({storeId:e,clientId:t,sessionId:n})=>`devtools-channel(client-session-${e}-${t}-${n})`,devtoolsClientLeader:({storeId:e,clientId:t,sessionId:n})=>`devtools-channel(client-leader-${e}-${t}-${n})`},fpe={devtoolsClientSession:(e,{storeId:t,clientId:n,sessionId:r})=>e===$H.devtoolsClientSession({storeId:t,clientId:n,sessionId:r}),devtoolsClientLeader:(e,{storeId:t,clientId:n})=>e.startsWith(`devtools-channel(client-leader-${t}-${n}`)},dpe=e=>e.makeBroadcastChannel({channelName:$H.sessionInfo(),schema:vH}),hpe=({otelTracer:e,parentSpanContext:t})=>n=>{const r=V_(V5,e??Nhe()),i=oP(Tt(xhe,cP)).pipe(rae(r));return n.pipe(t?Od(Ohe(ts.getSpanContext(t))):Ie,ss(i))},Vv=e=>{const t=e._duration;return t[0]*1e3+t[1]/1e6},dI=e=>e._performanceStartTime,ry=W.pipe(tt,g5({constructor:()=>Ta(10),decoding:()=>Ta(10)})),wf={id:ry,target:W,source:W,channelName:W,hops:gt(W)},IH=o5.pipe(tt);class ES extends ht("DirectChannelRequest",{...wf,remainingHops:gt(W).pipe(tt),channelVersion:dt,reqId:wh(W),sourceId:W}){}class MH extends ht("DirectChannelResponseSuccess",{...wf,reqId:W,port:Hw,remainingHops:gt(W),channelVersion:dt}){}class Hx extends ht("DirectChannelResponseNoTransferables",{...wf,reqId:W,remainingHops:gt(W)}){}class jH extends ht("ProxyChannelRequest",{...wf,remainingHops:IH,channelIdCandidate:W}){}class FH extends ht("ProxyChannelResponseSuccess",{...wf,reqId:W,remainingHops:gt(W),combinedChannelId:W,channelIdCandidate:W}){}class LH extends ht("ProxyChannelPayload",{...wf,remainingHops:IH,payload:sr,combinedChannelId:W}){}class UH extends ht("ProxyChannelPayloadAck",{...wf,reqId:W,remainingHops:gt(W),combinedChannelId:W}){}class WC extends ht("NetworkEdgeAdded",{id:ry,source:W,target:W}){}class JC extends ht("NetworkTopologyRequest",{id:ry,hops:gt(W),source:W,target:qe("-")}){}class XC extends ht("NetworkTopologyResponse",{id:ry,reqId:W,remainingHops:gt(W),nodeName:W,edges:gt(W),source:W,target:qe("-")}){}const TS=ht("BroadcastChannelPacket",{id:ry,channelName:W,payload:sr,hops:gt(W),source:W,target:qe("-")});class ZC extends ze(ES,MH,Hx){}class zH extends ze(jH,FH,LH,UH){}class Bx extends ze(ZC,zH,WC,JC,XC,TS){}class Xb extends ht("DirectChannelPing",{}){}class Zb extends ht("DirectChannelPong",{}){}class mpe extends li()("EdgeAlreadyExistsError",{target:W}){}const gp=e=>({packetId:e.id,"span.label":e.id+(Ae(e,"reqId")&&e.reqId!==void 0?` for ${e.reqId}`:""),...e._tag!=="DirectChannelResponseSuccess"&&e._tag!=="ProxyChannelPayload"?{packet:e}:{}});ve({channelName:W,source:W,mode:ze(qe("proxy"),qe("direct"))});const gpe=xt,ppe=({nodeName:e,incomingPacketsQueue:t,target:n,checkTransferableEdges:r,channelName:i,schema:c,sendPacket:f,channelVersion:m,scope:g,sourceId:b})=>ye(function*(){const S=yield*gpe(),v=yield*zw.pipe(h2(()=>Gn(void 0))),q={send:ze(c.send,Xb,Zb),listen:ze(c.listen,Xb,Zb)},k={current:{_tag:"Initial"}},N=({packet:E,respondToSender:$})=>ye(function*(){const R=k.current;if(v==null||v.addEvent(`process:${E._tag}`,{channelState:R._tag,packetId:E.id,packetReqId:E.reqId,packetChannelVersion:Ae("channelVersion")(E)?E.channelVersion:void 0}),R._tag==="Initial")return at();if(E._tag==="DirectChannelResponseNoTransferables")return yield*CR(S,E),"close";if(E.channelVersion>m)return v==null||v.addEvent(`incoming packet has higher version (${E.channelVersion}), closing channel`),yield*Xn(g,$n("higher-version-expected")),"close";if(E.channelVersion<m){const I=ES.make({source:e,sourceId:b,target:n,channelName:i,channelVersion:m,hops:[],remainingHops:E.hops,reqId:void 0});v==null||v.addEvent(`incoming packet has lower version (${E.channelVersion}), sending request to reconnect (${I.id})`),yield*f(I);return}if(R._tag==="Established"&&E._tag==="DirectChannelRequest")return E.sourceId===R.otherSourceId?void 0:(v==null||v.addEvent("force-new-channel"),yield*Xn(g,$n("force-new-channel")),"close");switch(E._tag){case"DirectChannelRequest":{if(R._tag!=="RequestSent")return;if(E.reqId!==R.reqPacketId){const z=ES.make({source:e,sourceId:b,target:n,channelName:i,channelVersion:m,hops:[],remainingHops:E.hops,reqId:E.id});v==null||v.addEvent(`Re-sending new request (${z.id}) for incoming request (${E.id})`),yield*f(z)}if(e>n){v==null||v.addEvent("winner side: creating direct channel and sending response");const z=new MessageChannel,V=yield*tI({port:z.port1,schema:q,debugId:m}).pipe(Hp(nI));yield*$(MH.make({reqId:E.id,target:n,source:e,channelName:E.channelName,hops:[],remainingHops:E.hops.slice(0,-1),port:z.port2,channelVersion:m})),k.current={_tag:"winner:ResponseSent",channel:V,otherSourceId:E.sourceId},yield*V.listen.pipe(hl(),Ho(rn(Xb)),Iv(1),Vr),yield*V.send(Zb.make({})),v==null||v.addEvent("winner side: established"),k.current={_tag:"Established",otherSourceId:E.sourceId},yield*dn(S,V)}else v==null||v.addEvent("loser side: waiting for response"),k.current={_tag:"loser:WaitingForResponse",otherSourceId:E.sourceId};break}case"DirectChannelResponseSuccess":{if(R._tag!=="loser:WaitingForResponse")return at(`Expected to find direct channel response from ${n}, but was in ${R._tag} state`);const I=yield*tI({port:E.port,schema:q,debugId:m}).pipe(Hp(nI)),z=yield*I.listen.pipe(hl(),Ho(rn(Zb)),Iv(1),Vr,_2);yield*I.send(Xb.make({})).pipe(yh(10),hw({times:2})),yield*z,v==null||v.addEvent("loser side: established"),k.current={_tag:"Established",otherSourceId:R.otherSourceId},yield*dn(S,I);return}default:return rf(E)}}).pipe(At(`handleMessagePacket:${E._tag}:${E.source}${E.target}`,{attributes:gp(E)}));yield*ye(function*(){for(;;){const E=yield*Sh(t);if((yield*N(E))==="close")return}}).pipe(kn,Ft,En);const H=k.current;return H._tag!=="Initial"?at(`Expected channel to be in Initial state, but was in ${H._tag} state`):(yield*ye(function*(){const E=ES.make({source:e,sourceId:b,target:n,channelName:i,channelVersion:m,hops:[],reqId:void 0});k.current={_tag:"RequestSent",reqPacketId:E.id};const $=r(E);if($!==void 0)return yield*wa(`No transferable edges found for ${E.source}${E.target}`),yield*Wu($);yield*f(E),v==null||v.addEvent(`initial edge request sent (${E.id})`)}),yield*S)}).pipe(E2(`makeDirectChannel:${m}`)),_pe=({schema:e,newEdgeAvailablePubSub:t,channelName:n,checkTransferableEdges:r,nodeName:i,incomingPacketsQueue:c,target:f,sendPacket:m})=>vf(g=>ye(function*(){const b=Ta(),S=yield*qs(),v=yield*Ace(),q=yield*xt(),k={pendingSends:0,totalSends:0,connectCounter:0,isConnected:!1,innerChannelRef:{current:void 0}};yield*ye(function*(){const $=yield*xt();for(;;){k.connectCounter++;const V=k.connectCounter;yield*wa(`Connecting#${V}`);const K=yield*z_();yield*rs(Se=>Xn(K,Se));const Y=yield*R5(t).pipe($s(Se=>wa(`new-conn:${Se}`)),Iv(1),Vr,Io("new-edge"),_2),P=ppe({nodeName:i,sourceId:b,incomingPacketsQueue:c,target:f,checkTransferableEdges:r,channelName:n,schema:e,channelVersion:V,sendPacket:m,scope:K}).pipe(U_(K),vs(K),Use(me())),ne=yield*nP(P,Y.pipe(Ase));if(ne==="new-edge")yield*Xn(K,Qh("new-edge"));else{const Se=yield*ne.pipe(In);if(Se._tag==="Failure")yield*Xn(K,Se),i4(Se.cause)&&rn(Hx)(Se.cause.error)&&(yield*Y.pipe(In));else{const Re=Se.value;yield*dn($,{channel:Re,makeDirectChannelScope:K,channelVersion:V});break}}}const{channel:R,makeDirectChannelScope:I,channelVersion:z}=yield*$;yield*wa(`Connected#${z}`),k.isConnected=!0,k.innerChannelRef.current=R,yield*dn(q,void 0),yield*R.listen.pipe(hl(),$5(V=>q2(S,V)),Vr,Ft,vs(I)),yield*ye(function*(){for(;;){const[V,K]=yield*kce(v);yield*R.send(V),yield*dn(K,void 0),yield*Cce(v)}}).pipe(vs(I)),yield*R.closedDeferred,yield*Xn(I,$n("channel-closed")),yield*wa(`Disconnected#${z}`),k.isConnected=!1,k.innerChannelRef.current=void 0}).pipe(Zu,bh,Ft,En);const N=yield*w2.pipe(va),H=$=>ye(function*(){const R=yield*xt();k.pendingSends++,k.totalSends++,yield*Tce(v,[$,R]),yield*R,k.pendingSends--}).pipe(Zu,Od(N)),x=nf(S,{maxChunkSize:1}).pipe(El(He)),C=yield*xt().pipe(wn(Sl(ea)));return{webChannel:{[as]:as,send:H,listen:x,closedDeferred:C,supportsTransferables:!0,schema:e,debugInfo:k,shutdown:Xn(g,$n("shutdown"))},initialEdgeDeferred:q}})),ype=({queue:e,nodeName:t,newEdgeAvailablePubSub:n,sendPacket:r,target:i,channelName:c,schema:f})=>vf(m=>ye(function*(){const g={current:{_tag:"Initial"}},b={kind:"proxy-channel",pendingSends:0,totalSends:0,connectCounter:0,isConnected:!1},S=Ta(5);yield*uC({channelIdCandidate:S});const v=yield*w2.pipe(va),q=yield*q5(!1),k=ye(function*(){return yield*$$(q,ne=>ne!==!1)}),N=P=>ye(function*(){yield*wa(`Connected (${P})`).pipe(Od(v)),g.current={_tag:"Established",listenSchema:f.listen,listenQueue:$,ackMap:R,combinedChannelId:P},yield*_S(q,g.current),b.isConnected=!0}),H=Nn(()=>r(jH.make({channelName:c,hops:[],source:t,target:i,channelIdCandidate:S}))),x=P=>[S,P].sort().join("_"),C=yield*qs().pipe(wn(ys)),E=({packet:P,respondToSender:ne})=>ye(function*(){const Re=`target:${P.source}, channelName:${P.channelName}`,ge=g.current;switch(P._tag){case"ProxyChannelRequest":{const Ve=x(P.channelIdCandidate);ge._tag==="Established"?ge.combinedChannelId===Ve||(yield*Xa(`[${t}] Received ProxyChannelRequest with different channel ID (${Ve}) while established with ${ge.combinedChannelId}. Re-establishing.`),yield*_S(q,!1),g.current={_tag:"Pending",initiatedVia:"incoming-request"},yield*wa("Reconnecting (received conflicting ProxyChannelRequest)").pipe(Od(v)),b.isConnected=!1,b.connectCounter++,yield*H):ge._tag==="Initial"&&(yield*_S(q,!1),g.current={_tag:"Pending",initiatedVia:"incoming-request"},yield*wa("Connecting (received ProxyChannelRequest)").pipe(Od(v)),b.isConnected=!1,b.connectCounter++),yield*ne(FH.make({reqId:P.id,remainingHops:P.hops,hops:[],target:i,source:t,channelName:c,combinedChannelId:Ve,channelIdCandidate:S}));return}case"ProxyChannelResponseSuccess":{if(ge._tag!=="Pending"){if(ge._tag==="Established"&&ge.combinedChannelId!==P.combinedChannelId)return at(`ProxyChannel[${Re}]: Expected proxy channel to have the same combinedChannelId as the packet:
${ge.combinedChannelId} (channel) === ${P.combinedChannelId} (packet)`);if(ge._tag==="Established")return;yield*Xa(`[${t}] Ignoring ResponseSuccess ${P.id} received in unexpected state ${ge._tag}`);return}const Ve=x(P.channelIdCandidate);if(Ve!==P.combinedChannelId)return yield*Pp(`ProxyChannel[${Re}]: Expected proxy channel to have the same combinedChannelId as the packet:
${Ve} (channel) === ${P.combinedChannelId} (packet)`);yield*N(P.combinedChannelId);const oe=g.current;if(oe._tag==="Established"){const Te=yield*lie(C);for(const Ee of Te){if(oe.combinedChannelId!==Ee.combinedChannelId){yield*Xa(`[${t}] Discarding buffered payload ${Ee.id}: Combined channel ID mismatch during drain. Expected ${oe.combinedChannelId}, got ${Ee.combinedChannelId}`);continue}const pt=yield*Tv(oe.listenSchema)(Ee.payload);yield*oe.listenQueue.pipe(Tn(pt))}}else yield*Bp(`[${t}] State is not Established immediately after setStateToEstablished was called. Cannot drain buffer. State: ${oe._tag}`);return}case"ProxyChannelPayload":{if(ge._tag==="Established"&&ge.combinedChannelId!==P.combinedChannelId)return yield*Pp(`ProxyChannel[${Re}]: Expected proxy channel to have the same combinedChannelId as the packet:
${ge.combinedChannelId} (channel) === ${P.combinedChannelId} (packet)`);if(yield*ne(UH.make({reqId:P.id,remainingHops:P.hops,hops:[],target:i,source:t,channelName:c,combinedChannelId:ge._tag==="Established"?ge.combinedChannelId:P.combinedChannelId})),ge._tag==="Established"){const Ve=yield*Tv(ge.listenSchema)(P.payload);yield*ge.listenQueue.pipe(Tn(Ve))}else yield*Tn(C,P);return}case"ProxyChannelPayloadAck":{if(ge._tag!=="Established"){yield*wa(`Not yet connected to ${i}. dropping message`),yield*Xa(`[${t}] Received Ack but not established (State: ${ge._tag}). Dropping Ack for ${P.reqId}`);return}const Ve=ge.ackMap.get(P.reqId)??at(`[ProxyChannel[${Re}]] Expected ack for ${P.reqId}`);yield*dn(Ve,void 0),ge.ackMap.delete(P.reqId);return}default:return rf(P)}}).pipe(At(`handleProxyPacket:${P._tag}:${P.source}->${P.target}`,{attributes:gp(P)}));yield*nf(e).pipe($s(E),Vr,Ft,En);const $=yield*qs();yield*wa("Connecting");const R=new Map;{if(g.current._tag!=="Initial")return at("Expected proxy channel to be Initial");g.current={_tag:"Pending",initiatedVia:"outgoing-request"},yield*H;const P=yield*R5(n).pipe($s(()=>H),Vr,En),{combinedChannelId:ne}=yield*k;yield*Js(P),yield*N(ne)}const I=P=>ye(function*(){const ne=yield*rx(f.send)(P),Se=yield*z6(),Re=yield*xt();b.pendingSends++,b.totalSends++;const ge=ye(function*(){const{combinedChannelId:oe}=yield*$$(q,Ee=>Ee!==!1);yield*ye(function*(){const Ee=yield*xt(),pt=LH.make({channelName:c,payload:ne,hops:[],source:t,target:i,combinedChannelId:oe});R.set(pt.id,Ee),yield*r(pt),yield*Ee,yield*dn(Re,void 0),b.pendingSends--}).pipe(yh(100),hw(u6(10)),va)}).pipe(Ys(Bp)),Ve=yield*q.changes.pipe(Ho(oe=>oe===!1),$s(()=>Ev(Se,ge)),Vr,_2);yield*Ev(Se,ge),yield*Re,yield*Js(Ve)}).pipe(Zu,At("sendAckWithRetry:ProxyChannelPayload"),Od(v)),z=nf($).pipe(El(He)),V=yield*xt().pipe(wn(Sl(ea))),K=yield*em();return{[as]:as,send:I,listen:z,closedDeferred:V,supportsTransferables:!1,schema:f,shutdown:Xn(m,ea),debugInfo:b,debug:{ping:(P="ping")=>I(t_.make({message:P})).pipe(ss(K),Ft,oi)}}}).pipe(E2("makeProxyChannel"))),Jv=class Jv{constructor({timeout:t}){y(this,"values",new Map);y(this,"timeoutHandle");y(this,"timeoutMs");y(this,"onShutdown",()=>clearTimeout(this.timeoutHandle));this.timeoutMs=Xd(t)}add(t){this.values.set(t,Date.now()),this.scheduleCleanup()}has(t){return this.values.has(t)}delete(t){this.values.delete(t)}scheduleCleanup(){this.timeoutHandle===void 0&&(this.timeoutHandle=setTimeout(()=>{this.cleanup(),this.timeoutHandle=void 0},this.timeoutMs))}cleanup(){const t=Date.now();for(const[n,r]of this.values.entries())t-r>=this.timeoutMs&&this.values.delete(n)}};y(Jv,"make",t=>ye(function*(){const n=new Jv({timeout:t});return yield*rs(()=>Ke(()=>n.onShutdown())),n}));let eA=Jv;const bpe=e=>ye(function*(){const t=new Map,n=yield*eA.make(fL(1)),r=yield*pP().pipe(wn(dC)),i=new Map,c=yield*qs().pipe(wn(ys)),f=new Map,m=new Map,g=R=>{var I;if(R._tag==="DirectChannelRequest"&&(t.size===0||((I=t.get(R.target))==null?void 0:I.channel.supportsTransferables)===!1)||![...t.values()].some(z=>z.channel.supportsTransferables===!0))return Hx.make({reqId:R.id,channelName:R.channelName,source:R.target,target:R.source,remainingHops:R.hops,hops:[]})},b=R=>ye(function*(){var I,z;if(rn(WC)(R)){yield*wa("NetworkEdgeAdded",{packet:R,nodeName:e}),yield*O2(r,R.target);const V=Array.from(t).filter(([K])=>K!==R.source).map(([K,Y])=>Y.channel);yield*Hr(V,K=>K.send(R),{concurrency:"unbounded"});return}if(rn(TS)(R)){const V=Array.from(t).filter(([P])=>!R.hops.includes(P)).map(([P,ne])=>ne.channel),K={...R,hops:[...R.hops,e]};if(yield*Hr(V,P=>P.send(K),{concurrency:"unbounded"}),R.source===e)return;const Y=m.get(R.channelName);Y!==void 0&&(yield*Tn(Y,R));return}if(rn(JC)(R)){if(R.source!==e){const Y=R.hops.at(-1)??at(`${e}: Expected hops for packet`,R),P=t.get(Y).channel,ne=XC.make({reqId:R.id,source:R.source,target:R.target,remainingHops:R.hops.slice(0,-1),nodeName:e,edges:Array.from(t.keys())});yield*P.send(ne)}const V=Array.from(t).filter(([Y])=>!R.hops.includes(Y)).map(([Y,P])=>P.channel),K={...R,hops:[...R.hops,e]};yield*Hr(V,Y=>Y.send(K),{concurrency:"unbounded"});return}if(rn(XC)(R)){if(R.source===e)f.get(R.reqId).set(R.nodeName,new Set(R.edges));else{const K=R.remainingHops.at(-1)??at(`${e}: Expected remaining hops for packet`,R);yield*(((I=t.get(K))==null?void 0:I.channel)??at(`${e}: Expected edge channel (${K}) for packet`,R,"Available edges:",Array.from(t.keys()))).send({...R,remainingHops:R.remainingHops.slice(0,-1)})}return}if(t.has(R.target)){const V=t.get(R.target).channel,K=R.source===e?[]:[...R.hops,e];yield*uC({hasDirectEdge:!0}),yield*V.send({...R,hops:K})}else if(R.remainingHops!==void 0){const V=R.remainingHops.at(-1)??at(`${e}: Expected remaining hops for packet`,R),K=(z=t.get(V))==null?void 0:z.channel;if(K===void 0){yield*Xa(`${e}: Expected to find hop target ${V} in edges. Dropping packet.`,R);return}yield*K.send({...R,remainingHops:R.remainingHops.slice(0,-1),hops:[...R.hops,e]})}else{const V=R.source===e?[]:[...R.hops,e],K=Array.from(t).filter(([P])=>P!==R.source).map(([P,ne])=>({name:P,channel:ne.channel}));V.length===0&&K.length===0&&Vo&&(yield*Xa(e,"no route found to",R.target,R._tag,"TODO handle better"));const Y={...R,hops:V};yield*uC({edgesToForwardTo:K.map(({name:P})=>P)}),yield*Hr(K,({channel:P})=>P.send(Y),{concurrency:"unbounded"})}}).pipe(At(`sendPacket:${R._tag}:${R.source}${R.target}`,{attributes:gp(R)}),va),S=({target:R,edgeChannel:I,replaceIfExists:z=!1})=>ye(function*(){if(t.has(R))if(z)yield*v(R).pipe(va);else return yield*new mpe({target:R});const V=yield*I.listen.pipe(hl(),$s(Y=>ye(function*(){const P=yield*Tv(Bx)(Y);if(!n.has(P.id))switch(n.add(P.id),P._tag){case"NetworkEdgeAdded":case"NetworkTopologyRequest":case"NetworkTopologyResponse":{yield*b(P);break}default:if(P.target===e){const ne=`target:${P.source}, channelName:${P.channelName}`;if(!i.has(ne)){const ge=yield*qs().pipe(wn(ys));i.set(ne,{queue:ge,debugInfo:void 0})}const Se=i.get(ne).queue,Re=ge=>I.send(ge).pipe(At(`respondToSender:${ge._tag}:${ge.source}${ge.target}`,{attributes:gp(ge)}),va);rn(zH)(P)?yield*Tn(Se,{packet:P,respondToSender:Re}):rn(ZC)(P)&&(yield*Tn(Se,{packet:P,respondToSender:Re})),(P._tag==="ProxyChannelRequest"||P._tag==="DirectChannelRequest")&&(yield*Tn(c,{channelName:P.channelName,source:P.source,mode:P._tag==="ProxyChannelRequest"?"proxy":"direct"}))}else{if(rn(ZC)(P)){const ne=g(P);if(ne!==void 0)return yield*wa(`No transferable edges found for ${P.source}${P.target}`),yield*I.send(ne).pipe(At(`sendNoTransferableResponse:${P.source}${P.target}`,{attributes:gp(ne)}))}yield*b(P)}}})),Vr,kn,va,Ft,En);t.set(R,{channel:I,listenFiber:V});const K=WC.make({source:e,target:R});yield*b(K).pipe(va)}).pipe(nl({"addEdge:target":R,nodeName:e}),At(`addEdge:${e}${R}`,{attributes:{supportsTransferables:I.supportsTransferables}})),v=R=>ye(function*(){t.has(R)||(yield*new lw(`No edge found for ${R}`)),yield*Js(t.get(R).listenFiber),t.delete(R)}),q=({target:R,channelName:I})=>Ke(()=>i.has(`target:${R}, channelName:${I}`)),k=({target:R,channelName:I,schema:z,mode:V,timeout:K=US(1),closeExisting:Y=!1})=>ye(function*(){var Re;const P=ty(z),ne=`target:${R}, channelName:${I}`;if(i.has(ne)){const ge=(Re=i.get(ne).debugInfo)==null?void 0:Re.channel;ge&&(Y?(yield*ge.shutdown,i.delete(ne)):at(`Channel ${ne} already exists`,ge))}if(i.has(ne)===!1){const ge=yield*qs().pipe(wn(ys));i.set(ne,{queue:ge,debugInfo:void 0})}const Se=i.get(ne).queue;if(yield*rs(()=>Ke(()=>i.delete(ne))),V==="direct"){const ge=yield*qs().pipe(wn(ys));yield*_P(Se,1,10).pipe(Ns(Te=>q2(ge,Te)),bh,kn,Ft,En);const{webChannel:Ve,initialEdgeDeferred:oe}=yield*_pe({nodeName:e,incomingPacketsQueue:ge,newEdgeAvailablePubSub:r,target:R,channelName:I,schema:P,sendPacket:b,checkTransferableEdges:g});return i.set(ne,{queue:Se,debugInfo:{channel:Ve,target:R}}),yield*oe,Ve}else{const ge=yield*ype({nodeName:e,newEdgeAvailablePubSub:r,target:R,channelName:I,schema:P,queue:Se,sendPacket:b});return i.set(ne,{queue:Se,debugInfo:{channel:ge,target:R}}),ge}}).pipe(E2(`makeChannel:${e}${R}(${I})`,{attributes:{target:R,channelName:I,mode:V,timeout:K}}),nl({nodeName:e,target:R,channelName:I}));let N=!1;const H=D5(()=>{if(N)return at("listenForChannel already started");N=!0;const R=z=>`${z.channelName}:${z.source}:${z.mode}`,I=new Set;return nf(c).pipe(Ho(z=>{const V=R(z);return I.has(V)?!1:(I.add(V),!0)}))}),x=({channelName:R,schema:I})=>vf(z=>ye(function*(){if(m.has(R))return at(`Broadcast channel ${R} already exists`,m.get(R));const V={},K=yield*qs().pipe(wn(ys));m.set(R,K);const Y=Se=>ye(function*(){const Re=yield*sx(I)(Se),ge=TS.make({channelName:R,payload:Re,source:e,target:"-",hops:[]});yield*b(ge)}),P=nf(K).pipe(Ho(rn(TS)),El(Se=>fm(I)(Se.payload))),ne=yield*xt().pipe(wn(Sl(ea)));return{[as]:as,send:Y,listen:P,closedDeferred:ne,supportsTransferables:!1,schema:{listen:I,send:I},shutdown:Xn(z,ea),debugInfo:V}})),C=Ke(()=>new Set(t.keys())),E=yield*em();return{nodeName:e,addEdge:S,removeEdge:v,hasChannel:q,makeChannel:k,listenForChannel:H,makeBroadcastChannel:x,edgeKeys:C,debug:{print:()=>{var R,I,z,V;console.log("Webmesh debug info for node:",e),console.log("Edges:",t.size);for(const[K,Y]of t)console.log(`  ${K}: supportsTransferables=${Y.channel.supportsTransferables}`);console.log("Channels:",i.size);for(const[K,Y]of i)console.log(Qg(K,2),`
`,Object.entries({target:(R=Y.debugInfo)==null?void 0:R.target,supportsTransferables:(I=Y.debugInfo)==null?void 0:I.channel.supportsTransferables,...(z=Y.debugInfo)==null?void 0:z.channel.debugInfo}).map(([P,ne])=>Qg(`${P}=${ne}`,4)).join(`
`),"    ",(V=Y.debugInfo)==null?void 0:V.channel,`
`,Qg(`Queue: ${Y.queue.unsafeSize().pipe(ba)}`,4),Y.queue);console.log("Broadcast channels:",m.size);for(const[K,Y]of m)console.log(Qg(K,2))},ping:R=>{ye(function*(){const I=z=>t_.make({message:`ping from ${e} via ${z}`,payload:R});for(const[z,V]of t)yield*Ur(`sending ping via edge ${z}`),yield*V.channel.send(I(`edge ${z}`));for(const[z,V]of i){if(V.debugInfo===void 0){yield*Ur(`channel ${z} has no debug info`);continue}yield*Ur(`sending ping via channel ${z}`),yield*V.debugInfo.channel.send(I(`channel ${z}`))}}).pipe(ss(E),Ft,oi)},requestTopology:(R=1e3)=>ye(function*(){const I=JC.make({source:e,target:"-",hops:[]}),z=new Map;z.set(e,new Set(t.keys())),f.set(I.id,z),yield*b(I),yield*Ur(`Waiting ${R}ms for topology response`),yield*y2(R),yield*Ur(`Topology response (from ${e}):`);for(const[V,K]of z)yield*Ur(`  node '${V}' has edge to: ${Array.from(K.values()).join(", ")}`)}).pipe(ss(E),Ft,pw)}}}).pipe(At(`makeMeshNode:${e}`),nl({"makeMeshNode.nodeName":e})),Spe=({storeId:e,clientId:t,sessionId:n,isLeader:r,devtoolsEnabled:i,connectDevtoolsToStore:c,lockStatus:f,leaderThread:m,schema:g,sqliteDb:b,shutdown:S,connectWebmeshNode:v,webmeshMode:q,registerBeforeUnload:k,debugInstanceId:N})=>ye(function*(){const H=i?{enabled:!0,pullLatch:yield*NN(!0),pushLatch:yield*NN(!0)}:{enabled:!1};return i&&(yield*ye(function*(){const x=yield*bpe(upe.client.session({storeId:e,clientId:t,sessionId:n}));globalThis.__debugWebmeshNode=x;const C=g.devtools.alias,E=SH.make({storeId:e,clientId:t,sessionId:n,schemaAlias:C,isLeader:r});yield*v({webmeshNode:x,sessionInfo:E});const $=yield*dpe(x);yield*wH({webChannel:$,sessionInfo:E}).pipe(Ft,En),yield*x.listenForChannel.pipe(Ho(R=>fpe.devtoolsClientSession(R.channelName,{storeId:e,clientId:t,sessionId:n})&&R.mode===q),$s(Hse(function*({channelName:R,source:I}){const z=yield*x.makeChannel({target:I,channelName:R,schema:{listen:jge,send:Fge},mode:q}),V=z.send(Ux.make({clientId:t,liveStoreVersion:gs,sessionId:n})).pipe(va);yield*rs(()=>V),yield*wn(Ke(()=>k(()=>V.pipe(oi))),K=>Ke(()=>K())),yield*c(z)},Ft,En)),Vr)}).pipe(At("@livestore/common:make-client-session:devtools"),Ft,En)),{sqliteDb:b,leaderThread:m,devtools:H,lockStatus:f,clientId:t,sessionId:n,shutdown:S,debugInstanceId:N}}),PH=e=>(...t)=>{const[n,r,i]=t;if(Di(n)){const{query:c,bindValues:f}=n.asSql();return e(c,f,r)}else return e(n,r,i)},HH=e=>(...t)=>{const[n,r]=t;if(Di(n)){const{query:i,bindValues:c}=n.asSql(),f=Gw(n),m=e(i,c);return tf(f)(m)}else return e(n,r)},De=0,vpe=1,r_=10,Vx=12,sy=14,Fc=21,sk=25,wpe=27,tA=100,Epe=101,Ww=522,BH=778,hI=2,Gv=4,Kv=8,VH=64,GH=256,KH=2048,QH=16384,YH=524288,Tpe=2048,mI=1,gI=2,pI=3,_I=4,yI=5,kpe=512;class WH{constructor(t,n){y(this,"name");y(this,"mxPathname",64);y(this,"_module");this.name=t,this._module=n}close(){}isReady(){return!0}hasAsyncMethod(t){return!1}xOpen(t,n,r,i,c){return sy}xDelete(t,n,r){return De}xAccess(t,n,r,i){return De}xFullPathname(t,n,r,i){return De}xGetLastError(t,n,r){return De}xClose(t){return De}xRead(t,n,r,i,c){return De}xWrite(t,n,r,i,c){return De}xTruncate(t,n,r){return De}xSync(t,n){return De}xFileSize(t,n){return De}xLock(t,n){return De}xUnlock(t,n){return De}xCheckReservedLock(t,n){return De}xFileControl(t,n,r){return Vx}xSectorSize(t){return kpe}xDeviceCharacteristics(t){return 0}}const Cpe=Object.getPrototypeOf(async function(){}).constructor;var ka,Jg,nA,JH,qj;let Ape=(qj=class extends WH{constructor(n,r){super(n,r);br(this,ka)}hasAsyncMethod(n){const r=`j${n.slice(1)}`;return this[r]instanceof Cpe}getFilename(n){throw new Error("unimplemented")}jOpen(n,r,i,c){return sy}jDelete(n,r){return De}jAccess(n,r,i){return De}jFullPathname(n,r){const{read:i,written:c}=new TextEncoder().encodeInto(n,r);return i<n.length||c>=r.length?r_:(r[c]=0,De)}jGetLastError(n){return De}jClose(n){return De}jRead(n,r,i){return r.fill(0),Ww}jWrite(n,r,i){return BH}jTruncate(n,r){return De}jSync(n,r){return De}jFileSize(n,r){return De}jLock(n,r){return De}jUnlock(n,r){return De}jCheckReservedLock(n,r){return r.setInt32(0,0,!0),De}jFileControl(n,r,i){return Vx}jSectorSize(n){return super.xSectorSize(n)}jDeviceCharacteristics(n){return 0}xOpen(n,r,i,c,f){var b;const m=jt(this,ka,JH).call(this,r,c),g=jt(this,ka,Jg).call(this,"Int32",f);return(b=this.log)==null||b.call(this,"jOpen",m,i,"0x"+c.toString(16)),this.jOpen(m,i,c,g)}xDelete(n,r,i){var f;const c=this._module.UTF8ToString(r);return(f=this.log)==null||f.call(this,"jDelete",c,i),this.jDelete(c,i)}xAccess(n,r,i,c){var g;const f=this._module.UTF8ToString(r),m=jt(this,ka,Jg).call(this,"Int32",c);return(g=this.log)==null||g.call(this,"jAccess",f,i),this.jAccess(f,i,m)}xFullPathname(n,r,i,c){var g;const f=this._module.UTF8ToString(r),m=this._module.HEAPU8.subarray(c,c+i);return(g=this.log)==null||g.call(this,"jFullPathname",f,i),this.jFullPathname(f,m)}xGetLastError(n,r,i){var f;const c=this._module.HEAPU8.subarray(i,i+r);return(f=this.log)==null||f.call(this,"jGetLastError",r),this.jGetLastError(c)}xClose(n){var r;return(r=this.log)==null||r.call(this,"jClose",n),this.jClose(n)}xRead(n,r,i,c,f){var b;const m=jt(this,ka,nA).call(this,r,i),g=ak(c,f);return(b=this.log)==null||b.call(this,"jRead",n,i,g),this.jRead(n,m,g)}xWrite(n,r,i,c,f){var b;const m=jt(this,ka,nA).call(this,r,i),g=ak(c,f);return(b=this.log)==null||b.call(this,"jWrite",n,m,g),this.jWrite(n,m,g)}xTruncate(n,r,i){var f;const c=ak(r,i);return(f=this.log)==null||f.call(this,"jTruncate",n,c),this.jTruncate(n,c)}xSync(n,r){var i;return(i=this.log)==null||i.call(this,"jSync",n,r),this.jSync(n,r)}xFileSize(n,r){var c;const i=jt(this,ka,Jg).call(this,"BigInt64",r);return(c=this.log)==null||c.call(this,"jFileSize",n),this.jFileSize(n,i)}xLock(n,r){var i;return(i=this.log)==null||i.call(this,"jLock",n,r),this.jLock(n,r)}xUnlock(n,r){var i;return(i=this.log)==null||i.call(this,"jUnlock",n,r),this.jUnlock(n,r)}xCheckReservedLock(n,r){var c;const i=jt(this,ka,Jg).call(this,"Int32",r);return(c=this.log)==null||c.call(this,"jCheckReservedLock",n),this.jCheckReservedLock(n,i)}xFileControl(n,r,i){var f;const c=new DataView(this._module.HEAPU8.buffer,this._module.HEAPU8.byteOffset+i);return(f=this.log)==null||f.call(this,"jFileControl",n,r,c),this.jFileControl(n,r,c)}xSectorSize(n){var r;return(r=this.log)==null||r.call(this,"jSectorSize",n),this.jSectorSize(n)}xDeviceCharacteristics(n){var r;return(r=this.log)==null||r.call(this,"jDeviceCharacteristics",n),this.jDeviceCharacteristics(n)}},ka=new WeakSet,Jg=function(n,r){const i=n==="Int32"?4:8,c=`get${n}`,f=`set${n}`,m=()=>new DataView(this._module.HEAPU8.buffer,this._module.HEAPU8.byteOffset+r,i);let g=m();return new Proxy(g,{get(b,S){if(g.buffer.byteLength===0&&(g=m()),S===c)return function(q,k){if(!k)throw new Error("must be little endian");return g[S](q,k)};if(S===f)return function(q,k,N){if(!N)throw new Error("must be little endian");return g[S](q,k,N)};if(typeof S=="string"&&S.match(/^(get)|(set)/))throw new Error("invalid type");const v=g[S];return typeof v=="function"?v.bind(g):v}})},nA=function(n,r){let i=this._module.HEAPU8.subarray(n,n+r);return new Proxy(i,{get:(c,f,m)=>{i.buffer.byteLength===0&&(i=this._module.HEAPU8.subarray(n,n+r));const g=i[f];return typeof g=="function"?g.bind(i):g}})},JH=function(n,r){if(r&VH){let i=n,c=1;const f=[];for(;c;){const m=this._module.HEAPU8[i++];if(m)f.push(m);else switch(this._module.HEAPU8[i]||(c=null),c){case 1:f.push(63),c=2;break;case 2:f.push(61),c=3;break;case 3:f.push(38),c=2;break}}return new TextDecoder().decode(new Uint8Array(f))}return n?this._module.UTF8ToString(n):null},qj);function ak(e,t){return t*4294967296+e+(e<0?2**32:0)}class Gx extends Ape{constructor(n,r){super(n,r);y(this,"mapNameToFile",new Map);y(this,"mapIdToFile",new Map)}static async create(n,r){const i=new Gx(n,r);return await i.isReady(),i}close(){for(const n of this.mapIdToFile.keys())this.jClose(n)}jOpen(n,r,i,c){const m=new URL(n||Math.random().toString(36).slice(2),"file://").pathname;let g=this.mapNameToFile.get(m);if(!g)if(i&Gv)g={pathname:m,flags:i,size:0,data:new ArrayBuffer(0)},this.mapNameToFile.set(m,g);else return sy;return this.mapIdToFile.set(r,g),c.setInt32(0,i,!0),De}jClose(n){const r=this.mapIdToFile.get(n);return this.mapIdToFile.delete(n),r.flags&Kv&&this.mapNameToFile.delete(r.pathname),De}jRead(n,r,i){const c=this.mapIdToFile.get(n),f=Math.min(i,c.size),g=Math.min(i+r.byteLength,c.size)-f;return g&&r.set(new Uint8Array(c.data,f,g)),g<r.byteLength?(r.fill(0,g),Ww):De}jWrite(n,r,i){const c=this.mapIdToFile.get(n);if(i+r.byteLength>c.data.byteLength){const f=Math.max(i+r.byteLength,2*c.data.byteLength),m=new ArrayBuffer(f);new Uint8Array(m).set(new Uint8Array(c.data,0,c.size)),c.data=m}return new Uint8Array(c.data,i,r.byteLength).set(r),c.size=Math.max(c.size,i+r.byteLength),De}jTruncate(n,r){const i=this.mapIdToFile.get(n);return i.size=Math.min(i.size,r),De}jFileSize(n,r){const i=this.mapIdToFile.get(n);return r.setBigInt64(0,BigInt(i.size),!0),De}jDelete(n,r){const c=new URL(n,"file://").pathname;return this.mapNameToFile.delete(c),De}jAccess(n,r,i){const f=new URL(n,"file://").pathname,m=this.mapNameToFile.get(f);return i.setInt32(0,m?1:0,!0),De}}let bI;const XH=e=>{if(e.vfs_registered.has("memory-vfs")===!1){const r=new Gx("memory-vfs",e.module);e.vfs_register(r,!1),bI=r}return{dbPointer:e.open_v2Sync(":memory:",void 0,"memory-vfs"),vfs:bI}},SI=({sqlite3:e,metadata:t})=>{const n=[],{dbPointer:r}=t;let i=!1;const c={_tag:"SqliteDb",metadata:t,prepare:f=>{try{const m=e.statements(r,f.trim(),{unscoped:!0});let g=!1;const b={execute:(S,v)=>{for(const q of m){S!==void 0&&Object.keys(S).length>0&&e.bind_collection(q,S);try{e.step(q)}finally{v!=null&&v.onRowsChanged&&v.onRowsChanged(e.changes(r)),e.reset(q)}}},select:S=>{if(m.length!==1)throw new Yg({query:{bindValues:S,sql:f},code:-1,cause:"Expected only one statement when using `select`"});const v=m[0];S!==void 0&&Object.keys(S).length>0&&e.bind_collection(v,S);const q=[];try{let k;try{k=e.column_names(v)}catch{}for(;e.step(v)===tA;)if(k!==void 0){const N={};for(let H=0;H<k.length;H++)N[k[H]]=e.column(v,H);q.push(N)}}catch(k){throw new Yg({query:{bindValues:S,sql:f},code:k.code,cause:k})}finally{e.reset(v)}return q},finalize:()=>{if(!g){g=!0;for(const S of m)e.finalize(S)}},sql:f};return n.push(b),b}catch(m){throw new Yg({query:{sql:f,bindValues:{}},code:m.code,cause:m})}},export:()=>e.serialize(r,"main"),execute:PH((f,m,g)=>{const b=c.prepare(f);b.execute(m,g),b.finalize()}),select:HH((f,m)=>{const g=c.prepare(f),b=g.select(m);return g.finalize(),b}),destroy:()=>{c.close(),t.deleteDb()},close:()=>{if(!i){for(const f of n)f.finalize();e.close(r),i=!0}},import:f=>{if(f instanceof Uint8Array){const b=XH(e);e.deserialize(b.dbPointer,"main",f,f.length,f.length,3),e.backup(r,"main",b.dbPointer,"main"),e.close(b.dbPointer)}else e.backup(r,"main",f.metadata.dbPointer,"main");t.configureDb(c)},session:()=>{const f=e.session_create(r,"main");return e.session_attach(f,null),{changeset:()=>e.session_changeset(f).changeset??void 0,finish:()=>{e.session_delete(f)}}},makeChangeset:f=>({invert:()=>{const g=e.changeset_invert(f);return c.makeChangeset(g)},apply:()=>{try{e.changeset_apply(r,f),f=void 0}catch(g){throw new Yg({code:g.code??-1,cause:g,note:"Failed calling makeChangeset.apply"})}}})};return t.configureDb(c),c},Rpe=Object.getPrototypeOf(async()=>{}).constructor;var Ca,Xg,rA,ZH;class xpe extends WH{constructor(n,r){super(n,r);br(this,Ca)}hasAsyncMethod(n){const r=`j${n.slice(1)}`;return this[r]instanceof Rpe}getFilename(n){throw new Error("unimplemented")}jOpen(n,r,i,c){return sy}jDelete(n,r){return De}jAccess(n,r,i){return De}jFullPathname(n,r){const{read:i,written:c}=new TextEncoder().encodeInto(n,r);return i<n.length||c>=r.length?r_:(r[c]=0,De)}jGetLastError(n){return De}jClose(n){return De}jRead(n,r,i){return r.fill(0),Ww}jWrite(n,r,i){return BH}jTruncate(n,r){return De}jSync(n,r){return De}jFileSize(n,r){return De}jLock(n,r){return De}jUnlock(n,r){return De}jCheckReservedLock(n,r){return r.setInt32(0,0,!0),De}jFileControl(n,r,i){return Vx}jSectorSize(n){return super.xSectorSize(n)}jDeviceCharacteristics(n){return 0}xOpen(n,r,i,c,f){var b;const m=jt(this,Ca,ZH).call(this,r,c),g=jt(this,Ca,Xg).call(this,"Int32",f);return(b=this.log)==null||b.call(this,"jOpen",m,i,"0x"+c.toString(16)),this.jOpen(m,i,c,g)}xDelete(n,r,i){var f;const c=this._module.UTF8ToString(r);return(f=this.log)==null||f.call(this,"jDelete",c,i),this.jDelete(c,i)}xAccess(n,r,i,c){var g;const f=this._module.UTF8ToString(r),m=jt(this,Ca,Xg).call(this,"Int32",c);return(g=this.log)==null||g.call(this,"jAccess",f,i),this.jAccess(f,i,m)}xFullPathname(n,r,i,c){var g;const f=this._module.UTF8ToString(r),m=this._module.HEAPU8.subarray(c,c+i);return(g=this.log)==null||g.call(this,"jFullPathname",f,i),this.jFullPathname(f,m)}xGetLastError(n,r,i){var f;const c=this._module.HEAPU8.subarray(i,i+r);return(f=this.log)==null||f.call(this,"jGetLastError",r),this.jGetLastError(c)}xClose(n){var r;return(r=this.log)==null||r.call(this,"jClose",n),this.jClose(n)}xRead(n,r,i,c,f){var b;const m=jt(this,Ca,rA).call(this,r,i),g=ik(c,f);return(b=this.log)==null||b.call(this,"jRead",n,i,g),this.jRead(n,m,g)}xWrite(n,r,i,c,f){var b;const m=jt(this,Ca,rA).call(this,r,i),g=ik(c,f);return(b=this.log)==null||b.call(this,"jWrite",n,m,g),this.jWrite(n,m,g)}xTruncate(n,r,i){var f;const c=ik(r,i);return(f=this.log)==null||f.call(this,"jTruncate",n,c),this.jTruncate(n,c)}xSync(n,r){var i;return(i=this.log)==null||i.call(this,"jSync",n,r),this.jSync(n,r)}xFileSize(n,r){var c;const i=jt(this,Ca,Xg).call(this,"BigInt64",r);return(c=this.log)==null||c.call(this,"jFileSize",n),this.jFileSize(n,i)}xLock(n,r){var i;return(i=this.log)==null||i.call(this,"jLock",n,r),this.jLock(n,r)}xUnlock(n,r){var i;return(i=this.log)==null||i.call(this,"jUnlock",n,r),this.jUnlock(n,r)}xCheckReservedLock(n,r){var c;const i=jt(this,Ca,Xg).call(this,"Int32",r);return(c=this.log)==null||c.call(this,"jCheckReservedLock",n),this.jCheckReservedLock(n,i)}xFileControl(n,r,i){var f;const c=new DataView(this._module.HEAPU8.buffer,this._module.HEAPU8.byteOffset+i);return(f=this.log)==null||f.call(this,"jFileControl",n,r,c),this.jFileControl(n,r,c)}xSectorSize(n){var r;return(r=this.log)==null||r.call(this,"jSectorSize",n),this.jSectorSize(n)}xDeviceCharacteristics(n){var r;return(r=this.log)==null||r.call(this,"jDeviceCharacteristics",n),this.jDeviceCharacteristics(n)}}Ca=new WeakSet,Xg=function(n,r){const i=n==="Int32"?4:8,c=`get${n}`,f=`set${n}`,m=()=>new DataView(this._module.HEAPU8.buffer,this._module.HEAPU8.byteOffset+r,i);let g=m();return new Proxy(g,{get(b,S){if(g.buffer.byteLength===0&&(g=m()),S===c)return function(q,k){if(!k)throw new Error("must be little endian");return g[S](q,k)};if(S===f)return function(q,k,N){if(!N)throw new Error("must be little endian");return g[S](q,k,N)};if(typeof S=="string"&&/^(get)|(set)/.test(S))throw new Error("invalid type");const v=g[S];return typeof v=="function"?v.bind(g):v}})},rA=function(n,r){let i=this._module.HEAPU8.subarray(n,n+r);return new Proxy(i,{get:(c,f,m)=>{i.buffer.byteLength===0&&(i=this._module.HEAPU8.subarray(n,n+r));const g=i[f];return typeof g=="function"?g.bind(i):g}})},ZH=function(n,r){if(r&VH){let i=n,c=1;const f=[];for(;c;){const m=this._module.HEAPU8[i++];if(m)f.push(m);else switch(this._module.HEAPU8[i]||(c=null),c){case 1:{f.push(63),c=2;break}case 2:{f.push(61),c=3;break}case 3:{f.push(38),c=2;break}}}return new TextDecoder().decode(new Uint8Array(f))}return n?this._module.UTF8ToString(n):null};function ik(e,t){return t*4294967296+e+(e<0?2**32:0)}const e8=4096,Kx=512,Ope=4,Dpe=8,sA=Kx+Ope,vI=Kx,wI=sA,ru=e8,qpe=GH|KH|QH|YH,Npe=6;var o_,Bc,Ka,Bs,wi,Qa,fn,t8,n8,r8,Td,iA,kd,oA;const Jx=class Jx extends xpe{constructor(n,r,i){super(n,i);br(this,fn);y(this,"log",null);br(this,o_);br(this,Bc);br(this,Ka,new Map);br(this,Bs,new Map);br(this,wi,new Set);br(this,Qa,new Map);Zl(this,o_,r)}static async create(n,r,i){const c=new Jx(n,r,i);return await c.isReady(),c}getOpfsFileName(n){const r=jt(this,fn,kd).call(this,n),i=Ce(this,Bs).get(r);return Ce(this,Ka).get(i)}resetAccessHandle(n){const r=jt(this,fn,kd).call(this,n);Ce(this,Bs).get(r).truncate(ru)}jOpen(n,r,i,c){try{const f=n?jt(this,fn,kd).call(this,n):Math.random().toString(36);let m=Ce(this,Bs).get(f);if(!m&&i&Gv)if(this.getSize()<this.getCapacity())[m]=Ce(this,wi).keys(),jt(this,fn,Td).call(this,m,f,i);else throw new Error("cannot create file");if(!m)throw new Error("file not found");const g={path:f,flags:i,accessHandle:m};return Ce(this,Qa).set(r,g),c.setInt32(0,i,!0),De}catch(f){return console.error(f.message),sy}}jClose(n){const r=Ce(this,Qa).get(n);return r&&(r.accessHandle.flush(),Ce(this,Qa).delete(n),r.flags&Kv&&jt(this,fn,oA).call(this,r.path)),De}jRead(n,r,i){const f=Ce(this,Qa).get(n).accessHandle.read(r.subarray(),{at:ru+i});return f<r.byteLength?(r.fill(0,f,r.byteLength),Ww):De}jWrite(n,r,i){return Ce(this,Qa).get(n).accessHandle.write(r.subarray(),{at:ru+i})===r.byteLength?De:r_}jTruncate(n,r){return Ce(this,Qa).get(n).accessHandle.truncate(ru+r),De}jSync(n,r){return Ce(this,Qa).get(n).accessHandle.flush(),De}jFileSize(n,r){const c=Ce(this,Qa).get(n).accessHandle.getSize()-ru;return r.setBigInt64(0,BigInt(c),!0),De}jSectorSize(n){return e8}jDeviceCharacteristics(n){return Tpe}jAccess(n,r,i){const c=jt(this,fn,kd).call(this,n);return i.setInt32(0,Ce(this,Bs).has(c)?1:0,!0),De}jDelete(n,r){const i=jt(this,fn,kd).call(this,n);return jt(this,fn,oA).call(this,i),De}async close(){jt(this,fn,n8).call(this)}async isReady(){if(!Ce(this,Bc)){let n=await navigator.storage.getDirectory();for(const r of Ce(this,o_).split("/"))r&&(n=await n.getDirectoryHandle(r,{create:!0}));Zl(this,Bc,n),await jt(this,fn,t8).call(this),this.getCapacity()===0&&await this.addCapacity(Npe)}return!0}getSize(){return Ce(this,Bs).size}getCapacity(){return Ce(this,Ka).size}async addCapacity(n){for(let r=0;r<n;++r){const i=Math.random().toString(36).replace("0.",""),f=await(await Ce(this,Bc).getFileHandle(i,{create:!0})).createSyncAccessHandle();Ce(this,Ka).set(f,i),jt(this,fn,Td).call(this,f,"",0)}return n}async removeCapacity(n){let r=0;for(const i of Array.from(Ce(this,wi))){if(r==n||this.getSize()===this.getCapacity())return r;const c=Ce(this,Ka).get(i);i.close(),await Ce(this,Bc).removeEntry(c),Ce(this,Ka).delete(i),Ce(this,wi).delete(i),++r}return r}};o_=new WeakMap,Bc=new WeakMap,Ka=new WeakMap,Bs=new WeakMap,wi=new WeakMap,Qa=new WeakMap,fn=new WeakSet,t8=async function(){const n=[];for await(const[r,i]of Ce(this,Bc))i.kind==="file"&&n.push([r,i]);await Promise.all(n.map(async([r,i])=>{const c=await i.createSyncAccessHandle();Ce(this,Ka).set(c,r);const f=jt(this,fn,r8).call(this,c);f?Ce(this,Bs).set(f,c):Ce(this,wi).add(c)}))},n8=function(){for(const n of Ce(this,Ka).keys())n.close();Ce(this,Ka).clear(),Ce(this,Bs).clear(),Ce(this,wi).clear()},r8=function(n){const r=new Uint8Array(sA);n.read(r,{at:0});const c=new DataView(r.buffer,r.byteOffset).getUint32(vI);if(r[0]&&(c&Kv||(c&qpe)===0))return console.warn(`Remove file with unexpected flags ${c.toString(16)}`),jt(this,fn,Td).call(this,n,"",0),"";const f=new Uint32Array(Dpe/4);n.read(f,{at:wI});const m=jt(this,fn,iA).call(this,r);if(f.every((g,b)=>g===m[b])){const g=r.indexOf(0);return g===0&&n.truncate(ru),new TextDecoder().decode(r.subarray(0,g))}else return console.warn("Disassociating file with bad digest."),jt(this,fn,Td).call(this,n,"",0),""},Td=function(n,r,i){const c=new Uint8Array(sA);if(new TextEncoder().encodeInto(r,c).written>=Kx)throw new Error("path too long");new DataView(c.buffer,c.byteOffset).setUint32(vI,i);const g=jt(this,fn,iA).call(this,c);n.write(c,{at:0}),n.write(g,{at:wI}),n.flush(),r?(Ce(this,Bs).set(r,n),Ce(this,wi).delete(n)):(n.truncate(ru),Ce(this,wi).add(n))},iA=function(n){if(!n[0])return new Uint32Array([4274806656,2899230775]);let r=3735928559,i=1103547991;for(const c of n)r=Math.imul(r^c,2654435761),i=Math.imul(i^c,1597334677);return r=Math.imul(r^r>>>16,2246822507)^Math.imul(i^i>>>13,3266489909),i=Math.imul(i^i>>>16,2246822507)^Math.imul(r^r>>>13,3266489909),new Uint32Array([r>>>0,i>>>0])},kd=function(n){return(typeof n=="string"?new URL(n,"file://localhost/"):n).pathname},oA=function(n){const r=Ce(this,Bs).get(n);r&&(Ce(this,Bs).delete(n),jt(this,fn,Td).call(this,r,"",0))};let aA=Jx;const $pe=gw(1).pipe(ya),EI=new Map,Ipe=({sqlite3:e,directory:t,fileName:n})=>ye(function*(){const r=t.replaceAll(/["*/:<>?\\|]/g,"_"),c=`opfs${r.length===0?"":`-${r}`}`;if(e.vfs_registered.has(c)===!1){const g=yield*Ju(()=>aA.create(c,t,e.module));e.vfs_register(g,!1),EI.set(c,g)}const f=e.open_v2Sync(n,void 0,c),m=EI.get(c);return{dbPointer:f,vfs:m}}).pipe($pe.withPermits(1)),Mpe=4096,s8=512,jpe=4,Fpe=8,a8=s8+jpe,Lpe=s8,TI=a8,Upe=Mpe,zpe=GH|KH|QH|YH,Ppe=new TextDecoder,Hpe=async e=>{const t=new Uint8Array(await e.slice(0,a8).arrayBuffer()),r=new DataView(t.buffer,t.byteOffset).getUint32(Lpe);if(t[0]&&(r&Kv||(r&zpe)===0))return console.warn(`Remove file with unexpected flags ${r.toString(16)}`),"";const i=new Uint32Array(await e.slice(TI,TI+Fpe).arrayBuffer()),c=Bpe(t);if(i.every((f,m)=>f===c[m])){const f=t.indexOf(0);return Ppe.decode(t.subarray(0,f))}else return console.warn("Disassociating file with bad digest."),""},Bpe=e=>{if(!e[0])return new Uint32Array([4274806656,2899230775]);let t=3735928559,n=1103547991;for(const r of e)t=Math.imul(t^r,2654435761),n=Math.imul(n^r,1597334677);return t=Math.imul(t^t>>>16,2246822507)^Math.imul(n^n>>>13,3266489909),n=Math.imul(n^n>>>16,2246822507)^Math.imul(t^t>>>13,3266489909),new Uint32Array([t>>>0,n>>>0])},Vpe=({sqlite3:e})=>t=>ye(function*(){if(t._tag==="in-memory"){const{dbPointer:f,vfs:m}=XH(e);return SI({sqlite3:e,metadata:{_tag:"in-memory",vfs:m,dbPointer:f,deleteDb:()=>{},configureDb:t.configureDb??(()=>{}),persistenceInfo:{fileName:":memory:"}}})}const n=60;let r=t.fileName;t.fileName.length>n&&(yield*Xa(`dbFilename too long: '${t.fileName}'. Max ${n} chars, got ${t.fileName.length}. Hashing...`),r=`hash-${qn(t.fileName)}.db`);const{dbPointer:i,vfs:c}=yield*Ipe({sqlite3:e,directory:t.opfsDirectory,fileName:r});return SI({sqlite3:e,metadata:{_tag:"opfs",vfs:c,dbPointer:i,deleteDb:()=>c.resetAccessHandle(t.fileName),configureDb:t.configureDb??(()=>{}),persistenceInfo:{fileName:r,opfsDirectory:t.opfsDirectory,opfsFileName:c.getOpfsFileName(r)}}})}),kI=0x7fffffffffffffffn,CI=-0x8000000000000000n;class ha extends Error{constructor(t,n){super(t),this.code=n}}const bd=!1;function Gpe(e){const t={};e.retryOps=[];const n=e._getSqliteFree(),r=e._malloc(8),i=[r,r+4];function c(x){if(typeof x!="string")return 0;const C=new TextEncoder().encode(x),E=e._sqlite3_malloc(C.byteLength+1);return e.HEAPU8.set(C,E),e.HEAPU8[E+C.byteLength]=0,E}function f(x,C){return BigInt(C)<<32n|BigInt(x)&0xffffffffn}const m=(function(){const x=BigInt(Number.MAX_SAFE_INTEGER)>>32n,C=BigInt(Number.MIN_SAFE_INTEGER)>>32n;return function(E,$){return $>x||$<C?f(E,$):$*4294967296+(E&2147483647)-(E&2147483648)}})(),g=new Set;function b(x){if(!g.has(x))throw new ha("not a database",Fc)}const S=new Map;function v(x){if(!S.has(x))throw new ha("not a statement",Fc)}t.bind_collection=function(x,C){v(x);const E=Array.isArray(C),$=t.bind_parameter_count(x);for(let R=1;R<=$;++R){const I=E?R-1:t.bind_parameter_name(x,R),z=C[I];z!==void 0&&t.bind(x,R,z)}return De},t.bind=function(x,C,E){switch(v(x),typeof E){case"number":return E===(E|0)?t.bind_int(x,C,E):t.bind_double(x,C,E);case"string":return t.bind_text(x,C,E);default:return E instanceof Uint8Array||Array.isArray(E)?t.bind_blob(x,C,E):E===null?t.bind_null(x,C):typeof E=="bigint"?t.bind_int64(x,C,E):E===void 0?wpe:(console.warn("unknown binding converted to null",E),t.bind_null(x,C))}},t.bind_blob=(function(){const x="sqlite3_bind_blob",C=e.cwrap(x,...$e("nnnnn:n"));return function(E,$,R){v(E);const I=R.byteLength??R.length,z=e._sqlite3_malloc(I);e.HEAPU8.subarray(z).set(R);const V=C(E,$,z,I,n);return N(x,V,S.get(E))}})(),t.bind_parameter_count=(function(){const C=e.cwrap("sqlite3_bind_parameter_count",...$e("n:n"));return function(E){return v(E),C(E)}})(),t.bind_double=(function(){const x="sqlite3_bind_double",C=e.cwrap(x,...$e("nnn:n"));return function(E,$,R){v(E);const I=C(E,$,R);return N(x,I,S.get(E))}})(),t.bind_int=(function(){const x="sqlite3_bind_int",C=e.cwrap(x,...$e("nnn:n"));return function(E,$,R){if(v(E),R>2147483647||R<-2147483648)return sk;const I=C(E,$,R);return N(x,I,S.get(E))}})(),t.bind_int64=(function(){const x="sqlite3_bind_int64",C=e.cwrap(x,...$e("nnnn:n"));return function(E,$,R){if(v(E),R>kI||R<CI)return sk;const I=R&0xffffffffn,z=R>>32n,V=C(E,$,Number(I),Number(z));return N(x,V,S.get(E))}})(),t.bind_null=(function(){const x="sqlite3_bind_null",C=e.cwrap(x,...$e("nn:n"));return function(E,$){v(E);const R=C(E,$);return N(x,R,S.get(E))}})(),t.bind_parameter_name=(function(){const C=e.cwrap("sqlite3_bind_parameter_name",...$e("n:s"));return function(E,$){return v(E),C(E,$)}})(),t.bind_text=(function(){const x="sqlite3_bind_text",C=e.cwrap(x,...$e("nnnnn:n"));return function(E,$,R){v(E);const I=c(R),z=C(E,$,I,-1,n);return N(x,z,S.get(E))}})(),t.changes=(function(){const C=e.cwrap("sqlite3_changes",...$e("n:n"));return function(E){return b(E),C(E)}})(),t.deserialize=(function(){const C=e.cwrap("sqlite3_deserialize",...$e("nnnnnn:n"));return function(E,$,R,I,z,V){b(E);const K=e._sqlite3_malloc(I);return e.HEAPU8.subarray(K).set(R),C(E,$,K,I,z,V)}})();const q=1;t.serialize=(function(){const C=e.cwrap("sqlite3_serialize",...$e("nsnn:n"));return function(E,$){b(E);const R=i[0];let I=C(E,$,R,0);if(I===0){I=C(E,$,R,q);const z=e.getValue(R,"*"),V=e.HEAPU8.subarray(I,I+z);return new Uint8Array(V.slice())}else{const z=e.getValue(R,"*"),V=e.HEAPU8.subarray(I,I+z);return new Uint8Array(V)}}})(),t.backup=(function(){const x=e.cwrap("sqlite3_backup_init",...$e("nsns:n")),C=e.cwrap("sqlite3_backup_step",...$e("nn:n")),E=e.cwrap("sqlite3_backup_finish",...$e("n:n"));return function($,R,I,z){b($),b(I);const V=x($,R,I,z);if(V===0){const K=e.ccall("sqlite3_errmsg","string",["number"],[$]);throw new ha(`backup failed: ${K}`,vpe)}return C(V,-1),E(V)}})(),t.clear_bindings=(function(){const x="sqlite3_clear_bindings",C=e.cwrap(x,...$e("n:n"));return function(E){v(E);const $=C(E);return N(x,$,S.get(E))}})(),t.close=(function(){const x="sqlite3_close",C=e.cwrap(x,...$e("n:n"),{async:bd});return function(E){b(E);const $=C(E);return g.delete(E),N(x,$,E)}})(),t.column=function(x,C){v(x);const E=t.column_type(x,C);switch(E){case _I:return t.column_blob(x,C);case gI:return t.column_double(x,C);case mI:const $=t.column_int(x,C),R=e.getTempRet0();return m($,R);case yI:return null;case pI:return t.column_text(x,C);default:throw new ha("unknown type",E)}},t.column_blob=(function(){const C=e.cwrap("sqlite3_column_blob",...$e("nn:n"));return function(E,$){v(E);const R=t.column_bytes(E,$),I=C(E,$);if(I===0)return null;const z=e.HEAPU8.subarray(I,I+R);return new Uint8Array(z)}})(),t.column_bytes=(function(){const C=e.cwrap("sqlite3_column_bytes",...$e("nn:n"));return function(E,$){return v(E),C(E,$)}})(),t.column_count=(function(){const C=e.cwrap("sqlite3_column_count",...$e("n:n"));return function(E){return v(E),C(E)}})(),t.column_double=(function(){const C=e.cwrap("sqlite3_column_double",...$e("nn:n"));return function(E,$){return v(E),C(E,$)}})(),t.column_int=(function(){const C=e.cwrap("sqlite3_column_int64",...$e("nn:n"));return function(E,$){return v(E),C(E,$)}})(),t.column_int64=(function(){const C=e.cwrap("sqlite3_column_int64",...$e("nn:n"));return function(E,$){v(E);const R=C(E,$),I=e.getTempRet0();return f(R,I)}})(),t.column_name=(function(){const C=e.cwrap("sqlite3_column_name",...$e("nn:s"));return function(E,$){return v(E),C(E,$)}})(),t.column_names=function(x){const C=[],E=t.column_count(x);for(let $=0;$<E;++$)C.push(t.column_name(x,$));return C},t.column_text=(function(){const C=e.cwrap("sqlite3_column_text",...$e("nn:s"));return function(E,$){return v(E),C(E,$)}})(),t.column_type=(function(){const C=e.cwrap("sqlite3_column_type",...$e("nn:n"));return function(E,$){return v(E),C(E,$)}})(),t.create_function=function(x,C,E,$,R,I,z,V){b(x);function K(P){return((ne,Se,Re)=>P(ne,e.HEAP32.subarray(Re/4,Re/4+Se)))}const Y=e.create_function(x,C,E,$,R,I&&K(I),z&&K(z),V);return N("sqlite3_create_function",Y,x)},t.data_count=(function(){const C=e.cwrap("sqlite3_data_count",...$e("n:n"));return function(E){return v(E),C(E)}})(),t.exec=function(x,C,E){const $=t.statements(x,C,{unscoped:!0});for(const R of $){let I;for(;t.step(R)===tA;)if(E){I=I??t.column_names(R);const z=t.row(R);E(z,I),E(z,I)}}for(const R of $)t.finalize(R);return De},t.finalize=(function(){const C=e.cwrap("sqlite3_finalize",...$e("n:n"),{async:bd});return function(E){const $=C(E);return S.delete(E),$}})(),t.get_autocommit=(function(){const C=e.cwrap("sqlite3_get_autocommit",...$e("n:n"));return function(E){return C(E)}})(),t.libversion=(function(){const C=e.cwrap("sqlite3_libversion",...$e(":s"));return function(){return C()}})(),t.libversion_number=(function(){const C=e.cwrap("sqlite3_libversion_number",...$e(":n"));return function(){return C()}})(),t.limit=(function(){const C=e.cwrap("sqlite3_limit",...$e("nnn:n"));return function(E,$,R){return C(E,$,R)}})(),t.open_v2=(function(){const x="sqlite3_open_v2",C=e.cwrap(x,...$e("snnn:n"),{async:bd});return async function(E,$,R){$=$||Gv|hI,R=c(R);try{const I=await H(()=>C(E,i[0],$,R)),z=e.getValue(i[0],"*");return g.add(z),e.ccall("RegisterExtensionFunctions","void",["number"],[z]),N(x,I,z),z}finally{e._sqlite3_free(R)}}})(),t.open_v2Sync=(function(){const x="sqlite3_open_v2",C=e.cwrap(x,...$e("snnn:n"),{async:bd});return function(E,$,R){$=$||Gv|hI,R=c(R);try{const I=C(E,i[0],$,R),z=e.getValue(i[0],"*");return g.add(z),e.ccall("RegisterExtensionFunctions","void",["number"],[z]),N(x,I,z),z}finally{e._sqlite3_free(R)}}})(),t.progress_handler=function(x,C,E,$){b(x),e.progress_handler(x,C,E,$)},t.reset=(function(){const x="sqlite3_reset",C=e.cwrap(x,...$e("n:n"),{async:bd});return function(E){v(E);const $=C(E);return N(x,$,S.get(E))}})(),t.result=function(x,C){switch(typeof C){case"number":C===(C|0)?t.result_int(x,C):t.result_double(x,C);break;case"string":t.result_text(x,C);break;default:if(C instanceof Uint8Array||Array.isArray(C))t.result_blob(x,C);else if(C===null)t.result_null(x);else{if(typeof C=="bigint")return t.result_int64(x,C);console.warn("unknown result converted to null",C),t.result_null(x)}break}},t.result_blob=(function(){const C=e.cwrap("sqlite3_result_blob",...$e("nnnn:n"));return function(E,$){const R=$.byteLength??$.length,I=e._sqlite3_malloc(R);e.HEAPU8.subarray(I).set($),C(E,I,R,n)}})(),t.result_double=(function(){const C=e.cwrap("sqlite3_result_double",...$e("nn:n"));return function(E,$){C(E,$)}})(),t.result_int=(function(){const C=e.cwrap("sqlite3_result_int",...$e("nn:n"));return function(E,$){C(E,$)}})(),t.result_int64=(function(){const C=e.cwrap("sqlite3_result_int64",...$e("nnn:n"));return function(E,$){if($>kI||$<CI)return sk;const R=$&0xffffffffn,I=$>>32n;C(E,Number(R),Number(I))}})(),t.result_null=(function(){const C=e.cwrap("sqlite3_result_null",...$e("n:n"));return function(E){C(E)}})(),t.result_text=(function(){const C=e.cwrap("sqlite3_result_text",...$e("nnnn:n"));return function(E,$){const R=c($);C(E,R,-1,n)}})(),t.row=function(x){const C=[],E=t.data_count(x);for(let $=0;$<E;++$){const R=t.column(x,$);C.push((R==null?void 0:R.buffer)===e.HEAPU8.buffer?R.slice():R)}return C},t.set_authorizer=function(x,C,E){b(x);function $(z,V,K,Y,P,ne){return[z,V,e.UTF8ToString(K),e.UTF8ToString(Y),e.UTF8ToString(P),e.UTF8ToString(ne)]}function R(z){return((V,K,Y,P,ne,Se)=>z(...$(V,K,Y,P,ne,Se)))}const I=e.set_authorizer(x,R(C),E);return N("sqlite3_set_authorizer",I,x)},t.sql=(function(){const C=e.cwrap("sqlite3_sql",...$e("n:s"));return function(E){return v(E),C(E)}})(),t.statements=function(x,C,E={}){const $=e.cwrap("sqlite3_prepare_v3","number",["number","number","number","number","number","number"],{async:!1}),R=[],I=new TextEncoder().encode(C),z=I.byteLength-I.byteLength%4+12,V=e._sqlite3_malloc(z),K=V+I.byteLength+1;e.HEAPU8.set(I,V),e.HEAPU8[K-1]=0;const Y=V+z-8,P=V+z-4;let ne;function Se(){ne&&!E.unscoped&&t.finalize(ne),ne=0}e.setValue(P,V,"*");do{Se();const Re=e.getValue(P,"*"),ge=$(x,Re,K-P,E.flags||0,Y,P);ge!==De&&N("sqlite3_prepare_v3",ge,x),ne=e.getValue(Y,"*"),ne&&(S.set(ne,x),R.push(ne))}while(ne);return R},t.step=(function(){const x="sqlite3_step",C=e.cwrap(x,...$e("n:n"),{async:bd});return function(E){v(E);const $=C(E);return N(x,$,S.get(E),[tA,Epe])}})(),t.commit_hook=function(x,C){b(x),e.commit_hook(x,C)},t.update_hook=function(x,C){b(x);function E(R,I,z,V,K){return[R,e.UTF8ToString(I),e.UTF8ToString(z),f(V,K)]}function $(R){return((I,z,V,K,Y)=>R(...E(I,z,V,K,Y)))}e.update_hook(x,$(C))},t.session_create=(function(){const x="sqlite3session_create",C=e.cwrap(x,...$e("nsn:n"));return function(E,$){b(E);const R=e._malloc(4),I=C(E,$,R);return I!==De&&N(x,I,E),e.getValue(R,"i32")}})(),t.session_attach=(function(){const x="sqlite3session_attach",C=e.cwrap(x,...$e("ns:n"));return function(E,$){if(typeof E!="number")throw new ha("Invalid session object",Fc);const R=C(E,$);return N(x,R)}})(),t.session_enable=(function(){const C=e.cwrap("sqlite3session_enable",...$e("nn:n"));return function(E,$){const R=$?1:0;if(typeof E!="number")throw new ha("Invalid session object",Fc);if(C(E,R)!==R)throw new ha("Failed to enable session",Fc)}})(),t.session_changeset=(function(){const x="sqlite3session_changeset",C=e.cwrap(x,...$e("nnn:n"));return function(E){if(typeof E!="number")throw new ha("Invalid session object",Fc);const $=e._malloc(4),R=e._malloc(4);try{const I=C(E,$,R);if(I===De){const z=e.getValue($,"i32"),V=e.getValue(R,"i32");if(V===0)return{result:I,size:0,changeset:null};const K=new Uint8Array(e.HEAPU8.subarray(V,V+z));return e._sqlite3_free(V),{result:I,size:z,changeset:K}}return N(x,I)}finally{e._free($),e._free(R)}}})(),t.session_delete=(function(){const C=e.cwrap("sqlite3session_delete",...$e("n:v"));return function(E){if(typeof E!="number")throw new ha("Invalid session object",Fc);return C(E)}})(),t.changeset_start=(function(){const x="sqlite3changeset_start",C=e.cwrap(x,...$e("nnn:n"));return function(E){const $=e._sqlite3_malloc(E.length);e.HEAPU8.subarray($).set(E);const R=e._malloc(4);try{const I=C(R,E.length,$);return I!==De&&N(x,I),e.getValue(R,"i32")}finally{e._sqlite3_free($),e._free(R)}}})(),t.changeset_finalize=(function(){const C=e.cwrap("sqlite3changeset_finalize",...$e("n:n"));return function(E){return C(E)}})(),t.changeset_invert=(function(){const x="sqlite3changeset_invert",C=e.cwrap(x,...$e("nn:nn"));return function(E){const $=e._sqlite3_malloc(E.length);e.HEAPU8.subarray($).set(E);const R=e._malloc(4),I=e._malloc(4),z=C(E.length,$,R,I);z!==De&&N(x,z);const V=e.getValue(R,"i32"),K=e.getValue(I,"i32"),Y=new Uint8Array(e.HEAPU8.buffer,K,V).slice();return e._sqlite3_free($),e._sqlite3_free(K),Y}})(),t.session_changeset_inverted=(function(){const x="sqlite3session_changeset",C=e.cwrap(x,...$e("nnn:n")),E="sqlite3changeset_invert",$=e.cwrap(E,...$e("nn:nn"));return function(R){if(typeof R!="number")throw new ha("Invalid session object",Fc);const I=e._malloc(4),z=e._malloc(4),V=e._malloc(4),K=e._malloc(4);try{const Y=C(R,I,z);if(Y!==De)return N(x,Y);const P=e.getValue(I,"i32"),ne=e.getValue(z,"i32"),Se=$(P,ne,V,K);if(Se!==De)return N(E,Se);const Re=e.getValue(V,"i32"),ge=e.getValue(K,"i32"),Ve=new Uint8Array(e.HEAPU8.buffer,ge,Re);return e._sqlite3_free(ne),e._sqlite3_free(ge),{result:Y,size:P,changeset:new Uint8Array(Ve)}}finally{e._free(I),e._free(z),e._free(V),e._free(K)}}})(),t.changeset_apply=(function(){const x="sqlite3changeset_apply",C=e.cwrap(x,...$e("nnnnnn:n"));return function(E,$,R){const I=e._sqlite3_malloc($.length);e.HEAPU8.subarray(I).set($);const z=1,V=()=>z,K=C(E,$.length,I,null,V,null);return e._sqlite3_free(I),K!==De&&N(x,K),K}})(),t.value=function(x){const C=t.value_type(x);switch(C){case _I:return t.value_blob(x);case gI:return t.value_double(x);case mI:const E=t.value_int(x),$=e.getTempRet0();return m(E,$);case yI:return null;case pI:return t.value_text(x);default:throw new ha("unknown type",C)}},t.value_blob=(function(){const C=e.cwrap("sqlite3_value_blob",...$e("n:n"));return function(E){const $=t.value_bytes(E),R=C(E);return e.HEAPU8.subarray(R,R+$)}})(),t.value_bytes=(function(){const C=e.cwrap("sqlite3_value_bytes",...$e("n:n"));return function(E){return C(E)}})(),t.value_double=(function(){const C=e.cwrap("sqlite3_value_double",...$e("n:n"));return function(E){return C(E)}})(),t.value_int=(function(){const C=e.cwrap("sqlite3_value_int64",...$e("n:n"));return function(E){return C(E)}})(),t.value_int64=(function(){const C=e.cwrap("sqlite3_value_int64",...$e("n:n"));return function(E){const $=C(E),R=e.getTempRet0();return f($,R)}})(),t.value_text=(function(){const C=e.cwrap("sqlite3_value_text",...$e("n:s"));return function(E){return C(E)}})(),t.value_type=(function(){const C=e.cwrap("sqlite3_value_type",...$e("n:n"));return function(E){return C(E)}})();const k=new Set;t.vfs_register=function(x,C){if(k.has(x.name))return;const E=e.vfs_register(x,C),$=N("sqlite3_vfs_register",E);return k.add(x.name),$},t.vfs_registered=k;function N(x,C,E=null,$=[De]){if($.includes(C))return C;const R=E?e.ccall("sqlite3_errmsg","string",["number"],[E]):x;throw new ha(R,C)}async function H(x){let C;do e.retryOps.length&&(await Promise.all(e.retryOps),e.retryOps=[]),C=await x();while(C&&e.retryOps.length);return C}return t}function $e(e){const t=[],n=e.match(/([ns@]*):([nsv@])/);switch(n[2]){case"n":t.push("number");break;case"s":t.push("string");break;case"v":t.push(null);break}const r=[];for(let i of n[1])switch(i){case"n":r.push("number");break;case"s":r.push("string");break}return t.push(r),t}var Kpe=(()=>{var e=import.meta.url;return(function(t={}){var n,r=t,i,c,f=new Promise((u,d)=>{i=u,c=d}),m=typeof window=="object",g=typeof WorkerGlobalScope<"u";typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string"&&process.type!="renderer";var b=Object.assign({},r),S="./this.program",v=(u,d)=>{throw d},q="";function k(u){return r.locateFile?r.locateFile(u,q):q+u}var N,H;(m||g)&&(g?q=self.location.href:typeof document<"u"&&document.currentScript&&(q=document.currentScript.src),e&&(q=e),q.startsWith("blob:")?q="":q=q.substr(0,q.replace(/[?#].*/,"").lastIndexOf("/")+1),g&&(H=u=>{var d=new XMLHttpRequest;return d.open("GET",u,!1),d.responseType="arraybuffer",d.send(null),new Uint8Array(d.response)}),N=u=>fetch(u,{credentials:"same-origin"}).then(d=>d.ok?d.arrayBuffer():Promise.reject(new Error(d.status+" : "+d.url))));var x=r.print||console.log.bind(console),C=r.printErr||console.error.bind(console);Object.assign(r,b),b=null,r.arguments&&r.arguments,r.thisProgram&&(S=r.thisProgram);var E=r.wasmBinary,$,R=!1,I,z,V,K,Y,P,ne,Se,Re;function ge(){var u=$.buffer;r.HEAP8=z=new Int8Array(u),r.HEAP16=K=new Int16Array(u),r.HEAPU8=V=new Uint8Array(u),r.HEAPU16=Y=new Uint16Array(u),r.HEAP32=P=new Int32Array(u),r.HEAPU32=ne=new Uint32Array(u),r.HEAPF32=Se=new Float32Array(u),r.HEAPF64=Re=new Float64Array(u)}var Ve=[],oe=[],Te=[],Ee=[];function pt(){if(r.preRun)for(typeof r.preRun=="function"&&(r.preRun=[r.preRun]);r.preRun.length;)_e(r.preRun.shift());kf(Ve)}function Q(){!r.noFSInit&&!A.initialized&&A.init(),A.ignorePermissions=!1,kf(oe)}function ue(){kf(Te)}function Be(){if(r.postRun)for(typeof r.postRun=="function"&&(r.postRun=[r.postRun]);r.postRun.length;)ct(r.postRun.shift());kf(Ee)}function _e(u){Ve.unshift(u)}function be(u){oe.unshift(u)}function ct(u){Ee.unshift(u)}var rt=0,Qn=null;function Lt(u){return u}function vn(u){var d;rt++,(d=r.monitorRunDependencies)==null||d.call(r,rt)}function Kt(u){var _;if(rt--,(_=r.monitorRunDependencies)==null||_.call(r,rt),rt==0&&Qn){var d=Qn;Qn=null,d()}}function pr(u){var _;(_=r.onAbort)==null||_.call(r,u),u="Aborted("+u+")",C(u),R=!0,u+=". Build with -sASSERTIONS for more info.";var d=new WebAssembly.RuntimeError(u);throw c(d),d}var Tl="data:application/octet-stream;base64,",Ia=u=>u.startsWith(Tl);function Tf(){if(r.locateFile){var u="wa-sqlite.wasm";return Ia(u)?u:k(u)}return new URL("/assets/wa-sqlite-CWx0VZcQ.wasm",import.meta.url).href}var Xo;function Qi(u){if(u==Xo&&E)return new Uint8Array(E);if(H)return H(u);throw"both async and sync fetching of the wasm failed"}function hm(u){return E?Promise.resolve().then(()=>Qi(u)):N(u).then(d=>new Uint8Array(d),()=>Qi(u))}function kl(u,d,_){return hm(u).then(w=>WebAssembly.instantiate(w,d)).then(_,w=>{C(`failed to asynchronously prepare wasm: ${w}`),pr(w)})}function mm(u,d,_,w){return!u&&typeof WebAssembly.instantiateStreaming=="function"&&!Ia(d)&&typeof fetch=="function"?fetch(d,{credentials:"same-origin"}).then(O=>{var U=WebAssembly.instantiateStreaming(O,_);return U.then(w,function(G){return C(`wasm streaming compile failed: ${G}`),C("falling back to ArrayBuffer instantiation"),kl(d,_,w)})}):kl(d,_,w)}function gm(){return{a:mc}}function pm(){function u(w,O){return L=w.exports,$=L.la,ge(),dc=L.of,be(L.ma),Kt(),L}vn();function d(w){u(w.instance)}var _=gm();if(r.instantiateWasm)try{return r.instantiateWasm(_,u)}catch(w){C(`Module.instantiateWasm callback failed with error: ${w}`),c(w)}return Xo??(Xo=Tf()),mm(E,Xo,_,d).catch(c),{}}var We,cn;class Ms{constructor(d){y(this,"name","ExitStatus");this.message=`Program terminated with exit(${d})`,this.status=d}}var kf=u=>{for(;u.length>0;)u.shift()(r)};function _m(u,d="i8"){switch(d.endsWith("*")&&(d="*"),d){case"i1":return z[u];case"i8":return z[u];case"i16":return K[u>>1];case"i32":return P[u>>2];case"i64":pr("to do getValue(i64) use WASM_BIGINT");case"float":return Se[u>>2];case"double":return Re[u>>3];case"*":return ne[u>>2];default:pr(`invalid type for getValue: ${d}`)}}r.noExitRuntime;function Yi(u,d,_="i8"){switch(_.endsWith("*")&&(_="*"),_){case"i1":z[u]=d;break;case"i8":z[u]=d;break;case"i16":K[u>>1]=d;break;case"i32":P[u>>2]=d;break;case"i64":pr("to do setValue(i64) use WASM_BIGINT");case"float":Se[u>>2]=d;break;case"double":Re[u>>3]=d;break;case"*":ne[u>>2]=d;break;default:pr(`invalid type for setValue: ${_}`)}}var Cf=u=>jm(u),eE=()=>pc(),ym=typeof TextDecoder<"u"?new TextDecoder:void 0,Zo=(u,d=0,_=NaN)=>{for(var w=d+_,O=d;u[O]&&!(O>=w);)++O;if(O-d>16&&u.buffer&&ym)return ym.decode(u.subarray(d,O));for(var U="";d<O;){var G=u[d++];if(!(G&128)){U+=String.fromCharCode(G);continue}var J=u[d++]&63;if((G&224)==192){U+=String.fromCharCode((G&31)<<6|J);continue}var ce=u[d++]&63;if((G&240)==224?G=(G&15)<<12|J<<6|ce:G=(G&7)<<18|J<<12|ce<<6|u[d++]&63,G<65536)U+=String.fromCharCode(G);else{var ke=G-65536;U+=String.fromCharCode(55296|ke>>10,56320|ke&1023)}}return U},Wi=(u,d)=>u?Zo(V,u,d):"",Cl=(u,d,_,w)=>pr(`Assertion failed: ${Wi(u)}, at: `+[d?Wi(d):"unknown filename",_,w?Wi(w):"unknown function"]),mt={isAbs:u=>u.charAt(0)==="/",splitPath:u=>{var d=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;return d.exec(u).slice(1)},normalizeArray:(u,d)=>{for(var _=0,w=u.length-1;w>=0;w--){var O=u[w];O==="."?u.splice(w,1):O===".."?(u.splice(w,1),_++):_&&(u.splice(w,1),_--)}if(d)for(;_;_--)u.unshift("..");return u},normalize:u=>{var d=mt.isAbs(u),_=u.substr(-1)==="/";return u=mt.normalizeArray(u.split("/").filter(w=>!!w),!d).join("/"),!u&&!d&&(u="."),u&&_&&(u+="/"),(d?"/":"")+u},dirname:u=>{var d=mt.splitPath(u),_=d[0],w=d[1];return!_&&!w?".":(w&&(w=w.substr(0,w.length-1)),_+w)},basename:u=>{if(u==="/")return"/";u=mt.normalize(u),u=u.replace(/\/$/,"");var d=u.lastIndexOf("/");return d===-1?u:u.substr(d+1)},join:(...u)=>mt.normalize(u.join("/")),join2:(u,d)=>mt.normalize(u+"/"+d)},tE=()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return u=>crypto.getRandomValues(u);pr("initRandomDevice")},Ma=u=>(Ma=tE())(u),jn={resolve:(...u)=>{for(var d="",_=!1,w=u.length-1;w>=-1&&!_;w--){var O=w>=0?u[w]:A.cwd();if(typeof O!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!O)return"";d=O+"/"+d,_=mt.isAbs(O)}return d=mt.normalizeArray(d.split("/").filter(U=>!!U),!_).join("/"),(_?"/":"")+d||"."},relative:(u,d)=>{u=jn.resolve(u).substr(1),d=jn.resolve(d).substr(1);function _(ke){for(var Me=0;Me<ke.length&&ke[Me]==="";Me++);for(var st=ke.length-1;st>=0&&ke[st]==="";st--);return Me>st?[]:ke.slice(Me,st-Me+1)}for(var w=_(u.split("/")),O=_(d.split("/")),U=Math.min(w.length,O.length),G=U,J=0;J<U;J++)if(w[J]!==O[J]){G=J;break}for(var ce=[],J=G;J<w.length;J++)ce.push("..");return ce=ce.concat(O.slice(G)),ce.join("/")}},bm=[],ec=u=>{for(var d=0,_=0;_<u.length;++_){var w=u.charCodeAt(_);w<=127?d++:w<=2047?d+=2:w>=55296&&w<=57343?(d+=4,++_):d+=3}return d},Sm=(u,d,_,w)=>{if(!(w>0))return 0;for(var O=_,U=_+w-1,G=0;G<u.length;++G){var J=u.charCodeAt(G);if(J>=55296&&J<=57343){var ce=u.charCodeAt(++G);J=65536+((J&1023)<<10)|ce&1023}if(J<=127){if(_>=U)break;d[_++]=J}else if(J<=2047){if(_+1>=U)break;d[_++]=192|J>>6,d[_++]=128|J&63}else if(J<=65535){if(_+2>=U)break;d[_++]=224|J>>12,d[_++]=128|J>>6&63,d[_++]=128|J&63}else{if(_+3>=U)break;d[_++]=240|J>>18,d[_++]=128|J>>12&63,d[_++]=128|J>>6&63,d[_++]=128|J&63}}return d[_]=0,_-O};function tc(u,d,_){var w=_>0?_:ec(u)+1,O=new Array(w),U=Sm(u,O,0,O.length);return d&&(O.length=U),O}var Af=()=>{if(!bm.length){var u=null;if(typeof window<"u"&&typeof window.prompt=="function"&&(u=window.prompt("Input: "),u!==null&&(u+=`
`)),!u)return null;bm=tc(u,!0)}return bm.shift()},cs={ttys:[],init(){},shutdown(){},register(u,d){cs.ttys[u]={input:[],output:[],ops:d},A.registerDevice(u,cs.stream_ops)},stream_ops:{open(u){var d=cs.ttys[u.node.rdev];if(!d)throw new A.ErrnoError(43);u.tty=d,u.seekable=!1},close(u){u.tty.ops.fsync(u.tty)},fsync(u){u.tty.ops.fsync(u.tty)},read(u,d,_,w,O){if(!u.tty||!u.tty.ops.get_char)throw new A.ErrnoError(60);for(var U=0,G=0;G<w;G++){var J;try{J=u.tty.ops.get_char(u.tty)}catch{throw new A.ErrnoError(29)}if(J===void 0&&U===0)throw new A.ErrnoError(6);if(J==null)break;U++,d[_+G]=J}return U&&(u.node.timestamp=Date.now()),U},write(u,d,_,w,O){if(!u.tty||!u.tty.ops.put_char)throw new A.ErrnoError(60);try{for(var U=0;U<w;U++)u.tty.ops.put_char(u.tty,d[_+U])}catch{throw new A.ErrnoError(29)}return w&&(u.node.timestamp=Date.now()),U}},default_tty_ops:{get_char(u){return Af()},put_char(u,d){d===null||d===10?(x(Zo(u.output)),u.output=[]):d!=0&&u.output.push(d)},fsync(u){u.output&&u.output.length>0&&(x(Zo(u.output)),u.output=[])},ioctl_tcgets(u){return{c_iflag:25856,c_oflag:5,c_cflag:191,c_lflag:35387,c_cc:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},ioctl_tcsets(u,d,_){return 0},ioctl_tiocgwinsz(u){return[24,80]}},default_tty1_ops:{put_char(u,d){d===null||d===10?(C(Zo(u.output)),u.output=[]):d!=0&&u.output.push(d)},fsync(u){u.output&&u.output.length>0&&(C(Zo(u.output)),u.output=[])}}},Rf=(u,d)=>{V.fill(0,u,u+d)},nc=(u,d)=>Math.ceil(u/d)*d,oy=u=>{u=nc(u,65536);var d=Fy(65536,u);return d&&Rf(d,u),d},et={ops_table:null,mount(u){return et.createNode(null,"/",16895,0)},createNode(u,d,_,w){if(A.isBlkdev(_)||A.isFIFO(_))throw new A.ErrnoError(63);et.ops_table||(et.ops_table={dir:{node:{getattr:et.node_ops.getattr,setattr:et.node_ops.setattr,lookup:et.node_ops.lookup,mknod:et.node_ops.mknod,rename:et.node_ops.rename,unlink:et.node_ops.unlink,rmdir:et.node_ops.rmdir,readdir:et.node_ops.readdir,symlink:et.node_ops.symlink},stream:{llseek:et.stream_ops.llseek}},file:{node:{getattr:et.node_ops.getattr,setattr:et.node_ops.setattr},stream:{llseek:et.stream_ops.llseek,read:et.stream_ops.read,write:et.stream_ops.write,allocate:et.stream_ops.allocate,mmap:et.stream_ops.mmap,msync:et.stream_ops.msync}},link:{node:{getattr:et.node_ops.getattr,setattr:et.node_ops.setattr,readlink:et.node_ops.readlink},stream:{}},chrdev:{node:{getattr:et.node_ops.getattr,setattr:et.node_ops.setattr},stream:A.chrdev_stream_ops}});var O=A.createNode(u,d,_,w);return A.isDir(O.mode)?(O.node_ops=et.ops_table.dir.node,O.stream_ops=et.ops_table.dir.stream,O.contents={}):A.isFile(O.mode)?(O.node_ops=et.ops_table.file.node,O.stream_ops=et.ops_table.file.stream,O.usedBytes=0,O.contents=null):A.isLink(O.mode)?(O.node_ops=et.ops_table.link.node,O.stream_ops=et.ops_table.link.stream):A.isChrdev(O.mode)&&(O.node_ops=et.ops_table.chrdev.node,O.stream_ops=et.ops_table.chrdev.stream),O.timestamp=Date.now(),u&&(u.contents[d]=O,u.timestamp=O.timestamp),O},getFileDataAsTypedArray(u){return u.contents?u.contents.subarray?u.contents.subarray(0,u.usedBytes):new Uint8Array(u.contents):new Uint8Array(0)},expandFileStorage(u,d){var _=u.contents?u.contents.length:0;if(!(_>=d)){var w=1024*1024;d=Math.max(d,_*(_<w?2:1.125)>>>0),_!=0&&(d=Math.max(d,256));var O=u.contents;u.contents=new Uint8Array(d),u.usedBytes>0&&u.contents.set(O.subarray(0,u.usedBytes),0)}},resizeFileStorage(u,d){if(u.usedBytes!=d)if(d==0)u.contents=null,u.usedBytes=0;else{var _=u.contents;u.contents=new Uint8Array(d),_&&u.contents.set(_.subarray(0,Math.min(d,u.usedBytes))),u.usedBytes=d}},node_ops:{getattr(u){var d={};return d.dev=A.isChrdev(u.mode)?u.id:1,d.ino=u.id,d.mode=u.mode,d.nlink=1,d.uid=0,d.gid=0,d.rdev=u.rdev,A.isDir(u.mode)?d.size=4096:A.isFile(u.mode)?d.size=u.usedBytes:A.isLink(u.mode)?d.size=u.link.length:d.size=0,d.atime=new Date(u.timestamp),d.mtime=new Date(u.timestamp),d.ctime=new Date(u.timestamp),d.blksize=4096,d.blocks=Math.ceil(d.size/d.blksize),d},setattr(u,d){d.mode!==void 0&&(u.mode=d.mode),d.timestamp!==void 0&&(u.timestamp=d.timestamp),d.size!==void 0&&et.resizeFileStorage(u,d.size)},lookup(u,d){throw et.doesNotExistError},mknod(u,d,_,w){return et.createNode(u,d,_,w)},rename(u,d,_){if(A.isDir(u.mode)){var w;try{w=A.lookupNode(d,_)}catch{}if(w)for(var O in w.contents)throw new A.ErrnoError(55)}delete u.parent.contents[u.name],u.parent.timestamp=Date.now(),u.name=_,d.contents[_]=u,d.timestamp=u.parent.timestamp},unlink(u,d){delete u.contents[d],u.timestamp=Date.now()},rmdir(u,d){var _=A.lookupNode(u,d);for(var w in _.contents)throw new A.ErrnoError(55);delete u.contents[d],u.timestamp=Date.now()},readdir(u){var d=[".",".."];for(var _ of Object.keys(u.contents))d.push(_);return d},symlink(u,d,_){var w=et.createNode(u,d,41471,0);return w.link=_,w},readlink(u){if(!A.isLink(u.mode))throw new A.ErrnoError(28);return u.link}},stream_ops:{read(u,d,_,w,O){var U=u.node.contents;if(O>=u.node.usedBytes)return 0;var G=Math.min(u.node.usedBytes-O,w);if(G>8&&U.subarray)d.set(U.subarray(O,O+G),_);else for(var J=0;J<G;J++)d[_+J]=U[O+J];return G},write(u,d,_,w,O,U){if(d.buffer===z.buffer&&(U=!1),!w)return 0;var G=u.node;if(G.timestamp=Date.now(),d.subarray&&(!G.contents||G.contents.subarray)){if(U)return G.contents=d.subarray(_,_+w),G.usedBytes=w,w;if(G.usedBytes===0&&O===0)return G.contents=d.slice(_,_+w),G.usedBytes=w,w;if(O+w<=G.usedBytes)return G.contents.set(d.subarray(_,_+w),O),w}if(et.expandFileStorage(G,O+w),G.contents.subarray&&d.subarray)G.contents.set(d.subarray(_,_+w),O);else for(var J=0;J<w;J++)G.contents[O+J]=d[_+J];return G.usedBytes=Math.max(G.usedBytes,O+w),w},llseek(u,d,_){var w=d;if(_===1?w+=u.position:_===2&&A.isFile(u.node.mode)&&(w+=u.node.usedBytes),w<0)throw new A.ErrnoError(28);return w},allocate(u,d,_){et.expandFileStorage(u.node,d+_),u.node.usedBytes=Math.max(u.node.usedBytes,d+_)},mmap(u,d,_,w,O){if(!A.isFile(u.node.mode))throw new A.ErrnoError(43);var U,G,J=u.node.contents;if(!(O&2)&&J&&J.buffer===z.buffer)G=!1,U=J.byteOffset;else{if(G=!0,U=oy(d),!U)throw new A.ErrnoError(48);J&&((_>0||_+d<J.length)&&(J.subarray?J=J.subarray(_,_+d):J=Array.prototype.slice.call(J,_,_+d)),z.set(J,U))}return{ptr:U,allocated:G}},msync(u,d,_,w,O){return et.stream_ops.write(u,d,0,w,_,!1),0}}},cy=(u,d,_,w)=>{var O=`al ${u}`;N(u).then(U=>{d(new Uint8Array(U)),O&&Kt()},U=>{if(_)_();else throw`Loading data file "${u}" failed.`}),O&&vn()},vm=(u,d,_,w,O,U)=>{A.createDataFile(u,d,_,w,O,U)},Al=r.preloadPlugins||[],nE=(u,d,_,w)=>{typeof Browser<"u"&&Browser.init();var O=!1;return Al.forEach(U=>{O||U.canHandle(d)&&(U.handle(u,d,_,w),O=!0)}),O},ly=(u,d,_,w,O,U,G,J,ce,ke)=>{var Me=d?jn.resolve(mt.join2(u,d)):u;function st(Rt){function je(Pe){ke==null||ke(),J||vm(u,d,Pe,w,O,ce),U==null||U(),Kt()}nE(Rt,Me,je,()=>{G==null||G(),Kt()})||je(Rt)}vn(),typeof _=="string"?cy(_,st,G):st(_)},uy=u=>{var d={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},_=d[u];if(typeof _>"u")throw new Error(`Unknown file open mode: ${u}`);return _},xf=(u,d)=>{var _=0;return u&&(_|=365),d&&(_|=146),_},A={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,ErrnoError:class{constructor(u){y(this,"name","ErrnoError");this.errno=u}},filesystems:null,syncFSRequests:0,readFiles:{},FSStream:class{constructor(){y(this,"shared",{})}get object(){return this.node}set object(u){this.node=u}get isRead(){return(this.flags&2097155)!==1}get isWrite(){return(this.flags&2097155)!==0}get isAppend(){return this.flags&1024}get flags(){return this.shared.flags}set flags(u){this.shared.flags=u}get position(){return this.shared.position}set position(u){this.shared.position=u}},FSNode:class{constructor(u,d,_,w){y(this,"node_ops",{});y(this,"stream_ops",{});y(this,"readMode",365);y(this,"writeMode",146);y(this,"mounted",null);u||(u=this),this.parent=u,this.mount=u.mount,this.id=A.nextInode++,this.name=d,this.mode=_,this.rdev=w}get read(){return(this.mode&this.readMode)===this.readMode}set read(u){u?this.mode|=this.readMode:this.mode&=~this.readMode}get write(){return(this.mode&this.writeMode)===this.writeMode}set write(u){u?this.mode|=this.writeMode:this.mode&=~this.writeMode}get isFolder(){return A.isDir(this.mode)}get isDevice(){return A.isChrdev(this.mode)}},lookupPath(u,d={}){if(u=jn.resolve(u),!u)return{path:"",node:null};var _={follow_mount:!0,recurse_count:0};if(d=Object.assign(_,d),d.recurse_count>8)throw new A.ErrnoError(32);for(var w=u.split("/").filter(st=>!!st),O=A.root,U="/",G=0;G<w.length;G++){var J=G===w.length-1;if(J&&d.parent)break;if(O=A.lookupNode(O,w[G]),U=mt.join2(U,w[G]),A.isMountpoint(O)&&(!J||J&&d.follow_mount)&&(O=O.mounted.root),!J||d.follow)for(var ce=0;A.isLink(O.mode);){var ke=A.readlink(U);U=jn.resolve(mt.dirname(U),ke);var Me=A.lookupPath(U,{recurse_count:d.recurse_count+1});if(O=Me.node,ce++>40)throw new A.ErrnoError(32)}}return{path:U,node:O}},getPath(u){for(var d;;){if(A.isRoot(u)){var _=u.mount.mountpoint;return d?_[_.length-1]!=="/"?`${_}/${d}`:_+d:_}d=d?`${u.name}/${d}`:u.name,u=u.parent}},hashName(u,d){for(var _=0,w=0;w<d.length;w++)_=(_<<5)-_+d.charCodeAt(w)|0;return(u+_>>>0)%A.nameTable.length},hashAddNode(u){var d=A.hashName(u.parent.id,u.name);u.name_next=A.nameTable[d],A.nameTable[d]=u},hashRemoveNode(u){var d=A.hashName(u.parent.id,u.name);if(A.nameTable[d]===u)A.nameTable[d]=u.name_next;else for(var _=A.nameTable[d];_;){if(_.name_next===u){_.name_next=u.name_next;break}_=_.name_next}},lookupNode(u,d){var _=A.mayLookup(u);if(_)throw new A.ErrnoError(_);for(var w=A.hashName(u.id,d),O=A.nameTable[w];O;O=O.name_next){var U=O.name;if(O.parent.id===u.id&&U===d)return O}return A.lookup(u,d)},createNode(u,d,_,w){var O=new A.FSNode(u,d,_,w);return A.hashAddNode(O),O},destroyNode(u){A.hashRemoveNode(u)},isRoot(u){return u===u.parent},isMountpoint(u){return!!u.mounted},isFile(u){return(u&61440)===32768},isDir(u){return(u&61440)===16384},isLink(u){return(u&61440)===40960},isChrdev(u){return(u&61440)===8192},isBlkdev(u){return(u&61440)===24576},isFIFO(u){return(u&61440)===4096},isSocket(u){return(u&49152)===49152},flagsToPermissionString(u){var d=["r","w","rw"][u&3];return u&512&&(d+="w"),d},nodePermissions(u,d){return A.ignorePermissions?0:d.includes("r")&&!(u.mode&292)||d.includes("w")&&!(u.mode&146)||d.includes("x")&&!(u.mode&73)?2:0},mayLookup(u){if(!A.isDir(u.mode))return 54;var d=A.nodePermissions(u,"x");return d||(u.node_ops.lookup?0:2)},mayCreate(u,d){var _;try{return _=A.lookupNode(u,d),20}catch{}return A.nodePermissions(u,"wx")},mayDelete(u,d,_){var w;try{w=A.lookupNode(u,d)}catch(U){return U.errno}var O=A.nodePermissions(u,"wx");if(O)return O;if(_){if(!A.isDir(w.mode))return 54;if(A.isRoot(w)||A.getPath(w)===A.cwd())return 10}else if(A.isDir(w.mode))return 31;return 0},mayOpen(u,d){return u?A.isLink(u.mode)?32:A.isDir(u.mode)&&(A.flagsToPermissionString(d)!=="r"||d&512)?31:A.nodePermissions(u,A.flagsToPermissionString(d)):44},MAX_OPEN_FDS:4096,nextfd(){for(var u=0;u<=A.MAX_OPEN_FDS;u++)if(!A.streams[u])return u;throw new A.ErrnoError(33)},getStreamChecked(u){var d=A.getStream(u);if(!d)throw new A.ErrnoError(8);return d},getStream:u=>A.streams[u],createStream(u,d=-1){return u=Object.assign(new A.FSStream,u),d==-1&&(d=A.nextfd()),u.fd=d,A.streams[d]=u,u},closeStream(u){A.streams[u]=null},dupStream(u,d=-1){var w,O;var _=A.createStream(u,d);return(O=(w=_.stream_ops)==null?void 0:w.dup)==null||O.call(w,_),_},chrdev_stream_ops:{open(u){var _,w;var d=A.getDevice(u.node.rdev);u.stream_ops=d.stream_ops,(w=(_=u.stream_ops).open)==null||w.call(_,u)},llseek(){throw new A.ErrnoError(70)}},major:u=>u>>8,minor:u=>u&255,makedev:(u,d)=>u<<8|d,registerDevice(u,d){A.devices[u]={stream_ops:d}},getDevice:u=>A.devices[u],getMounts(u){for(var d=[],_=[u];_.length;){var w=_.pop();d.push(w),_.push(...w.mounts)}return d},syncfs(u,d){typeof u=="function"&&(d=u,u=!1),A.syncFSRequests++,A.syncFSRequests>1&&C(`warning: ${A.syncFSRequests} FS.syncfs operations in flight at once, probably just doing extra work`);var _=A.getMounts(A.root.mount),w=0;function O(G){return A.syncFSRequests--,d(G)}function U(G){if(G)return U.errored?void 0:(U.errored=!0,O(G));++w>=_.length&&O(null)}_.forEach(G=>{if(!G.type.syncfs)return U(null);G.type.syncfs(G,u,U)})},mount(u,d,_){var w=_==="/",O=!_,U;if(w&&A.root)throw new A.ErrnoError(10);if(!w&&!O){var G=A.lookupPath(_,{follow_mount:!1});if(_=G.path,U=G.node,A.isMountpoint(U))throw new A.ErrnoError(10);if(!A.isDir(U.mode))throw new A.ErrnoError(54)}var J={type:u,opts:d,mountpoint:_,mounts:[]},ce=u.mount(J);return ce.mount=J,J.root=ce,w?A.root=ce:U&&(U.mounted=J,U.mount&&U.mount.mounts.push(J)),ce},unmount(u){var d=A.lookupPath(u,{follow_mount:!1});if(!A.isMountpoint(d.node))throw new A.ErrnoError(28);var _=d.node,w=_.mounted,O=A.getMounts(w);Object.keys(A.nameTable).forEach(G=>{for(var J=A.nameTable[G];J;){var ce=J.name_next;O.includes(J.mount)&&A.destroyNode(J),J=ce}}),_.mounted=null;var U=_.mount.mounts.indexOf(w);_.mount.mounts.splice(U,1)},lookup(u,d){return u.node_ops.lookup(u,d)},mknod(u,d,_){var w=A.lookupPath(u,{parent:!0}),O=w.node,U=mt.basename(u);if(!U||U==="."||U==="..")throw new A.ErrnoError(28);var G=A.mayCreate(O,U);if(G)throw new A.ErrnoError(G);if(!O.node_ops.mknod)throw new A.ErrnoError(63);return O.node_ops.mknod(O,U,d,_)},statfs(u){var d={bsize:4096,frsize:4096,blocks:1e6,bfree:5e5,bavail:5e5,files:A.nextInode,ffree:A.nextInode-1,fsid:42,flags:2,namelen:255},_=A.lookupPath(u,{follow:!0}).node;return _!=null&&_.node_ops.statfs&&Object.assign(d,_.node_ops.statfs(_.mount.opts.root)),d},create(u,d=438){return d&=4095,d|=32768,A.mknod(u,d,0)},mkdir(u,d=511){return d&=1023,d|=16384,A.mknod(u,d,0)},mkdirTree(u,d){for(var _=u.split("/"),w="",O=0;O<_.length;++O)if(_[O]){w+="/"+_[O];try{A.mkdir(w,d)}catch(U){if(U.errno!=20)throw U}}},mkdev(u,d,_){return typeof _>"u"&&(_=d,d=438),d|=8192,A.mknod(u,d,_)},symlink(u,d){if(!jn.resolve(u))throw new A.ErrnoError(44);var _=A.lookupPath(d,{parent:!0}),w=_.node;if(!w)throw new A.ErrnoError(44);var O=mt.basename(d),U=A.mayCreate(w,O);if(U)throw new A.ErrnoError(U);if(!w.node_ops.symlink)throw new A.ErrnoError(63);return w.node_ops.symlink(w,O,u)},rename(u,d){var _=mt.dirname(u),w=mt.dirname(d),O=mt.basename(u),U=mt.basename(d),G,J,ce;if(G=A.lookupPath(u,{parent:!0}),J=G.node,G=A.lookupPath(d,{parent:!0}),ce=G.node,!J||!ce)throw new A.ErrnoError(44);if(J.mount!==ce.mount)throw new A.ErrnoError(75);var ke=A.lookupNode(J,O),Me=jn.relative(u,w);if(Me.charAt(0)!==".")throw new A.ErrnoError(28);if(Me=jn.relative(d,_),Me.charAt(0)!==".")throw new A.ErrnoError(55);var st;try{st=A.lookupNode(ce,U)}catch{}if(ke!==st){var Rt=A.isDir(ke.mode),je=A.mayDelete(J,O,Rt);if(je)throw new A.ErrnoError(je);if(je=st?A.mayDelete(ce,U,Rt):A.mayCreate(ce,U),je)throw new A.ErrnoError(je);if(!J.node_ops.rename)throw new A.ErrnoError(63);if(A.isMountpoint(ke)||st&&A.isMountpoint(st))throw new A.ErrnoError(10);if(ce!==J&&(je=A.nodePermissions(J,"w"),je))throw new A.ErrnoError(je);A.hashRemoveNode(ke);try{J.node_ops.rename(ke,ce,U),ke.parent=ce}catch(Pe){throw Pe}finally{A.hashAddNode(ke)}}},rmdir(u){var d=A.lookupPath(u,{parent:!0}),_=d.node,w=mt.basename(u),O=A.lookupNode(_,w),U=A.mayDelete(_,w,!0);if(U)throw new A.ErrnoError(U);if(!_.node_ops.rmdir)throw new A.ErrnoError(63);if(A.isMountpoint(O))throw new A.ErrnoError(10);_.node_ops.rmdir(_,w),A.destroyNode(O)},readdir(u){var d=A.lookupPath(u,{follow:!0}),_=d.node;if(!_.node_ops.readdir)throw new A.ErrnoError(54);return _.node_ops.readdir(_)},unlink(u){var d=A.lookupPath(u,{parent:!0}),_=d.node;if(!_)throw new A.ErrnoError(44);var w=mt.basename(u),O=A.lookupNode(_,w),U=A.mayDelete(_,w,!1);if(U)throw new A.ErrnoError(U);if(!_.node_ops.unlink)throw new A.ErrnoError(63);if(A.isMountpoint(O))throw new A.ErrnoError(10);_.node_ops.unlink(_,w),A.destroyNode(O)},readlink(u){var d=A.lookupPath(u),_=d.node;if(!_)throw new A.ErrnoError(44);if(!_.node_ops.readlink)throw new A.ErrnoError(28);return _.node_ops.readlink(_)},stat(u,d){var _=A.lookupPath(u,{follow:!d}),w=_.node;if(!w)throw new A.ErrnoError(44);if(!w.node_ops.getattr)throw new A.ErrnoError(63);return w.node_ops.getattr(w)},lstat(u){return A.stat(u,!0)},chmod(u,d,_){var w;if(typeof u=="string"){var O=A.lookupPath(u,{follow:!_});w=O.node}else w=u;if(!w.node_ops.setattr)throw new A.ErrnoError(63);w.node_ops.setattr(w,{mode:d&4095|w.mode&-4096,timestamp:Date.now()})},lchmod(u,d){A.chmod(u,d,!0)},fchmod(u,d){var _=A.getStreamChecked(u);A.chmod(_.node,d)},chown(u,d,_,w){var O;if(typeof u=="string"){var U=A.lookupPath(u,{follow:!w});O=U.node}else O=u;if(!O.node_ops.setattr)throw new A.ErrnoError(63);O.node_ops.setattr(O,{timestamp:Date.now()})},lchown(u,d,_){A.chown(u,d,_,!0)},fchown(u,d,_){var w=A.getStreamChecked(u);A.chown(w.node,d,_)},truncate(u,d){if(d<0)throw new A.ErrnoError(28);var _;if(typeof u=="string"){var w=A.lookupPath(u,{follow:!0});_=w.node}else _=u;if(!_.node_ops.setattr)throw new A.ErrnoError(63);if(A.isDir(_.mode))throw new A.ErrnoError(31);if(!A.isFile(_.mode))throw new A.ErrnoError(28);var O=A.nodePermissions(_,"w");if(O)throw new A.ErrnoError(O);_.node_ops.setattr(_,{size:d,timestamp:Date.now()})},ftruncate(u,d){var _=A.getStreamChecked(u);if((_.flags&2097155)===0)throw new A.ErrnoError(28);A.truncate(_.node,d)},utime(u,d,_){var w=A.lookupPath(u,{follow:!0}),O=w.node;O.node_ops.setattr(O,{timestamp:Math.max(d,_)})},open(u,d,_=438){if(u==="")throw new A.ErrnoError(44);d=typeof d=="string"?uy(d):d,d&64?_=_&4095|32768:_=0;var w;if(typeof u=="object")w=u;else{u=mt.normalize(u);try{var O=A.lookupPath(u,{follow:!(d&131072)});w=O.node}catch{}}var U=!1;if(d&64)if(w){if(d&128)throw new A.ErrnoError(20)}else w=A.mknod(u,_,0),U=!0;if(!w)throw new A.ErrnoError(44);if(A.isChrdev(w.mode)&&(d&=-513),d&65536&&!A.isDir(w.mode))throw new A.ErrnoError(54);if(!U){var G=A.mayOpen(w,d);if(G)throw new A.ErrnoError(G)}d&512&&!U&&A.truncate(w,0),d&=-131713;var J=A.createStream({node:w,path:A.getPath(w),flags:d,seekable:!0,position:0,stream_ops:w.stream_ops,ungotten:[],error:!1});return J.stream_ops.open&&J.stream_ops.open(J),r.logReadFiles&&!(d&1)&&(u in A.readFiles||(A.readFiles[u]=1)),J},close(u){if(A.isClosed(u))throw new A.ErrnoError(8);u.getdents&&(u.getdents=null);try{u.stream_ops.close&&u.stream_ops.close(u)}catch(d){throw d}finally{A.closeStream(u.fd)}u.fd=null},isClosed(u){return u.fd===null},llseek(u,d,_){if(A.isClosed(u))throw new A.ErrnoError(8);if(!u.seekable||!u.stream_ops.llseek)throw new A.ErrnoError(70);if(_!=0&&_!=1&&_!=2)throw new A.ErrnoError(28);return u.position=u.stream_ops.llseek(u,d,_),u.ungotten=[],u.position},read(u,d,_,w,O){if(w<0||O<0)throw new A.ErrnoError(28);if(A.isClosed(u))throw new A.ErrnoError(8);if((u.flags&2097155)===1)throw new A.ErrnoError(8);if(A.isDir(u.node.mode))throw new A.ErrnoError(31);if(!u.stream_ops.read)throw new A.ErrnoError(28);var U=typeof O<"u";if(!U)O=u.position;else if(!u.seekable)throw new A.ErrnoError(70);var G=u.stream_ops.read(u,d,_,w,O);return U||(u.position+=G),G},write(u,d,_,w,O,U){if(w<0||O<0)throw new A.ErrnoError(28);if(A.isClosed(u))throw new A.ErrnoError(8);if((u.flags&2097155)===0)throw new A.ErrnoError(8);if(A.isDir(u.node.mode))throw new A.ErrnoError(31);if(!u.stream_ops.write)throw new A.ErrnoError(28);u.seekable&&u.flags&1024&&A.llseek(u,0,2);var G=typeof O<"u";if(!G)O=u.position;else if(!u.seekable)throw new A.ErrnoError(70);var J=u.stream_ops.write(u,d,_,w,O,U);return G||(u.position+=J),J},allocate(u,d,_){if(A.isClosed(u))throw new A.ErrnoError(8);if(d<0||_<=0)throw new A.ErrnoError(28);if((u.flags&2097155)===0)throw new A.ErrnoError(8);if(!A.isFile(u.node.mode)&&!A.isDir(u.node.mode))throw new A.ErrnoError(43);if(!u.stream_ops.allocate)throw new A.ErrnoError(138);u.stream_ops.allocate(u,d,_)},mmap(u,d,_,w,O){if((w&2)!==0&&(O&2)===0&&(u.flags&2097155)!==2)throw new A.ErrnoError(2);if((u.flags&2097155)===1)throw new A.ErrnoError(2);if(!u.stream_ops.mmap)throw new A.ErrnoError(43);if(!d)throw new A.ErrnoError(28);return u.stream_ops.mmap(u,d,_,w,O)},msync(u,d,_,w,O){return u.stream_ops.msync?u.stream_ops.msync(u,d,_,w,O):0},ioctl(u,d,_){if(!u.stream_ops.ioctl)throw new A.ErrnoError(59);return u.stream_ops.ioctl(u,d,_)},readFile(u,d={}){if(d.flags=d.flags||0,d.encoding=d.encoding||"binary",d.encoding!=="utf8"&&d.encoding!=="binary")throw new Error(`Invalid encoding type "${d.encoding}"`);var _,w=A.open(u,d.flags),O=A.stat(u),U=O.size,G=new Uint8Array(U);return A.read(w,G,0,U,0),d.encoding==="utf8"?_=Zo(G):d.encoding==="binary"&&(_=G),A.close(w),_},writeFile(u,d,_={}){_.flags=_.flags||577;var w=A.open(u,_.flags,_.mode);if(typeof d=="string"){var O=new Uint8Array(ec(d)+1),U=Sm(d,O,0,O.length);A.write(w,O,0,U,void 0,_.canOwn)}else if(ArrayBuffer.isView(d))A.write(w,d,0,d.byteLength,void 0,_.canOwn);else throw new Error("Unsupported data type");A.close(w)},cwd:()=>A.currentPath,chdir(u){var d=A.lookupPath(u,{follow:!0});if(d.node===null)throw new A.ErrnoError(44);if(!A.isDir(d.node.mode))throw new A.ErrnoError(54);var _=A.nodePermissions(d.node,"x");if(_)throw new A.ErrnoError(_);A.currentPath=d.path},createDefaultDirectories(){A.mkdir("/tmp"),A.mkdir("/home"),A.mkdir("/home/web_user")},createDefaultDevices(){A.mkdir("/dev"),A.registerDevice(A.makedev(1,3),{read:()=>0,write:(w,O,U,G,J)=>G,llseek:()=>0}),A.mkdev("/dev/null",A.makedev(1,3)),cs.register(A.makedev(5,0),cs.default_tty_ops),cs.register(A.makedev(6,0),cs.default_tty1_ops),A.mkdev("/dev/tty",A.makedev(5,0)),A.mkdev("/dev/tty1",A.makedev(6,0));var u=new Uint8Array(1024),d=0,_=()=>(d===0&&(d=Ma(u).byteLength),u[--d]);A.createDevice("/dev","random",_),A.createDevice("/dev","urandom",_),A.mkdir("/dev/shm"),A.mkdir("/dev/shm/tmp")},createSpecialDirectories(){A.mkdir("/proc");var u=A.mkdir("/proc/self");A.mkdir("/proc/self/fd"),A.mount({mount(){var d=A.createNode(u,"fd",16895,73);return d.node_ops={lookup(_,w){var O=+w,U=A.getStreamChecked(O),G={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:()=>U.path}};return G.parent=G,G}},d}},{},"/proc/self/fd")},createStandardStreams(u,d,_){u?A.createDevice("/dev","stdin",u):A.symlink("/dev/tty","/dev/stdin"),d?A.createDevice("/dev","stdout",null,d):A.symlink("/dev/tty","/dev/stdout"),_?A.createDevice("/dev","stderr",null,_):A.symlink("/dev/tty1","/dev/stderr"),A.open("/dev/stdin",0),A.open("/dev/stdout",1),A.open("/dev/stderr",1)},staticInit(){A.nameTable=new Array(4096),A.mount(et,{},"/"),A.createDefaultDirectories(),A.createDefaultDevices(),A.createSpecialDirectories(),A.filesystems={MEMFS:et}},init(u,d,_){A.initialized=!0,u??(u=r.stdin),d??(d=r.stdout),_??(_=r.stderr),A.createStandardStreams(u,d,_)},quit(){A.initialized=!1;for(var u=0;u<A.streams.length;u++){var d=A.streams[u];d&&A.close(d)}},findObject(u,d){var _=A.analyzePath(u,d);return _.exists?_.object:null},analyzePath(u,d){try{var _=A.lookupPath(u,{follow:!d});u=_.path}catch{}var w={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var _=A.lookupPath(u,{parent:!0});w.parentExists=!0,w.parentPath=_.path,w.parentObject=_.node,w.name=mt.basename(u),_=A.lookupPath(u,{follow:!d}),w.exists=!0,w.path=_.path,w.object=_.node,w.name=_.node.name,w.isRoot=_.path==="/"}catch(O){w.error=O.errno}return w},createPath(u,d,_,w){u=typeof u=="string"?u:A.getPath(u);for(var O=d.split("/").reverse();O.length;){var U=O.pop();if(U){var G=mt.join2(u,U);try{A.mkdir(G)}catch{}u=G}}return G},createFile(u,d,_,w,O){var U=mt.join2(typeof u=="string"?u:A.getPath(u),d),G=xf(w,O);return A.create(U,G)},createDataFile(u,d,_,w,O,U){var G=d;u&&(u=typeof u=="string"?u:A.getPath(u),G=d?mt.join2(u,d):u);var J=xf(w,O),ce=A.create(G,J);if(_){if(typeof _=="string"){for(var ke=new Array(_.length),Me=0,st=_.length;Me<st;++Me)ke[Me]=_.charCodeAt(Me);_=ke}A.chmod(ce,J|146);var Rt=A.open(ce,577);A.write(Rt,_,0,_.length,0,U),A.close(Rt),A.chmod(ce,J)}},createDevice(u,d,_,w){var J;var O=mt.join2(typeof u=="string"?u:A.getPath(u),d),U=xf(!!_,!!w);(J=A.createDevice).major??(J.major=64);var G=A.makedev(A.createDevice.major++,0);return A.registerDevice(G,{open(ce){ce.seekable=!1},close(ce){var ke;(ke=w==null?void 0:w.buffer)!=null&&ke.length&&w(10)},read(ce,ke,Me,st,Rt){for(var je=0,Pe=0;Pe<st;Pe++){var Ut;try{Ut=_()}catch{throw new A.ErrnoError(29)}if(Ut===void 0&&je===0)throw new A.ErrnoError(6);if(Ut==null)break;je++,ke[Me+Pe]=Ut}return je&&(ce.node.timestamp=Date.now()),je},write(ce,ke,Me,st,Rt){for(var je=0;je<st;je++)try{w(ke[Me+je])}catch{throw new A.ErrnoError(29)}return st&&(ce.node.timestamp=Date.now()),je}}),A.mkdev(O,U,G)},forceLoadFile(u){if(u.isDevice||u.isFolder||u.link||u.contents)return!0;if(typeof XMLHttpRequest<"u")throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");try{u.contents=H(u.url),u.usedBytes=u.contents.length}catch{throw new A.ErrnoError(29)}},createLazyFile(u,d,_,w,O){class U{constructor(){y(this,"lengthKnown",!1);y(this,"chunks",[])}get(je){if(!(je>this.length-1||je<0)){var Pe=je%this.chunkSize,Ut=je/this.chunkSize|0;return this.getter(Ut)[Pe]}}setDataGetter(je){this.getter=je}cacheLength(){var je=new XMLHttpRequest;if(je.open("HEAD",_,!1),je.send(null),!(je.status>=200&&je.status<300||je.status===304))throw new Error("Couldn't load "+_+". Status: "+je.status);var Pe=Number(je.getResponseHeader("Content-length")),Ut,Rr=(Ut=je.getResponseHeader("Accept-Ranges"))&&Ut==="bytes",ls=(Ut=je.getResponseHeader("Content-Encoding"))&&Ut==="gzip",js=1024*1024;Rr||(js=Pe);var xr=(Jr,mi)=>{if(Jr>mi)throw new Error("invalid range ("+Jr+", "+mi+") or no bytes requested!");if(mi>Pe-1)throw new Error("only "+Pe+" bytes available! programmer error!");var or=new XMLHttpRequest;if(or.open("GET",_,!1),Pe!==js&&or.setRequestHeader("Range","bytes="+Jr+"-"+mi),or.responseType="arraybuffer",or.overrideMimeType&&or.overrideMimeType("text/plain; charset=x-user-defined"),or.send(null),!(or.status>=200&&or.status<300||or.status===304))throw new Error("Couldn't load "+_+". Status: "+or.status);return or.response!==void 0?new Uint8Array(or.response||[]):tc(or.responseText||"",!0)},eo=this;eo.setDataGetter(Jr=>{var mi=Jr*js,or=(Jr+1)*js-1;if(or=Math.min(or,Pe-1),typeof eo.chunks[Jr]>"u"&&(eo.chunks[Jr]=xr(mi,or)),typeof eo.chunks[Jr]>"u")throw new Error("doXHR failed!");return eo.chunks[Jr]}),(ls||!Pe)&&(js=Pe=1,Pe=this.getter(0).length,js=Pe,x("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=Pe,this._chunkSize=js,this.lengthKnown=!0}get length(){return this.lengthKnown||this.cacheLength(),this._length}get chunkSize(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}if(typeof XMLHttpRequest<"u"){if(!g)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var G=new U,J={isDevice:!1,contents:G}}else var J={isDevice:!1,url:_};var ce=A.createFile(u,d,J,w,O);J.contents?ce.contents=J.contents:J.url&&(ce.contents=null,ce.url=J.url),Object.defineProperties(ce,{usedBytes:{get:function(){return this.contents.length}}});var ke={},Me=Object.keys(ce.stream_ops);Me.forEach(Rt=>{var je=ce.stream_ops[Rt];ke[Rt]=(...Pe)=>(A.forceLoadFile(ce),je(...Pe))});function st(Rt,je,Pe,Ut,Rr){var ls=Rt.node.contents;if(Rr>=ls.length)return 0;var js=Math.min(ls.length-Rr,Ut);if(ls.slice)for(var xr=0;xr<js;xr++)je[Pe+xr]=ls[Rr+xr];else for(var xr=0;xr<js;xr++)je[Pe+xr]=ls.get(Rr+xr);return js}return ke.read=(Rt,je,Pe,Ut,Rr)=>(A.forceLoadFile(ce),st(Rt,je,Pe,Ut,Rr)),ke.mmap=(Rt,je,Pe,Ut,Rr)=>{A.forceLoadFile(ce);var ls=oy(je);if(!ls)throw new A.ErrnoError(48);return st(Rt,z,ls,je,Pe),{ptr:ls,allocated:!0}},ce.stream_ops=ke,ce}},bt={DEFAULT_POLLMASK:5,calculateAt(u,d,_){if(mt.isAbs(d))return d;var w;if(u===-100)w=A.cwd();else{var O=bt.getStreamFromFD(u);w=O.path}if(d.length==0){if(!_)throw new A.ErrnoError(44);return w}return mt.join2(w,d)},doStat(u,d,_){var w=u(d);P[_>>2]=w.dev,P[_+4>>2]=w.mode,ne[_+8>>2]=w.nlink,P[_+12>>2]=w.uid,P[_+16>>2]=w.gid,P[_+20>>2]=w.rdev,cn=[w.size>>>0,(We=w.size,+Math.abs(We)>=1?We>0?+Math.floor(We/4294967296)>>>0:~~+Math.ceil((We-+(~~We>>>0))/4294967296)>>>0:0)],P[_+24>>2]=cn[0],P[_+28>>2]=cn[1],P[_+32>>2]=4096,P[_+36>>2]=w.blocks;var O=w.atime.getTime(),U=w.mtime.getTime(),G=w.ctime.getTime();return cn=[Math.floor(O/1e3)>>>0,(We=Math.floor(O/1e3),+Math.abs(We)>=1?We>0?+Math.floor(We/4294967296)>>>0:~~+Math.ceil((We-+(~~We>>>0))/4294967296)>>>0:0)],P[_+40>>2]=cn[0],P[_+44>>2]=cn[1],ne[_+48>>2]=O%1e3*1e3*1e3,cn=[Math.floor(U/1e3)>>>0,(We=Math.floor(U/1e3),+Math.abs(We)>=1?We>0?+Math.floor(We/4294967296)>>>0:~~+Math.ceil((We-+(~~We>>>0))/4294967296)>>>0:0)],P[_+56>>2]=cn[0],P[_+60>>2]=cn[1],ne[_+64>>2]=U%1e3*1e3*1e3,cn=[Math.floor(G/1e3)>>>0,(We=Math.floor(G/1e3),+Math.abs(We)>=1?We>0?+Math.floor(We/4294967296)>>>0:~~+Math.ceil((We-+(~~We>>>0))/4294967296)>>>0:0)],P[_+72>>2]=cn[0],P[_+76>>2]=cn[1],ne[_+80>>2]=G%1e3*1e3*1e3,cn=[w.ino>>>0,(We=w.ino,+Math.abs(We)>=1?We>0?+Math.floor(We/4294967296)>>>0:~~+Math.ceil((We-+(~~We>>>0))/4294967296)>>>0:0)],P[_+88>>2]=cn[0],P[_+92>>2]=cn[1],0},doMsync(u,d,_,w,O){if(!A.isFile(d.node.mode))throw new A.ErrnoError(43);if(w&2)return 0;var U=V.slice(u,u+_);A.msync(d,U,O,_,w)},getStreamFromFD(u){var d=A.getStreamChecked(u);return d},varargs:void 0,getStr(u){var d=Wi(u);return d}};function fi(u,d){try{return u=bt.getStr(u),A.chmod(u,d),0}catch(_){if(typeof A>"u"||_.name!=="ErrnoError")throw _;return-_.errno}}function Ar(u,d,_,w){try{if(d=bt.getStr(d),d=bt.calculateAt(u,d),_&-8)return-28;var O=A.lookupPath(d,{follow:!0}),U=O.node;if(!U)return-44;var G="";return _&4&&(G+="r"),_&2&&(G+="w"),_&1&&(G+="x"),G&&A.nodePermissions(U,G)?-2:0}catch(J){if(typeof A>"u"||J.name!=="ErrnoError")throw J;return-J.errno}}function Qr(u,d){try{return A.fchmod(u,d),0}catch(_){if(typeof A>"u"||_.name!=="ErrnoError")throw _;return-_.errno}}function rc(u,d,_){try{return A.fchown(u,d,_),0}catch(w){if(typeof A>"u"||w.name!=="ErrnoError")throw w;return-w.errno}}var sc=()=>{var u=P[+bt.varargs>>2];return bt.varargs+=4,u},rE=sc;function sE(u,d,_){bt.varargs=_;try{var w=bt.getStreamFromFD(u);switch(d){case 0:{var O=sc();if(O<0)return-28;for(;A.streams[O];)O++;var U;return U=A.dupStream(w,O),U.fd}case 1:case 2:return 0;case 3:return w.flags;case 4:{var O=sc();return w.flags|=O,0}case 12:{var O=rE(),G=0;return K[O+G>>1]=2,0}case 13:case 14:return 0}return-28}catch(J){if(typeof A>"u"||J.name!=="ErrnoError")throw J;return-J.errno}}function fy(u,d){try{var _=bt.getStreamFromFD(u);return bt.doStat(A.stat,_.path,d)}catch(w){if(typeof A>"u"||w.name!=="ErrnoError")throw w;return-w.errno}}var ja=(u,d)=>d+2097152>>>0<4194305-!!u?(u>>>0)+d*4294967296:NaN;function wm(u,d,_){var w=ja(d,_);try{return isNaN(w)?61:(A.ftruncate(u,w),0)}catch(O){if(typeof A>"u"||O.name!=="ErrnoError")throw O;return-O.errno}}var Yr=(u,d,_)=>Sm(u,V,d,_);function ac(u,d){try{if(d===0)return-28;var _=A.cwd(),w=ec(_)+1;return d<w?-68:(Yr(_,u,d),w)}catch(O){if(typeof A>"u"||O.name!=="ErrnoError")throw O;return-O.errno}}function Rl(u,d){try{return u=bt.getStr(u),bt.doStat(A.lstat,u,d)}catch(_){if(typeof A>"u"||_.name!=="ErrnoError")throw _;return-_.errno}}function ic(u,d,_){try{return d=bt.getStr(d),d=bt.calculateAt(u,d),d=mt.normalize(d),d[d.length-1]==="/"&&(d=d.substr(0,d.length-1)),A.mkdir(d,_,0),0}catch(w){if(typeof A>"u"||w.name!=="ErrnoError")throw w;return-w.errno}}function ir(u,d,_,w){try{d=bt.getStr(d);var O=w&256,U=w&4096;return w=w&-6401,d=bt.calculateAt(u,d,U),bt.doStat(O?A.lstat:A.stat,d,_)}catch(G){if(typeof A>"u"||G.name!=="ErrnoError")throw G;return-G.errno}}function dy(u,d,_,w){bt.varargs=w;try{d=bt.getStr(d),d=bt.calculateAt(u,d);var O=w?sc():0;return A.open(d,_,O).fd}catch(U){if(typeof A>"u"||U.name!=="ErrnoError")throw U;return-U.errno}}function hy(u,d,_,w){try{if(d=bt.getStr(d),d=bt.calculateAt(u,d),w<=0)return-28;var O=A.readlink(d),U=Math.min(w,ec(O)),G=z[_+U];return Yr(O,_,w+1),z[_+U]=G,U}catch(J){if(typeof A>"u"||J.name!=="ErrnoError")throw J;return-J.errno}}function Ji(u){try{return u=bt.getStr(u),A.rmdir(u),0}catch(d){if(typeof A>"u"||d.name!=="ErrnoError")throw d;return-d.errno}}function oc(u,d){try{return u=bt.getStr(u),bt.doStat(A.stat,u,d)}catch(_){if(typeof A>"u"||_.name!=="ErrnoError")throw _;return-_.errno}}function Fa(u,d,_){try{return d=bt.getStr(d),d=bt.calculateAt(u,d),_===0?A.unlink(d):_===512?A.rmdir(d):pr("Invalid flags passed to unlinkat"),0}catch(w){if(typeof A>"u"||w.name!=="ErrnoError")throw w;return-w.errno}}var my=u=>ne[u>>2]+P[u+4>>2]*4294967296;function gy(u,d,_,w){try{d=bt.getStr(d),d=bt.calculateAt(u,d,!0);var O=Date.now(),U,G;if(!_)U=O,G=O;else{var J=my(_),ce=P[_+8>>2];ce==1073741823?U=O:ce==1073741822?U=-1:U=J*1e3+ce/(1e3*1e3),_+=16,J=my(_),ce=P[_+8>>2],ce==1073741823?G=O:ce==1073741822?G=-1:G=J*1e3+ce/(1e3*1e3)}return(G!=-1||U!=-1)&&A.utime(d,U,G),0}catch(ke){if(typeof A>"u"||ke.name!=="ErrnoError")throw ke;return-ke.errno}}var py=u=>u%4===0&&(u%100!==0||u%400===0),aE=[0,31,60,91,121,152,182,213,244,274,305,335],Of=[0,31,59,90,120,151,181,212,243,273,304,334],Df=u=>{var d=py(u.getFullYear()),_=d?aE:Of,w=_[u.getMonth()]+u.getDate()-1;return w};function La(u,d,_){var w=ja(u,d),O=new Date(w*1e3);P[_>>2]=O.getSeconds(),P[_+4>>2]=O.getMinutes(),P[_+8>>2]=O.getHours(),P[_+12>>2]=O.getDate(),P[_+16>>2]=O.getMonth(),P[_+20>>2]=O.getFullYear()-1900,P[_+24>>2]=O.getDay();var U=Df(O)|0;P[_+28>>2]=U,P[_+36>>2]=-(O.getTimezoneOffset()*60);var G=new Date(O.getFullYear(),0,1),J=new Date(O.getFullYear(),6,1).getTimezoneOffset(),ce=G.getTimezoneOffset(),ke=(J!=ce&&O.getTimezoneOffset()==Math.min(ce,J))|0;P[_+32>>2]=ke}function As(u,d,_,w,O,U,G,J){var ce=ja(O,U);try{if(isNaN(ce))return 61;var ke=bt.getStreamFromFD(w),Me=A.mmap(ke,u,ce,d,_),st=Me.ptr;return P[G>>2]=Me.allocated,ne[J>>2]=st,0}catch(Rt){if(typeof A>"u"||Rt.name!=="ErrnoError")throw Rt;return-Rt.errno}}function _y(u,d,_,w,O,U,G){var J=ja(U,G);try{var ce=bt.getStreamFromFD(O);_&2&&bt.doMsync(u,ce,d,w,J)}catch(ke){if(typeof A>"u"||ke.name!=="ErrnoError")throw ke;return-ke.errno}}var iE=(u,d,_,w)=>{var O=new Date().getFullYear(),U=new Date(O,0,1),G=new Date(O,6,1),J=U.getTimezoneOffset(),ce=G.getTimezoneOffset(),ke=Math.max(J,ce);ne[u>>2]=ke*60,P[d>>2]=+(J!=ce);var Me=je=>{var Pe=je>=0?"-":"+",Ut=Math.abs(je),Rr=String(Math.floor(Ut/60)).padStart(2,"0"),ls=String(Ut%60).padStart(2,"0");return`UTC${Pe}${Rr}${ls}`},st=Me(J),Rt=Me(ce);ce<J?(Yr(st,_,17),Yr(Rt,w,17)):(Yr(st,w,17),Yr(Rt,_,17))},qf=()=>Date.now(),yy=()=>performance.now(),Nf=()=>2147483648,oE=u=>{var d=$.buffer,_=(u-d.byteLength+65535)/65536|0;try{return $.grow(_),ge(),1}catch{}},Rs=u=>{var d=V.length;u>>>=0;var _=Nf();if(u>_)return!1;for(var w=1;w<=4;w*=2){var O=d*(1+.2/w);O=Math.min(O,u+100663296);var U=Math.min(_,nc(Math.max(u,O),65536)),G=oE(U);if(G)return!0}return!1},xl={},by=()=>S||"./this.program",Xi=()=>{if(!Xi.strings){var u=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",d={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:u,_:by()};for(var _ in xl)xl[_]===void 0?delete d[_]:d[_]=xl[_];var w=[];for(var _ in d)w.push(`${_}=${d[_]}`);Xi.strings=w}return Xi.strings},cc=(u,d)=>{for(var _=0;_<u.length;++_)z[d++]=u.charCodeAt(_);z[d]=0},Sy=(u,d)=>{var _=0;return Xi().forEach((w,O)=>{var U=d+_;ne[u+O*4>>2]=U,cc(w,U),_+=w.length+1}),0},vy=(u,d)=>{var _=Xi();ne[u>>2]=_.length;var w=0;return _.forEach(O=>w+=O.length+1),ne[d>>2]=w,0};function lc(u){try{var d=bt.getStreamFromFD(u);return A.close(d),0}catch(_){if(typeof A>"u"||_.name!=="ErrnoError")throw _;return _.errno}}function cE(u,d){try{var _=0,w=0,O=0,U=bt.getStreamFromFD(u),G=U.tty?2:A.isDir(U.mode)?3:A.isLink(U.mode)?7:4;return z[d]=G,K[d+2>>1]=O,cn=[_>>>0,(We=_,+Math.abs(We)>=1?We>0?+Math.floor(We/4294967296)>>>0:~~+Math.ceil((We-+(~~We>>>0))/4294967296)>>>0:0)],P[d+8>>2]=cn[0],P[d+12>>2]=cn[1],cn=[w>>>0,(We=w,+Math.abs(We)>=1?We>0?+Math.floor(We/4294967296)>>>0:~~+Math.ceil((We-+(~~We>>>0))/4294967296)>>>0:0)],P[d+16>>2]=cn[0],P[d+20>>2]=cn[1],0}catch(J){if(typeof A>"u"||J.name!=="ErrnoError")throw J;return J.errno}}var wy=(u,d,_,w)=>{for(var O=0,U=0;U<_;U++){var G=ne[d>>2],J=ne[d+4>>2];d+=8;var ce=A.read(u,z,G,J,w);if(ce<0)return-1;if(O+=ce,ce<J)break}return O};function Ey(u,d,_,w){try{var O=bt.getStreamFromFD(u),U=wy(O,d,_);return ne[w>>2]=U,0}catch(G){if(typeof A>"u"||G.name!=="ErrnoError")throw G;return G.errno}}function Em(u,d,_,w,O){var U=ja(d,_);try{if(isNaN(U))return 61;var G=bt.getStreamFromFD(u);return A.llseek(G,U,w),cn=[G.position>>>0,(We=G.position,+Math.abs(We)>=1?We>0?+Math.floor(We/4294967296)>>>0:~~+Math.ceil((We-+(~~We>>>0))/4294967296)>>>0:0)],P[O>>2]=cn[0],P[O+4>>2]=cn[1],G.getdents&&U===0&&w===0&&(G.getdents=null),0}catch(J){if(typeof A>"u"||J.name!=="ErrnoError")throw J;return J.errno}}function lE(u){var _;try{var d=bt.getStreamFromFD(u);return(_=d.stream_ops)!=null&&_.fsync?d.stream_ops.fsync(d):0}catch(w){if(typeof A>"u"||w.name!=="ErrnoError")throw w;return w.errno}}var uE=(u,d,_,w)=>{for(var O=0,U=0;U<_;U++){var G=ne[d>>2],J=ne[d+4>>2];d+=8;var ce=A.write(u,z,G,J,w);if(ce<0)return-1;if(O+=ce,ce<J)break}return O};function $f(u,d,_,w){try{var O=bt.getStreamFromFD(u),U=uE(O,d,_);return ne[w>>2]=U,0}catch(G){if(typeof A>"u"||G.name!=="ErrnoError")throw G;return G.errno}}var wt=function(){const u=typeof Asyncify=="object"?Asyncify.handleAsync.bind(Asyncify):null;r.handleAsync=u;const d=new Map;r.setCallback=(_,w)=>d.set(_,w),r.getCallback=_=>d.get(_),r.deleteCallback=_=>d.delete(_),wt=function(_,w,...O){const U=d.get(w);let G=null;const J=typeof U=="function"?U:U[G=Wi(O.shift())];if(_){if(u)return u(()=>J.apply(U,O));throw new Error("Synchronous WebAssembly cannot call async function")}const ce=J.apply(U,O);if(typeof(ce==null?void 0:ce.then)=="function")throw console.error("unexpected Promise",J),new Error(`${G} unexpectedly returned a Promise`);return ce}};function Tm(...u){return wt(!1,...u)}function uc(...u){return wt(!0,...u)}function fc(...u){return wt(!1,...u)}function Ty(...u){return wt(!0,...u)}function km(...u){return wt(!1,...u)}function ky(...u){return wt(!0,...u)}function Ol(...u){return wt(!1,...u)}function Cm(...u){return wt(!0,...u)}function Dl(...u){return wt(!1,...u)}function di(...u){return wt(!0,...u)}function Am(...u){return wt(!1,...u)}function If(...u){return wt(!0,...u)}function Cy(...u){return wt(!1,...u)}function Mf(...u){return wt(!0,...u)}function jf(...u){return wt(!1,...u)}function Ay(...u){return wt(!0,...u)}function Wr(...u){return wt(!1,...u)}function Zi(...u){return wt(!0,...u)}function Ff(...u){return wt(!1,...u)}function ql(...u){return wt(!0,...u)}function fE(...u){return wt(!1,...u)}function Rm(...u){return wt(!0,...u)}function xm(...u){return wt(!1,...u)}function Nl(...u){return wt(!0,...u)}function Lf(...u){return wt(!1,...u)}function Ry(...u){return wt(!0,...u)}function dE(...u){return wt(!1,...u)}function hE(...u){return wt(!0,...u)}function mE(...u){return wt(!1,...u)}function Om(...u){return wt(!0,...u)}function gE(...u){return wt(!1,...u)}function pE(...u){return wt(!0,...u)}var _E=u=>{I=u,v(u,new Ms(u))},yE=(u,d)=>{I=u,_E(u)},bE=u=>{if(u instanceof Ms||u=="unwind")return I;v(1,u)},Dm=(u,d)=>{u<128?d.push(u):d.push(u%128|128,u>>7)},SE=u=>{for(var d={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},_={parameters:[],results:u[0]=="v"?[]:[d[u[0]]]},w=1;w<u.length;++w)_.parameters.push(d[u[w]]);return _},vE=(u,d)=>{var _=u.slice(0,1),w=u.slice(1),O={i:127,p:127,j:126,f:125,d:124,e:111};d.push(96),Dm(w.length,d);for(var U=0;U<w.length;++U)d.push(O[w[U]]);_=="v"?d.push(0):d.push(1,O[_])},wE=(u,d)=>{if(typeof WebAssembly.Function=="function")return new WebAssembly.Function(SE(d),u);var _=[1];vE(d,_);var w=[0,97,115,109,1,0,0,0,1];Dm(_.length,w),w.push(..._),w.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0);var O=new WebAssembly.Module(new Uint8Array(w)),U=new WebAssembly.Instance(O,{e:{f:u}}),G=U.exports.f;return G},dc,qm=u=>dc.get(u),EE=(u,d)=>{if(hc)for(var _=u;_<u+d;_++){var w=qm(_);w&&hc.set(w,_)}},hc,TE=u=>(hc||(hc=new WeakMap,EE(0,dc.length)),hc.get(u)||0),Nm=[],kE=()=>{if(Nm.length)return Nm.pop();try{dc.grow(1)}catch(u){throw u instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":u}return dc.length-1},xy=(u,d)=>dc.set(u,d),CE=(u,d)=>{var _=TE(u);if(_)return _;var w=kE();try{xy(w,u)}catch(U){if(!(U instanceof TypeError))throw U;var O=wE(u,d);xy(w,O)}return hc.set(u,w),w},Oy=u=>{var d=r["_"+u];return d},Dy=(u,d)=>{z.set(u,d)},qy=u=>gc(u),AE=u=>{var d=ec(u)+1,_=qy(d);return Yr(u,_,d),_},hi=(u,d,_,w,O)=>{var U={string:Pe=>{var Ut=0;return Pe!=null&&Pe!==0&&(Ut=AE(Pe)),Ut},array:Pe=>{var Ut=qy(Pe.length);return Dy(Pe,Ut),Ut}};function G(Pe){return d==="string"?Wi(Pe):d==="boolean"?!!Pe:Pe}var J=Oy(u),ce=[],ke=0;if(w)for(var Me=0;Me<w.length;Me++){var st=U[_[Me]];st?(ke===0&&(ke=eE()),ce[Me]=st(w[Me])):ce[Me]=w[Me]}var Rt=J(...ce);function je(Pe){return ke!==0&&Cf(ke),G(Pe)}return Rt=je(Rt),Rt},RE=(u,d,_,w)=>{var O=!_||_.every(G=>G==="number"||G==="boolean"),U=d!=="string";return U&&O&&!w?Oy(u):(...G)=>hi(u,d,_,G)},$m=u=>Mm(),$l=(u,d,_)=>{if(_??(_=2147483647),_<2)return 0;_-=2;for(var w=d,O=_<u.length*2?_/2:u.length,U=0;U<O;++U){var G=u.charCodeAt(U);K[d>>1]=G,d+=2}return K[d>>1]=0,d-w},xE=(u,d,_)=>{if(_??(_=2147483647),_<4)return 0;for(var w=d,O=w+_-4,U=0;U<u.length;++U){var G=u.charCodeAt(U);if(G>=55296&&G<=57343){var J=u.charCodeAt(++U);G=65536+((G&1023)<<10)|J&1023}if(P[d>>2]=G,d+=4,d+4>O)break}return P[d>>2]=0,d-w},Ny=u=>{for(var d="";;){var _=V[u++];if(!_)return d;d+=String.fromCharCode(_)}},Im=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,$y=(u,d)=>{for(var _=u,w=_>>1,O=w+d/2;!(w>=O)&&Y[w];)++w;if(_=w<<1,_-u>32&&Im)return Im.decode(V.subarray(u,_));for(var U="",G=0;!(G>=d/2);++G){var J=K[u+G*2>>1];if(J==0)break;U+=String.fromCharCode(J)}return U},Iy=(u,d)=>{for(var _=0,w="";!(_>=d/4);){var O=P[u+_*4>>2];if(O==0)break;if(++_,O>=65536){var U=O-65536;w+=String.fromCharCode(55296|U>>10,56320|U&1023)}else w+=String.fromCharCode(O)}return w};function My(u){for(var d=[],_=0;_<u.length;_++){var w=u[_];w>255&&(w&=255),d.push(String.fromCharCode(w))}return d.join("")}A.createPreloadedFile=ly,A.staticInit(),et.doesNotExistError=new A.ErrnoError(44),et.doesNotExistError.stack="<generic error, no stack>",wt();var mc={a:Cl,Y:fi,$:Ar,Z:Qr,X:rc,b:sE,W:fy,y:wm,Q:ac,U:Rl,N:ic,S:ir,L:dy,J:hy,I:Ji,V:oc,G:Fa,F:gy,w:La,u:As,v:_y,M:iE,n:qf,m:yy,D:Rs,O:Sy,P:vy,o:lc,E:cE,K:Ey,x:Em,R:lE,H:$f,s:Tm,t:uc,ga:fc,ka:Ty,i:km,j:ky,c:Ol,d:Cm,ca:Dl,da:di,ea:Am,fa:If,g:Cy,h:Mf,z:jf,A:Ay,e:Wr,f:Zi,aa:Ff,ba:ql,B:fE,C:Rm,p:xm,q:Nl,ha:Lf,ia:Ry,ja:dE,r:hE,k:mE,l:Om,T:gE,_:pE},L=pm();r._sqlite3_status64=(u,d,_,w)=>(r._sqlite3_status64=L.na)(u,d,_,w),r._sqlite3_status=(u,d,_,w)=>(r._sqlite3_status=L.oa)(u,d,_,w),r._sqlite3_db_status=(u,d,_,w,O)=>(r._sqlite3_db_status=L.pa)(u,d,_,w,O),r._sqlite3_msize=u=>(r._sqlite3_msize=L.qa)(u),r._sqlite3_vfs_find=u=>(r._sqlite3_vfs_find=L.ra)(u),r._sqlite3_vfs_register=(u,d)=>(r._sqlite3_vfs_register=L.sa)(u,d),r._sqlite3_vfs_unregister=u=>(r._sqlite3_vfs_unregister=L.ta)(u),r._sqlite3_release_memory=u=>(r._sqlite3_release_memory=L.ua)(u),r._sqlite3_soft_heap_limit64=(u,d)=>(r._sqlite3_soft_heap_limit64=L.va)(u,d),r._sqlite3_memory_used=()=>(r._sqlite3_memory_used=L.wa)(),r._sqlite3_hard_heap_limit64=(u,d)=>(r._sqlite3_hard_heap_limit64=L.xa)(u,d),r._sqlite3_memory_highwater=u=>(r._sqlite3_memory_highwater=L.ya)(u),r._sqlite3_malloc=u=>(r._sqlite3_malloc=L.za)(u),r._sqlite3_malloc64=(u,d)=>(r._sqlite3_malloc64=L.Aa)(u,d),r._sqlite3_free=u=>(r._sqlite3_free=L.Ba)(u),r._sqlite3_realloc=(u,d)=>(r._sqlite3_realloc=L.Ca)(u,d),r._sqlite3_realloc64=(u,d,_)=>(r._sqlite3_realloc64=L.Da)(u,d,_),r._sqlite3_str_vappendf=(u,d,_)=>(r._sqlite3_str_vappendf=L.Ea)(u,d,_),r._sqlite3_str_append=(u,d,_)=>(r._sqlite3_str_append=L.Fa)(u,d,_),r._sqlite3_str_appendchar=(u,d,_)=>(r._sqlite3_str_appendchar=L.Ga)(u,d,_),r._sqlite3_str_appendall=(u,d)=>(r._sqlite3_str_appendall=L.Ha)(u,d),r._sqlite3_str_appendf=(u,d,_)=>(r._sqlite3_str_appendf=L.Ia)(u,d,_),r._sqlite3_str_finish=u=>(r._sqlite3_str_finish=L.Ja)(u),r._sqlite3_str_errcode=u=>(r._sqlite3_str_errcode=L.Ka)(u),r._sqlite3_str_length=u=>(r._sqlite3_str_length=L.La)(u),r._sqlite3_str_value=u=>(r._sqlite3_str_value=L.Ma)(u),r._sqlite3_str_reset=u=>(r._sqlite3_str_reset=L.Na)(u),r._sqlite3_str_new=u=>(r._sqlite3_str_new=L.Oa)(u),r._sqlite3_vmprintf=(u,d)=>(r._sqlite3_vmprintf=L.Pa)(u,d),r._sqlite3_mprintf=(u,d)=>(r._sqlite3_mprintf=L.Qa)(u,d),r._sqlite3_vsnprintf=(u,d,_,w)=>(r._sqlite3_vsnprintf=L.Ra)(u,d,_,w),r._sqlite3_snprintf=(u,d,_,w)=>(r._sqlite3_snprintf=L.Sa)(u,d,_,w),r._sqlite3_log=(u,d,_)=>(r._sqlite3_log=L.Ta)(u,d,_),r._sqlite3_randomness=(u,d)=>(r._sqlite3_randomness=L.Ua)(u,d),r._sqlite3_stricmp=(u,d)=>(r._sqlite3_stricmp=L.Va)(u,d),r._sqlite3_strnicmp=(u,d,_)=>(r._sqlite3_strnicmp=L.Wa)(u,d,_),r._sqlite3_os_init=()=>(r._sqlite3_os_init=L.Xa)(),r._sqlite3_os_end=()=>(r._sqlite3_os_end=L.Ya)(),r._sqlite3_serialize=(u,d,_,w)=>(r._sqlite3_serialize=L.Za)(u,d,_,w),r._sqlite3_prepare_v2=(u,d,_,w,O)=>(r._sqlite3_prepare_v2=L._a)(u,d,_,w,O),r._sqlite3_step=u=>(r._sqlite3_step=L.$a)(u),r._sqlite3_column_int64=(u,d)=>(r._sqlite3_column_int64=L.ab)(u,d),r._sqlite3_reset=u=>(r._sqlite3_reset=L.bb)(u),r._sqlite3_exec=(u,d,_,w,O)=>(r._sqlite3_exec=L.cb)(u,d,_,w,O),r._sqlite3_column_int=(u,d)=>(r._sqlite3_column_int=L.db)(u,d),r._sqlite3_finalize=u=>(r._sqlite3_finalize=L.eb)(u),r._sqlite3_deserialize=(u,d,_,w,O,U,G,J)=>(r._sqlite3_deserialize=L.fb)(u,d,_,w,O,U,G,J),r._sqlite3_database_file_object=u=>(r._sqlite3_database_file_object=L.gb)(u),r._sqlite3_backup_init=(u,d,_,w)=>(r._sqlite3_backup_init=L.hb)(u,d,_,w),r._sqlite3_backup_step=(u,d)=>(r._sqlite3_backup_step=L.ib)(u,d),r._sqlite3_backup_finish=u=>(r._sqlite3_backup_finish=L.jb)(u),r._sqlite3_backup_remaining=u=>(r._sqlite3_backup_remaining=L.kb)(u),r._sqlite3_backup_pagecount=u=>(r._sqlite3_backup_pagecount=L.lb)(u),r._sqlite3_clear_bindings=u=>(r._sqlite3_clear_bindings=L.mb)(u),r._sqlite3_value_blob=u=>(r._sqlite3_value_blob=L.nb)(u),r._sqlite3_value_text=u=>(r._sqlite3_value_text=L.ob)(u),r._sqlite3_value_bytes=u=>(r._sqlite3_value_bytes=L.pb)(u),r._sqlite3_value_bytes16=u=>(r._sqlite3_value_bytes16=L.qb)(u),r._sqlite3_value_double=u=>(r._sqlite3_value_double=L.rb)(u),r._sqlite3_value_int=u=>(r._sqlite3_value_int=L.sb)(u),r._sqlite3_value_int64=u=>(r._sqlite3_value_int64=L.tb)(u),r._sqlite3_value_subtype=u=>(r._sqlite3_value_subtype=L.ub)(u),r._sqlite3_value_pointer=(u,d)=>(r._sqlite3_value_pointer=L.vb)(u,d),r._sqlite3_value_text16=u=>(r._sqlite3_value_text16=L.wb)(u),r._sqlite3_value_text16be=u=>(r._sqlite3_value_text16be=L.xb)(u),r._sqlite3_value_text16le=u=>(r._sqlite3_value_text16le=L.yb)(u),r._sqlite3_value_type=u=>(r._sqlite3_value_type=L.zb)(u),r._sqlite3_value_encoding=u=>(r._sqlite3_value_encoding=L.Ab)(u),r._sqlite3_value_nochange=u=>(r._sqlite3_value_nochange=L.Bb)(u),r._sqlite3_value_frombind=u=>(r._sqlite3_value_frombind=L.Cb)(u),r._sqlite3_value_dup=u=>(r._sqlite3_value_dup=L.Db)(u),r._sqlite3_value_free=u=>(r._sqlite3_value_free=L.Eb)(u),r._sqlite3_result_blob=(u,d,_,w)=>(r._sqlite3_result_blob=L.Fb)(u,d,_,w),r._sqlite3_result_blob64=(u,d,_,w,O)=>(r._sqlite3_result_blob64=L.Gb)(u,d,_,w,O),r._sqlite3_result_double=(u,d)=>(r._sqlite3_result_double=L.Hb)(u,d),r._sqlite3_result_error=(u,d,_)=>(r._sqlite3_result_error=L.Ib)(u,d,_),r._sqlite3_result_error16=(u,d,_)=>(r._sqlite3_result_error16=L.Jb)(u,d,_),r._sqlite3_result_int=(u,d)=>(r._sqlite3_result_int=L.Kb)(u,d),r._sqlite3_result_int64=(u,d,_)=>(r._sqlite3_result_int64=L.Lb)(u,d,_),r._sqlite3_result_null=u=>(r._sqlite3_result_null=L.Mb)(u),r._sqlite3_result_pointer=(u,d,_,w)=>(r._sqlite3_result_pointer=L.Nb)(u,d,_,w),r._sqlite3_result_subtype=(u,d)=>(r._sqlite3_result_subtype=L.Ob)(u,d),r._sqlite3_result_text=(u,d,_,w)=>(r._sqlite3_result_text=L.Pb)(u,d,_,w),r._sqlite3_result_text64=(u,d,_,w,O,U)=>(r._sqlite3_result_text64=L.Qb)(u,d,_,w,O,U),r._sqlite3_result_text16=(u,d,_,w)=>(r._sqlite3_result_text16=L.Rb)(u,d,_,w),r._sqlite3_result_text16be=(u,d,_,w)=>(r._sqlite3_result_text16be=L.Sb)(u,d,_,w),r._sqlite3_result_text16le=(u,d,_,w)=>(r._sqlite3_result_text16le=L.Tb)(u,d,_,w),r._sqlite3_result_value=(u,d)=>(r._sqlite3_result_value=L.Ub)(u,d),r._sqlite3_result_error_toobig=u=>(r._sqlite3_result_error_toobig=L.Vb)(u),r._sqlite3_result_zeroblob=(u,d)=>(r._sqlite3_result_zeroblob=L.Wb)(u,d),r._sqlite3_result_zeroblob64=(u,d,_)=>(r._sqlite3_result_zeroblob64=L.Xb)(u,d,_),r._sqlite3_result_error_code=(u,d)=>(r._sqlite3_result_error_code=L.Yb)(u,d),r._sqlite3_result_error_nomem=u=>(r._sqlite3_result_error_nomem=L.Zb)(u),r._sqlite3_user_data=u=>(r._sqlite3_user_data=L._b)(u),r._sqlite3_context_db_handle=u=>(r._sqlite3_context_db_handle=L.$b)(u),r._sqlite3_vtab_nochange=u=>(r._sqlite3_vtab_nochange=L.ac)(u),r._sqlite3_vtab_in_first=(u,d)=>(r._sqlite3_vtab_in_first=L.bc)(u,d),r._sqlite3_vtab_in_next=(u,d)=>(r._sqlite3_vtab_in_next=L.cc)(u,d),r._sqlite3_aggregate_context=(u,d)=>(r._sqlite3_aggregate_context=L.dc)(u,d),r._sqlite3_get_auxdata=(u,d)=>(r._sqlite3_get_auxdata=L.ec)(u,d),r._sqlite3_set_auxdata=(u,d,_,w)=>(r._sqlite3_set_auxdata=L.fc)(u,d,_,w),r._sqlite3_column_count=u=>(r._sqlite3_column_count=L.gc)(u),r._sqlite3_data_count=u=>(r._sqlite3_data_count=L.hc)(u),r._sqlite3_column_blob=(u,d)=>(r._sqlite3_column_blob=L.ic)(u,d),r._sqlite3_column_bytes=(u,d)=>(r._sqlite3_column_bytes=L.jc)(u,d),r._sqlite3_column_bytes16=(u,d)=>(r._sqlite3_column_bytes16=L.kc)(u,d),r._sqlite3_column_double=(u,d)=>(r._sqlite3_column_double=L.lc)(u,d),r._sqlite3_column_text=(u,d)=>(r._sqlite3_column_text=L.mc)(u,d),r._sqlite3_column_value=(u,d)=>(r._sqlite3_column_value=L.nc)(u,d),r._sqlite3_column_text16=(u,d)=>(r._sqlite3_column_text16=L.oc)(u,d),r._sqlite3_column_type=(u,d)=>(r._sqlite3_column_type=L.pc)(u,d),r._sqlite3_column_name=(u,d)=>(r._sqlite3_column_name=L.qc)(u,d),r._sqlite3_column_name16=(u,d)=>(r._sqlite3_column_name16=L.rc)(u,d),r._sqlite3_bind_blob=(u,d,_,w,O)=>(r._sqlite3_bind_blob=L.sc)(u,d,_,w,O),r._sqlite3_bind_blob64=(u,d,_,w,O,U)=>(r._sqlite3_bind_blob64=L.tc)(u,d,_,w,O,U),r._sqlite3_bind_double=(u,d,_)=>(r._sqlite3_bind_double=L.uc)(u,d,_),r._sqlite3_bind_int=(u,d,_)=>(r._sqlite3_bind_int=L.vc)(u,d,_),r._sqlite3_bind_int64=(u,d,_,w)=>(r._sqlite3_bind_int64=L.wc)(u,d,_,w),r._sqlite3_bind_null=(u,d)=>(r._sqlite3_bind_null=L.xc)(u,d),r._sqlite3_bind_pointer=(u,d,_,w,O)=>(r._sqlite3_bind_pointer=L.yc)(u,d,_,w,O),r._sqlite3_bind_text=(u,d,_,w,O)=>(r._sqlite3_bind_text=L.zc)(u,d,_,w,O),r._sqlite3_bind_text64=(u,d,_,w,O,U,G)=>(r._sqlite3_bind_text64=L.Ac)(u,d,_,w,O,U,G),r._sqlite3_bind_text16=(u,d,_,w,O)=>(r._sqlite3_bind_text16=L.Bc)(u,d,_,w,O),r._sqlite3_bind_value=(u,d,_)=>(r._sqlite3_bind_value=L.Cc)(u,d,_),r._sqlite3_bind_zeroblob=(u,d,_)=>(r._sqlite3_bind_zeroblob=L.Dc)(u,d,_),r._sqlite3_bind_zeroblob64=(u,d,_,w)=>(r._sqlite3_bind_zeroblob64=L.Ec)(u,d,_,w),r._sqlite3_bind_parameter_count=u=>(r._sqlite3_bind_parameter_count=L.Fc)(u),r._sqlite3_bind_parameter_name=(u,d)=>(r._sqlite3_bind_parameter_name=L.Gc)(u,d),r._sqlite3_bind_parameter_index=(u,d)=>(r._sqlite3_bind_parameter_index=L.Hc)(u,d),r._sqlite3_db_handle=u=>(r._sqlite3_db_handle=L.Ic)(u),r._sqlite3_stmt_readonly=u=>(r._sqlite3_stmt_readonly=L.Jc)(u),r._sqlite3_stmt_isexplain=u=>(r._sqlite3_stmt_isexplain=L.Kc)(u),r._sqlite3_stmt_explain=(u,d)=>(r._sqlite3_stmt_explain=L.Lc)(u,d),r._sqlite3_stmt_busy=u=>(r._sqlite3_stmt_busy=L.Mc)(u),r._sqlite3_next_stmt=(u,d)=>(r._sqlite3_next_stmt=L.Nc)(u,d),r._sqlite3_stmt_status=(u,d,_)=>(r._sqlite3_stmt_status=L.Oc)(u,d,_),r._sqlite3_sql=u=>(r._sqlite3_sql=L.Pc)(u),r._sqlite3_expanded_sql=u=>(r._sqlite3_expanded_sql=L.Qc)(u),r._sqlite3_value_numeric_type=u=>(r._sqlite3_value_numeric_type=L.Rc)(u),r._sqlite3_blob_open=(u,d,_,w,O,U,G,J)=>(r._sqlite3_blob_open=L.Sc)(u,d,_,w,O,U,G,J),r._sqlite3_blob_close=u=>(r._sqlite3_blob_close=L.Tc)(u),r._sqlite3_blob_read=(u,d,_,w)=>(r._sqlite3_blob_read=L.Uc)(u,d,_,w),r._sqlite3_blob_write=(u,d,_,w)=>(r._sqlite3_blob_write=L.Vc)(u,d,_,w),r._sqlite3_blob_bytes=u=>(r._sqlite3_blob_bytes=L.Wc)(u),r._sqlite3_blob_reopen=(u,d,_)=>(r._sqlite3_blob_reopen=L.Xc)(u,d,_),r._sqlite3_set_authorizer=(u,d,_)=>(r._sqlite3_set_authorizer=L.Yc)(u,d,_),r._sqlite3_strglob=(u,d)=>(r._sqlite3_strglob=L.Zc)(u,d),r._sqlite3_strlike=(u,d,_)=>(r._sqlite3_strlike=L._c)(u,d,_),r._sqlite3_errmsg=u=>(r._sqlite3_errmsg=L.$c)(u),r._sqlite3_auto_extension=u=>(r._sqlite3_auto_extension=L.ad)(u),r._sqlite3_cancel_auto_extension=u=>(r._sqlite3_cancel_auto_extension=L.bd)(u),r._sqlite3_reset_auto_extension=()=>(r._sqlite3_reset_auto_extension=L.cd)(),r._sqlite3_prepare=(u,d,_,w,O)=>(r._sqlite3_prepare=L.dd)(u,d,_,w,O),r._sqlite3_prepare_v3=(u,d,_,w,O,U)=>(r._sqlite3_prepare_v3=L.ed)(u,d,_,w,O,U),r._sqlite3_prepare16=(u,d,_,w,O)=>(r._sqlite3_prepare16=L.fd)(u,d,_,w,O),r._sqlite3_prepare16_v2=(u,d,_,w,O)=>(r._sqlite3_prepare16_v2=L.gd)(u,d,_,w,O),r._sqlite3_prepare16_v3=(u,d,_,w,O,U)=>(r._sqlite3_prepare16_v3=L.hd)(u,d,_,w,O,U),r._sqlite3_get_table=(u,d,_,w,O,U)=>(r._sqlite3_get_table=L.id)(u,d,_,w,O,U),r._sqlite3_free_table=u=>(r._sqlite3_free_table=L.jd)(u),r._sqlite3_create_module=(u,d,_,w)=>(r._sqlite3_create_module=L.kd)(u,d,_,w),r._sqlite3_create_module_v2=(u,d,_,w,O)=>(r._sqlite3_create_module_v2=L.ld)(u,d,_,w,O),r._sqlite3_drop_modules=(u,d)=>(r._sqlite3_drop_modules=L.md)(u,d),r._sqlite3_declare_vtab=(u,d)=>(r._sqlite3_declare_vtab=L.nd)(u,d),r._sqlite3_vtab_on_conflict=u=>(r._sqlite3_vtab_on_conflict=L.od)(u),r._sqlite3_vtab_config=(u,d,_)=>(r._sqlite3_vtab_config=L.pd)(u,d,_),r._sqlite3_vtab_collation=(u,d)=>(r._sqlite3_vtab_collation=L.qd)(u,d),r._sqlite3_vtab_in=(u,d,_)=>(r._sqlite3_vtab_in=L.rd)(u,d,_),r._sqlite3_vtab_rhs_value=(u,d,_)=>(r._sqlite3_vtab_rhs_value=L.sd)(u,d,_),r._sqlite3_vtab_distinct=u=>(r._sqlite3_vtab_distinct=L.td)(u),r._sqlite3_keyword_name=(u,d,_)=>(r._sqlite3_keyword_name=L.ud)(u,d,_),r._sqlite3_keyword_count=()=>(r._sqlite3_keyword_count=L.vd)(),r._sqlite3_keyword_check=(u,d)=>(r._sqlite3_keyword_check=L.wd)(u,d),r._sqlite3_complete=u=>(r._sqlite3_complete=L.xd)(u),r._sqlite3_complete16=u=>(r._sqlite3_complete16=L.yd)(u),r._sqlite3_libversion=()=>(r._sqlite3_libversion=L.zd)(),r._sqlite3_libversion_number=()=>(r._sqlite3_libversion_number=L.Ad)(),r._sqlite3_threadsafe=()=>(r._sqlite3_threadsafe=L.Bd)(),r._sqlite3_initialize=()=>(r._sqlite3_initialize=L.Cd)(),r._sqlite3_shutdown=()=>(r._sqlite3_shutdown=L.Dd)(),r._sqlite3_config=(u,d)=>(r._sqlite3_config=L.Ed)(u,d),r._sqlite3_db_mutex=u=>(r._sqlite3_db_mutex=L.Fd)(u),r._sqlite3_db_release_memory=u=>(r._sqlite3_db_release_memory=L.Gd)(u),r._sqlite3_db_cacheflush=u=>(r._sqlite3_db_cacheflush=L.Hd)(u),r._sqlite3_db_config=(u,d,_)=>(r._sqlite3_db_config=L.Id)(u,d,_),r._sqlite3_last_insert_rowid=u=>(r._sqlite3_last_insert_rowid=L.Jd)(u),r._sqlite3_set_last_insert_rowid=(u,d,_)=>(r._sqlite3_set_last_insert_rowid=L.Kd)(u,d,_),r._sqlite3_changes64=u=>(r._sqlite3_changes64=L.Ld)(u),r._sqlite3_changes=u=>(r._sqlite3_changes=L.Md)(u),r._sqlite3_total_changes64=u=>(r._sqlite3_total_changes64=L.Nd)(u),r._sqlite3_total_changes=u=>(r._sqlite3_total_changes=L.Od)(u),r._sqlite3_txn_state=(u,d)=>(r._sqlite3_txn_state=L.Pd)(u,d),r._sqlite3_close=u=>(r._sqlite3_close=L.Qd)(u),r._sqlite3_close_v2=u=>(r._sqlite3_close_v2=L.Rd)(u),r._sqlite3_busy_handler=(u,d,_)=>(r._sqlite3_busy_handler=L.Sd)(u,d,_),r._sqlite3_progress_handler=(u,d,_,w)=>(r._sqlite3_progress_handler=L.Td)(u,d,_,w),r._sqlite3_busy_timeout=(u,d)=>(r._sqlite3_busy_timeout=L.Ud)(u,d),r._sqlite3_interrupt=u=>(r._sqlite3_interrupt=L.Vd)(u),r._sqlite3_is_interrupted=u=>(r._sqlite3_is_interrupted=L.Wd)(u),r._sqlite3_create_function=(u,d,_,w,O,U,G,J)=>(r._sqlite3_create_function=L.Xd)(u,d,_,w,O,U,G,J),r._sqlite3_create_function_v2=(u,d,_,w,O,U,G,J,ce)=>(r._sqlite3_create_function_v2=L.Yd)(u,d,_,w,O,U,G,J,ce),r._sqlite3_create_window_function=(u,d,_,w,O,U,G,J,ce,ke)=>(r._sqlite3_create_window_function=L.Zd)(u,d,_,w,O,U,G,J,ce,ke),r._sqlite3_create_function16=(u,d,_,w,O,U,G,J)=>(r._sqlite3_create_function16=L._d)(u,d,_,w,O,U,G,J),r._sqlite3_overload_function=(u,d,_)=>(r._sqlite3_overload_function=L.$d)(u,d,_),r._sqlite3_trace_v2=(u,d,_,w)=>(r._sqlite3_trace_v2=L.ae)(u,d,_,w),r._sqlite3_commit_hook=(u,d,_)=>(r._sqlite3_commit_hook=L.be)(u,d,_),r._sqlite3_update_hook=(u,d,_)=>(r._sqlite3_update_hook=L.ce)(u,d,_),r._sqlite3_rollback_hook=(u,d,_)=>(r._sqlite3_rollback_hook=L.de)(u,d,_),r._sqlite3_autovacuum_pages=(u,d,_,w)=>(r._sqlite3_autovacuum_pages=L.ee)(u,d,_,w),r._sqlite3_wal_autocheckpoint=(u,d)=>(r._sqlite3_wal_autocheckpoint=L.fe)(u,d),r._sqlite3_wal_hook=(u,d,_)=>(r._sqlite3_wal_hook=L.ge)(u,d,_),r._sqlite3_wal_checkpoint_v2=(u,d,_,w,O)=>(r._sqlite3_wal_checkpoint_v2=L.he)(u,d,_,w,O),r._sqlite3_wal_checkpoint=(u,d)=>(r._sqlite3_wal_checkpoint=L.ie)(u,d),r._sqlite3_error_offset=u=>(r._sqlite3_error_offset=L.je)(u),r._sqlite3_errmsg16=u=>(r._sqlite3_errmsg16=L.ke)(u),r._sqlite3_errcode=u=>(r._sqlite3_errcode=L.le)(u),r._sqlite3_extended_errcode=u=>(r._sqlite3_extended_errcode=L.me)(u),r._sqlite3_system_errno=u=>(r._sqlite3_system_errno=L.ne)(u),r._sqlite3_errstr=u=>(r._sqlite3_errstr=L.oe)(u),r._sqlite3_limit=(u,d,_)=>(r._sqlite3_limit=L.pe)(u,d,_),r._sqlite3_open=(u,d)=>(r._sqlite3_open=L.qe)(u,d),r._sqlite3_open_v2=(u,d,_,w)=>(r._sqlite3_open_v2=L.re)(u,d,_,w),r._sqlite3_open16=(u,d)=>(r._sqlite3_open16=L.se)(u,d),r._sqlite3_create_collation=(u,d,_,w,O)=>(r._sqlite3_create_collation=L.te)(u,d,_,w,O),r._sqlite3_create_collation_v2=(u,d,_,w,O,U)=>(r._sqlite3_create_collation_v2=L.ue)(u,d,_,w,O,U),r._sqlite3_create_collation16=(u,d,_,w,O)=>(r._sqlite3_create_collation16=L.ve)(u,d,_,w,O),r._sqlite3_collation_needed=(u,d,_)=>(r._sqlite3_collation_needed=L.we)(u,d,_),r._sqlite3_collation_needed16=(u,d,_)=>(r._sqlite3_collation_needed16=L.xe)(u,d,_),r._sqlite3_get_clientdata=(u,d)=>(r._sqlite3_get_clientdata=L.ye)(u,d),r._sqlite3_set_clientdata=(u,d,_,w)=>(r._sqlite3_set_clientdata=L.ze)(u,d,_,w),r._sqlite3_get_autocommit=u=>(r._sqlite3_get_autocommit=L.Ae)(u),r._sqlite3_table_column_metadata=(u,d,_,w,O,U,G,J,ce)=>(r._sqlite3_table_column_metadata=L.Be)(u,d,_,w,O,U,G,J,ce),r._sqlite3_sleep=u=>(r._sqlite3_sleep=L.Ce)(u),r._sqlite3_extended_result_codes=(u,d)=>(r._sqlite3_extended_result_codes=L.De)(u,d),r._sqlite3_file_control=(u,d,_,w)=>(r._sqlite3_file_control=L.Ee)(u,d,_,w),r._sqlite3_test_control=(u,d)=>(r._sqlite3_test_control=L.Fe)(u,d),r._sqlite3_create_filename=(u,d,_,w,O)=>(r._sqlite3_create_filename=L.Ge)(u,d,_,w,O),r._sqlite3_free_filename=u=>(r._sqlite3_free_filename=L.He)(u),r._sqlite3_uri_parameter=(u,d)=>(r._sqlite3_uri_parameter=L.Ie)(u,d),r._sqlite3_uri_key=(u,d)=>(r._sqlite3_uri_key=L.Je)(u,d),r._sqlite3_uri_boolean=(u,d,_)=>(r._sqlite3_uri_boolean=L.Ke)(u,d,_),r._sqlite3_uri_int64=(u,d,_,w)=>(r._sqlite3_uri_int64=L.Le)(u,d,_,w),r._sqlite3_filename_database=u=>(r._sqlite3_filename_database=L.Me)(u),r._sqlite3_filename_journal=u=>(r._sqlite3_filename_journal=L.Ne)(u),r._sqlite3_filename_wal=u=>(r._sqlite3_filename_wal=L.Oe)(u),r._sqlite3_db_name=(u,d)=>(r._sqlite3_db_name=L.Pe)(u,d),r._sqlite3_db_filename=(u,d)=>(r._sqlite3_db_filename=L.Qe)(u,d),r._sqlite3_db_readonly=(u,d)=>(r._sqlite3_db_readonly=L.Re)(u,d),r._sqlite3_compileoption_used=u=>(r._sqlite3_compileoption_used=L.Se)(u),r._sqlite3_compileoption_get=u=>(r._sqlite3_compileoption_get=L.Te)(u),r._sqlite3session_create=(u,d,_)=>(r._sqlite3session_create=L.Ue)(u,d,_),r._sqlite3session_delete=u=>(r._sqlite3session_delete=L.Ve)(u),r._sqlite3session_attach=(u,d)=>(r._sqlite3session_attach=L.We)(u,d),r._sqlite3session_changeset=(u,d,_)=>(r._sqlite3session_changeset=L.Xe)(u,d,_),r._sqlite3session_enable=(u,d)=>(r._sqlite3session_enable=L.Ye)(u,d),r._sqlite3changeset_start=(u,d,_)=>(r._sqlite3changeset_start=L.Ze)(u,d,_),r._sqlite3changeset_finalize=u=>(r._sqlite3changeset_finalize=L._e)(u),r._sqlite3changeset_invert=(u,d,_,w)=>(r._sqlite3changeset_invert=L.$e)(u,d,_,w),r._sqlite3changeset_apply=(u,d,_,w,O,U)=>(r._sqlite3changeset_apply=L.af)(u,d,_,w,O,U),r._sqlite3_sourceid=()=>(r._sqlite3_sourceid=L.bf)(),r._malloc=u=>(r._malloc=L.cf)(u),r._free=u=>(r._free=L.df)(u),r._RegisterExtensionFunctions=u=>(r._RegisterExtensionFunctions=L.ef)(u),r._getSqliteFree=()=>(r._getSqliteFree=L.ff)();var jy=r._main=(u,d)=>(jy=r._main=L.gf)(u,d);r._libauthorizer_set_authorizer=(u,d,_)=>(r._libauthorizer_set_authorizer=L.hf)(u,d,_),r._libfunction_create_function=(u,d,_,w,O,U,G,J)=>(r._libfunction_create_function=L.jf)(u,d,_,w,O,U,G,J),r._libhook_commit_hook=(u,d,_)=>(r._libhook_commit_hook=L.kf)(u,d,_),r._libhook_update_hook=(u,d,_)=>(r._libhook_update_hook=L.lf)(u,d,_),r._libprogress_progress_handler=(u,d,_,w)=>(r._libprogress_progress_handler=L.mf)(u,d,_,w),r._libvfs_vfs_register=(u,d,_,w,O,U)=>(r._libvfs_vfs_register=L.nf)(u,d,_,w,O,U);var Fy=(u,d)=>(Fy=L.pf)(u,d),Mm=()=>(Mm=L.qf)(),jm=u=>(jm=L.rf)(u),gc=u=>(gc=L.sf)(u),pc=()=>(pc=L.tf)();r._sqlite3_version=5472,r.getTempRet0=$m,r.ccall=hi,r.cwrap=RE,r.addFunction=CE,r.setValue=Yi,r.getValue=_m,r.UTF8ToString=Wi,r.stringToUTF8=Yr,r.lengthBytesUTF8=ec,r.intArrayFromString=tc,r.intArrayToString=My,r.AsciiToString=Ny,r.UTF16ToString=$y,r.stringToUTF16=$l,r.UTF32ToString=Iy,r.stringToUTF32=xE,r.writeArrayToMemory=Dy;var Uf;Qn=function u(){Uf||Fm(),Uf||(Qn=u)};function zf(){var u=jy,d=0,_=0;try{var w=u(d,_);return yE(w,!0),w}catch(O){return bE(O)}}function Fm(){if(rt>0||(pt(),rt>0))return;function u(){var d;Uf||(Uf=!0,r.calledRun=!0,!R&&(Q(),ue(),i(r),(d=r.onRuntimeInitialized)==null||d.call(r),Lm&&zf(),Be()))}r.setStatus?(r.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>r.setStatus(""),1),u()},1)):u()}if(r.preInit)for(typeof r.preInit=="function"&&(r.preInit=[r.preInit]);r.preInit.length>0;)r.preInit.pop()();var Lm=!0;return r.noInitialRun&&(Lm=!1),Fm(),(function(){const u=Object.getPrototypeOf(async function(){}).constructor;let d=0;r.set_authorizer=function(_,w,O){d&&(r.deleteCallback(d),r._sqlite3_free(d),d=0),d=r._sqlite3_malloc(4),Yi(d,w instanceof u?1:0,"i32");const U=hi("libauthorizer_set_authorizer","number",["number","number","number"],[_,w?1:0,d]);return!U&&w&&r.setCallback(d,(G,J,ce,ke,Me,st)=>w(O,J,ce,ke,Me,st)),U}})(),(function(){const u=Object.getPrototypeOf(async function(){}).constructor,d=["xFunc","xStep","xFinal"],_=new Map;r.create_function=function(w,O,U,G,J,ce,ke,Me){const st=r._sqlite3_malloc(4),Rt={xFunc:ce,xStep:ke,xFinal:Me};Yi(st,d.reduce((Pe,Ut,Rr)=>Rt[Ut]instanceof u?Pe|1<<Rr:Pe,0),"i32");const je=hi("libfunction_create_function","number",["number","string","number","number","number","number","number","number"],[w,O,U,G,st,ce?1:0,ke?1:0,Me?1:0]);if(!je){if(_.has(O)){const Pe=_.get(O);r.deleteCallback(Pe)}_.set(O,st),r.setCallback(st,{xFunc:ce,xStep:ke,xFinal:Me})}return je}})(),(function(){const u=Object.getPrototypeOf(async function(){}).constructor;let d=0;r.update_hook=function(_,w){d&&(r.deleteCallback(d),r._sqlite3_free(d),d=0),d=r._sqlite3_malloc(4),Yi(d,w instanceof u?1:0,"i32"),hi("libhook_update_hook","void",["number","number","number"],[_,w?1:0,d]),w&&r.setCallback(d,(O,U,G,J,ce,ke)=>w(U,G,J,ce,ke))}})(),(function(){const u=Object.getPrototypeOf(async function(){}).constructor;let d=0;r.commit_hook=function(_,w){d&&(r.deleteCallback(d),r._sqlite3_free(d),d=0),d=r._sqlite3_malloc(4),Yi(d,w instanceof u?1:0,"i32"),hi("libhook_commit_hook","void",["number","number","number"],[_,w?1:0,d]),w&&r.setCallback(d,O=>w())}})(),(function(){const u=Object.getPrototypeOf(async function(){}).constructor;let d=0;r.progress_handler=function(_,w,O,U){d&&(r.deleteCallback(d),r._sqlite3_free(d),d=0),d=r._sqlite3_malloc(4),Yi(d,O instanceof u?1:0,"i32"),hi("libprogress_progress_handler","number",["number","number","number","number"],[_,w,O?1:0,d]),O&&r.setCallback(d,G=>O(U))}})(),(function(){const u=["xOpen","xDelete","xAccess","xFullPathname","xRandomness","xSleep","xCurrentTime","xGetLastError","xCurrentTimeInt64","xClose","xRead","xWrite","xTruncate","xSync","xFileSize","xLock","xUnlock","xCheckReservedLock","xFileControl","xSectorSize","xDeviceCharacteristics","xShmMap","xShmLock","xShmBarrier","xShmUnmap"],d=new Map;r.vfs_register=function(_,w){let O=0,U=0;u.forEach((J,ce)=>{_[J]&&(O|=1<<ce,_.hasAsyncMethod(J)&&(U|=1<<ce))});const G=r._sqlite3_malloc(4);try{const J=hi("libvfs_vfs_register","number",["string","number","number","number","number","number"],[_.name,_.mxPathname,O,U,w?1:0,G]);if(!J){if(d.has(_.name)){const ke=d.get(_.name);r.deleteCallback(ke)}const ce=_m(G,"*");d.set(_.name,ce),r.setCallback(ce,_)}return J}finally{r._sqlite3_free(G)}}})(),n=f,n})})();const Qpe=async()=>{const e=await Kpe(),t=Gpe(e);return t.module=e,t},Jw=typeof navigator>"u"||navigator.storage===void 0?new Proxy({},{get:()=>Promise.reject(new Error("Can't get OPFS root handle in this environment as navigator.storage is undefined"))}):navigator.storage.getDirectory(),i8=async e=>{const t=await Jw;if(e===void 0)return t;let n=t;const r=e==null?void 0:e.split("/").filter(Boolean);for(;r.length>0;)n=await n.getDirectoryHandle(r.shift());return n},o8=async(e=Jw,t=Number.POSITIVE_INFINITY,n="")=>{if(t<0)return;const r=await e,i=r.values();for await(const c of i){const f=c.kind==="directory",m=c.kind==="file"?await c.getFile().then(g=>Lhe(g.size)):void 0;if(console.log(`${n}${f?"":""} ${c.name} ${m?`(${m})`:""}`),f){const g=await r.getDirectoryHandle(c.name);await o8(g,t-1,`${n}  `)}}},Ype=async e=>{if(e.kind==="directory")for await(const t of e.keys())await e.removeEntry(t,{recursive:!0})},Wpe=Object.freeze(Object.defineProperty({__proto__:null,deleteAll:Ype,getDirHandle:i8,printTree:o8,rootHandlePromise:Jw},Symbol.toStringTag,{value:"Module"}));class _be extends li()("PersistedSqliteError",{cause:Th}){}const Jpe=({storageOptions:e,storeId:t,schema:n})=>Ju(async()=>{const r=c8(e.directory,t),i=await i8(r).catch(()=>{});if(i===void 0)return;const c=async v=>{const q=await v.getFile(),k=await Hpe(q);return k?{fileName:k,file:q}:void 0},m=await(async v=>{const q=[];for await(const k of v)k.kind==="file"&&q.push(k);return q})(i.values()),g=await Promise.all(m.map(c)),b="/"+e_e(n),S=g.find(v=>(v==null?void 0:v.fileName)===b);if(S!==void 0){const v=await S.file.slice(Upe).arrayBuffer();return v.byteLength===0?void 0:new Uint8Array(v)}}).pipe(Ax({duration:1e3,label:"@livestore/adapter-web:readPersistedAppDbFromClientSession"}),K5("@livestore/adapter-web:readPersistedAppDbFromClientSession"),At("@livestore/adapter-web:readPersistedAppDbFromClientSession")),Xpe=({storageOptions:e,storeId:t})=>ye(function*(){const n=c8(e.directory,t);yield*Zpe(n)}).pipe(hw({schedule:mme}),At("@livestore/adapter-web:resetPersistedDataFromClientSession")),Zpe=e=>Ju(async()=>{const t=await Jw,n=e.split("/").filter(r=>r.length);try{let r=t;for(let i=0;i<n.length-1;i++)r=await r.getDirectoryHandle(n[i]);await r.removeEntry(n.at(-1),{recursive:!0})}catch(r){if(r instanceof DOMException&&r.name==="NotFoundError")return;throw r}}).pipe(ft.mapToUnexpectedError,At("@livestore/adapter-web:worker:opfsDeleteFile",{attributes:{absFilePath:e}})),c8=(e,t)=>{if(e===void 0||e===""||e==="/")return`livestore-${t}@${uI}`;if(e.includes("/"))throw new Error(`@livestore/adapter-web:worker:sanitizeOpfsDir: Nested directories are not yet supported ('${e}')`);return`${e}@${uI}`},e_e=e=>`state${e.state.sqlite.migrations.strategy==="manual"?"fixed":e.state.sqlite.hash.toString()}.db`;class t_e extends ze(Pv,ft){}const n_e=e=>Ox({channelName:`livestore.shutdown.${e}`,schema:t_e});class l8 extends ht("DedicatedWorkerDisconnectBroadcast",{}){}const r_e=e=>Ox({channelName:`livestore.worker-disconnect.${e}`,schema:l8});class Xw extends hs()("DevtoolsWebCommon.CreateConnection",{payload:{from:W,port:Hw},success:ve({}),failure:$w}){}class ybe extends ze(Xw){}const s_e=ve({type:qe("opfs"),directory:tt(W)}),u8=ze(s_e);dm({key:W,value:sf});var cA;(function(e){class t extends hs()("InitialMessage",{payload:{port:Hw,storeId:W,clientId:W},success:Oi,failure:ft}){}e.InitialMessage=t;class n extends ze(t){}e.Request=n})(cA||(cA={}));var Hn;(function(e){class t extends hs()("InitialMessage",{payload:{storageOptions:u8,devtoolsEnabled:Po,storeId:W,clientId:W,debugInstanceId:W,syncPayload:wh(sf)},success:Oi,failure:ft}){}e.InitialMessage=t;class n extends hs()("BootStatusStream",{payload:{},success:Ime,failure:ft}){}e.BootStatusStream=n;class r extends hs()("PushToLeader",{payload:{batch:gt(cge)},success:Oi,failure:ze(ft,dge)}){}e.PushToLeader=r;class i extends hs()("PullStream",{payload:{cursor:$me},success:ve({payload:gH,mergeCounter:dt}),failure:ft}){}e.PullStream=i;class c extends hs()("Export",{payload:{},success:Gd,failure:ft}){}e.Export=c;class f extends hs()("ExportEventlog",{payload:{},success:Gd,failure:ft}){}e.ExportEventlog=f;class m extends hs()("GetRecreateSnapshot",{payload:{},success:ve({snapshot:Gd,migrationsReport:jme}),failure:ft}){}e.GetRecreateSnapshot=m;class g extends hs()("GetLeaderHead",{payload:{},success:ar,failure:ft}){}e.GetLeaderHead=g;class b extends hs()("GetLeaderSyncState",{payload:{},success:ki,failure:ft}){}e.GetLeaderSyncState=b;class S extends hs()("Shutdown",{payload:{},success:Oi,failure:ft}){}e.Shutdown=S;class v extends hs()("ExtraDevtoolsMessage",{payload:{message:cpe},success:Oi,failure:ft}){}e.ExtraDevtoolsMessage=v,e.Request=ze(t,n,r,i,c,f,m,g,b,S,v,Xw)})(Hn||(Hn={}));var Qv;(function(e){class t extends ht("FromClientSession",{initialMessage:Hn.InitialMessage}){}e.InitialMessagePayloadFromClientSession=t;class n extends hs()("InitialMessage",{payload:{payload:ze(t,ht("FromWebBridge",{})),liveStoreVersion:qe(gs)},success:Oi,failure:ft}){}e.InitialMessage=n;class r extends hs()("UpdateMessagePort",{payload:{port:Hw},success:Oi,failure:ft}){}e.UpdateMessagePort=r;class i extends ze(n,r,Hn.BootStatusStream,Hn.PushToLeader,Hn.PullStream,Hn.Export,Hn.GetRecreateSnapshot,Hn.ExportEventlog,Hn.GetLeaderHead,Hn.GetLeaderSyncState,Hn.Shutdown,Hn.ExtraDevtoolsMessage,Xw){}e.Request=i})(Qv||(Qv={}));const a_e=Ox({channelName:"session-info",schema:vH}),AI={sharedWorker:({storeId:e})=>`shared-worker-${e}`,browserExtension:{contentscriptMain:e=>`contentscript-main-${e}`,contentscriptIframe:e=>`contentscript-iframe-${e}`}},lA=ht("ClientSessionContentscriptMainReq",{storeId:W,clientId:W,sessionId:W}),RI=ht("ClientSessionContentscriptMainRes",{tabId:dt}),i_e={contentscriptMain:Nn(()=>BC({listenWindow:window,sendWindow:window,schema:{listen:lA,send:RI},ids:{own:"contentscript-main-static",other:"client-session-static"}})),clientSession:Nn(()=>BC({listenWindow:window,sendWindow:window,schema:{listen:RI,send:lA},ids:{own:"client-session-static",other:"contentscript-main-static"}}))},o_e=({node:e,target:t,worker:n})=>ye(function*(){const r=new MessageChannel,i=yield*xt();Vo&&(yield*Bhe(`@livestore/devtools-web-common: closing message channel ${e.nodeName}  ${t}`)),yield*n.execute(Xw.make({from:e.nodeName,port:r.port1})).pipe($s(()=>dn(i,!0)),Vr,Ft,En),yield*i;const c=yield*lme({port:r.port2,schema:Bx});yield*e.addEdge({target:t,edgeChannel:c,replaceIfExists:!0}),Vo&&(yield*Ur(`@livestore/devtools-web-common: initiated connection: ${e.nodeName}  ${t}`))}).pipe(ft.mapToUnexpectedError),c_e=({schema:e,storeId:t,clientId:n,sessionId:r})=>ye(function*(){if(Bo()){const i=globalThis.LIVESTORE_DEVTOOLS_PATH??"/_livestore",c=`${location.origin}${i}`,f=yield*Ju(()=>fetch(c));if(f.ok&&(yield*Ju(()=>f.text())).includes('<meta name="livestore-devtools" content="true" />')){const g=`${c}/web/${t}/${n}/${r}/${e.devtools.alias}`;yield*S2(`[@livestore/adapter-web] Devtools ready on ${g}`)}}}).pipe(At("@livestore/adapter-web:client-session:devtools:logDevtoolsUrl")),l_e=yw(function*({webmeshNode:e,sessionInfo:t,sharedWorker:n,devtoolsEnabled:r,schema:i}){if(r){const{clientId:c,sessionId:f,storeId:m}=t;yield*c_e({clientId:c,sessionId:f,schema:i,storeId:m}),yield*wH({webChannel:yield*a_e,sessionInfo:t}).pipe(Ft,En),yield*ye(function*(){const g=yield*i_e.clientSession;yield*g.send(lA.make({clientId:c,sessionId:f,storeId:m}));const{tabId:b}=yield*g.listen.pipe(hl(),ude,Hc),S=AI.browserExtension.contentscriptMain(b),v=yield*BC({listenWindow:window,sendWindow:window,schema:Bx,ids:{own:e.nodeName,other:S}});yield*e.addEdge({target:S,edgeChannel:v})}).pipe(At("@livestore/adapter-web:client-session:devtools:browser-extension"),Ft,En),yield*o_e({node:e,target:AI.sharedWorker({storeId:m}),worker:n})}}),u_e=Qpe();Bo()&&(globalThis.__debugLiveStoreUtils={opfs:Wpe,runSync:e=>ya(e),runFork:e=>oi(e)});const f_e=e=>t=>ye(function*(){var ue,Be;const{schema:n,storeId:r,devtoolsEnabled:i,debugInstanceId:c,bootStatusQueue:f,shutdown:m,syncPayload:g}=t;yield*d_e,yield*Tn(f,{stage:"loading"});const b=yield*Ju(()=>u_e),S=`livestore-tab-lock-${r}`,v=yield*Gg(u8)(e.storage),q=yield*n_e(r);e.resetPersistence===!0&&(yield*q.send(Pv.make({reason:"adapter-reset"})),yield*Xpe({storageOptions:v,storeId:r}));const k=((ue=e.experimental)==null?void 0:ue.disableFastPath)===!0?void 0:yield*Jpe({storageOptions:v,storeId:r,schema:n}),N=e.clientId??xI(`clientId:${r}`,"local"),H=e.sessionId??xI(`sessionId:${r}`,"session"),x=yield*r_e(r);yield*q.listen.pipe(hl(),$s(_e=>m(ol(_e))),Vr,kn,Ft,En);const C=M$(e.sharedWorker,{name:`livestore-shared-worker-${r}`}),E=yield*ame({size:1,concurrency:100,initialMessage:()=>new Qv.InitialMessage({liveStoreVersion:gs,payload:{_tag:"FromClientSession",initialMessage:new Hn.InitialMessage({storageOptions:v,storeId:r,clientId:N,devtoolsEnabled:i,debugInstanceId:c,syncPayload:g})}})}).pipe(ss(rI(()=>C)),Ft,ft.mapToUnexpectedError,Ys(m),At("@livestore/adapter-web:client-session:setupSharedWorker"),En),$=yield*xt();let R=yield*pme($,S);const I=yield*q5(R?"has-lock":"no-lock"),z=yield*xt();R===!1&&(yield*dn(z,void 0));const V=ye(function*(){yield*Ur(`[@livestore/adapter-web:client-session]  Got lock '${S}' (clientId: ${N}, sessionId: ${H}).`),yield*rs(()=>Ur(`[@livestore/adapter-web:client-session] Releasing lock for '${S}'`)),yield*_S(I,"has-lock");const _e=new MessageChannel,be=M$(e.worker,{name:`livestore-worker-${r}-${H}`});yield*sme({initialMessage:()=>new cA.InitialMessage({port:_e.port1,storeId:r,clientId:N})}).pipe(ss(rI(()=>be)),ft.mapToUnexpectedError,Ys(m),At("@livestore/adapter-web:client-session:setupDedicatedWorker"),Ft,En),yield*x.send(l8.make({})),yield*(yield*Gc(E)).executeEffect(new Qv.UpdateMessagePort({port:_e.port2})).pipe(ft.mapToUnexpectedError,Ys(m)),yield*dn(z,void 0),yield*d2}).pipe(At("@livestore/adapter-web:client-session:lock"));R===!1?(yield*Ur(`[@livestore/adapter-web:client-session]  Waiting for lock '${S}' (sessionId: ${H})`),yield*gme($,S).pipe(Hp(()=>(R=!0,V)),kn,Ft,En)):yield*V.pipe(kn,Ft,En);const K=_e=>Gc(E).pipe(Ns(()=>z),Xe(be=>be.executeEffect(_e)),Ax({label:`@livestore/adapter-web:client-session:runInWorker:${_e._tag}`,duration:2e3}),At(`@livestore/adapter-web:client-session:runInWorker:${_e._tag}`),pf(be=>rn(ft)(be)?be:l$(be)||rn(Go)(be)?new ft({cause:be}):be),X4(be=>new ft({cause:be}))),Y=_e=>ye(function*(){return(yield*Gc(E)).execute(_e).pipe(O5(ct=>rn(ft)(ct)?ct:l$(ct)||rn(Go)(ct)?new ft({cause:ct}):ct),hde(`@livestore/adapter-web:client-session:runInWorkerStream:${_e._tag}`))}).pipe(fde),P=yield*Y(new Hn.BootStatusStream).pipe($s(_e=>Tn(f,_e)),Vr,Ys(_e=>tl(_e)?ot:m(_e)),kn,Ft,En);yield*cie(f).pipe(Hp(Js(P)),Ft,En);const ne=k===void 0?yield*K(new Hn.GetRecreateSnapshot).pipe(Tt(({snapshot:_e,migrationsReport:be})=>({_tag:"from-leader-worker",snapshot:_e,migrationsReport:be}))):{_tag:"fast-path",snapshot:k},Se=ne._tag==="from-leader-worker"?ne.migrationsReport:{migrations:[]},ge=yield*Vpe({sqlite3:b})({_tag:"in-memory"});ge.import(ne.snapshot),(((Be=ge.select("select count(*) as count from sqlite_master")[0])==null?void 0:Be.count)??0)===0&&(yield*ft.make({cause:"Encountered empty or corrupted database",payload:{snapshotByteLength:ne.snapshot.byteLength,storageOptions:e.storage}}));const oe=ge.select(`select seqNumGlobal, seqNumClient from ${iH} order by seqNumGlobal desc, seqNumClient desc limit 1`)[0],Te=oe?vme({global:oe.seqNumGlobal,client:oe.seqNumClient}):bme;yield*rs(_e=>ye(function*(){Kh(_e)&&bW(_e)===!1&&rn(Pv)(wN(_e.cause))===!1&&rn(vS)(wN(_e.cause))===!1?yield*Bp("[@livestore/adapter-web:client-session] client-session shutdown",_e.cause):yield*Ur("[@livestore/adapter-web:client-session] client-session shutdown",R,_e),R&&(yield*dn($,void 0))}).pipe(Ft,va));const Ee={export:K(new Hn.Export).pipe(yh(1e4),ft.mapToUnexpectedError,At("@livestore/adapter-web:client-session:export")),events:{pull:({cursor:_e})=>Y(new Hn.PullStream({cursor:_e})).pipe(cde),push:_e=>K(new Hn.PushToLeader({batch:_e})).pipe(At("@livestore/adapter-web:client-session:pushToLeader",{attributes:{batchSize:_e.length}}))},initialState:{leaderHead:Te,migrationsReport:Se},getEventlogData:K(new Hn.ExportEventlog).pipe(yh(1e4),ft.mapToUnexpectedError,At("@livestore/adapter-web:client-session:getEventlogData")),getSyncState:K(new Hn.GetLeaderSyncState).pipe(ft.mapToUnexpectedError,At("@livestore/adapter-web:client-session:getLeaderSyncState")),sendDevtoolsMessage:_e=>K(new Hn.ExtraDevtoolsMessage({message:_e})).pipe(ft.mapToUnexpectedError,At("@livestore/adapter-web:client-session:devtoolsMessageForLeader"))},pt=yield*Gc(E);return yield*Spe({...t,sqliteDb:ge,lockStatus:I,clientId:N,sessionId:H,isLeader:!0,leaderThread:Ee,webmeshMode:"direct",connectWebmeshNode:({sessionInfo:_e,webmeshNode:be})=>l_e({webmeshNode:be,sessionInfo:_e,sharedWorker:pt,devtoolsEnabled:i,schema:n}),registerBeforeUnload:_e=>typeof window<"u"&&typeof window.addEventListener=="function"?(window.addEventListener("beforeunload",_e),()=>window.removeEventListener("beforeunload",_e)):()=>{}})}).pipe(ft.mapToUnexpectedError),xI=(e,t)=>{const n=()=>Ta(5),r=typeof window>"u"?void 0:t==="session"?sessionStorage:t==="local"?localStorage:at(`[@livestore/adapter-web] Invalid storage type: ${t}`);if(r===void 0)return n();const i=`livestore:${e}`,c=r.getItem(i);if(c)return c;const f=n();return r.setItem(i,f),f},d_e=ye(function*(){const e=(t,n)=>ye(function*(){t&&(yield*ft.make({cause:`[@livestore/adapter-web] Browser not supported. The LiveStore web adapter needs '${n}' to work properly`}))});yield*dw([e(typeof navigator>"u","navigator"),e(navigator.locks===void 0,"navigator.locks"),e(navigator.storage===void 0,"navigator.storage"),e(crypto.randomUUID===void 0,"crypto.randomUUID"),e(typeof window>"u","window"),e(typeof sessionStorage>"u","sessionStorage")])});function h_e(e){return new SharedWorker("/assets/make-shared-worker-rBiIyi9i.js",{type:"module",name:e==null?void 0:e.name})}var bs=hA();const er=$j(bs),Zw=er.createContext(void 0),s_=Symbol.for("NOT_REFRESHED_YET"),m_e=e=>typeof e=="object"&&e!==null&&"_tag"in e&&e._tag==="thunk",OI=()=>({_tag:"unknown"}),g_e=e=>({_tag:"Some",value:e}),p_e=()=>({_tag:"None"});let __e=0;const y_e=()=>`graph-${++__e}`;class b_e{constructor(){y(this,"id",y_e());y(this,"atoms",new Set);y(this,"effects",new Set);y(this,"context");y(this,"debugRefreshInfos",new qi(200));y(this,"currentDebugRefresh");y(this,"deferredEffects",new Map);y(this,"refreshCallbacks",new Set);y(this,"nodeIdCounter",0);y(this,"uniqueNodeId",()=>`node-${++this.nodeIdCounter}`);y(this,"refreshInfoIdCounter",0);y(this,"uniqueRefreshInfoId",()=>`refresh-info-${++this.refreshInfoIdCounter}`);y(this,"runEffects",(t,n)=>{var i;(((i=this.context)==null?void 0:i.effectsWrapper)??(c=>c()))(()=>{this.currentDebugRefresh={refreshedAtoms:[],startMs:performance.now()};for(const g of t)g.doEffect(n==null?void 0:n.otelContext,n.debugRefreshReason);const c=this.currentDebugRefresh.refreshedAtoms,f=performance.now()-this.currentDebugRefresh.startMs;this.currentDebugRefresh=void 0;const m={id:this.uniqueRefreshInfoId(),reason:n.debugRefreshReason,skippedRefresh:!1,refreshedAtoms:c,durationMs:f,completedTimestamp:Date.now(),graphSnapshot:this.getSnapshot({includeResults:!1})};this.debugRefreshInfos.push(m),this.runRefreshCallbacks()})});y(this,"runDeferredEffects",t=>{for(const[n,r]of this.deferredEffects)this.runEffects(new Set([n]),{debugRefreshReason:{_tag:"runDeferredEffects",originalRefreshReasons:Array.from(r),manualRefreshReason:t==null?void 0:t.debugRefreshReason},otelContext:t==null?void 0:t.otelContext})});y(this,"runRefreshCallbacks",()=>{for(const t of this.refreshCallbacks)t()});y(this,"getSnapshot",t=>{const{includeResults:n=!1}=t??{},r=[];for(const f of this.atoms)r.push(qI(f,n));const i=[];for(const f of this.effects)i.push(v_e(f));const c=[];for(const[f]of this.deferredEffects)c.push(f.id);return{atoms:r,effects:i,deferredEffects:c}});y(this,"subscribeToRefresh",t=>(this.refreshCallbacks.add(t),()=>{this.refreshCallbacks.delete(t)}))}makeRef(t,n){const r={_tag:"ref",id:this.uniqueNodeId(),isDirty:!1,isDestroyed:!1,previousResult:t,computeResult:()=>r.previousResult,sub:new Set,super:new Set,label:n==null?void 0:n.label,meta:n==null?void 0:n.meta,equal:(n==null?void 0:n.equal)??Au,refreshes:0};return this.atoms.add(r),r}makeThunk(t,n){const r={_tag:"thunk",id:this.uniqueNodeId(),previousResult:s_,isDirty:!0,isDestroyed:!1,computeResult:(i,c)=>{if(r.isDirty){const f=this.currentDebugRefresh===void 0;f&&(this.currentDebugRefresh={refreshedAtoms:[],startMs:performance.now()}),r.sub=new Set;const m=(k,N)=>(this.addEdge(r,k),DI(k,N,c));let g;const S=t(m,k=>{g=k},this.context??S_e(this),i,c),v=r.equal(r.previousResult,S)===!1,q={atom:qI(r,!1),resultChanged:v,debugInfo:g??OI()};if(this.currentDebugRefresh.refreshedAtoms.push(q),r.isDirty=!1,r.previousResult=S,r.recomputations++,f){const k=this.currentDebugRefresh.refreshedAtoms,N=performance.now()-this.currentDebugRefresh.startMs;this.currentDebugRefresh=void 0,this.debugRefreshInfos.push({id:this.uniqueRefreshInfoId(),reason:c??{_tag:"makeThunk",label:n==null?void 0:n.label},skippedRefresh:!1,refreshedAtoms:k,durationMs:N,completedTimestamp:Date.now(),graphSnapshot:this.getSnapshot({includeResults:!1})})}return S}else return r.previousResult},sub:new Set,super:new Set,recomputations:0,label:n==null?void 0:n.label,meta:n==null?void 0:n.meta,equal:(n==null?void 0:n.equal)??Au,__getResult:t};return this.atoms.add(r),r}destroyNode(t){if(t._tag==="ref"||t._tag==="thunk")for(const n of t.super)this.destroyNode(n);if(t._tag!=="ref")for(const n of t.sub)this.removeEdge(t,n);t._tag==="effect"?(this.deferredEffects.delete(t),this.effects.delete(t)):this.atoms.delete(t),t.isDestroyed=!0}destroy(){for(const t of this.atoms)this.destroyNode(t)}makeEffect(t,n){const r={_tag:"effect",id:this.uniqueNodeId(),isDestroyed:!1,doEffect:(i,c)=>{r.invocations++,r.sub=new Set,t((m,g,b)=>(this.addEdge(r,m),DI(m,g,b)),i,c)},sub:new Set,label:n==null?void 0:n.label,invocations:0};return this.effects.add(r),r}setRef(t,n,r){this.setRefs([[t,n]],r)}setRefs(t,n){const r=new Set;for(const[i,c]of t)i.previousResult=c,i.refreshes++,uA(i,r);if(n!=null&&n.skipRefresh)for(const i of r)this.deferredEffects.has(i)===!1&&this.deferredEffects.set(i,new Set),(n==null?void 0:n.debugRefreshReason)!==void 0&&this.deferredEffects.get(i).add(n.debugRefreshReason);else this.runEffects(r,{debugRefreshReason:(n==null?void 0:n.debugRefreshReason)??OI(),otelContext:n==null?void 0:n.otelContext})}addEdge(t,n){t.sub.add(n),n.super.add(t),this.currentDebugRefresh===void 0&&this.runRefreshCallbacks()}removeEdge(t,n){t.sub.delete(n);const r=new Set;uA(n,r);for(const i of r)this.deferredEffects.set(i,new Set);n.super.delete(t),this.currentDebugRefresh===void 0&&this.runRefreshCallbacks()}}const DI=(e,t,n)=>{if(e.isDestroyed&&at(`LiveStore Error: Attempted to compute destroyed ${e._tag} (${e.id}): ${e.label??""}`),e.isDirty){const r=e.computeResult(t,n);return e.isDirty=!1,e.previousResult=r,r}else return e.previousResult},uA=(e,t)=>{for(const n of e.super)n._tag==="thunk"?(n.isDirty=!0,uA(n,t)):t.add(n)},S_e=e=>{throw new Error(`LiveStore Error: \`context\` not set on ReactiveGraph (${e.id})`)},qI=(e,t)=>{const n=[];for(const c of e.sub)n.push(c.id);const r=[];for(const c of e.super)r.push(c.id);const i=t?g_e(e.previousResult===s_?'"SYMBOL_NOT_REFRESHED_YET"':JSON.stringify(e.previousResult)):p_e();return e._tag==="ref"?{_tag:e._tag,id:e.id,label:e.label,meta:e.meta,isDirty:e.isDirty,sub:n,super:r,isDestroyed:e.isDestroyed,refreshes:e.refreshes,previousResult:i}:{_tag:"thunk",id:e.id,label:e.label,meta:e.meta,isDirty:e.isDirty,sub:n,super:r,isDestroyed:e.isDestroyed,recomputations:e.recomputations,previousResult:i}},v_e=e=>{const t=[];for(const n of e.sub)t.push(n.id);return{_tag:e._tag,id:e.id,label:e.label,sub:t,invocations:e.invocations,isDestroyed:e.isDestroyed}},w_e=()=>new b_e;let E_e=0;const NI=Symbol.for("LiveQuery"),$I=e=>typeof e=="string"||typeof e=="number"?e.toString():e.filter(qhe).join(",");var Nj;Nj=NI;class T_e{constructor(){y(this,"__result!");y(this,"id",E_e++);y(this,Nj,NI);y(this,"activeSubscriptions",new Set);y(this,"executionTimes",[]);y(this,"isDestroyed",!1);y(this,"run",t=>this.results$.computeResult(t.otelContext,t.debugRefreshReason));y(this,"dependencyQueriesRef",new Set)}get runs(){return this.results$._tag==="thunk"?this.results$.recomputations:0}}const k_e=(e,t,n,r)=>{const i=(c,f,m)=>{if(c._tag==="thunk"||c._tag==="ref")return e(c,n,m);if(c._tag==="def"||c._tag==="signal-def"){const g=c.make(t);return r.add(g),i(g.value,f,m)}return c._tag==="signal"&&Ae(c,"ref")?e(c.ref,n,m):e(c.results$,n,m)};return i},C_e=(e,t)=>(n,r)=>{let i=n.defRcMap.get(e);return i?(i.rc++,i):(i={rc:1,value:t(n,r),deref:()=>{i.rc--,i.rc===0&&(i.value.destroy(),n.defRcMap.delete(e))}},n.defRcMap.set(e,i),i)},II=(e,t)=>`${e.sqliteDef.name}.get:${t===void 0?e.default.id:t===ri?"sessionId":t}`,f8=({id:e,explicitDefaultValues:t,table:n,otelContext:r})=>({store:i})=>{if(Kw(n)===!1)return at(`Cannot insert row for table "${n.sqliteDef.name}" which does not have 'deriveEvents: true' set`);const c=r??i.otel.queriesSpanContext,f=e===ri?i.sessionId:e;i.sqliteDbWrapper.cachedSelect(`SELECT 1 FROM '${n.sqliteDef.name}' WHERE id = ?`,[f],{otelContext:c}).length!==1&&i.commit({otelContext:c,skipRefresh:!0,label:`${n.sqliteDef.name}.set:${f}`},n.set(t,f))},A_e=["begin","rollback","commit","savepoint","release"],MI=200;var _u,Qd,Xv;class R_e{constructor(){br(this,_u,new Bv(MI));br(this,Qd,new Map);y(this,"getKey",(t,n)=>n==null?t:Array.isArray(n)?t+`
`+n.join(`
`):t+`
`+Object.values(n).join(`
`));y(this,"get",t=>Ce(this,_u).get(t));y(this,"set",(t,n,r)=>{Ce(this,_u).set(n,r);for(const i of t){let c=Ce(this,Qd).get(i);c==null&&(c=new yge(MI),c.onEvict=Ce(this,Xv),Ce(this,Qd).set(i,c)),c.add(n)}});br(this,Xv,t=>{Ce(this,_u).delete(t)});y(this,"ignoreQuery",t=>A_e.some(n=>t.startsWith(n)));y(this,"invalidate",t=>{for(const n of t){const r=Ce(this,Qd).get(n);if(r!=null)for(const i of r)Ce(this,_u).delete(i)}})}}_u=new WeakMap,Qd=new WeakMap,Xv=new WeakMap;const d8=()=>({slowQueries:new qi(200),queryFrameDuration:0,queryFrameCount:0,events:new qi(1e3)});class x_e{constructor({db:t,otel:n}){y(this,"_tag","SqliteDb");y(this,"cachedStmts",new Bv(200));y(this,"tablesUsedCache",new Bv(200));y(this,"resultCache",new R_e);y(this,"db");y(this,"otelTracer");y(this,"otelRootSpanContext");y(this,"tablesUsedStmt");y(this,"debugInfo",d8());y(this,"metadata");y(this,"execute",PH((t,n)=>this.cachedExecute(t,n)));y(this,"select",HH((t,n)=>this.cachedSelect(t,n)));this.db=t,this.otelTracer=n.tracer,this.otelRootSpanContext=n.rootSpanContext,this.tablesUsedStmt=t.prepare("SELECT tbl_name FROM tables_used(?) AS u JOIN sqlite_master ON sqlite_master.name = u.name WHERE u.schema = 'main';"),this.cachedStmts.onEvict=(r,i)=>i.finalize(),O_e(this)}prepare(t){return this.db.prepare(t)}import(t){return this.db.import(t)}close(){this.db.close()}destroy(){this.db.destroy()}session(){return this.db.session()}makeChangeset(t){return this.db.makeChangeset(t)}txn(t){this.execute(Kd`begin transaction;`);let n=!1,r;try{r=t()}catch(i){throw n=!0,this.execute(Kd`rollback;`),i}return n||this.execute(Kd`commit;`),r}withChangeset(t){const n=this.db.session(),r=t(),i=n.changeset();return n.finish(),{result:r,changeset:i?{_tag:"sessionChangeset",data:i,debug:null}:{_tag:"no-op"}}}rollback(t){this.db.makeChangeset(t).invert().apply()}getTablesUsed(t){const n=D_e(t);if(n!==void 0)return new Set([n]);const r=this.tablesUsedCache.get(t);if(r)return r;const i=this.tablesUsedStmt,c=new Set;try{const f=i.select([t]);for(const m of f)c.add(m.tbl_name)}catch(f){return console.error("Error getting tables used",f,"for query",t),new Set}return this.tablesUsedCache.set(t,c),c}cachedExecute(t,n,r){return this.otelTracer.startActiveSpan("livestore.in-memory-db:execute",{attributes:{"sql.query":t}},(r==null?void 0:r.otelContext)??this.otelRootSpanContext,i=>{try{let c=this.cachedStmts.get(t);c===void 0&&(c=this.db.prepare(t),this.cachedStmts.set(t,c)),c.execute(n),(r==null?void 0:r.hasNoEffects)!==!0&&!this.resultCache.ignoreQuery(t)&&this.resultCache.invalidate((r==null?void 0:r.writeTables)??this.getTablesUsed(t)),i.end();const f=Vv(i);return this.debugInfo.queryFrameDuration+=f,this.debugInfo.queryFrameCount++,f>5&&Bo()&&this.debugInfo.slowQueries.push({queryStr:t,bindValues:n,durationMs:f,rowsCount:void 0,queriedTables:new Set,startTimePerfNow:dI(i)}),{durationMs:f}}catch(c){if(i.recordException(c),i.end(),Vo)debugger;throw new Yg({cause:c,query:{bindValues:n??{},sql:t}})}})}cachedSelect(t,n,r){const{queriedTables:i,skipCache:c=!1,otelContext:f}=r??{};return this.otelTracer.startActiveSpan("sql-in-memory-select",{},f??this.otelRootSpanContext,m=>{try{m.setAttribute("sql.query",t);const g=this.resultCache.getKey(t,n),b=this.resultCache.get(g);if(c===!1&&b!==void 0)return m.setAttribute("sql.rowsCount",b.length),m.setAttribute("sql.cached",!0),m.end(),b;let S=this.cachedStmts.get(t);S===void 0&&(S=this.db.prepare(t),this.cachedStmts.set(t,S));const v=S.select(n);m.setAttribute("sql.rowsCount",v.length),m.setAttribute("sql.cached",!1);const q=i??this.getTablesUsed(t);this.resultCache.set(q,g,v),m.end();const k=Vv(m);return this.debugInfo.queryFrameDuration+=k,this.debugInfo.queryFrameCount++,k>5&&Bo()&&this.debugInfo.slowQueries.push({queryStr:t,bindValues:n,durationMs:k,rowsCount:v.length,queriedTables:q,startTimePerfNow:dI(m)}),v}finally{m.end()}})}export(){for(const t of this.cachedStmts.keys())this.cachedStmts.delete(t);return this.db.export()}}const O_e=e=>{e.execute(Kd`
      PRAGMA page_size=32768;
      PRAGMA cache_size=10000;
      PRAGMA synchronous='OFF';
      PRAGMA temp_store='MEMORY';
      PRAGMA foreign_keys='ON'; -- we want foreign key constraints to be enforced
    `)},D_e=e=>{const[t,n]=e.trim().match(/^delete\s+from\s+(\w+)$/i)??[];return n};class q_e{constructor(){y(this,"map");y(this,"add",t=>{const n=this.map.get(t)??0;this.map.set(t,n+1)});y(this,"remove",t=>{const n=this.map.get(t)??0;n===1?this.map.delete(t):this.map.set(t,n-1)});y(this,"has",t=>this.map.has(t));this.map=new Map}get size(){return this.map.size}*[Symbol.iterator](){for(const t of this.map.keys())yield t}}const fA=(e,t,n="application/octet-stream")=>{const r=e instanceof Blob?e:new Blob([e],{type:n}),i=window.URL.createObjectURL(r);N_e(i,t),setTimeout(()=>window.URL.revokeObjectURL(i),1e3)},N_e=(e,t)=>{const n=document.createElement("a");n.href=e,n.download=t,document.body.append(n),n.style.display="none",n.click(),n.remove()},$_e=()=>{Bo()&&(globalThis.__debugLiveStoreUtils={downloadBlob:fA,runSync:e=>ya(e),runFork:e=>oi(e)})};Bo()&&$_e();class I_e extends S7{constructor({clientSession:n,schema:r,otelOptions:i,context:c,batchUpdates:f,storeId:m,effectContext:g,params:b,confirmUnsavedChanges:S,__runningInDevtools:v}){super();y(this,"storeId");y(this,"reactivityGraph");y(this,"sqliteDbWrapper");y(this,"clientSession");y(this,"schema");y(this,"context");y(this,"otel");y(this,"tableRefs");y(this,"effectContext");y(this,"activeQueries");y(this,"__eventSchema");y(this,"syncProcessor");y(this,"boot");y(this,"subscribe",(n,r)=>this.otel.tracer.startActiveSpan("LiveStore.subscribe",{attributes:{label:r==null?void 0:r.label,queryLabel:n.label}},(r==null?void 0:r.otelContext)??this.otel.queriesSpanContext,i=>{var v;const c=ts.setSpan(Os.active(),i),f=n._tag==="def"||n._tag==="signal-def"?n.make(this.reactivityGraph.context):{value:n,deref:()=>{}},m=f.value,g=`subscribe:${r==null?void 0:r.label}`,b=this.reactivityGraph.makeEffect((q,k,N)=>r.onUpdate(q(m.results$,c,N)),{label:g});return r!=null&&r.stackInfo&&m.activeSubscriptions.add(r.stackInfo),(v=r==null?void 0:r.onSubscribe)==null||v.call(r,m),this.activeQueries.add(m),(r==null?void 0:r.skipInitialRun)!==!0&&!m.isDestroyed&&b.doEffect(c,{_tag:"subscribe.initial",label:`subscribe-initial-run:${r==null?void 0:r.label}`}),()=>{var q;try{this.reactivityGraph.destroyNode(b),this.activeQueries.remove(m),r!=null&&r.stackInfo&&m.activeSubscriptions.delete(r.stackInfo),f.deref(),(q=r==null?void 0:r.onUnsubsubscribe)==null||q.call(r)}finally{i.end()}}}));y(this,"subscribeStream",(n,r)=>nde(i=>ye(this,function*(){const c=yield*zw.pipe(Xu("NoSuchElementException",()=>Gn(void 0))),f=c?ts.setSpan(Os.active(),c):Os.active();yield*wn(Ke(()=>this.subscribe(n,{onUpdate:m=>i.single(m),otelContext:f,label:r==null?void 0:r.label})),m=>Ke(()=>m()))})));y(this,"query",(n,r)=>{if(typeof n=="object"&&"query"in n&&"bindValues"in n)return this.sqliteDbWrapper.cachedSelect(n.query,hp(n.bindValues,n.query),{otelContext:r==null?void 0:r.otelContext});if(Di(n)){const i=n[Ko];i._tag==="RowQuery"&&f8({table:i.tableDef,id:i.id,explicitDefaultValues:i.explicitDefaultValues,otelContext:r==null?void 0:r.otelContext})(this.reactivityGraph.context);const c=n.asSql(),f=Gw(n),m=this.sqliteDbWrapper.cachedSelect(c.query,c.bindValues,{otelContext:r==null?void 0:r.otelContext,queriedTables:new Set([n[Ko].tableDef.sqliteDef.name])});return tf(f)(m)}else if(n._tag==="def"){const i=n.make(this.reactivityGraph.context),c=this.query(i.value,r);return i.deref(),c}else return n._tag==="signal-def"?n.make(this.reactivityGraph.context).value.get():n.run({otelContext:r==null?void 0:r.otelContext,debugRefreshReason:r==null?void 0:r.debugRefreshReason})});y(this,"setSignal",(n,r)=>{const i=n.make(this.reactivityGraph.context),c=typeof r=="function"?r(i.value.get()):r;i.value.set(c),i.rc>1&&i.deref()});y(this,"commit",(n,...r)=>{const{events:i,options:c}=this.getCommitArgs(n,r);for(const b of i)fH(b.args,this.clientSession.sessionId);if(i.length===0)return;const f=(c==null?void 0:c.skipRefresh)??!1;ts.getSpan(this.otel.commitsSpanContext).addEvent("commit");let g;return this.otel.tracer.startActiveSpan("LiveStore:commit",{attributes:{"livestore.eventsCount":i.length,"livestore.eventTags":i.map(b=>b.name),"livestore.commitLabel":c==null?void 0:c.label},links:c==null?void 0:c.spanLinks},(c==null?void 0:c.otelContext)??this.otel.commitsSpanContext,b=>{const S=ts.setSpan(Os.active(),b);try{const{writeTables:v}=(()=>{try{const N=()=>this.syncProcessor.push(i,{otelContext:S});return i.length>1?this.sqliteDbWrapper.txn(N):N()}catch(N){throw console.error(N),b.setStatus({code:Wc.ERROR,message:N.toString()}),N}finally{b.end()}})(),q=[];for(const N of v){const H=this.tableRefs[N];Q$(H!==void 0,`No table ref found for ${N}`),q.push([H,null])}const k={_tag:"commit",events:i,writeTables:Array.from(v)};this.reactivityGraph.setRefs(q,{debugRefreshReason:k,otelContext:S,skipRefresh:f})}catch(v){throw console.error(v),b.setStatus({code:Wc.ERROR,message:v.toString()}),v}finally{b.end(),g=Vv(b)}return{durationMs:g}})});y(this,"events",n=>Y$("store.events() is not yet implemented but planned soon"));y(this,"eventsStream",n=>Y$("store.eventsStream() is not yet implemented but planned soon"));y(this,"manualRefresh",n=>{const{label:r}=n??{};this.otel.tracer.startActiveSpan("LiveStore:manualRefresh",{attributes:{"livestore.manualRefreshLabel":r}},this.otel.commitsSpanContext,i=>{const c=ts.setSpan(Os.active(),i);this.reactivityGraph.runDeferredEffects({otelContext:c}),i.end()})});y(this,"shutdown",async n=>{await this.clientSession.shutdown(n??ol(Pv.make({reason:"manual"}))).pipe(this.runEffectFork,Gc,pw)});y(this,"_dev",{downloadDb:(n="local")=>{ye(this,function*(){const r=n==="local"?this.sqliteDbWrapper.export():yield*this.clientSession.leaderThread.export;fA(r,`livestore-${Date.now()}.db`)}).pipe(this.runEffectFork)},downloadEventlogDb:()=>{ye(this,function*(){const n=yield*this.clientSession.leaderThread.getEventlogData;fA(n,`livestore-eventlog-${Date.now()}.db`)}).pipe(this.runEffectFork)},hardReset:(n="all-data")=>{ye(this,function*(){const r=this.clientSession.clientId;yield*this.clientSession.leaderThread.sendDevtoolsMessage(Px.Request.make({liveStoreVersion:gs,mode:n,requestId:Ta(),clientId:r}))}).pipe(this.runEffectFork)},overrideNetworkStatus:n=>{const r=this.clientSession.clientId;this.clientSession.leaderThread.sendDevtoolsMessage(zx.Request.make({clientId:r,closeLatch:n==="offline",liveStoreVersion:gs,requestId:Ta()})).pipe(this.runEffectFork)},syncStates:()=>{ye(this,function*(){const n=yield*this.syncProcessor.syncState;console.log("Session sync state:",n.toJSON());const r=yield*this.clientSession.leaderThread.getSyncState;console.log("Leader sync state:",r.toJSON())}).pipe(this.runEffectFork)},version:gs,otel:{rootSpanContext:()=>{var n;return(n=ts.getSpan(this.otel.rootSpanContext))==null?void 0:n.spanContext()}}});y(this,"toJSON",()=>({_tag:"livestore.Store",reactivityGraph:this.reactivityGraph.getSnapshot({includeResults:!0})}));y(this,"runEffectFork",n=>n.pipe(vs(this.effectContext.lifetimeScope),Ft,l6(this.effectContext.runtime)));y(this,"getCommitArgs",(n,r)=>{let i,c;return typeof n=="function"?i=n(f=>i.push(f)):(n==null?void 0:n.label)!==void 0||(n==null?void 0:n.skipRefresh)!==void 0||(n==null?void 0:n.otelContext)!==void 0||(n==null?void 0:n.spanLinks)!==void 0?(c=n,i=r):n===void 0?i=[]:i=[n,...r],{events:i,options:c}});this.storeId=m,this.sqliteDbWrapper=new x_e({otel:i,db:n.sqliteDb}),this.clientSession=n,this.schema=r,this.context=c,this.effectContext=g;const q=w_e(),k=i.tracer.startSpan("LiveStore:sync",{},i.rootSpanContext);this.syncProcessor=pge({schema:r,clientSession:n,runtime:g.runtime,materializeEvent:(R,{otelContext:I,withChangeset:z,materializerHashLeader:V})=>{const{eventDef:K,materializer:Y}=VC(r,R.name),P=age({eventDef:K,materializer:Y,dbState:this.sqliteDbWrapper,event:{decoded:R,encoded:void 0}}),ne=Bo()?pe(ige(P)):me();V._tag==="Some"&&ne._tag==="Some"&&V.value!==ne.value&&this.shutdown(ol(ft.make({cause:`Materializer hash mismatch detected for event "${R.name}".`,note:"Please make sure your event materializer is a pure function without side effects."})));const Se=new Set,Re=()=>{for(const{statementSql:Ve,bindValues:oe,writeTables:Te=this.sqliteDbWrapper.getTablesUsed(Ve)}of P){try{this.sqliteDbWrapper.cachedExecute(Ve,oe,{otelContext:I,writeTables:Te})}catch(Ee){throw ft.make({cause:Ee,note:`Error executing materializer for event "${R.name}".
Statement: ${Ve}
Bind values: ${JSON.stringify(oe)}`})}for(const Ee of Te)Se.add(Ee)}};let ge={_tag:"unset"};return z===!0?ge=this.sqliteDbWrapper.withChangeset(Re).changeset:Re(),{writeTables:Se,sessionChangeset:ge,materializerHash:ne}},rollback:R=>{this.sqliteDbWrapper.rollback(R)},refreshTables:R=>{const I=[];for(const z of R){const V=this.tableRefs[z];Q$(V!==void 0,`No table ref found for ${z}`),I.push([V,null])}q.setRefs(I)},span:k,params:{leaderPushBatchSize:b.leaderPushBatchSize},confirmUnsavedChanges:S}),this.__eventSchema=dH(r),this.tableRefs={},this.activeQueries=new q_e;const N=i.tracer.startSpan("LiveStore:commits",{},i.rootSpanContext),H=ts.setSpan(Os.active(),N),x=i.tracer.startSpan("LiveStore:queries",{},i.rootSpanContext),C=ts.setSpan(Os.active(),x);this.reactivityGraph=q,this.reactivityGraph.context={store:this,defRcMap:new Map,reactivityGraph:new WeakRef(q),otelTracer:i.tracer,rootOtelContext:C,effectsWrapper:f},this.otel={tracer:i.tracer,rootSpanContext:i.rootSpanContext,commitsSpanContext:H,queriesSpanContext:C};const E=new Set(v?this.schema.state.sqlite.tables.keys():Array.from(this.schema.state.sqlite.tables.keys()).filter(R=>!Qme(R))),$=new Map(Array.from(this.reactivityGraph.atoms.values()).filter(R=>{var I;return R._tag==="ref"&&((I=R.label)==null?void 0:I.startsWith("tableRef:"))===!0}).map(R=>[R.label.slice(9),R]));for(const R of E)this.tableRefs[R]=$.get(R)??this.reactivityGraph.makeRef(null,{equal:()=>!1,label:`tableRef:${R}`,meta:{liveStoreRefType:"table"}});this.boot=ye(this,function*(){yield*rs(()=>Ke(()=>{for(const R of Object.values(this.tableRefs))for(const I of R.super)this.reactivityGraph.removeEdge(I,R);k.end(),N.end(),x.end()})),yield*this.syncProcessor.boot})}get sessionId(){return this.clientSession.sessionId}get clientId(){return this.clientSession.clientId}}const jI=globalThis.requestAnimationFrame===void 0?e=>setTimeout(e,1e3):globalThis.requestAnimationFrame,M_e=globalThis.cancelAnimationFrame===void 0?e=>clearTimeout(e):globalThis.cancelAnimationFrame,j_e=({storeDevtoolsChannel:e,store:t})=>ye(function*(){const n=new Map,r=new Map,i=new Map,c=new Map,{clientId:f,sessionId:m}=t.clientSession;yield*rs(()=>Ke(()=>{for(const v of n.values())v();for(const v of r.values())v();for(const v of i.values())v();for(const v of c.values())v()}));const g=new Set,b=v=>e.send(v).pipe(Ft,oi),S=v=>{var N,H,x,C;if(v.clientId!==f||v.sessionId!==m||v._tag==="LSD.ClientSession.Disconnect")return;const q=v.requestId;if(g.has(q))return;g.add(q);const k=globalThis.requestIdleCallback??(E=>E());switch(v._tag){case"LSD.ClientSession.ReactivityGraphSubscribe":{const E=v.includeResults,{subscriptionId:$}=v,R=()=>k(()=>b(xH.make({reactivityGraph:t.reactivityGraph.getSnapshot({includeResults:E}),requestId:Ta(10),clientId:f,sessionId:m,liveStoreVersion:gs,subscriptionId:$})),{timeout:500});R();const I=W$(R,20);n.set($,t.reactivityGraph.subscribeToRefresh(I));break}case"LSD.ClientSession.DebugInfoReq":{b(TH.make({debugInfo:t.sqliteDbWrapper.debugInfo,requestId:q,clientId:f,sessionId:m,liveStoreVersion:gs}));break}case"LSD.ClientSession.DebugInfoHistorySubscribe":{const{subscriptionId:E}=v,$=[];let R=!1,I;const z=()=>{$.push(t.sqliteDbWrapper.debugInfo),t.sqliteDbWrapper.debugInfo=d8(),$.length>10&&(b(kH.make({debugInfoHistory:$,requestId:Ta(10),clientId:f,sessionId:m,liveStoreVersion:gs,subscriptionId:E})),$.length=0),R===!1&&(I=jI(z))};I=jI(z);const V=()=>{R=!0,I!==void 0&&(M_e(I),I=void 0)};i.set(E,V);break}case"LSD.ClientSession.DebugInfoHistoryUnsubscribe":{const{subscriptionId:E}=v;(N=i.get(E))==null||N(),i.delete(E);break}case"LSD.ClientSession.DebugInfoResetReq":{t.sqliteDbWrapper.debugInfo.slowQueries.clear(),b(CH.make({requestId:q,clientId:f,sessionId:m,liveStoreVersion:gs}));break}case"LSD.ClientSession.DebugInfoRerunQueryReq":{const{queryStr:E,bindValues:$,queriedTables:R}=v;t.sqliteDbWrapper.cachedSelect(E,$,{queriedTables:R,skipCache:!0}),b(AH.make({requestId:q,clientId:f,sessionId:m,liveStoreVersion:gs}));break}case"LSD.ClientSession.ReactivityGraphUnsubscribe":{const{subscriptionId:E}=v;(H=n.get(E))==null||H(),n.delete(E);break}case"LSD.ClientSession.LiveQueriesSubscribe":{const{subscriptionId:E}=v,$=()=>k(()=>b(OH.make({liveQueries:[...t.activeQueries].map(I=>({_tag:I._tag,id:I.id,label:I.label,hash:I.def.hash,runs:I.runs,executionTimes:I.executionTimes.map(z=>Number(z.toString().slice(0,5))),lastestResult:I.results$.previousResult===s_?"SYMBOL_NOT_REFRESHED_YET":I.results$.previousResult,activeSubscriptions:Array.from(I.activeSubscriptions)})),requestId:Ta(10),liveStoreVersion:gs,clientId:f,sessionId:m,subscriptionId:E})),{timeout:500});$();const R=W$($,20);r.set(E,t.reactivityGraph.subscribeToRefresh(R));break}case"LSD.ClientSession.LiveQueriesUnsubscribe":{const{subscriptionId:E}=v;(x=r.get(E))==null||x(),r.delete(E);break}case"LSD.ClientSession.SyncHeadSubscribe":{const{subscriptionId:E}=v,$=R=>b(RH.make({local:R.localHead,upstream:R.upstreamHead,requestId:Ta(10),clientId:f,sessionId:m,liveStoreVersion:gs,subscriptionId:E}));$(t.syncProcessor.syncState.pipe(ya)),c.set(E,t.syncProcessor.syncState.changes.pipe($s(R=>$(R)),Vr,kn,Ft,sP));break}case"LSD.ClientSession.SyncHeadUnsubscribe":{const{subscriptionId:E}=v;(C=c.get(E))==null||C(),c.delete(E);break}case"LSD.ClientSession.Ping":{b(DH.make({requestId:q,clientId:f,sessionId:m,liveStoreVersion:gs}));break}default:console.warn("[LSD.ClientSession] Unknown message",v)}};yield*e.listen.pipe(hl(),Ede(v=>S(v)),Vr,At("LSD.devtools.onMessage"))}).pipe(ft.mapToUnexpectedError,At("LSD.devtools.connectStoreToDevtools")),F_e={leaderPushBatchSize:100},Zv=class Zv extends LA("@livestore/livestore/effect/LiveStoreContextRunning")(){};y(Zv,"fromDeferred",ye(function*(){const n=yield*yield*L_e;return V_(Zv,n)}).pipe(sae));let dA=Zv;class L_e extends LA("@livestore/livestore/effect/DeferredStoreContext")(){}const U_e=({schema:e,adapter:t,storeId:n,context:r={},boot:i,batchUpdates:c,disableDevtools:f,onBootStatus:m,shutdownDeferred:g,params:b,debug:S,confirmUnsavedChanges:v=!0,syncPayload:q})=>ye(function*(){const k=yield*z_();yield*z_e(n),yield*rs(H=>Xn(k,H));const N=(S==null?void 0:S.instanceId)??Ta(10);return yield*ye(function*(){const H=yield*zw.pipe(va),x=ts.setSpan(Os.active(),H),C=yield*V5,E=yield*qs().pipe(wn(ys));yield*Sh(E).pipe(Vhe(Y=>m==null?void 0:m(Y)),Ns(Y=>Y.stage==="done"?ys(E):ot),bh,Ft,En);const $=yield*xt(),R=Y=>ye(function*(){const P=yield*$;yield*j_e({storeDevtoolsChannel:Y,store:P})}),I=yield*em(),z=Y=>ye(function*(){yield*Xn(k,dr(Y)).pipe(Ax({label:"@livestore/livestore:shutdown",duration:500}),yh(1e3),Xu("TimeoutException",()=>Bp("@livestore/livestore:shutdown: Timed out after 1 second"))),g&&(yield*Eu(g,Y)),yield*Ur("LiveStore shutdown complete")}).pipe(At("@livestore/livestore:shutdown"),ss(I),Ft,oi,Gc),V=yield*t({schema:e,storeId:n,devtoolsEnabled:FI(f),bootStatusQueue:E,shutdown:z,connectDevtoolsToStore:R,debugInstanceId:N,syncPayload:q}).pipe(K5("livestore:makeAdapter"),At("createStore:makeAdapter"));Vo&&V.leaderThread.initialState.migrationsReport.migrations.length>0&&(yield*Ur("[@livestore/livestore:createStore] migrationsReport",...V.leaderThread.initialState.migrationsReport.migrations.map(Y=>Y.hashes.actual===void 0?`Table '${Y.tableName}' doesn't exist yet. Creating table...`:`Schema hash mismatch for table '${Y.tableName}' (DB: ${Y.hashes.actual}, expected: ${Y.hashes.expected}), migrating table...`)));const K=new I_e({clientSession:V,schema:e,context:r,otelOptions:{tracer:C,rootSpanContext:x},effectContext:{lifetimeScope:k,runtime:I},__runningInDevtools:FI(f)===!1,confirmUnsavedChanges:v,batchUpdates:Y=>Y(),storeId:n,params:{leaderPushBatchSize:(b==null?void 0:b.leaderPushBatchSize)??F_e.leaderPushBatchSize}});return yield*K.boot,i!==void 0&&(yield*Hhe(()=>i(K,{migrationsReport:V.leaderThread.initialState.migrationsReport,parentSpan:H})).pipe(ft.mapToUnexpectedError,ss(V_(dA,{stage:"running",store:K})),At("createStore:boot"))),yield*kse(),c!==void 0&&(K.reactivityGraph.context.effectsWrapper=c),yield*dn($,K),K}).pipe(At("createStore",{attributes:{debugInstanceId:N,storeId:n}}),nl({debugInstanceId:N,storeId:n}),Vo?Z5(H=>console.createTask(H)):Ie,U_(k))}),z_e=e=>ye(function*(){if(!/^[a-zA-Z0-9_-]+$/.test(e))return yield*ft.make({cause:`Invalid storeId: ${e}. Only alphanumeric characters, underscores, and hyphens are allowed.`,payload:{storeId:e}})}),FI=e=>e===!0||e===!1?!e:Bo()===!0,P_e=xt(),H_e="function() { [bytecode] }",B_e=e=>e===H_e?{_tag:"invalid",reason:"react-native"}:{_tag:"valid"},V_e=e=>Ae(e,"query")&&Ae(e,"schema"),Ir=(e,t)=>{const{queryString:n,extraDeps:r}=G_e(e),i=[n,t!=null&&t.deps?$I(t.deps):void 0,$I(r)].filter(Boolean).join("-");if(B_e(i)._tag==="invalid")throw new Error("On Expo/React Native, db queries must provide a `deps` option");if(i.trim()==="")return at(`Invalid query hash for query: ${e}`);const c=(t==null?void 0:t.label)??n,f={_tag:"def",make:C_e(i,(m,g)=>new K_e({reactivityGraph:m.reactivityGraph.deref(),queryInput:e,label:c,map:t==null?void 0:t.map,otelContext:g,def:f})),label:c,hash:i};return f},LI=e=>e===void 0?[]:Object.entries(e).map(([t,n])=>`${t}:${n===ri?"SessionIdSymbol":n}`).join(","),G_e=e=>{if(Di(e)){const{query:t,bindValues:n}=e.asSql();return{queryString:t,extraDeps:LI(n)}}return V_e(e)?{queryString:e.query,extraDeps:LI(e.bindValues)}:typeof e=="function"?{queryString:e.toString(),extraDeps:[]}:at(`Invalid query input: ${e}`)};class K_e extends T_e{constructor({queryInput:n,label:r,reactivityGraph:i,map:c,otelContext:f,def:m}){super();y(this,"_tag","db");y(this,"queryInput$");y(this,"results$");y(this,"label");y(this,"reactivityGraph");y(this,"mapResult");y(this,"def");y(this,"destroy",()=>{this.isDestroyed=!0,this.queryInput$!==void 0&&this.reactivityGraph.destroyNode(this.queryInput$),this.reactivityGraph.destroyNode(this.results$);for(const n of this.dependencyQueriesRef)n.deref()});let g=r??"db(unknown)";this.reactivityGraph=i,this.def=m,this.mapResult=c===void 0?C=>C:c;const b={current:typeof n=="function"||Di(n)?void 0:n.schema},S={current:void 0};let v;const q=(C,E)=>{try{const $=C.asSql(),R=Gw(C),I=C[Ko];return{queryInputRaw:{query:$.query,schema:R,bindValues:$.bindValues,queriedTables:new Set([I.tableDef.sqliteDef.name])},label:I._tag==="RowQuery"?II(I.tableDef,I.id):C.toString(),execBeforeFirstRun:I._tag==="RowQuery"?f8({table:I.tableDef,explicitDefaultValues:I.explicitDefaultValues,id:I.id,otelContext:E}):void 0}}catch($){throw new ft({cause:$,note:`Error building query for ${C.toString()}`,payload:{qb:C}})}};if(typeof n=="function")v=this.reactivityGraph.makeThunk((C,E,$,R)=>{const I=performance.now(),z=n(k_e(C,$,R??$.rootOtelContext,this.dependencyQueriesRef),$),V=performance.now()-I;let K;if(Di(z)){const Y=q(z,R);K=Y.queryInputRaw,this.label=Y.label,S.current=Y.execBeforeFirstRun}else K=z;return E({_tag:"computed",label:`${this.label}:queryInput`,query:K.query,durationMs:V}),b.current=K.schema,K},{label:`${g}:query`,meta:{liveStoreThunkType:"db.query"},equal:(C,E)=>C.query===E.query&&Au(C.bindValues,E.bindValues)}),this.queryInput$=v;else{let C;if(Di(n)){const E=q(n,f);C=E.queryInputRaw,g=E.label,S.current=E.execBeforeFirstRun}else C=n;if(b.current=C.schema,v=C,r===void 0&&Di(n)){const E=n[Ko];E._tag==="RowQuery"&&(g=`db(${II(E.tableDef,E.id)})`)}}const k={current:void 0},N=C=>(E,$)=>E===s_||$===s_?!1:ede(C)(E,$),H=c===void 0?b.current===void 0?(C,E)=>N(b.current)(C,E):N(b.current):void 0,x=this.reactivityGraph.makeThunk((C,E,$,R,I)=>$.otelTracer.startActiveSpan("db:...",{attributes:{"livestore.debugRefreshReason":Ae(I,"label")?I.label:I==null?void 0:I._tag}},R??$.rootOtelContext,z=>{const V=ts.setSpan(Os.active(),z),{store:K}=$;S.current!==void 0&&(S.current($,V),S.current=void 0);const Y=m_e(v)?C(v,V,I):v,P=Y.query,ne=Y.bindValues;k.current===void 0&&(k.current=K.sqliteDbWrapper.getTablesUsed(P)),ne!==void 0&&fH(ne,K.clientSession.sessionId);for(const oe of k.current){const Te=K.tableRefs[oe]??at(`No table ref found for ${oe}`);C(Te,V,I)}z.setAttribute("sql.query",P),z.updateName(`db:${P.slice(0,50)}`);const Se=K.sqliteDbWrapper.cachedSelect(P,ne?hp(ne,P):void 0,{queriedTables:k.current,otelContext:V});z.setAttribute("sql.rowsCount",Se.length);const Re=fm(b.current)(Se);if(Re._tag==="Left"){const oe=cp.formatErrorSync(Re.left),Te=String(b.current.ast),Ee=ne===void 0?"":`
Bind values: ${JSON.stringify(ne)}`;return at(`Error parsing SQL query result (${g}).

Query: ${P}${Ee}

Expected schema: ${Te}

Error: ${oe}

Result:`,Se,`
`)}const ge=this.mapResult(Re.right);z.end();const Ve=Vv(z);return this.executionTimes.push(Ve),E({_tag:"db",label:`${g}:results`,query:P,durationMs:Ve}),ge}),{label:`${g}:results`,meta:{liveStoreThunkType:"db.result"},equal:H});this.results$=x,this.label=g}}const Q_e=e=>{const t=/at (\S+) \((.+)\)/g;let n;const r=[];let i=!1;for(;(n=t.exec(e))!==null;){const[,c,f]=n;if((c.startsWith("use")||c.startsWith("Module.use"))&&c.endsWith("QueryRef")===!1)i=!0,r.unshift({name:c.replace(/^Module\./,""),filePath:f});else if(i){c!=="Object.react-stack-bottom-frame"&&r.unshift({name:c,filePath:f});break}}return{frames:r}},Y_e=e=>e.frames.map(t=>`${t.name} (${t.filePath})`).join(`
`),UI=(e,t,n,r)=>{const i=bs.useRef(void 0),c=bs.useRef(!1),f=bs.useMemo(()=>{if(c.current){const b=su.get(e);if(b!==void 0&&b._tag==="active")return b.resource}if(i.current!==void 0&&i.current!==e){const b=i.current,S=su.get(b);S!==void 0&&S._tag==="active"&&(S.rc--,S.rc===0&&(n(S.resource),su.set(b,{_tag:"destroyed"}),c.current=!0))}const m=su.get(e);if(m!==void 0&&m._tag==="active")return m.rc++,m.resource;const g=t();return su.set(e,{_tag:"active",rc:1,resource:g}),g},[e]);return bs.useEffect(()=>()=>{if(c.current){c.current=!1;return}const m=su.get(e);m===void 0||m._tag==="destroyed"||(m.rc--,m.rc===0&&(n(m.resource),su.delete(e)))},[e]),i.current=e,f},su=new Map,W_e=Error.stackTraceLimit,J_e=e=>{const[t,n]=er.useState(0),r=er.useRef(e),i=er.useRef(e);r.current!==e&&(r.current=e,i.current=e);const c=er.useCallback(f=>{const m=typeof f=="function"?f(i.current):f;i.current=m,n(g=>g+1)},[n]);return[i,c]},X_e=(e,t)=>h8(e,t).valueRef.current,h8=(e,t)=>{var q;const n=(t==null?void 0:t.store)??((q=er.useContext(Zw))==null?void 0:q.store)??at("No store provided to useQuery"),r=`${n.storeId}_${n.clientId}_${n.sessionId}_${e.hash}`,i=er.useMemo(()=>{Error.stackTraceLimit=10;const k=new Error().stack;return Error.stackTraceLimit=W_e,Q_e(k)},[]),{queryRcRef:c,span:f,otelContext:m}=UI(r,()=>{const k=e.label,N=n.otel.tracer.startSpan((t==null?void 0:t.otelSpanName)??`LiveStore:useQuery:${k}`,{attributes:{label:k,firstStackInfo:JSON.stringify(i)}},(t==null?void 0:t.otelContext)??n.otel.queriesSpanContext),H=ts.setSpan(Os.active(),N);return{queryRcRef:e.make(n.reactivityGraph.context,H),span:N,otelContext:H}},()=>{}),g=c.value;er.useDebugValue(`LiveStore:useQuery:${g.id}:${g.label}`);const b=er.useMemo(()=>{try{return g.run({otelContext:m,debugRefreshReason:{_tag:"react",api:"useQuery",label:`useQuery:initial-run:${g.label}`,stackInfo:i}})}catch(k){throw console.error("[@livestore/react:useQuery] Error running query",k),new Error(`[@livestore/react:useQuery] Error running query: ${k.name}

Query: ${g.label}

React trace:

${Qg(Y_e(i),4)}

Stack trace:
`,{cause:k})}},[m,g,i]),[S,v]=J_e(b);return er.useEffect(()=>(g.activeSubscriptions.add(i),f.updateName((t==null?void 0:t.otelSpanName)??`LiveStore:useQuery:${g.label}`),n.subscribe(g,{onUpdate:k=>{Au(k,S.current)===!1&&v(k)},onUnsubsubscribe:()=>{g.activeSubscriptions.delete(i)},label:g.label,otelContext:m})),[i,g,v,n,S,m,f,t==null?void 0:t.otelSpanName]),UI(r,()=>({queryRcRef:c,span:f}),({queryRcRef:k,span:N})=>{k.deref(),N.end()}),{valueRef:S,queryRcRef:c}},Z_e=(e,t,n,r)=>{var k;const i=typeof t=="string"||t===ri?t:e[Ch].options.default.id,c=typeof t=="string"||t===ri?n:t,{default:f}=c??{};er.useMemo(()=>eye(e),[e]);const m=e.sqliteDef.name,g=(r==null?void 0:r.store)??((k=er.useContext(Zw))==null?void 0:k.store)??at("No store provided to useClientDocument"),b=i===ri?g.clientSession.sessionId:i,S=er.useMemo(()=>Ir(e.get(i,{default:f}),{deps:[b,e.sqliteDef.name,JSON.stringify(f)]}),[e,i,f,b]),v=h8(S,{otelSpanName:`LiveStore:useClientDocument:${m}:${b}`,store:r==null?void 0:r.store}),q=er.useMemo(()=>N=>{const H=typeof N=="function"?N(v.valueRef.current):N;v.valueRef.current!==H&&g.commit(e.set(tye(H),i))},[i,v.valueRef,g,e]);return[v.valueRef.current,q,b,v.queryRcRef.value]},eye=e=>{if(Kw(e)===!1)return at(`useClientDocument called on table "${e.sqliteDef.name}" which is not a client document table`)},tye=e=>typeof e=="object"&&e!==null?Object.fromEntries(Object.entries(e).filter(([t,n])=>n!==void 0)):e,nye=e=>(e.useQuery=t=>X_e(t,{store:e}),e.useClientDocument=(t,n,r)=>Z_e(t,n,r,{store:e}),e),ui=e=>{const t=er.useContext(Zw);if(t===void 0)throw new Error("useStore can only be used inside StoreContext.Provider");if(t.stage!=="running")throw new Error("useStore can only be used after the store is running");return{store:nye(t.store)}},rye=e=>Cx?F.jsx(F.Fragment,{}):F.jsx(F.Fragment,{children:rn(ft)(e)?e.toString():I5(e)}),sye=e=>{const t=e._tag==="LiveStore.StoreInterrupted"?`interrupted due to: ${e.reason}`:e.reason==="devtools-import"?"devtools import":e.reason==="devtools-reset"?"devtools reset":e.reason==="adapter-reset"?"adapter reset":e.reason==="manual"?"manual shutdown":"unknown reason";return Cx?F.jsx(F.Fragment,{}):F.jsxs(F.Fragment,{children:["LiveStore Shutdown due to ",t]})},aye=e=>Cx?F.jsx(F.Fragment,{}):F.jsxs(F.Fragment,{children:["LiveStore is loading (",e.stage,")..."]}),iye=({renderLoading:e=aye,renderError:t=rye,renderShutdown:n=sye,otelOptions:r,children:i,schema:c,storeId:f="default",boot:m,adapter:g,batchUpdates:b,disableDevtools:S,signal:v,confirmUnsavedChanges:q=!0,syncPayload:k,debug:N})=>{const H=oye({storeId:f,schema:c,otelOptions:r,boot:m,adapter:g,batchUpdates:b,disableDevtools:S,signal:v,confirmUnsavedChanges:q,syncPayload:k,debug:N});return H.stage==="error"?t(H.error):H.stage==="shutdown"?n(H.cause):H.stage!=="running"?e(H):(globalThis.__debugLiveStore??(globalThis.__debugLiveStore={}),Object.keys(globalThis.__debugLiveStore).length===0&&(globalThis.__debugLiveStore._=H.store),globalThis.__debugLiveStore[(N==null?void 0:N.instanceId)??f]=H.store,F.jsx(Zw.Provider,{value:H,children:i}))},oye=({schema:e,storeId:t,otelOptions:n,boot:r,adapter:i,batchUpdates:c,disableDevtools:f,signal:m,context:g,params:b,confirmUnsavedChanges:S,syncPayload:v,debug:q})=>{const[k,N]=er.useState(0),H=er.useRef({value:{stage:"loading"},componentScope:void 0,shutdownDeferred:void 0,previousShutdownDeferred:void 0,counter:0}),x=q==null?void 0:q.instanceId,C=er.useRef({schema:e,otelOptions:n,boot:r,adapter:i,batchUpdates:c,disableDevtools:f,signal:m,context:g,params:b,confirmUnsavedChanges:S,syncPayload:v,debugInstanceId:x}),E=(R,I,z)=>ye(function*(){yield*Xn(R,Qh(z)),yield*CR(I,z)}).pipe(Ys(V=>Ur("[@livestore/livestore/react] interupting",V)),oi),$={schema:C.current.schema!==e,otelOptions:C.current.otelOptions!==n,boot:C.current.boot!==r,adapter:C.current.adapter!==i,batchUpdates:C.current.batchUpdates!==c,disableDevtools:C.current.disableDevtools!==f,signal:C.current.signal!==m,context:C.current.context!==g,params:C.current.params!==b,confirmUnsavedChanges:C.current.confirmUnsavedChanges!==S,syncPayload:C.current.syncPayload!==v,debugInstanceId:C.current.debugInstanceId!==x};if($.schema||$.otelOptions||$.boot||$.adapter||$.batchUpdates||$.disableDevtools||$.signal||$.context||$.params||$.confirmUnsavedChanges||$.syncPayload){if(C.current={schema:e,otelOptions:n,boot:r,adapter:i,batchUpdates:c,disableDevtools:f,signal:m,context:g,params:b,confirmUnsavedChanges:S,syncPayload:v,debugInstanceId:x},H.current.componentScope!==void 0&&H.current.shutdownDeferred!==void 0){const R=Object.keys($).filter(I=>$[I]);E(H.current.componentScope,H.current.shutdownDeferred,new vS({reason:`re-rendering due to changed input props: ${R.join(", ")}`})),H.current.componentScope=void 0,H.current.shutdownDeferred=void 0}H.current={value:{stage:"loading"},componentScope:void 0,shutdownDeferred:void 0,previousShutdownDeferred:H.current.shutdownDeferred,counter:H.current.counter+1}}return er.useEffect(()=>{const R=H.current.counter,I=V=>{H.current.counter===R&&(H.current.value=V,N(K=>K+1))};m==null||m.addEventListener("abort",()=>{H.current.componentScope!==void 0&&H.current.shutdownDeferred!==void 0&&H.current.counter===R&&(E(H.current.componentScope,H.current.shutdownDeferred,new vS({reason:"Aborted via provided AbortController"})),H.current.componentScope=void 0,H.current.shutdownDeferred=void 0)});const z=ye(function*(){H.current.previousShutdownDeferred&&(yield*gn(H.current.previousShutdownDeferred));const V=yield*z_().pipe(wn(Xn)),K=yield*P_e;H.current.componentScope=V,H.current.shutdownDeferred=K,yield*ye(function*(){const P=yield*U_e({schema:e,storeId:t,boot:r,adapter:i,batchUpdates:c,disableDevtools:f,shutdownDeferred:K,context:g,params:b,confirmUnsavedChanges:S,syncPayload:v,onBootStatus:ne=>{H.current.value.stage==="running"||H.current.value.stage==="error"||I(ne)},debug:{instanceId:x}}).pipe(Ys(ne=>Eu(K,ne)));I({stage:"running",store:P})}).pipe(U_(V),vs(V));const Y=P=>Ke(()=>I({stage:"shutdown",cause:P}));yield*gn(K).pipe(Ys(P=>Ur("[@livestore/livestore/react] shutdown",zp(P))),Xu("LiveStore.IntentionalShutdownCause",P=>Y(P)),Xu("LiveStore.StoreInterrupted",P=>Y(P)),Mse(P=>Ke(()=>I({stage:"error",error:P}))),Ise(P=>Ke(()=>I({stage:"error",error:P}))),In)}).pipe(Zu,At("@livestore/react:useCreateStore"),Vo?Z5(V=>console.createTask(V)):Ie,hpe({parentSpanContext:n==null?void 0:n.rootSpanContext,otelTracer:n==null?void 0:n.tracer}),Ft,nl({thread:"window"}),ss(Ode("window")),wue($R),sP);return()=>{z(),H.current.componentScope!==void 0&&H.current.shutdownDeferred!==void 0&&(E(H.current.componentScope,H.current.shutdownDeferred,new vS({reason:"unmounting component"})),H.current.componentScope=void 0,H.current.shutdownDeferred=void 0)}},[e,n,r,i,c,f,m,t,g,b,S,v,x]),H.current.value},Fg=Math.round(window.devicePixelRatio||1),ok=2,cye=1,lye=0,ck=-1,uye=({width:e=120,height:t=30,systemFps:n=60,className:r})=>{const i=Math.round(e*Fg),c=Math.round(t*Fg),f=Math.floor(i/ok),m=1e3/n,b=Math.min(2*n,f),S=er.useRef(void 0),v=er.useCallback(q=>{if(S.current!==void 0&&window.cancelAnimationFrame(S.current),q===null)return;if(b>f)throw new Error(`numberOfFramesForAverageFps (${b}) must be smaller than numberOfVisibleFrames (${f}). Either increase the width or increase the resolutionInMs.`);const k=new Array(f).fill(ck),N=q.getContext("2d"),H=()=>{N.clearRect(0,0,i,c);for(let R=0;R<f;R++){const I=k[R];if(I===ck)continue;const z=R*ok;N.fillStyle=I>0?"rgba(255, 255, 255, 0.3)":"rgba(255, 0, 0, 1)",N.fillRect(z,c,ok,-c)}let E=0,$=0;for(let R=0;R<b;R++){const I=k.at(-R-1);I!==ck&&(E+=I,$++)}if($>=b){N.fillStyle="white";const R=Fg*10;N.font=`${R}px monospace`;const I=Math.round(n*E/$);N.fillText(`${I} FPS`,2*Fg,c-3*Fg)}};let x=0;const C=()=>{S.current=window.requestAnimationFrame(E=>{C();const $=Math.floor(E/m),R=$-x-1;for(let I=0;I<R;I++)k.shift(),k.push(lye);k.shift(),k.push(cye),x=$,H()})};C()},[c,i,f,b,m,n]);return F.jsx("canvas",{width:i,height:c,className:r,ref:v,style:{width:e,height:t}})};var fye=Ij();const Ct={members:Ds({name:"members",columns:{id:ut({primaryKey:!0}),name:ut({default:""}),bio:ut({default:""}),role:ut({default:"member"}),stakeAmount:xn({default:0}),stakeStatus:ut({default:"none"}),stakedAt:xn({nullable:!0,schema:Sr}),permissions:ut({default:"read"}),createdAt:xn({schema:Sr}),updatedAt:xn({nullable:!0,schema:Sr})}}),projects:Ds({name:"projects",columns:{id:ut({primaryKey:!0}),name:ut({default:""}),status:ut({default:"active"}),sharingLevel:ut({default:"private"}),ownerId:ut({default:""}),origin:ut({default:""}),description:ut({default:""}),learned:ut({default:""}),link:ut({nullable:!0}),linkText:ut({nullable:!0}),createdAt:xn({schema:Sr}),updatedAt:xn({nullable:!0,schema:Sr}),deletedAt:xn({nullable:!0,schema:Sr})}}),notebookEntries:Ds({name:"notebookEntries",columns:{id:ut({primaryKey:!0}),date:ut({default:""}),title:ut({default:""}),type:ut({default:"note"}),sharingLevel:ut({default:"private"}),ownerId:ut({default:""}),content:ut({default:""}),createdAt:xn({schema:Sr}),updatedAt:xn({nullable:!0,schema:Sr}),deletedAt:xn({nullable:!0,schema:Sr})}}),proposals:Ds({name:"proposals",columns:{id:ut({primaryKey:!0}),title:ut({default:""}),description:ut({default:""}),type:ut({default:"general"}),targetId:ut({nullable:!0}),proposerId:ut({default:""}),status:ut({default:"open"}),votesFor:xn({default:0}),votesAgainst:xn({default:0}),createdAt:xn({schema:Sr}),closedAt:xn({nullable:!0,schema:Sr}),deletedAt:xn({nullable:!0,schema:Sr})}}),votes:Ds({name:"votes",columns:{id:ut({primaryKey:!0}),proposalId:ut({default:""}),memberId:ut({default:""}),vote:ut({default:"abstain"}),createdAt:xn({schema:Sr})}}),comments:Ds({name:"comments",columns:{id:ut({primaryKey:!0}),targetType:ut({default:"project"}),targetId:ut({default:""}),authorId:ut({default:""}),content:ut({default:""}),createdAt:xn({schema:Sr}),updatedAt:xn({nullable:!0,schema:Sr}),deletedAt:xn({nullable:!0,schema:Sr})}}),collaborators:Ds({name:"collaborators",columns:{id:ut({primaryKey:!0}),icon:ut({default:""}),title:ut({default:""}),description:ut({default:""}),order:xn({default:0}),createdAt:xn({schema:Sr}),updatedAt:xn({nullable:!0,schema:Sr}),deletedAt:xn({nullable:!0,schema:Sr})}}),uiState:Zme({name:"uiState",schema:ve({activeSection:qe("projects","notebook","chama","proposals","collaborators","export"),selectedItemId:ze(W,Gs),currentMemberId:ze(W,Gs)}),default:{id:ri,value:{activeSection:"projects",selectedItemId:null,currentMemberId:null}}})},nr={memberCreated:Nr({name:"v1.MemberCreated",schema:ve({id:W,name:W,bio:W,role:qe("founder","member","contributor"),stakeAmount:dt,stakeStatus:qe("none","pending","active","withdrawn"),stakedAt:ze(Wn,Gs),permissions:qe("read","comment","propose","vote","admin"),createdAt:Wn})}),memberUpdated:Nr({name:"v1.MemberUpdated",schema:ve({id:W,name:tt(W),bio:tt(W),role:tt(qe("founder","member","contributor")),stakeAmount:tt(dt),stakeStatus:tt(qe("none","pending","active","withdrawn")),stakedAt:tt(ze(Wn,Gs)),permissions:tt(qe("read","comment","propose","vote","admin")),updatedAt:Wn})}),projectCreated:Nr({name:"v1.ProjectCreated",schema:ve({id:W,name:W,status:qe("active","archived"),sharingLevel:qe("private","chama","public"),ownerId:W,origin:W,description:W,learned:W,link:ze(W,Gs),linkText:ze(W,Gs),createdAt:Wn})}),projectUpdated:Nr({name:"v1.ProjectUpdated",schema:ve({id:W,name:tt(W),status:tt(qe("active","archived")),sharingLevel:tt(qe("private","chama","public")),ownerId:tt(W),origin:tt(W),description:tt(W),learned:tt(W),link:tt(ze(W,Gs)),linkText:tt(ze(W,Gs)),updatedAt:Wn})}),projectDeleted:Nr({name:"v1.ProjectDeleted",schema:ve({id:W,deletedAt:Wn})}),notebookEntryCreated:Nr({name:"v1.NotebookEntryCreated",schema:ve({id:W,date:W,title:W,type:qe("prototype","sketch","failed","concept","note","thought","reflection"),sharingLevel:qe("private","chama","public"),ownerId:W,content:W,createdAt:Wn})}),notebookEntryUpdated:Nr({name:"v1.NotebookEntryUpdated",schema:ve({id:W,date:tt(W),title:tt(W),type:tt(qe("prototype","sketch","failed","concept","note","thought","reflection")),sharingLevel:tt(qe("private","chama","public")),ownerId:tt(W),content:tt(W),updatedAt:Wn})}),notebookEntryDeleted:Nr({name:"v1.NotebookEntryDeleted",schema:ve({id:W,deletedAt:Wn})}),proposalCreated:Nr({name:"v1.ProposalCreated",schema:ve({id:W,title:W,description:W,type:qe("general","elevate-project","budget","membership"),targetId:ze(W,Gs),proposerId:W,status:qe("open","approved","rejected","withdrawn"),createdAt:Wn})}),proposalUpdated:Nr({name:"v1.ProposalUpdated",schema:ve({id:W,title:tt(W),description:tt(W),status:tt(qe("open","approved","rejected","withdrawn")),votesFor:tt(dt),votesAgainst:tt(dt),closedAt:tt(ze(Wn,Gs))})}),proposalDeleted:Nr({name:"v1.ProposalDeleted",schema:ve({id:W,deletedAt:Wn})}),voteCreated:Nr({name:"v1.VoteCreated",schema:ve({id:W,proposalId:W,memberId:W,vote:qe("for","against","abstain"),createdAt:Wn})}),commentCreated:Nr({name:"v1.CommentCreated",schema:ve({id:W,targetType:qe("project","notebook","proposal"),targetId:W,authorId:W,content:W,createdAt:Wn})}),commentUpdated:Nr({name:"v1.CommentUpdated",schema:ve({id:W,content:tt(W),updatedAt:Wn})}),commentDeleted:Nr({name:"v1.CommentDeleted",schema:ve({id:W,deletedAt:Wn})}),collaboratorCreated:Nr({name:"v1.CollaboratorCreated",schema:ve({id:W,icon:W,title:W,description:W,order:dt,createdAt:Wn})}),collaboratorUpdated:Nr({name:"v1.CollaboratorUpdated",schema:ve({id:W,icon:tt(W),title:tt(W),description:tt(W),order:tt(dt),updatedAt:Wn})}),collaboratorDeleted:Nr({name:"v1.CollaboratorDeleted",schema:ve({id:W,deletedAt:Wn})}),uiStateSet:Ct.uiState.set},dye=Jme(nr,{"v1.MemberCreated":e=>Ct.members.insert({id:e.id,name:e.name,bio:e.bio,role:e.role,stakeAmount:e.stakeAmount,stakeStatus:e.stakeStatus,stakedAt:e.stakedAt,permissions:e.permissions,createdAt:e.createdAt}),"v1.MemberUpdated":e=>{const t={updatedAt:e.updatedAt};return e.name!==void 0&&(t.name=e.name),e.bio!==void 0&&(t.bio=e.bio),e.role!==void 0&&(t.role=e.role),e.stakeAmount!==void 0&&(t.stakeAmount=e.stakeAmount),e.stakeStatus!==void 0&&(t.stakeStatus=e.stakeStatus),e.stakedAt!==void 0&&(t.stakedAt=e.stakedAt),e.permissions!==void 0&&(t.permissions=e.permissions),Ct.members.update(t).where({id:e.id})},"v1.ProjectCreated":e=>Ct.projects.insert({id:e.id,name:e.name,status:e.status,sharingLevel:e.sharingLevel,ownerId:e.ownerId,origin:e.origin,description:e.description,learned:e.learned,link:e.link,linkText:e.linkText,createdAt:e.createdAt}),"v1.ProjectUpdated":e=>{const t={updatedAt:e.updatedAt};return e.name!==void 0&&(t.name=e.name),e.status!==void 0&&(t.status=e.status),e.sharingLevel!==void 0&&(t.sharingLevel=e.sharingLevel),e.ownerId!==void 0&&(t.ownerId=e.ownerId),e.origin!==void 0&&(t.origin=e.origin),e.description!==void 0&&(t.description=e.description),e.learned!==void 0&&(t.learned=e.learned),e.link!==void 0&&(t.link=e.link),e.linkText!==void 0&&(t.linkText=e.linkText),Ct.projects.update(t).where({id:e.id})},"v1.ProjectDeleted":({id:e,deletedAt:t})=>Ct.projects.update({deletedAt:t}).where({id:e}),"v1.NotebookEntryCreated":e=>Ct.notebookEntries.insert({id:e.id,date:e.date,title:e.title,type:e.type,sharingLevel:e.sharingLevel,ownerId:e.ownerId,content:e.content,createdAt:e.createdAt}),"v1.NotebookEntryUpdated":e=>{const t={updatedAt:e.updatedAt};return e.date!==void 0&&(t.date=e.date),e.title!==void 0&&(t.title=e.title),e.type!==void 0&&(t.type=e.type),e.sharingLevel!==void 0&&(t.sharingLevel=e.sharingLevel),e.ownerId!==void 0&&(t.ownerId=e.ownerId),e.content!==void 0&&(t.content=e.content),Ct.notebookEntries.update(t).where({id:e.id})},"v1.NotebookEntryDeleted":({id:e,deletedAt:t})=>Ct.notebookEntries.update({deletedAt:t}).where({id:e}),"v1.ProposalCreated":e=>Ct.proposals.insert({id:e.id,title:e.title,description:e.description,type:e.type,targetId:e.targetId,proposerId:e.proposerId,status:e.status,votesFor:0,votesAgainst:0,createdAt:e.createdAt}),"v1.ProposalUpdated":e=>{const t={};return e.title!==void 0&&(t.title=e.title),e.description!==void 0&&(t.description=e.description),e.status!==void 0&&(t.status=e.status),e.votesFor!==void 0&&(t.votesFor=e.votesFor),e.votesAgainst!==void 0&&(t.votesAgainst=e.votesAgainst),e.closedAt!==void 0&&(t.closedAt=e.closedAt),Ct.proposals.update(t).where({id:e.id})},"v1.ProposalDeleted":({id:e,deletedAt:t})=>Ct.proposals.update({deletedAt:t}).where({id:e}),"v1.VoteCreated":e=>Ct.votes.insert({id:e.id,proposalId:e.proposalId,memberId:e.memberId,vote:e.vote,createdAt:e.createdAt}),"v1.CommentCreated":e=>Ct.comments.insert({id:e.id,targetType:e.targetType,targetId:e.targetId,authorId:e.authorId,content:e.content,createdAt:e.createdAt}),"v1.CommentUpdated":e=>{const t={updatedAt:e.updatedAt};return e.content!==void 0&&(t.content=e.content),Ct.comments.update(t).where({id:e.id})},"v1.CommentDeleted":({id:e,deletedAt:t})=>Ct.comments.update({deletedAt:t}).where({id:e}),"v1.CollaboratorCreated":e=>Ct.collaborators.insert({id:e.id,icon:e.icon,title:e.title,description:e.description,order:e.order,createdAt:e.createdAt}),"v1.CollaboratorUpdated":e=>{const t={updatedAt:e.updatedAt};return e.icon!==void 0&&(t.icon=e.icon),e.title!==void 0&&(t.title=e.title),e.description!==void 0&&(t.description=e.description),e.order!==void 0&&(t.order=e.order),Ct.collaborators.update(t).where({id:e.id})},"v1.CollaboratorDeleted":({id:e,deletedAt:t})=>Ct.collaborators.update({deletedAt:t}).where({id:e})}),hye=oge({tables:Ct,materializers:dye}),mye=sge({events:nr,state:hye}),ay=Ir(Ct.uiState.get(),{label:"uiState"}),iy=Ir(Ct.members.select().orderBy("createdAt","asc"),{label:"allMembers"});Ir(Ct.members.select().where({stakeStatus:"active"}).orderBy("createdAt","asc"),{label:"stakedMembers"});const m8=Ir(Ct.projects.select().where({deletedAt:null}).orderBy("createdAt","desc"),{label:"allProjects"});Ir(Ct.projects.select().where({status:"active",deletedAt:null}).orderBy("createdAt","desc"),{label:"activeProjects"});Ir(Ct.projects.select().where({status:"archived",deletedAt:null}).orderBy("createdAt","desc"),{label:"archivedProjects"});const gye=Ir(Ct.projects.select().where({sharingLevel:"chama",deletedAt:null}).orderBy("createdAt","desc"),{label:"chamaProjects"});Ir(Ct.projects.select().where({sharingLevel:"public",deletedAt:null}).orderBy("createdAt","desc"),{label:"publicProjects"});const g8=Ir(Ct.notebookEntries.select().where({deletedAt:null}).orderBy("date","desc"),{label:"allNotebookEntries"}),pye=Ir(Ct.notebookEntries.select().where({sharingLevel:"chama",deletedAt:null}).orderBy("date","desc"),{label:"chamaNotebookEntries"});Ir(Ct.notebookEntries.select().where({sharingLevel:"public",deletedAt:null}).orderBy("date","desc"),{label:"publicNotebookEntries"});const _ye=Ir(Ct.proposals.select().where({deletedAt:null}).orderBy("createdAt","desc"),{label:"allProposals"}),yye=Ir(Ct.proposals.select().where({status:"open",deletedAt:null}).orderBy("createdAt","desc"),{label:"openProposals"});function bye(e){return Ir(Ct.votes.select().where({proposalId:e}).orderBy("createdAt","asc"),{label:`votes_${e}`})}function Sye(e,t){return Ir(Ct.votes.select().where({memberId:e,proposalId:t}),{label:`vote_${e}_${t}`})}function p8(e,t){return Ir(Ct.comments.select().where({targetType:e,targetId:t,deletedAt:null}).orderBy("createdAt","asc"),{label:`comments_${e}_${t}`})}const _8=Ir(Ct.collaborators.select().where({deletedAt:null}).orderBy("createdAt","asc"),{label:"allCollaborators"}),Ef=()=>{if(typeof window>"u")return"unused";const e=new URLSearchParams(window.location.search),t=e.get("storeId");if(t!==null)return t;const n=crypto.randomUUID();return e.set("storeId",n),window.location.search=e.toString(),n},vye=()=>{const{store:e}=ui(),t=e.useQuery(ay),n=e.useQuery(iy),r=Ef(),i=n.find(m=>m.id===r),c=[{id:"projects",label:" Projects",icon:""},{id:"notebook",label:" Lab Notebook",icon:""},{id:"chama",label:" Chama Feed",icon:""},{id:"proposals",label:" Proposals",icon:""},{id:"collaborators",label:" Collaborators",icon:""},{id:"export",label:" Export Data",icon:""}],f=m=>{e.commit(nr.uiStateSet({activeSection:m,selectedItemId:null,currentMemberId:t.currentMemberId}))};return F.jsxs("aside",{className:"studio-sidebar",children:[F.jsxs("div",{className:"studio-logo",children:[F.jsx("h1",{children:" sspirial studio"}),F.jsx("p",{className:"studio-subtitle",children:"micro-studio + chama"})]}),i&&F.jsxs("div",{className:"sidebar-member-card",children:[F.jsx("div",{className:"member-name",children:i.name}),F.jsxs("div",{className:"member-status",children:[i.stakeStatus==="active"&&" Staked Member",i.stakeStatus==="pending"&&" Pending",i.stakeStatus==="none"&&" Observer"]})]}),F.jsx("nav",{className:"studio-nav",children:c.map(m=>F.jsxs("button",{className:`studio-nav-item ${t.activeSection===m.id?"active":""}`,onClick:()=>f(m.id),children:[F.jsx("span",{className:"nav-icon",children:m.icon}),F.jsx("span",{className:"nav-label",children:m.label.replace(/^.+\s/,"")})]},m.id))}),F.jsxs("div",{className:"studio-info",children:[F.jsx("p",{className:"info-text",children:F.jsx("small",{children:"Local-first + Chama governance"})}),F.jsx("p",{className:"info-text",children:F.jsxs("small",{children:[n.length," ",n.length===1?"member":"members"]})})]})]})},wye=()=>{const{store:e}=ui(),t=e.useQuery(m8),n=e.useQuery(ay),[r,i]=bs.useState(null),[c,f]=bs.useState({name:"",status:"active",sharingLevel:"private",origin:"",description:"",learned:"",link:"",linkText:""}),m=Ef(),g=n.currentMemberId||m,b=()=>{const k={id:crypto.randomUUID(),name:"New Project",status:"active",sharingLevel:"private",ownerId:g,origin:"",description:"",learned:"",link:null,linkText:null,createdAt:new Date};e.commit(nr.projectCreated(k)),i(k.id),f({name:k.name,status:k.status,sharingLevel:k.sharingLevel,origin:k.origin,description:k.description,learned:k.learned,link:"",linkText:""})},S=k=>{i(k.id),f({name:k.name,status:k.status,sharingLevel:k.sharingLevel,origin:k.origin,description:k.description,learned:k.learned,link:k.link||"",linkText:k.linkText||""})},v=k=>{e.commit(nr.projectUpdated({id:k,name:c.name,status:c.status,sharingLevel:c.sharingLevel,origin:c.origin,description:c.description,learned:c.learned,link:c.link||null,linkText:c.linkText||null,updatedAt:new Date})),i(null)},q=k=>{confirm("Are you sure you want to delete this project?")&&e.commit(nr.projectDeleted({id:k,deletedAt:new Date}))};return F.jsxs("div",{className:"content-section",children:[F.jsxs("div",{className:"section-header",children:[F.jsx("h2",{children:" Projects"}),F.jsx("button",{className:"btn btn-primary",onClick:b,children:"+ New Project"})]}),F.jsx("div",{className:"items-list",children:t.map(k=>F.jsx("div",{className:"item-card",children:r===k.id?F.jsxs("div",{className:"edit-form",children:[F.jsxs("div",{className:"form-row",children:[F.jsxs("label",{children:["Name:",F.jsx("input",{type:"text",value:c.name,onChange:N=>f({...c,name:N.target.value}),className:"form-input"})]}),F.jsxs("label",{children:["Status:",F.jsxs("select",{value:c.status,onChange:N=>f({...c,status:N.target.value}),className:"form-select",children:[F.jsx("option",{value:"active",children:"Active"}),F.jsx("option",{value:"archived",children:"Archived"})]})]}),F.jsxs("label",{children:["Sharing:",F.jsxs("select",{value:c.sharingLevel,onChange:N=>f({...c,sharingLevel:N.target.value}),className:"form-select",children:[F.jsx("option",{value:"private",children:" Private"}),F.jsx("option",{value:"chama",children:" Chama"}),F.jsx("option",{value:"public",children:" Public"})]})]})]}),F.jsxs("label",{children:["Origin Story:",F.jsx("textarea",{value:c.origin,onChange:N=>f({...c,origin:N.target.value}),className:"form-textarea",rows:3})]}),F.jsxs("label",{children:["Description:",F.jsx("textarea",{value:c.description,onChange:N=>f({...c,description:N.target.value}),className:"form-textarea",rows:3})]}),F.jsxs("label",{children:["What We Learned:",F.jsx("textarea",{value:c.learned,onChange:N=>f({...c,learned:N.target.value}),className:"form-textarea",rows:2})]}),F.jsxs("div",{className:"form-row",children:[F.jsxs("label",{children:["Link:",F.jsx("input",{type:"url",value:c.link,onChange:N=>f({...c,link:N.target.value}),className:"form-input",placeholder:"https://..."})]}),F.jsxs("label",{children:["Link Text:",F.jsx("input",{type:"text",value:c.linkText,onChange:N=>f({...c,linkText:N.target.value}),className:"form-input",placeholder:"View source "})]})]}),F.jsxs("div",{className:"form-actions",children:[F.jsx("button",{className:"btn btn-primary",onClick:()=>v(k.id),children:"Save"}),F.jsx("button",{className:"btn btn-secondary",onClick:()=>i(null),children:"Cancel"})]})]}):F.jsxs("div",{className:"item-content",children:[F.jsxs("div",{className:"item-header",children:[F.jsx("h3",{children:k.name}),F.jsxs("div",{className:"item-badges",children:[F.jsx("span",{className:`status-badge status-${k.status}`,children:k.status}),F.jsxs("span",{className:`sharing-badge sharing-${k.sharingLevel}`,children:[k.sharingLevel==="private"&&" Private",k.sharingLevel==="chama"&&" Chama",k.sharingLevel==="public"&&" Public"]})]})]}),F.jsxs("p",{className:"item-meta",children:[F.jsx("strong",{children:"Origin:"})," ",k.origin]}),F.jsx("p",{children:k.description}),F.jsxs("p",{className:"item-meta",children:[F.jsx("strong",{children:"Learned:"})," ",k.learned]}),k.link&&F.jsx("p",{className:"item-link",children:F.jsx("a",{href:k.link,target:"_blank",rel:"noopener noreferrer",children:k.linkText||"View "})}),F.jsxs("div",{className:"item-actions",children:[F.jsx("button",{className:"btn btn-small",onClick:()=>S(k),children:"Edit"}),F.jsx("button",{className:"btn btn-small btn-danger",onClick:()=>q(k.id),children:"Delete"})]})]})},k.id))})]})},Eye=["prototype","sketch","failed","concept","note","thought","reflection"],Tye=()=>{const{store:e}=ui(),t=e.useQuery(g8),n=e.useQuery(ay),[r,i]=bs.useState(null),[c,f]=bs.useState({date:"",title:"",type:"note",sharingLevel:"private",content:""}),m=Ef(),g=n.currentMemberId||m,b=()=>{const N=new Date,H=N.getFullYear(),x=String(N.getMonth()+1).padStart(2,"0"),C=String(N.getDate()).padStart(2,"0");return`${H}.${x}.${C}`},S=()=>{const N={id:crypto.randomUUID(),date:b(),title:"New Entry",type:"note",sharingLevel:"private",ownerId:g,content:"",createdAt:new Date};e.commit(nr.notebookEntryCreated(N)),i(N.id),f({date:N.date,title:N.title,type:N.type,sharingLevel:N.sharingLevel,content:N.content})},v=N=>{i(N.id),f({date:N.date,title:N.title,type:N.type,sharingLevel:N.sharingLevel,content:N.content})},q=N=>{e.commit(nr.notebookEntryUpdated({id:N,date:c.date,title:c.title,type:c.type,sharingLevel:c.sharingLevel,content:c.content,updatedAt:new Date})),i(null)},k=N=>{confirm("Are you sure you want to delete this entry?")&&e.commit(nr.notebookEntryDeleted({id:N,deletedAt:new Date}))};return F.jsxs("div",{className:"content-section",children:[F.jsxs("div",{className:"section-header",children:[F.jsx("h2",{children:" Lab Notebook"}),F.jsx("button",{className:"btn btn-primary",onClick:S,children:"+ New Entry"})]}),F.jsx("div",{className:"items-list",children:t.map(N=>F.jsx("div",{className:"item-card",children:r===N.id?F.jsxs("div",{className:"edit-form",children:[F.jsxs("div",{className:"form-row",children:[F.jsxs("label",{children:["Date (YYYY.MM.DD):",F.jsx("input",{type:"text",value:c.date,onChange:H=>f({...c,date:H.target.value}),className:"form-input",placeholder:"2024.11.13"})]}),F.jsxs("label",{children:["Type:",F.jsx("select",{value:c.type,onChange:H=>f({...c,type:H.target.value}),className:"form-select",children:Eye.map(H=>F.jsx("option",{value:H,children:H},H))})]}),F.jsxs("label",{children:["Sharing:",F.jsxs("select",{value:c.sharingLevel,onChange:H=>f({...c,sharingLevel:H.target.value}),className:"form-select",children:[F.jsx("option",{value:"private",children:" Private"}),F.jsx("option",{value:"chama",children:" Chama"}),F.jsx("option",{value:"public",children:" Public"})]})]})]}),F.jsxs("label",{children:["Title:",F.jsx("input",{type:"text",value:c.title,onChange:H=>f({...c,title:H.target.value}),className:"form-input"})]}),F.jsxs("label",{children:["Content:",F.jsx("textarea",{value:c.content,onChange:H=>f({...c,content:H.target.value}),className:"form-textarea",rows:5})]}),F.jsxs("div",{className:"form-actions",children:[F.jsx("button",{className:"btn btn-primary",onClick:()=>q(N.id),children:"Save"}),F.jsx("button",{className:"btn btn-secondary",onClick:()=>i(null),children:"Cancel"})]})]}):F.jsxs("div",{className:"item-content",children:[F.jsxs("div",{className:"notebook-entry-header",children:[F.jsx("span",{className:"notebook-date",children:N.date}),F.jsx("span",{className:`entry-type-badge type-${N.type}`,children:N.type}),F.jsxs("span",{className:`sharing-badge sharing-${N.sharingLevel}`,children:[N.sharingLevel==="private"&&"",N.sharingLevel==="chama"&&"",N.sharingLevel==="public"&&""]})]}),F.jsx("h3",{children:N.title}),F.jsx("p",{className:"notebook-content",children:N.content}),F.jsxs("div",{className:"item-actions",children:[F.jsx("button",{className:"btn btn-small",onClick:()=>v(N),children:"Edit"}),F.jsx("button",{className:"btn btn-small btn-danger",onClick:()=>k(N.id),children:"Delete"})]})]})},N.id))})]})},kye=()=>{const{store:e}=ui(),t=e.useQuery(gye),n=e.useQuery(pye),r=e.useQuery(iy),i=Ef(),c=r.find(S=>S.id===i),f=c&&["comment","propose","vote","admin"].includes(c.permissions),m=[...t.map(S=>({...S,type:"project",sortDate:S.createdAt})),...n.map(S=>({...S,type:"notebook",sortDate:S.createdAt}))].sort((S,v)=>new Date(v.sortDate).getTime()-new Date(S.sortDate).getTime()),g=S=>{const v=r.find(q=>q.id===S);return(v==null?void 0:v.name)||"Unknown"},b=(S,v)=>{if(!f){alert("You need to stake to comment on shared items.");return}const q=prompt("Add your comment:");q&&e.commit(nr.commentCreated({id:`comment-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,targetType:S,targetId:v,authorId:i,content:q,createdAt:new Date}))};return c?m.length===0?F.jsxs("div",{className:"content-section",children:[F.jsx("h2",{children:" Chama Feed"}),F.jsx("p",{children:"No items shared with the chama yet."}),F.jsx("p",{style:{fontSize:"0.9em",color:"#888"},children:'Share your projects or notebook entries by setting their visibility to "Chama".'})]}):F.jsxs("div",{className:"content-section",children:[F.jsx("h2",{children:" Chama Feed"}),F.jsxs("p",{className:"section-description",children:["Items shared by chama members. ",f?"You can comment and discuss.":"Stake to unlock commenting."]}),F.jsx("div",{className:"feed-list",children:m.map(S=>F.jsx(Cye,{item:S,ownerName:g(S.ownerId),canComment:f||!1,onComment:b},`${S.type}-${S.id}`))})]}):F.jsxs("div",{className:"content-section",children:[F.jsx("h2",{children:" Chama Feed"}),F.jsx("p",{children:"Create your member profile to see what's being shared with the chama."})]})},Cye=({item:e,ownerName:t,canComment:n,onComment:r})=>{const{store:i}=ui(),c=i.useQuery(p8(e.type,e.id)),f=i.useQuery(iy),[m,g]=bs.useState(!1),b=S=>{const v=f.find(q=>q.id===S);return(v==null?void 0:v.name)||"Unknown"};return F.jsxs("div",{className:"feed-item",children:[F.jsxs("div",{className:"feed-item-header",children:[F.jsxs("span",{className:"feed-type-badge",children:[e.type==="project"?"":""," ",e.type]}),F.jsxs("span",{className:"feed-owner",children:["by ",t]}),F.jsx("span",{className:"feed-date",children:new Date(e.sortDate).toLocaleDateString()})]}),F.jsx("h3",{children:e.name||e.title}),e.type==="project"&&F.jsxs("div",{className:"feed-item-content",children:[F.jsxs("p",{children:[F.jsx("strong",{children:"Origin:"})," ",e.origin]}),F.jsxs("p",{children:[F.jsx("strong",{children:"Description:"})," ",e.description]}),e.learned&&F.jsxs("p",{children:[F.jsx("strong",{children:"Learned:"})," ",e.learned]}),e.link&&F.jsx("p",{children:F.jsx("a",{href:e.link,target:"_blank",rel:"noopener noreferrer",children:e.linkText||"Link"})})]}),e.type==="notebook"&&F.jsxs("div",{className:"feed-item-content",children:[F.jsxs("p",{children:[F.jsx("span",{className:"notebook-type-badge",children:e.type})," ",e.date]}),F.jsx("p",{children:e.content})]}),F.jsxs("div",{className:"feed-item-actions",children:[F.jsxs("button",{onClick:()=>g(!m),className:"btn-text",children:[" ",c.length," ",c.length===1?"comment":"comments"]}),n&&F.jsx("button",{onClick:()=>r(e.type,e.id),className:"btn-text",children:"Add comment"})]}),m&&F.jsx("div",{className:"comments-section",children:c.length===0?F.jsx("p",{className:"no-comments",children:"No comments yet"}):c.map(S=>F.jsxs("div",{className:"comment",children:[F.jsxs("div",{className:"comment-header",children:[F.jsx("strong",{children:b(S.authorId)}),F.jsx("span",{className:"comment-date",children:new Date(S.createdAt).toLocaleString()})]}),F.jsx("p",{children:S.content})]},S.id))})]})},Aye=()=>{const{store:e}=ui(),[t,n]=bs.useState(!1),r=e.useQuery(t?_ye:yye),i=e.useQuery(iy),c=Ef(),f=i.find(S=>S.id===c),m=f&&["propose","vote","admin"].includes(f.permissions),g=f&&["vote","admin"].includes(f.permissions),b=()=>{if(!m){alert("You need staking permissions to create proposals.");return}const S=prompt("Proposal title:");if(!S)return;const v=prompt("Proposal description:");if(!v)return;const k=prompt(`Proposal type (${["general","elevate-project","budget","membership"].join(", ")}):`)||"general";e.commit(nr.proposalCreated({id:`proposal-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,title:S,description:v,type:k,targetId:null,proposerId:c,status:"open",createdAt:new Date}))};return f?F.jsxs("div",{className:"content-section",children:[F.jsx("h2",{children:" Proposals"}),F.jsx("p",{className:"section-description",children:"Chama governance through proposals and voting."}),F.jsxs("div",{className:"section-actions",children:[m&&F.jsx("button",{onClick:b,className:"btn-primary",children:"+ New Proposal"}),F.jsx("button",{onClick:()=>n(!t),className:"btn-secondary",children:t?"Show Open Only":"Show All"})]}),r.length===0?F.jsxs("p",{children:["No ",t?"":"open ","proposals yet."]}):F.jsx("div",{className:"proposals-list",children:r.map(S=>F.jsx(Rye,{proposal:S,members:i,currentMember:f,canVote:g||!1},S.id))})]}):F.jsxs("div",{className:"content-section",children:[F.jsx("h2",{children:" Proposals"}),F.jsx("p",{children:"Create your member profile to view and participate in governance."})]})},Rye=({proposal:e,members:t,currentMember:n,canVote:r})=>{const{store:i}=ui(),c=i.useQuery(bye(e.id)),f=i.useQuery(Sye(n.id,e.id))[0],m=i.useQuery(p8("proposal",e.id)),[g,b]=bs.useState(!1),S=t.find(E=>E.id===e.proposerId),v=c.length,q=c.filter(E=>E.vote==="for").length,k=c.filter(E=>E.vote==="against").length,N=E=>{if(!r){alert("You need voting permissions.");return}if(f){alert("You have already voted on this proposal.");return}i.commit(nr.voteCreated({id:`vote-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,proposalId:e.id,memberId:n.id,vote:E,createdAt:new Date}));const $=E==="for"?q+1:q,R=E==="against"?k+1:k;i.commit(nr.proposalUpdated({id:e.id,votesFor:$,votesAgainst:R}))},H=()=>{const E=prompt("Add your comment:");E&&i.commit(nr.commentCreated({id:`comment-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,targetType:"proposal",targetId:e.id,authorId:n.id,content:E,createdAt:new Date}))},x=E=>({open:" Open",approved:" Approved",rejected:" Rejected",withdrawn:" Withdrawn"})[E]||E,C=E=>({general:" General","elevate-project":" Elevate Project",budget:" Budget",membership:" Membership"})[E]||E;return F.jsxs("div",{className:"proposal-card",children:[F.jsxs("div",{className:"proposal-header",children:[F.jsx("h3",{children:e.title}),F.jsxs("div",{className:"proposal-badges",children:[F.jsx("span",{className:"status-badge",children:x(e.status)}),F.jsx("span",{className:"type-badge",children:C(e.type)})]})]}),F.jsx("p",{children:e.description}),F.jsxs("div",{className:"proposal-meta",children:[F.jsxs("span",{children:["Proposed by: ",F.jsx("strong",{children:(S==null?void 0:S.name)||"Unknown"})]}),F.jsx("span",{children:new Date(e.createdAt).toLocaleDateString()})]}),F.jsxs("div",{className:"proposal-voting",children:[F.jsxs("div",{className:"vote-counts",children:[F.jsxs("span",{className:"votes-for",children:[" ",q]}),F.jsxs("span",{className:"votes-against",children:[" ",k]}),F.jsxs("span",{className:"total-votes",children:["Total: ",v]})]}),f&&F.jsxs("div",{className:"my-vote",children:["Your vote: ",F.jsx("strong",{children:f.vote})]}),!f&&e.status==="open"&&r&&F.jsxs("div",{className:"vote-buttons",children:[F.jsx("button",{onClick:()=>N("for"),className:"btn-vote-for",children:" Vote For"}),F.jsx("button",{onClick:()=>N("against"),className:"btn-vote-against",children:" Vote Against"}),F.jsx("button",{onClick:()=>N("abstain"),className:"btn-vote-abstain",children:" Abstain"})]})]}),F.jsxs("div",{className:"proposal-actions",children:[F.jsxs("button",{onClick:()=>b(!g),className:"btn-text",children:[" ",m.length," ",m.length===1?"comment":"comments"]}),F.jsx("button",{onClick:H,className:"btn-text",children:"Add comment"})]}),g&&F.jsx("div",{className:"comments-section",children:m.length===0?F.jsx("p",{className:"no-comments",children:"No comments yet"}):m.map(E=>{const $=t.find(R=>R.id===E.authorId);return F.jsxs("div",{className:"comment",children:[F.jsxs("div",{className:"comment-header",children:[F.jsx("strong",{children:($==null?void 0:$.name)||"Unknown"}),F.jsx("span",{className:"comment-date",children:new Date(E.createdAt).toLocaleString()})]}),F.jsx("p",{children:E.content})]},E.id)})})]})},xye=()=>{const{store:e}=ui(),t=e.useQuery(_8),[n,r]=bs.useState(null),[i,c]=bs.useState({icon:"",title:"",description:""}),f=()=>{const S={id:crypto.randomUUID(),icon:"",title:"New Collaborator Type",description:"",order:t.length,createdAt:new Date};e.commit(nr.collaboratorCreated(S)),r(S.id),c({icon:S.icon,title:S.title,description:S.description})},m=S=>{r(S.id),c({icon:S.icon,title:S.title,description:S.description})},g=S=>{e.commit(nr.collaboratorUpdated({id:S,icon:i.icon,title:i.title,description:i.description,updatedAt:new Date})),r(null)},b=S=>{confirm("Are you sure you want to delete this collaborator type?")&&e.commit(nr.collaboratorDeleted({id:S,deletedAt:new Date}))};return F.jsxs("div",{className:"content-section",children:[F.jsxs("div",{className:"section-header",children:[F.jsx("h2",{children:" Collaborators"}),F.jsx("button",{className:"btn btn-primary",onClick:f,children:"+ New Type"})]}),F.jsx("div",{className:"items-list",children:t.map(S=>F.jsx("div",{className:"item-card",children:n===S.id?F.jsxs("div",{className:"edit-form",children:[F.jsxs("div",{className:"form-row",children:[F.jsxs("label",{children:["Icon (emoji):",F.jsx("input",{type:"text",value:i.icon,onChange:v=>c({...i,icon:v.target.value}),className:"form-input",placeholder:""})]}),F.jsxs("label",{children:["Title:",F.jsx("input",{type:"text",value:i.title,onChange:v=>c({...i,title:v.target.value}),className:"form-input",placeholder:"Builders"})]})]}),F.jsxs("label",{children:["Description:",F.jsx("textarea",{value:i.description,onChange:v=>c({...i,description:v.target.value}),className:"form-textarea",rows:4,placeholder:"Who they are and why we want to work with them..."})]}),F.jsxs("div",{className:"form-actions",children:[F.jsx("button",{className:"btn btn-primary",onClick:()=>g(S.id),children:"Save"}),F.jsx("button",{className:"btn btn-secondary",onClick:()=>r(null),children:"Cancel"})]})]}):F.jsxs("div",{className:"item-content",children:[F.jsxs("h3",{children:[S.icon," ",S.title]}),F.jsx("p",{children:S.description}),F.jsxs("div",{className:"item-actions",children:[F.jsx("button",{className:"btn btn-small",onClick:()=>m(S),children:"Edit"}),F.jsx("button",{className:"btn btn-small btn-danger",onClick:()=>b(S.id),children:"Delete"})]})]})},S.id))})]})},Oye=()=>{const{store:e}=ui(),t=e.useQuery(m8),n=e.useQuery(g8),r=e.useQuery(_8),[i,c]=bs.useState(""),f=k=>({id:k.id,name:k.name,status:k.status,origin:k.origin,description:k.description,learned:k.learned,link:k.link,linkText:k.linkText}),m=k=>({id:k.id,date:k.date,title:k.title,type:k.type,content:k.content}),g=k=>{const N=k.id;return{id:k.id,icon:k.icon,title:k.title,description:k.description,[N]:{}}},b=(k,N)=>{const H=new Blob([JSON.stringify(N,null,2)],{type:"application/json"}),x=URL.createObjectURL(H),C=document.createElement("a");C.href=x,C.download=k,document.body.appendChild(C),C.click(),document.body.removeChild(C),URL.revokeObjectURL(x)},S=()=>{try{const k={projects:t.map(f),notebook:n.map(m),collaborators:r.map(g)};b("projects.json",k.projects),b("notebook.json",k.notebook),b("collaborators.json",k.collaborators),c(" Successfully exported all files! Place them in portal/data/ directory."),setTimeout(()=>c(""),5e3)}catch(k){c(" Export failed: "+k.message)}},v=k=>{try{switch(k){case"projects":b("projects.json",t.map(f));break;case"notebook":b("notebook.json",n.map(m));break;case"collaborators":b("collaborators.json",r.map(g));break}c(` Exported ${k}.json successfully!`),setTimeout(()=>c(""),3e3)}catch(N){c(" Export failed: "+N.message)}},q={projects:t.length,notebook:n.length,collaborators:r.length};return F.jsxs("div",{className:"content-section",children:[F.jsxs("div",{className:"section-header",children:[F.jsx("h2",{children:" Export Data"}),F.jsx("button",{className:"btn btn-primary",onClick:S,children:"Export All Files"})]}),i&&F.jsx("div",{className:`export-status ${i.startsWith("")?"success":"error"}`,children:i}),F.jsxs("div",{className:"export-info",children:[F.jsx("h3",{children:"Export to Portal"}),F.jsxs("p",{children:["Export your studio content to JSON files that can be used by the portal site. After exporting, place the files in the ",F.jsx("code",{children:"portal/data/"})," directory."]})]}),F.jsxs("div",{className:"export-grid",children:[F.jsxs("div",{className:"export-card",children:[F.jsxs("div",{className:"export-card-header",children:[F.jsx("h4",{children:" Projects"}),F.jsxs("span",{className:"export-count",children:[q.projects," items"]})]}),F.jsx("p",{children:"Export project catalog with status, origin stories, and learnings."}),F.jsx("button",{className:"btn btn-small",onClick:()=>v("projects"),children:"Export projects.json"})]}),F.jsxs("div",{className:"export-card",children:[F.jsxs("div",{className:"export-card-header",children:[F.jsx("h4",{children:" Lab Notebook"}),F.jsxs("span",{className:"export-count",children:[q.notebook," entries"]})]}),F.jsx("p",{children:"Export notebook entries with dates, types, and content."}),F.jsx("button",{className:"btn btn-small",onClick:()=>v("notebook"),children:"Export notebook.json"})]}),F.jsxs("div",{className:"export-card",children:[F.jsxs("div",{className:"export-card-header",children:[F.jsx("h4",{children:" Collaborators"}),F.jsxs("span",{className:"export-count",children:[q.collaborators," types"]})]}),F.jsx("p",{children:"Export collaborator types with icons and descriptions."}),F.jsx("button",{className:"btn btn-small",onClick:()=>v("collaborators"),children:"Export collaborators.json"})]})]}),F.jsxs("div",{className:"export-instructions",children:[F.jsx("h3",{children:" Instructions"}),F.jsxs("ol",{children:[F.jsx("li",{children:'Click "Export All Files" or export individual files above'}),F.jsx("li",{children:"Files will download to your Downloads folder"}),F.jsxs("li",{children:["Move the files to ",F.jsx("code",{children:"portal/data/"})," directory"]}),F.jsx("li",{children:"Refresh the portal site to see your changes"}),F.jsx("li",{children:"Commit and push to deploy to production"})]})]})]})},Dye=()=>{const{store:e}=ui(),t=e.useQuery(ay),n=e.useQuery(iy),r=Ef(),i=n.find(S=>S.id===r),c=()=>{const S=prompt("Enter your name:");if(!S)return;const v=prompt("Enter a short bio:")||"";e.commit(nr.memberCreated({id:r,name:S,bio:v,role:"member",stakeAmount:0,stakeStatus:"none",stakedAt:null,permissions:"read",createdAt:new Date})),e.commit(nr.uiStateSet({activeSection:t.activeSection,selectedItemId:t.selectedItemId,currentMemberId:r}))},f=()=>{if(!i)return;const S=prompt("Update name:",i.name),v=prompt("Update bio:",i.bio);S!==null&&e.commit(nr.memberUpdated({id:r,name:S||i.name,bio:v||i.bio,updatedAt:new Date}))},m=()=>{if(!i)return;const S=prompt("Enter stake amount (in smallest currency unit, e.g., cents):");if(!S)return;const v=parseInt(S,10);if(isNaN(v)||v<0){alert("Invalid amount");return}e.commit(nr.memberUpdated({id:r,stakeAmount:v,stakeStatus:"pending",stakedAt:new Date,updatedAt:new Date})),alert("Stake pending. In production, this would integrate with payment processing.")},g=S=>({read:" Reader",comment:" Commenter",propose:" Proposer",vote:" Voter",admin:" Admin"})[S]||S,b=S=>({none:" No Stake",pending:" Pending",active:" Active",withdrawn:" Withdrawn"})[S]||S;return i?F.jsxs("div",{className:"member-profile",children:[F.jsx("h3",{children:" Your Profile"}),F.jsxs("div",{className:"profile-card",children:[F.jsxs("div",{className:"profile-header",children:[F.jsx("h4",{children:i.name}),F.jsx("span",{className:"role-badge",children:i.role})]}),F.jsx("p",{className:"bio",children:i.bio}),F.jsxs("div",{className:"profile-stats",children:[F.jsxs("div",{className:"stat",children:[F.jsx("span",{className:"label",children:"Permissions:"}),F.jsx("span",{className:"value",children:g(i.permissions)})]}),F.jsxs("div",{className:"stat",children:[F.jsx("span",{className:"label",children:"Stake:"}),F.jsx("span",{className:"value",children:b(i.stakeStatus)})]}),i.stakeAmount>0&&F.jsxs("div",{className:"stat",children:[F.jsx("span",{className:"label",children:"Amount:"}),F.jsxs("span",{className:"value",children:[i.stakeAmount," units"]})]})]}),F.jsxs("div",{className:"profile-meta",children:[F.jsxs("small",{children:["StoreID: ",F.jsx("code",{children:i.id})]}),F.jsxs("small",{children:["Joined: ",new Date(i.createdAt).toLocaleDateString()]})]}),F.jsxs("div",{className:"profile-actions",children:[F.jsx("button",{onClick:f,className:"btn-secondary",children:"Edit Profile"}),i.stakeStatus==="none"&&F.jsx("button",{onClick:m,className:"btn-primary",children:" Stake & Join Chama"})]})]}),F.jsxs("div",{className:"chama-info",children:[F.jsxs("h4",{children:[" Chama Members (",n.length,")"]}),F.jsx("div",{className:"members-list",children:n.map(S=>F.jsxs("div",{className:"member-item",children:[F.jsx("span",{className:"member-name",children:S.name}),F.jsx("span",{className:"member-status",children:S.stakeStatus==="active"?"":""})]},S.id))})]})]}):F.jsxs("div",{className:"member-profile-empty",children:[F.jsx("h3",{children:" Member Profile"}),F.jsx("p",{children:"You haven't created your chama profile yet."}),F.jsxs("p",{style:{fontSize:"0.9em",color:"#888",marginBottom:"1rem"},children:["StoreID: ",F.jsx("code",{children:r})]}),F.jsx("button",{onClick:c,className:"btn-primary",children:"Create Profile"})]})};function qye(e){return new Worker("/assets/livestore.worker-0_SFHYFC.js",{type:"module",name:e==null?void 0:e.name})}const Nye=()=>{const{store:e}=ui(),t=e.useQuery(ay),n=()=>{switch(t.activeSection){case"projects":return F.jsx(wye,{});case"notebook":return F.jsx(Tye,{});case"chama":return F.jsx(kye,{});case"proposals":return F.jsx(Aye,{});case"collaborators":return F.jsx(xye,{});case"export":return F.jsx(Oye,{});default:return F.jsxs("div",{className:"content-section",children:[F.jsx("h2",{children:"Welcome to sspirial studio"}),F.jsx("p",{children:"A micro-studio that is also a chama."}),F.jsx(Dye,{})]})}};return F.jsxs("div",{className:"studio-layout",children:[F.jsx(vye,{}),F.jsx("main",{className:"studio-main",children:n()})]})},$ye=()=>F.jsx("div",{className:"studio-app",children:F.jsx(Nye,{})}),Iye=Ef(),Mye=f_e({storage:{type:"opfs"},worker:qye,sharedWorker:h_e}),jye=()=>F.jsxs(iye,{schema:mye,adapter:Mye,renderLoading:e=>F.jsxs("div",{className:"loading-screen",children:["Loading sspirial studio (",e.stage,")..."]}),batchUpdates:fye.unstable_batchedUpdates,storeId:Iye,syncPayload:{authToken:"insecure-token-change-me"},children:[F.jsx("div",{style:{top:0,right:0,position:"absolute",background:"#333",zIndex:9999},children:F.jsx(uye,{height:40})}),F.jsx($ye,{})]});GB.createRoot(document.getElementById("react-app")).render(F.jsx(jye,{}));
